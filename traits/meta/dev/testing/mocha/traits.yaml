# Testing Framework - MOCHA

traits:
  # === Atomic: Mocha (JavaScript) ===

  - id: mocha-word
    desc: mocha reference
    crit: inert
    conf: 0.7
    for: [javascript]
    if:
      type: string
      word: "mocha"

  # describe() and it() shared with Jest above

  - id: mocha-before
    desc: "before() hook"
    crit: inert
    conf: 0.7
    for: [javascript]
    if:
      type: string
      substr: "before("

  - id: mocha-after
    desc: "after() hook"
    crit: inert
    conf: 0.7
    for: [javascript]
    if:
      type: string
      substr: "after("

composite_rules:
  # Jest BDD functions - use the one defined in jest/traits.yaml
  # (removed duplicate - use meta/dev/testing/jest::js-bdd-functions instead)

  # Mocha (JavaScript) - all patterns helper
  - id: mocha-all-patterns
    desc: Mocha test patterns
    crit: inert
    conf: 0.7
    for: [javascript]
    needs: 3
    any:
      - { id: mocha-word }
      - { id: meta/dev/testing/jest::jest-describe }
      - { id: meta/dev/testing/jest::jest-it }
      - { id: mocha-before }
      - { id: mocha-after }

  # Mocha (JavaScript)
  - id: mocha
    desc: Mocha test framework
    crit: notable
    conf: 0.95
    for: [javascript]
    any:
      - { id: mocha-word }
      - { id: mocha-all-patterns }
