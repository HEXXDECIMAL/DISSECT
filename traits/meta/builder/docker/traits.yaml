# Build System - DOCKER

traits:
  # === Docker micro-traits ===
  - id: dockerfile
    desc: Dockerfile
    crit: notable
    conf: 0.8
    if:
      type: string
      substr: "Dockerfile"

  - id: docker-env-prefix
    desc: DOCKER_ environment prefix
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "DOCKER_"

  # Removed dockerenv duplicate - use cap/os/container/runtime/docker::dockerenv

  - id: docker-entrypoint
    desc: /docker-entrypoint path
    crit: notable
    conf: 0.8
    if:
      type: string
      substr: "/docker-entrypoint"

composite_rules:
  # Docker composite (migrated from YARA)
  - id: docker
    desc: Built in Docker container
    crit: notable
    conf: 0.8
    any:
      - id: dockerfile
      - id: docker-env-prefix
      - id: dockerenv
      - id: docker-entrypoint
