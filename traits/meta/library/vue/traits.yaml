# Vue.js Library Detection
# Neutral detection of Vue.js library presence (not malicious by itself)

defaults:
  for: [javascript]

traits:
  # Detect Vue version string
  - id: version-string
    desc: Vue version string
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "Vue\\.js v[0-9]+\\.[0-9]+\\.[0-9]+"

  # Detect Vue copyright
  - id: copyright
    desc: Vue copyright notice
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "\\* Vue\\.js v[0-9]|\\(c\\) [0-9]+-[0-9]+ Evan You"

  # Vue global object
  - id: vue-global
    desc: Vue global object signature
    crit: benign
    conf: 0.90
    if:
      type: string
      regex: "\\bVue\\.version\\b|\\bVue\\.config\\b"

  # Vue component system
  - id: vue-component
    desc: Vue component registration
    crit: benign
    conf: 0.85
    if:
      type: string
      regex: "Vue\\.(component|directive|filter|mixin)"

  # Vue instance creation
  - id: vue-instance
    desc: Vue instance constructor
    crit: benign
    conf: 0.85
    if:
      type: string
      regex: "new Vue\\(\\{|Vue\\.extend\\("

  # Vue reactivity system
  - id: vue-reactivity
    desc: Vue reactivity signature
    crit: benign
    conf: 0.80
    if:
      type: string
      regex: "\\bVue\\.observable\\b|\\bVue\\.set\\b|\\bVue\\.delete\\b"

composite_rules:
  # Detect if file is Vue (neutral, benign detection)
  - id: library
    desc: "File contains Vue.js library"
    crit: benign
    conf: 0.9
    any:
      - { id: version-string }
      - { id: copyright }
      - { id: vue-global }
      - { id: vue-component }
