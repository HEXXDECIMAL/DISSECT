# jQuery Library Detection
# Neutral detection of jQuery library presence (not malicious by itself)

defaults:
  for: [javascript]

traits:
  # Detect jQuery version string (appears in all jQuery distributions)
  - id: version-string
    desc: jQuery version string
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "jQuery v[0-9]\\.[0-9]+\\.[0-9]+"

  # Detect jquery.org domain
  - id: domain
    desc: jquery.org domain reference
    crit: benign
    conf: 0.9
    if:
      type: string
      exact: "jquery.org"

  # jQuery copyright
  - id: copyright
    desc: jQuery copyright notice
    crit: benign
    conf: 0.95
    if:
      type: string
      exact: "jQuery JavaScript Library"

  # jQuery function signatures
  - id: fn-extend
    desc: jQuery.fn.extend signature
    crit: benign
    conf: 0.85
    if:
      type: string
      regex: "jQuery\\.fn\\.extend"

composite_rules:
  # Detect if file is jQuery (neutral, benign detection)
  - id: library
    desc: "File contains jQuery library"
    crit: benign
    conf: 0.9
    count_min: 1
    any:
      - {id: version-string}
      - {id: domain}
      - {id: copyright}
    explanation: |
      This file contains jQuery library signatures. jQuery is a popular JavaScript
      library used by millions of websites for DOM manipulation and AJAX.
      The presence of jQuery itself is not suspicious.
