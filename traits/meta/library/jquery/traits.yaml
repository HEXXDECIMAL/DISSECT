# jQuery Library Detection
# Neutral detection of jQuery library presence (not malicious by itself)

defaults:
  for: [javascript]

traits:
  # Detect jQuery version string (appears in all jQuery distributions)
  - id: version-string
    desc: jQuery version string
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "jQuery v[0-9]\\.[0-9]+\\.[0-9]+"

  # Detect jquery.org domain (in comments, not string literals)
  - id: domain
    desc: jquery.org domain reference
    crit: benign
    conf: 0.9
    if:
      type: raw
      substr: "jquery.org"

  # jQuery copyright (in comments, not string literals)
  - id: copyright
    desc: jQuery copyright notice
    crit: benign
    conf: 0.95
    if:
      type: raw
      substr: "jQuery JavaScript Library"

  # jQuery function signatures
  - id: fn-extend
    desc: jQuery.fn.extend signature
    crit: benign
    conf: 0.85
    if:
      type: raw
      substr: "jQuery.fn.extend"

composite_rules:
  # Detect if file is jQuery (neutral, benign detection)
  - id: library
    desc: "File contains jQuery library"
    crit: benign
    conf: 0.9
    any:
      - { id: version-string }
      - { id: domain }
      - { id: copyright }
