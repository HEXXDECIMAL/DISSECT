# Tiny Binary Features
# Detects unusually small or stripped binaries often associated with stagers

defaults:
  for: [elf]
  crit: notable

traits:
  - id: tiny-elf
    desc: "Tiny ELF binary (< 4KB)"
    size_max: 4096

  - id: micro-elf
    desc: "Micro ELF binary (< 1KB)"
    crit: suspicious
    size_max: 1024

  - id: text-section-ratio-dominant
    desc: ".text section is >75% of"
    if:
      type: section_ratio
      section: "\\.text"
      min: 0.75
