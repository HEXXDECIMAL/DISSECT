# Cron Persistence
# MBC: B0028 (Scheduled Task/Job)
# ATT&CK: T1053.003

traits:
  - id: crontab-command
    description: crontab command (schedule/view cron jobs)
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      word: "crontab"

  - id: etc-cron-path
    description: /etc/cron directory path (system cron jobs)
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      exact: "/etc/cron"

  - id: var-spool-cron-path
    description: /var/spool/cron directory path (user cron jobs)
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      exact: "/var/spool/cron"

  - id: cron-d-path
    description: /etc/cron.d directory path (additional system cron jobs)
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      exact: "/etc/cron.d"

composite_rules:
  - id: cron
    description: Cron job persistence (command or directory paths)
    crit: notable
    conf: 0.66
    mbc: B0028
    attack: T1053.003
    any:
      - type: trait
        id: crontab-command
      - type: trait
        id: etc-cron-path
      - type: trait
        id: var-spool-cron-path
      - type: trait
        id: cron-d-path
