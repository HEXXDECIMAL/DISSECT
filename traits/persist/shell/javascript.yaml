# Shell Configuration - JavaScript/Node.js
# ATT&CK: T1546.004 (Event Triggered Execution: Unix Shell Configuration Modification)

traits:
  # === Shell profile source atomic indicators ===
  - id: source-bashrc
    description: source .bashrc
    crit: inert
    confidence: 0.7
    file_types: [javascript]
    condition:
      type: string
      regex: 'source\s+\.bashrc'

  - id: source-bash-profile
    description: source .bash_profile
    crit: inert
    confidence: 0.7
    file_types: [javascript]
    condition:
      type: string
      regex: 'source\s+\.bash_profile'

  - id: source-profile
    description: source .profile
    crit: inert
    confidence: 0.7
    file_types: [javascript]
    condition:
      type: string
      regex: 'source\s+\.profile'

  - id: source-zshrc
    description: source .zshrc
    crit: inert
    confidence: 0.7
    file_types: [javascript]
    condition:
      type: string
      regex: 'source\s+\.zshrc'

  - id: js-path-manipulation
    description: Manually manipulates PATH environment variable
    crit: notable
    confidence: 0.8
    file_types: [javascript]
    condition:
      type: string
      regex: 'process\.env\.PATH\s*='

composite_rules:
  - id: js-source-profile
    description: Sources shell profile files to reload environment
    crit: suspicious
    confidence: 0.85
    attack: "T1546.004"
    file_types: [javascript]
    count: 1
    any:
      - id: source-bashrc
      - id: source-bash-profile
      - id: source-profile
      - id: source-zshrc
