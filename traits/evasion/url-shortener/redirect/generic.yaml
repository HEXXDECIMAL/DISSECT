# URL Shortener Detection Traits
# Detects use of URL shortening services which obscure true destinations
# Often used to hide malicious payloads or C2 infrastructure
# ATT&CK: T1027.006 (Obfuscated Files or Information: HTML Smuggling)

traits:
  - id: url-shortener-bitly
    desc: URL shortened via bit.ly (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "bit\\.ly/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-tinyurl
    desc: URL shortened via tinyurl.com (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "tinyurl\\.com/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-goo-gl
    desc: URL shortened via goo.gl (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "goo\\.gl/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-t-co
    desc: URL shortened via t.co (hides true destination)
    crit: notable
    conf: 0.85
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "t\\.co/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-is-gd
    desc: URL shortened via is.gd (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "is\\.gd/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-cutt-ly
    desc: URL shortened via cutt.ly (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "cutt\\.ly/[A-Za-z0-9]+"
      search_raw: true

  - id: url-shortener-rebrand-ly
    desc: URL shortened via rebrand.ly (hides true destination)
    crit: suspicious
    conf: 0.9
    mbc: "C0036"
    attack: "T1027"
    for: [all]
    if:
      type: string
      regex: "rebrand\\.ly/[A-Za-z0-9]+"
      search_raw: true
