# Process Injection Detection - Linux
# MBC: B0033 (Process Injection)
# ATT&CK: T1055

defaults:
  for: [elf]
  platforms: [linux]

traits:
  - id: process-inject-ptrace
    desc: Process injection via ptrace
    crit: suspicious
    conf: 0.66
    mbc: "B0033"
    attack: "T1055"
    if:
      type: yara
      source: |
        rule ptrace_injection {
          strings:
            $ptrace_attach = "PTRACE_ATTACH"
            $ptrace_poketext = "PTRACE_POKETEXT"
            $process_vm_writev = "process_vm_writev"
          condition:
            any of them
        }