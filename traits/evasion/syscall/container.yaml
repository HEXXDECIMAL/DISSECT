composite_rules:
  - id: namespace-manipulation
    description: Manipulates Linux namespaces
    confidence: 0.85
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - type: syscall
        name: ["setns"]
      - type: syscall
        name: ["unshare"]

  - id: container-escape
    description: Container escape pattern - clone + setns
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - type: syscall
        name: ["clone", "clone3"]
      - type: syscall
        name: ["setns"]

  - id: chroot-escape
    description: Potential chroot escape - chdir + chroot combination
    confidence: 0.8
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - type: syscall
        name: ["chroot"]
      - type: syscall
        name: ["chdir", "fchdir"]
        min_count: 2
