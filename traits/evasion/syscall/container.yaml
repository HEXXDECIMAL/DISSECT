traits:
  - id: syscall-setns
    desc: Uses setns syscall to change
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["setns"]

  - id: syscall-unshare
    desc: Uses unshare syscall to create
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["unshare"]

  - id: syscall-clone
    desc: Uses clone/clone3 syscall to create
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["clone", "clone3"]

  - id: syscall-chroot
    desc: Uses chroot syscall to change
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["chroot"]

  - id: syscall-chdir
    desc: Uses chdir/fchdir syscall to change
    crit: notable
    conf: 0.7
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["chdir", "fchdir"]

composite_rules:
  - id: namespace-manipulation
    desc: Manipulates Linux namespaces
    conf: 0.85
    crit: suspicious
    platforms: [linux]
    for: [elf]
    any:
      - id: syscall-setns
      - id: syscall-unshare

  - id: container-escape
    desc: Container escape pattern - clone
    conf: 0.9
    crit: suspicious
    platforms: [linux]
    for: [elf]
    all:
      - id: syscall-clone
      - id: syscall-setns

  - id: chroot-escape
    desc: Potential chroot escape - chdir
    conf: 0.8
    crit: suspicious
    platforms: [linux]
    for: [elf]
    all:
      - id: syscall-chroot
      - id: syscall-chdir
