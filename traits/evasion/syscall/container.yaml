traits:
  - id: syscall-setns
    description: Uses setns syscall to change namespace
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["setns"]

  - id: syscall-unshare
    description: Uses unshare syscall to create new namespace
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["unshare"]

  - id: syscall-clone
    description: Uses clone/clone3 syscall to create new process
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["clone", "clone3"]

  - id: syscall-chroot
    description: Uses chroot syscall to change root directory
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["chroot"]

  - id: syscall-chdir
    description: Uses chdir/fchdir syscall to change directory
    criticality: notable
    confidence: 0.7
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["chdir", "fchdir"]

composite_rules:
  - id: namespace-manipulation
    description: Manipulates Linux namespaces
    confidence: 0.85
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - id: syscall-setns
      - id: syscall-unshare

  - id: container-escape
    description: Container escape pattern - clone + setns
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - id: syscall-clone
      - id: syscall-setns

  - id: chroot-escape
    description: Potential chroot escape - chdir + chroot combination
    confidence: 0.8
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - id: syscall-chroot
      - id: syscall-chdir
