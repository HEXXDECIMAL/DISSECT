# Output Suppression Detection Traits
# Detects patterns that hide command output
# Note: /dev/null redirects are common in legitimate scripts for suppressing noise
# ATT&CK: T1564.001 (Hide Artifacts: Hidden Files and Directories)

traits:
  - id: evasion/output-suppression/redirect/redirect-to-devnull
    description: Output redirected to /dev/null
    criticality: notable
    confidence: 0.5
    mbc: "F0005"
    attack: "T1564"
    file_types: [all]
    condition:
      type: string
      regex: ">/dev/null|> /dev/null"
      search_raw: true

  - id: evasion/output-suppression/redirect/stderr-to-devnull
    description: Standard error redirected to /dev/null
    criticality: notable
    confidence: 0.5
    mbc: "F0005"
    attack: "T1564"
    file_types: [all]
    condition:
      type: string
      regex: "2>/dev/null|2> /dev/null|2>&1.*>/dev/null"
      search_raw: true

  - id: evasion/output-suppression/redirect/all-output-suppressed
    description: All output suppressed (stdout and stderr to /dev/null)
    criticality: notable
    confidence: 0.6
    mbc: "F0005"
    attack: "T1564"
    file_types: [all]
    condition:
      type: string
      regex: ">/dev/null 2>&1|&>/dev/null|2>&1 >/dev/null"
      search_raw: true
