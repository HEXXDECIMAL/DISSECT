# Fileless Execution / Memory-only Staging
# Patterns for avoiding disk-based detection
# ATT&CK: T1055, T1620
# NOTE: memfd_create is defined in mem/anonymous/create/linux.yaml

traits:
  - id: dev-shm
    description: "/dev/shm staging (fileless execution)"
    criticality: suspicious
    confidence: 0.85
    mbc: "F0012"
    attack: "T1055"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/dev/shm/"

  - id: proc-self-fd
    description: "Access /proc/self/fd for file descriptor manipulation"
    criticality: notable
    confidence: 0.7
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      regex: "/proc/self/fd/"
