# Network Discovery via /proc - Linux
# Patterns for network reconnaissance and enumeration
# ATT&CK: T1016 (System Network Configuration Discovery)

traits:
  - id: tcp-connections
    description: "Enumerate TCP connections via /proc/net/tcp"
    criticality: suspicious
    confidence: 0.8
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/proc/net/tcp"

  - id: udp-connections
    description: "Enumerate UDP connections via /proc/net/udp"
    criticality: suspicious
    confidence: 0.8
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/proc/net/udp"

  - id: raw-sockets
    description: "Enumerate raw sockets via /proc/net/raw"
    criticality: suspicious
    confidence: 0.85
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/proc/net/raw"

  - id: arp-table
    description: "Read ARP table via /proc/net/arp"
    criticality: notable
    confidence: 0.75
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/proc/net/arp"

  - id: routing-table
    description: "Read routing table via /proc/net/route"
    criticality: notable
    confidence: 0.75
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    condition:
      type: string
      exact: "/proc/net/route"

composite_rules:
  - id: scanner
    description: "Network connection enumeration (target scanning)"
    criticality: suspicious
    confidence: 0.85
    mbc: "E1016"
    attack: "T1016"
    file_types: [elf]
    platforms: [linux]
    requires_any:
      - id: tcp-connections
      - id: udp-connections
      - id: raw-sockets
