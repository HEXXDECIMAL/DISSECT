# System Fingerprinting - JavaScript/Node.js
# ATT&CK: T1082 (System Information Discovery)

traits:
  - id: js-profiling
    desc: Aggregates system info for profiling
    crit: suspicious
    conf: 0.95
    attack: "T1082"
    for: [javascript]
    if:
      type: yara
      source: |
        rule js_profiling {
          strings:
            $os1 = "os.hostname()" ascii
            $os2 = "os.userInfo()" ascii
            $os3 = "os.platform()" ascii
          condition:
            all of them
        }

composite_rules:
  - id: js-profiling-exfil
    desc: JavaScript system profiling with exfiltration
    crit: hostile
    conf: 0.98
    mbc: "E1082"
    attack: "T1020"
    for: [javascript]
    all:
      - id: js-profiling
      - id: comm/http/request/js-axios-post
      - id: fs/file/read
