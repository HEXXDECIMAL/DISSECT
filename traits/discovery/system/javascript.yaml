# System Fingerprinting - JavaScript/Node.js
# ATT&CK: T1082 (System Information Discovery)

traits:
  - id: js-profiling
    description: Aggregates system info for profiling
    criticality: suspicious
    confidence: 0.95
    attack: "T1082"
    file_types: [javascript]
    condition:
      type: yara
      source: |
        rule js_profiling {
          strings:
            $os1 = "os.hostname()" ascii
            $os2 = "os.userInfo()" ascii
            $os3 = "os.platform()" ascii
          condition:
            all of them
        }

composite_rules:
  - id: js-profiling-exfil
    description: JavaScript system profiling with exfiltration
    criticality: hostile
    confidence: 0.98
    mbc: "E1082"
    attack: "T1020"
    file_types: [javascript]
    requires_all:
      - id: js-profiling
      - id: comm/http/request/js-axios-post
      - id: fs/file/read
