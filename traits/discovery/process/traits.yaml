# Process Discovery Traits - Symbol-based Detection
# MBC: OB0007 (Discovery) â†’ E1057 (Process Discovery)
# ATT&CK: T1057 (Process Discovery)

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # User ID functions
  - id: getuid
    desc: Get real user ID of calling process
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: getuid
    platforms: [unix, linux, macos]

  - id: geteuid
    desc: Get effective user ID of calling process
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: geteuid
    platforms: [unix, linux, macos]

  - id: getgid
    desc: Get real group ID of calling process
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: getgid
    platforms: [unix, linux, macos]

  - id: getegid
    desc: Get effective group ID of calling process
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: getegid
    platforms: [unix, linux, macos]

  # Process ID functions
  - id: getpid
    desc: Get process ID of calling process
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: getpid
    platforms: [unix, linux, macos]

  - id: getppid
    desc: Get parent process ID
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      pattern: getppid
    platforms: [unix, linux, macos]

  # User information lookup
  - id: getpwnam
    desc: Get user database entry by name
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      pattern: getpwnam
    platforms: [unix, linux, macos]

  - id: getpwuid
    desc: Get user database entry by UID
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      pattern: getpwuid
    platforms: [unix, linux, macos]

  # Group information lookup
  - id: getgrnam
    desc: Get group database entry by name
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      pattern: getgrnam
    platforms: [unix, linux, macos]

  - id: getgrgid
    desc: Get group database entry by GID
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      pattern: getgrgid
    platforms: [unix, linux, macos]
