# Process Information Discovery - Python
# Detects Python code that enumerates or introspects running processes

traits:
  - id: psutil-enum
    description: "Enumerates running processes via psutil"
    criticality: notable
    confidence: 0.9
    file_types: [python]
    condition:
      type: string
      regex: 'psutil\.process_iter\('

  - id: tasklist-shell
    description: "Enumerates processes via shell command (tasklist/pgrep)"
    criticality: notable
    confidence: 0.8
    file_types: [python]
    condition:
      type: string
      regex: 'tasklist|pgrep|ps -ef'

composite_rules:
  - id: anti-analysis-recon
    description: "Process-based anti-analysis/recon (psutil + sensitive process)"
    criticality: suspicious
    confidence: 0.9
    requires_all:
      - type: trait
        id: process/psutil-enum
      - type: string
        regex: 'Wireshark|vbox|vmware|charles|fiddler'