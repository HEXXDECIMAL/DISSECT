# Terminal ANSI Color Handling - Python
# Detects libraries/code that manipulate terminal colors and styles
# These are benign terminal output formatting mechanisms

defaults:
  for: [python]
  crit: inert

traits:
  # ANSI escape code usage
  - id: escape-codes
    desc: "ANSI terminal escape codes"
    conf: 0.8
    if:
      type: string
      regex: "\\\\x1b\\[|\\\\033\\[|\\\\e\\["
      search_raw: true

  # colorama library
  - id: colorama
    desc: "Terminal color library (colorama)"
    conf: 0.9
    if:
      type: string
      regex: "colorama|from\\s+\\.ansi\\s+import|Fore,\\s*Back,\\s*Style"
      search_raw: true

  # Terminal color classes
  - id: color-classes
    desc: "Terminal color/style classes"
    conf: 0.85
    if:
      type: string
      regex: "\\bFore\\b|\\bBack\\b|\\bStyle\\b|\\bCursor\\b"
      search_raw: true

  # Windows console handling
  - id: windows-console
    desc: "Windows console color compatibility"
    conf: 0.8
    if:
      type: string
      regex: "AnsiToWin32|just_fix_windows_console|colorama_text"
      search_raw: true
