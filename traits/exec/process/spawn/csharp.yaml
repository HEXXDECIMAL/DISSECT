# C# Process Execution Traits
# objective: exec, behavior: process

traits:
  - id: start
    description: Process execution via Process.Start
    criticality: suspicious
    mbc: "OB0006"
    attack: "T1059"
    confidence: 0.95
    condition:
      type: ast_pattern
      node_type: invocation_expression
      pattern: "Process.Start"
    file_types: [csharp]

  - id: start-info
    description: Process start configuration
    criticality: notable
    mbc: "OB0006"
    attack: "T1059"
    confidence: 0.85
    condition:
      type: ast_pattern
      node_type: object_creation_expression
      pattern: "ProcessStartInfo"
    file_types: [csharp]

  - id: current-process
    description: Acquires handle to current process (often precedes self-termination)
    criticality: notable
    mbc: "OB0006"
    confidence: 0.85
    condition:
      type: ast_pattern
      node_type: invocation_expression
      pattern: "GetCurrentProcess"
    file_types: [csharp]

  - id: terminate
    description: Process termination via Kill()
    criticality: suspicious
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.95
    condition:
      type: ast_pattern
      node_type: invocation_expression
      pattern: ".Kill("
    file_types: [csharp]
