# C# Process Execution Traits
# objective: exec, behavior: process

traits:
  - id: start
    desc: Process execution via Process.Start
    crit: suspicious
    mbc: "OB0006"
    attack: "T1059"
    conf: 0.95
    if:
      type: ast_pattern
      node_type: invocation_expression
      pattern: "Process.Start"
    for: [csharp]

  - id: start-info
    desc: Process start configuration
    crit: notable
    mbc: "OB0006"
    attack: "T1059"
    conf: 0.85
    if:
      type: ast_pattern
      node_type: object_creation_expression
      pattern: "ProcessStartInfo"
    for: [csharp]

  - id: current-process
    desc: Acquires handle to current process (often precedes self-termination)
    crit: notable
    mbc: "OB0006"
    conf: 0.85
    if:
      type: ast_pattern
      node_type: invocation_expression
      pattern: "GetCurrentProcess"
    for: [csharp]

  - id: terminate
    desc: Process termination via Kill()
    crit: suspicious
    mbc: "E1562"
    attack: "T1562"
    conf: 0.95
    if:
      type: ast_pattern
      node_type: invocation_expression
      pattern: ".Kill("
    for: [csharp]
