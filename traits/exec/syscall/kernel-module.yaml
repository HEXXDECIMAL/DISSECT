traits:
  - id: syscall-init-module
    description: "init_module syscall for loading kernel module"
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["init_module"]

  - id: syscall-finit-module
    description: "finit_module syscall for loading kernel module from file descriptor"
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["finit_module"]

  - id: syscall-delete-module
    description: "delete_module syscall for unloading kernel module"
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["delete_module"]

  - id: syscall-kexec-load
    description: "kexec_load syscall for loading new kernel"
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["kexec_load"]

  - id: syscall-kexec-file-load
    description: "kexec_file_load syscall for loading new kernel from file"
    criticality: notable
    confidence: 0.8
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["kexec_file_load"]

composite_rules:
  - id: kernel-module-load
    description: Loads kernel module
    confidence: 0.95
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - id: syscall-init-module
      - id: syscall-finit-module

  - id: kernel-module-unload
    description: Unloads kernel module
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - id: syscall-delete-module

  - id: kexec
    description: Loads new kernel for kexec
    confidence: 0.95
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - id: syscall-kexec-load
      - id: syscall-kexec-file-load
