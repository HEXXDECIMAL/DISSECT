traits:
  - id: syscall-memfd-create
    desc: Calls memfd_create syscall
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["memfd_create"]

  - id: syscall-execve
    desc: Calls execve or execveat syscall
    crit: notable
    conf: 0.8
    platforms: [linux]
    for: [elf]
    if:
      type: syscall
      name: ["execve", "execveat"]

composite_rules:
  - id: memfd
    desc: Creates anonymous file in memory
    conf: 0.9
    crit: suspicious
    platforms: [linux]
    for: [elf]
    requires_all:
      - id: syscall-memfd-create

  - id: fileless
    desc: Fileless execution - memfd_create + execve
    conf: 0.95
    crit: suspicious
    platforms: [linux]
    for: [elf]
    requires_all:
      - id: syscall-memfd-create
      - id: syscall-execve
