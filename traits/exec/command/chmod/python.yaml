# File permission modification (Python)
# ATT&CK: T1222.002 (File and Directory Permissions Modification: Linux and Mac)

traits:
  - id: call
    desc: "Modifies file permissions via os.chmod"
    crit: notable
    conf: 0.85
    mbc: "C0047"
    attack: "T1222.002"
    for: [python]
    if:
      type: string
      regex: "os\\.chmod\\("

  - id: executable
    desc: "Sets executable permissions via chmod (0o7xx)"
    crit: suspicious
    conf: 0.9
    mbc: "C0047"
    attack: "T1222.002"
    for: [python]
    if:
      type: string
      regex: "0o7[0-7][0-7]"
