# NOTE: "do shell script" is defined in evasion/applescript/traits.yaml (do-shell-script)
# NOTE: "tell application" is defined in evasion/applescript/traits.yaml (tell-application)

traits:
  - id: lure
    description: "AppleScript social engineering lure (Compatibility Wizard)"
    criticality: hostile
    confidence: 1.0
    condition:
      type: string
      regex: "(?i)Compatibility Wizard|compatibility issue|Missing required extensions"

  - id: system-exec
    description: "AppleScript low-level system execution indicator"
    criticality: suspicious
    confidence: 0.8
    condition:
      type: string
      regex: "sysoexec|sysoopen"

  - id: app-reference
    description: "AppleScript references system applications"
    criticality: notable
    confidence: 0.7
    condition:
      type: string
      regex: "System Settings\\.app|System Preferences\\.app|Keychain Access\\.app"
