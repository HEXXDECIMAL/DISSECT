# Process detachment / daemonization
# MBC: F0003 (Process Detach)

traits:
  - id: python
    description: "Detaches process via os.setsid"
    criticality: suspicious
    confidence: 0.9
    mbc: "F0003"
    attack: "T1036"
    file_types: [python]
    condition:
      type: string
      exact: "os.setsid"

  - id: preexec-fn
    description: "Manipulates process via subprocess preexec_fn"
    criticality: suspicious
    confidence: 0.85
    mbc: "F0003"
    file_types: [python]
    condition:
      type: string
      exact: "preexec_fn="

  - id: c
    description: "Calls setsid() system call"
    criticality: notable
    confidence: 0.8
    mbc: "F0003"
    file_types: [c]
    condition:
      type: symbol
      pattern: setsid
