# Python subprocess execution
# ATT&CK: T1059.006 (Python)

traits:
  - id: run
    description: "Executes external system command"
    criticality: notable
    confidence: 0.85
    mbc: "C0017"
    attack: "T1059.006"
    file_types: [python]
    condition:
      type: ast_query
      language: python
      query: |
        (call
          function: (attribute
            attribute: (identifier) @meth)
          arguments: (argument_list
            (string) @cmd))
        (#match? @meth "^(Popen|run|call|check_output|system|spawn)$")
