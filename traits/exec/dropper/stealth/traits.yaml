# Stealth execution patterns (output hiding, process detachment)
# MBC: F0003 (Process Detach), F0005 (Hide Output)

traits:
  - id: devnull
    description: "subprocess.DEVNULL to hide output"
    criticality: notable
    confidence: 0.75
    mbc: "F0005"
    file_types: [python]
    condition:
      type: string
      exact: "subprocess.DEVNULL"

  - id: close-fds
    description: "close_fds=True for file descriptor isolation"
    criticality: notable
    confidence: 0.7
    file_types: [python]
    condition:
      type: string
      exact: "close_fds=True"

composite_rules:
  - id: python
    description: "Process execution with output hiding and detachment"
    confidence: 0.92
    criticality: suspicious
    mbc: "F0003"
    attack: "T1036"
    file_types: [python]
    requires_count: 3
    conditions:
      - type: string
        regex: "subprocess\\.Popen\\("
      - type: string
        exact: "subprocess.DEVNULL"
      - type: string
        exact: "os.setsid"
      - type: string
        exact: "close_fds=True"
      - type: string
        exact: "preexec_fn="
