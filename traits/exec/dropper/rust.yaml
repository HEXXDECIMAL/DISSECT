# Dropper - Rust
# ATT&CK: T1105

traits:
  - id: client-get
    desc: HTTP client.get call
    crit: inert
    conf: 0.6
    for: [rust]
    if:
      type: string
      exact: "client.get"

  - id: write-body
    desc: Write HTTP body to file
    crit: inert
    conf: 0.6
    for: [rust]
    if:
      type: string
      exact: ".write(&body)"

  - id: spawn-call
    desc: Process spawn call
    crit: inert
    conf: 0.6
    for: [rust]
    if:
      type: string
      exact: ".spawn()"

composite_rules:
  - id: rust-download-exec
    desc: Downloads and executes a file
    crit: suspicious
    conf: 0.95
    attack: "T1105"
    mbc: "B0024"
    for: [rust]
    all:
      - id: client-get
      - id: write-body
      - id: spawn-call
