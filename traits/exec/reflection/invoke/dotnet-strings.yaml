# .NET Reflection Patterns (string-based for compiled assemblies)
# These complement the AST-based csharp.yaml traits

defaults:
  file_types: [pe, dll, csharp]

traits:
  - id: namespace-import
    description: System.Reflection namespace usage
    criticality: notable
    confidence: 0.70
    condition:
      type: string
      exact: "System.Reflection"

  - id: activator
    description: Dynamic object instantiation via Activator
    criticality: notable
    confidence: 0.80
    condition:
      type: string
      exact: "Activator"

  - id: property-info
    description: Reflection property access
    criticality: notable
    confidence: 0.70
    condition:
      type: string
      regex: "PropertyInfo|GetProperties"

  - id: method-info
    description: Reflection method access
    criticality: notable
    confidence: 0.70
    condition:
      type: string
      regex: "MethodInfo|GetMethod|GetMethods"

  - id: type-info
    description: Runtime type inspection
    criticality: notable
    confidence: 0.70
    condition:
      type: string
      regex: "GetType\\(|typeof\\(|TypeInfo"
