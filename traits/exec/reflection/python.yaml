# Python Reflection and Dynamic Imports
# Detects attempts to hide module loading or function access

traits:
  - id: dynamic-import
    description: "Dynamic module import via __import__"
    criticality: suspicious
    confidence: 0.8
    file_types: [python]
    condition:
      type: string
      regex: "__import__("

  - id: getattr-module
    description: "Dynamic attribute access on modules (potential shadowing)"
    criticality: suspicious
    confidence: 0.7
    file_types: [python]
    condition:
      type: string
      regex: "getattr(.*? ,.*?)"

composite_rules:
  - id: obfuscated-import
    description: "Obfuscated module import (Dynamic Import + Encoding)"
    criticality: suspicious
    confidence: 0.95
    attack: "T1027"
    mbc: "F0001"
    file_types: [python]
    requires_all:
      - id: exec/reflection/dynamic-import
      - id: anti-static/obfuscation/strings/python-hex
      - id: exec/reflection/getattr-module
