# Large Obfuscated Payload Detection - Python
# Detects large blobs of encoded data embedded in scripts

traits:
  - id: large-encoded-string
    desc: "Large high-entropy string literal (likely payload)"
    crit: suspicious
    conf: 0.85
    for: [python]
    if:
      type: yara
      source: |
        rule large_encoded_string {
          strings:
            // Matches long strings of base64-like or hex-like data without spaces
            $b64 = /[A-Za-z0-9+\/]{512,}/
            $hex = /[0-9a-fA-F]{1024,}/
          condition:
            any of them
        }
