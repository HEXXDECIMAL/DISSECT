# React Library Detection
# Neutral detection of React library presence (not malicious by itself)

defaults:
  for: [javascript]

traits:
  # Detect React version banner (appears in development builds)
  - id: version-banner
    desc: React version banner
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "React (v)?[0-9]+\\.[0-9]+\\.[0-9]+"

  # Detect React copyright notice
  - id: copyright
    desc: React copyright notice
    crit: benign
    conf: 0.95
    if:
      type: string
      regex: "\\* React (\\(with addons\\) )?v[0-9]"

  # Detect React package name
  - id: package-name
    desc: React package identifier
    crit: benign
    conf: 0.90
    if:
      type: string
      regex: "@license React|React \\(c\\) (Facebook|Meta)"

  # React object signature
  - id: react-object
    desc: React object initialization
    crit: benign
    conf: 0.85
    if:
      type: string
      regex: "\\bReact\\.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\\b"

  # ReactDOM signature
  - id: react-dom
    desc: ReactDOM object reference
    crit: benign
    conf: 0.85
    if:
      type: string
      regex: "\\bReactDOM\\.(render|createRoot|hydrate)"

  # React JSX pragma
  - id: jsx-pragma
    desc: React JSX transformation signature
    crit: benign
    conf: 0.80
    if:
      type: string
      regex: "React\\.createElement\\("

composite_rules:
  # Detect if file is React (neutral, benign detection)
  - id: library
    desc: "File contains React library"
    crit: benign
    conf: 0.9
    count_min: 1
    any:
      - {id: version-banner}
      - {id: copyright}
      - {id: package-name}
      - {id: react-object}
    explanation: |
      This file contains React library signatures. React is a popular JavaScript
      library for building user interfaces, used by millions of websites.
      The presence of React itself is not suspicious.
