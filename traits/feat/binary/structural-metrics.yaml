# Binary Structural Metrics
# Observational traits for binary organization and characteristics

traits:
  # === Binary Size Metrics ===

  - id: small-elf-binary
    desc: "Small ELF binary (< 50KB)"
    crit: notable
    conf: 0.6
    for: [elf]
    if:
      type: filesize
      max: 51200

  # === Function Size Metrics ===

  - id: large-functions
    desc: "Binary contains unusually large functions"
    crit: notable
    conf: 0.65
    if:
      type: metrics
      field: binary.huge_functions
      min: 2

  # === Linear Code Patterns ===

  # NOTE: Go and Rust binaries have many linear functions due to compilation
  # patterns (inlining, code generation). Raised threshold significantly -
  # a typical Go binary has 500+ linear functions from runtime alone.
  - id: linear-code-ratio
    desc: "High ratio of linear functions"
    crit: inert
    conf: 0.4
    if:
      type: metrics
      field: binary.linear_functions
      min: 1000

  # === Complexity Metrics ===

  - id: low-average-complexity
    desc: "Low average code complexity (simple"
    crit: inert
    conf: 0.75
    if:
      type: metrics
      field: binary.avg_complexity
      max: 3

  # === Section Metrics ===

  - id: dominant-text-section
    desc: "Binary with dominant .text section"
    crit: notable
    conf: 0.6
    if:
      type: metrics
      field: binary.largest_section_ratio
      min: 0.75
