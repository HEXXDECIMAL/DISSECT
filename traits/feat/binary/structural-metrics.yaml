# Binary Structural Metrics
# Observational traits for binary organization and characteristics

traits:
  # === Function Size Metrics ===

  - id: large-functions
    description: "Binary contains unusually large functions"
    crit: notable
    conf: 0.65
    if:
      type: metrics
      field: binary.huge_functions
      min: 2

  # === Linear Code Patterns ===

  # NOTE: Go and Rust binaries have many linear functions due to compilation
  # patterns (inlining, code generation). Raised threshold significantly -
  # a typical Go binary has 500+ linear functions from runtime alone.
  - id: linear-code-ratio
    description: "High ratio of linear functions (monolithic or VM structure)"
    crit: inert
    conf: 0.4
    if:
      type: metrics
      field: binary.linear_functions
      min: 1000

  # === Complexity Metrics ===

  - id: low-average-complexity
    description: "Low average code complexity (simple functions or generated code)"
    crit: inert
    conf: 0.75
    if:
      type: metrics
      field: binary.avg_complexity
      max: 3

  # === Section Metrics ===

  - id: dominant-text-section
    description: "Binary with dominant .text section (monolithic multicall binary)"
    crit: notable
    conf: 0.6
    if:
      type: metrics
      field: binary.largest_section_ratio
      min: 0.75
