# Generic Intent Markers
# Used to categorize application purpose

traits:
  - id: magic
    desc: Magic marker string
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "\b(ebpf|bpf|rootkit|hide)[_-]?magic\b"
      case_insensitive: true

  - id: trigger
    desc: Trigger marker string
    crit: inert
    conf: 0.6
    if:
      type: string
      word: "Trigger"
      case_insensitive: true

  - id: backdoor
    desc: Backdoor marker string
    crit: suspicious
    conf: 0.7
    if:
      type: string
      # Match backdoor in malware context, not game/physical doors
      # Require adjacent technical terms like c2, shell, trojan, etc.
      regex: "backdoor[_-]?(shell|c2|trojan|server|client|agent|payload|access|connection|remote)"
      case_insensitive: true

  - id: secret
    desc: Secret marker string
    crit: inert
    conf: 0.6
    if:
      type: string
      # Match secret in malware context, not game/dungeon contexts
      # Require adjacent technical terms like key, token, api, exfil
      regex: "secret[_-]?(key|token|api|exfil|data|steal|grab)"
      case_insensitive: true

  - id: offensive-symbol
    desc: Offensive symbol marker
    crit: notable
    conf: 0.7
    if:
      type: string
      regex: "Âçê|hackend| ransomware|encrypted your files"
      case_insensitive: true

  - id: ransomware-banner
    desc: Ransomware tool marker
    crit: suspicious
    conf: 0.75
    if:
      type: string
      regex: "decrypt.{0,50}payment|pay.{0,50}bitcoin|ransom.{0,50}note|your files.{0,50}encrypted"
      case_insensitive: true

