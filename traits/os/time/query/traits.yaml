# Time and Date Operation Traits
# MBC: OB0009 (Operating System) â†’ Various time-related operations
# ATT&CK: T1124 (System Time Discovery), T1070.006 (Timestomp)

traits:
  # Time retrieval
  - id: os/time/query/time
    description: Get current calendar time (seconds since epoch)
    criticality: inert
    mbc: "T1124"
    attack: "T1124"
    confidence: 0.3
    condition:
      type: symbol
      pattern: time
    platforms: [unix, linux, macos, windows]

  - id: os/time/query/gettimeofday
    description: Get current time with microsecond precision
    criticality: inert
    mbc: "T1124"
    attack: "T1124"
    confidence: 0.3
    condition:
      type: symbol
      pattern: gettimeofday
    platforms: [unix, linux, macos]

  - id: os/time/query/clock_gettime
    description: Get time from specified clock
    criticality: inert
    mbc: "T1124"
    attack: "T1124"
    confidence: 0.3
    condition:
      type: symbol
      pattern: clock_gettime
    platforms: [unix, linux, macos]

  # Time formatting and conversion
  - id: os/time/query/localtime
    description: Convert time to local time structure
    criticality: inert
    confidence: 0.2
    condition:
      type: symbol
      pattern: localtime
    platforms: [unix, linux, macos, windows]

  - id: os/time/query/gmtime
    description: Convert time to UTC time structure
    criticality: inert
    confidence: 0.2
    condition:
      type: symbol
      pattern: gmtime
    platforms: [unix, linux, macos, windows]

  - id: os/time/query/strftime
    description: Format time as string
    criticality: inert
    confidence: 0.2
    condition:
      type: symbol
      pattern: strftime
    platforms: [unix, linux, macos, windows]

  - id: os/time/query/strptime
    description: Parse time string into time structure
    criticality: inert
    confidence: 0.2
    condition:
      type: symbol
      pattern: strptime
    platforms: [unix, linux, macos]

  # Time manipulation (suspicious for timestomping)
  - id: os/time/query/settimeofday
    description: Set system time (requires privileges)
    criticality: suspicious
    mbc: "F0005"
    attack: "T1070.006"
    confidence: 0.9
    condition:
      type: symbol
      pattern: settimeofday
    platforms: [unix, linux, macos]

  - id: os/time/query/clock_settime
    description: Set time for specified clock (requires privileges)
    criticality: suspicious
    mbc: "F0005"
    attack: "T1070.006"
    confidence: 0.9
    condition:
      type: symbol
      pattern: clock_settime
    platforms: [unix, linux, macos]

  - id: os/time/query/utimes
    description: Change file access and modification times
    criticality: notable
    mbc: "F0005"
    attack: "T1070.006"
    confidence: 0.7
    condition:
      type: symbol
      pattern: utimes|utimensat|futimens
    platforms: [unix, linux, macos]

  # Sleep/delay functions
  - id: os/time/query/sleep
    description: Suspend execution for interval
    criticality: inert
    confidence: 0.4
    condition:
      type: symbol
      pattern: sleep|usleep|nanosleep
    platforms: [unix, linux, macos]
