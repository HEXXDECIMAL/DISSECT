# C# Time-based Trigger Traits
# objective: time, behavior: trigger (potential logic bombs)

traits:
  - id: datetime-now
    description: Current time access (potential time-based trigger)
    crit: inert
    mbc: "B0003"
    confidence: 0.6
    condition:
      type: ast_pattern
      node_type: member_access_expression
      pattern: "DateTime.Now"
    file_types: [csharp]

  - id: datetime-utcnow
    description: Current UTC time access
    crit: inert
    mbc: "B0003"
    confidence: 0.6
    condition:
      type: ast_pattern
      node_type: member_access_expression
      pattern: "DateTime.UtcNow"
    file_types: [csharp]

  - id: hardcoded-datetime
    description: Hardcoded date/time value (potential logic bomb trigger)
    crit: notable
    mbc: "B0003"
    attack: "T1480.001"
    confidence: 0.75
    condition:
      type: ast_pattern
      node_type: object_creation_expression
      pattern: "new DateTime"
    file_types: [csharp]
