# Keylogging - JavaScript/Node.js
# ATT&CK: T1056.001 (Input Capture: Keylogging)

traits:
  - id: js-keyboard-listener
    description: Global keyboard listener implementation
    criticality: suspicious
    confidence: 0.9
    mbc: "B0015"
    attack: "T1056.001"
    file_types: [javascript]
    condition:
      type: string
      regex: "GlobalKeyboardListener"

composite_rules:
  - id: js-keylogger-exfil
    description: JavaScript keylogger with exfiltration
    criticality: suspicious
    confidence: 0.95
    attack: "T1056.001"
    mbc: "B0015"
    file_types: [javascript]
    requires_all:
      - type: trait
        id: js-keyboard-listener
      - type: trait
        id: comm/http/request/js-axios-post
