# Clipboard Monitoring - JavaScript/Node.js
# MBC: B0014 (Clipboard Data)
# ATT&CK: T1553 (Capture Clipboard)

traits:
  - id: js-pbpaste
    description: Accesses system clipboard via pbpaste (macOS)
    criticality: suspicious
    confidence: 0.95
    attack: "T1553"
    file_types: [javascript]
    condition:
      type: string
      exact: "pbpaste"

  - id: js-powershell-clipboard
    description: Accesses system clipboard via PowerShell (Windows)
    criticality: suspicious
    confidence: 0.95
    attack: "T1553"
    file_types: [javascript]
    condition:
      type: string
      regex: 'powershell.*Get-Clipboard'

  - id: js-xclip
    description: Accesses system clipboard via xclip (Linux)
    criticality: suspicious
    confidence: 0.95
    attack: "T1553"
    file_types: [javascript]
    condition:
      type: string
      exact: "xclip"

composite_rules:
  - id: js-clipboard-exfil
    description: JavaScript clipboard theft with exfiltration
    criticality: hostile
    confidence: 0.98
    attack: "T1553"
    requires_all:
      - type: trait
        id: comm/http/request/js-axios-post
    requires_any:
      - type: trait
        id: credential/clipboard/monitor/js-pbpaste
      - type: trait
        id: credential/clipboard/monitor/js-powershell-clipboard
      - type: trait
        id: credential/clipboard/monitor/js-xclip
