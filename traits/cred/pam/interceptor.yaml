# PAM Credential Interception
# ATT&CK: T1556.003 (Modify Authentication Process: Pluggable Authentication Modules)

traits:
  - id: interceptor
    desc: "Accesses PAM authentication tokens (potential credential stealer)"
    crit: suspicious
    conf: 0.8
    attack: "T1556.003"
    if:
      type: yara
      source: |
        rule pam_interceptor {
          strings:
            $lib = "libpam.so" ascii
            
            // Critical: Accessing the auth token (password)
            $get = "pam_get_item" ascii
            $set = "pam_set_item" ascii
            
            // Context: Auth functions
            $auth = "pam_authenticate" ascii
            $sess = "pam_open_session" ascii
            
          condition:
            $lib and ($get or $set) and ($auth or $sess)
        }
