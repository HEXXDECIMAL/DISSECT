# Secret/Credential Environment Variable Access - Generic
# Detects access to sensitive environment variables
# ATT&CK: T1552.001 (Credentials In Files)

traits:
  - id: credential/environment/secret-access/github-token
    description: GITHUB_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      regex: "GITHUB_TOKEN|GH_TOKEN"

  - id: credential/environment/secret-access/aws-access-key
    description: AWS_ACCESS_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      regex: "AWS_ACCESS_KEY"

  - id: credential/environment/secret-access/aws-secret
    description: AWS_SECRET environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      regex: "AWS_SECRET"

  - id: credential/environment/secret-access/api-key-generic
    description: Generic API_KEY environment variable access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.001"
    condition:
      type: string
      exact: "API_KEY"

  - id: credential/environment/secret-access/secret-key-generic
    description: Generic SECRET_KEY environment variable access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.001"
    condition:
      type: string
      exact: "SECRET_KEY"

  - id: credential/environment/secret-access/discord-token
    description: DISCORD_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "DISCORD_TOKEN"

  - id: credential/environment/secret-access/slack-token
    description: SLACK_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "SLACK_TOKEN"

  - id: credential/environment/secret-access/openai-api-key
    description: OPENAI_API_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "OPENAI_API_KEY"

  - id: credential/environment/secret-access/anthropic-api-key
    description: ANTHROPIC_API_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "ANTHROPIC_API_KEY"
