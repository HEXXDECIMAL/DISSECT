# Secret/Credential Environment Variable Access - Generic
# Detects access to sensitive environment variables
# ATT&CK: T1552.001 (Credentials In Files)

traits:
  # === GitHub token atomic indicators ===
  - id: github-token-var
    description: GITHUB_TOKEN environment variable
    criticality: notable
    confidence: 0.85
    attack: "T1552.001"
    condition:
      type: string
      exact: "GITHUB_TOKEN"

  - id: gh-token-var
    description: GH_TOKEN environment variable
    criticality: notable
    confidence: 0.85
    attack: "T1552.001"
    condition:
      type: string
      exact: "GH_TOKEN"

  - id: aws-access-key
    description: AWS_ACCESS_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      regex: "AWS_ACCESS_KEY"

  - id: aws-secret
    description: AWS_SECRET environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      regex: "AWS_SECRET"

  - id: api-key-generic
    description: Generic API_KEY environment variable access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.001"
    condition:
      type: string
      exact: "API_KEY"

  - id: secret-key-generic
    description: Generic SECRET_KEY environment variable access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.001"
    condition:
      type: string
      exact: "SECRET_KEY"

  - id: discord-token
    description: DISCORD_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "DISCORD_TOKEN"

  - id: slack-token
    description: SLACK_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "SLACK_TOKEN"

  - id: openai-api-key
    description: OPENAI_API_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "OPENAI_API_KEY"

  - id: anthropic-api-key
    description: ANTHROPIC_API_KEY environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    condition:
      type: string
      exact: "ANTHROPIC_API_KEY"

composite_rules:
  # GitHub token composite
  - id: github-token
    description: GitHub token environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    requires_count: 1
    conditions:
      - id: github-token-var
      - id: gh-token-var
