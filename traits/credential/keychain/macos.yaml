# Keychain Credential Access (macOS)
# MBC: E1003 (Credential Dumping)
# ATT&CK: T1555.001

traits:
  - id: credential/keychain/access
    description: macOS Keychain access
    criticality: suspicious
    confidence: 0.66
    attack: "T1555.001"
    condition:
      type: yara
      source: |
        rule keychain_access {
          strings:
            $security = "security" fullword
            $keychain = "keychain"
            $find_generic = "find-generic-password"
            $dump = "dump-keychain"
            $SecKeychainOpen = "SecKeychainOpen"
            $SecKeychainCopyDefault = "SecKeychainCopyDefault"
          condition:
            any of them
        }
