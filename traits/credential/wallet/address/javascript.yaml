# Cryptocurrency Address Regex Detection - JavaScript
# Detects code containing regex patterns for cryptocurrency addresses
# This is a strong indicator of clipboard hijackers or form interceptors
# ATT&CK: T1556 (Modify Authentication Process), T1557 (Adversary-in-the-Middle)

defaults:
  file_types: [javascript]
  attack: "T1557"
  criticality: suspicious

traits:
  # Ethereum address regex pattern
  - id: credential/wallet/address/ethereum-regex
    description: "Ethereum address regex pattern (0x...40 hex)"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "0x\\[a-fA-F0-9\\]\\{40\\}|\\\\b0x\\[a-fA-F0-9\\]"

  # Bitcoin Legacy address regex (1xxx)
  - id: credential/wallet/address/bitcoin-legacy-regex
    description: "Bitcoin legacy address regex pattern"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "1\\[a-km-zA-HJ-NP-Z1-9\\]\\{25,34\\}"

  # Bitcoin SegWit address regex (bc1xxx)
  - id: credential/wallet/address/bitcoin-segwit-regex
    description: "Bitcoin SegWit address regex pattern"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "bc1\\[qpzry9x8gf2tvdw0s3jn54khce6mua7l\\]"

  # Bitcoin Cash address regex
  - id: credential/wallet/address/bitcoin-cash-regex
    description: "Bitcoin Cash address regex pattern"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "bitcoincash:\\[qp\\]\\[a-zA-Z0-9\\]"

  # Litecoin address regex
  - id: credential/wallet/address/litecoin-regex
    description: "Litecoin address regex pattern"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "ltc1\\[qpzry9x8gf2tvdw0s3jn54khce6mua7l\\]|\\[mlML\\]\\[a-km-zA-HJ-NP-Z1-9\\]"

  # TRON address regex (Txxx)
  - id: credential/wallet/address/tron-regex
    description: "TRON address regex pattern"
    confidence: 0.9
    criticality: hostile
    condition:
      type: string
      regex: "\\[T\\]\\[1-9A-HJ-NP-Za-km-z\\]\\{33\\}"

  # Solana address regex
  - id: credential/wallet/address/solana-regex
    description: "Solana address regex pattern"
    confidence: 0.85
    criticality: hostile
    condition:
      type: string
      regex: "\\[1-9A-HJ-NP-Za-km-z\\]\\{32,44\\}"

composite_rules:
  # Multiple cryptocurrency address patterns = clipboard hijacker
  - id: credential/wallet/address/multi-crypto-regex
    description: "Multiple cryptocurrency address regex patterns (clipboard hijacker)"
    criticality: hostile
    confidence: 0.95
    requires_count: 2
    conditions:
      - type: string
        regex: "0x\\[a-fA-F0-9\\]\\{40\\}"
      - type: string
        regex: "1\\[a-km-zA-HJ-NP-Z1-9\\]"
      - type: string
        regex: "bc1\\[qpzry9x8gf2tvdw0s3jn54khce6mua7l\\]"
      - type: string
        regex: "bitcoincash:"
      - type: string
        regex: "ltc1\\[qpzry9x8gf2tvdw0s3jn54khce6mua7l\\]"
      - type: string
        regex: "\\[T\\]\\[1-9A-HJ-NP-Za-km-z\\]\\{33\\}"
