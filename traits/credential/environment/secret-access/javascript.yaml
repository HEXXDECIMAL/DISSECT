# NPM/Node.js Credential Environment Variable Access
# Detects access to npm and Node.js specific tokens
# ATT&CK: T1552.001 (Credentials In Files)

traits:
  - id: credential/environment/secret-access/npm-token
    description: NPM_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      exact: "NPM_TOKEN"

  - id: credential/environment/secret-access/node-auth-token
    description: NODE_AUTH_TOKEN environment variable access
    criticality: suspicious
    confidence: 0.95
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      exact: "NODE_AUTH_TOKEN"

  - id: credential/environment/secret-access/npm-config-token
    description: npm_config token access
    criticality: suspicious
    confidence: 0.9
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      regex: "npm_config.*token|NPM_CONFIG.*TOKEN"

  - id: credential/environment/secret-access/npmrc-access
    description: .npmrc file access (contains tokens)
    criticality: suspicious
    confidence: 0.9
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      regex: "\\.npmrc|npmrc"
