# NPM/Node.js Credential Environment Variable Access
# Detects access to npm and Node.js specific tokens
# ATT&CK: T1552.001 (Credentials In Files)

traits:
  - id: npm-token
    description: NPM_TOKEN environment variable access
    criticality: hostile
    confidence: 0.95
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      exact: "NPM_TOKEN"

  - id: node-auth-token
    description: NODE_AUTH_TOKEN environment variable access
    criticality: hostile
    confidence: 0.95
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      exact: "NODE_AUTH_TOKEN"

  - id: npm-config-token
    description: npm_config token access
    criticality: hostile
    confidence: 0.9
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      regex: "npm_config.*token|NPM_CONFIG.*TOKEN"

  - id: npmrc-access
    description: .npmrc file access (contains tokens)
    criticality: hostile
    confidence: 0.9
    attack: "T1552.001"
    file_types: [javascript]
    condition:
      type: string
      regex: "\\.npmrc|npmrc"
