# Credential Access - Shell History Files
# ATT&CK: T1552.003 (Unsecured Credentials: Bash History)

traits:
  # === Atomic: Bash History ===

  - id: credential/shell/bash-history
    description: Bash shell history file access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.003"
    platforms: [linux, macos, unix]
    condition:
      type: string
      exact: ".bash_history"

  # === Atomic: Zsh History ===

  - id: credential/shell/zsh-history
    description: Zsh shell history file access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.003"
    platforms: [linux, macos, unix]
    condition:
      type: string
      exact: ".zsh_history"

  # === Atomic: Fish History ===

  - id: credential/shell/fish-history
    description: Fish shell history file access
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.003"
    platforms: [linux, macos, unix]
    condition:
      type: string
      regex: "\\.local/share/fish/fish_history"

  # === Atomic: Shell RC Files ===

  - id: credential/shell/bashrc
    description: Bashrc configuration file access
    criticality: notable
    confidence: 0.5
    platforms: [linux, macos, unix]
    condition:
      type: string
      exact: ".bashrc"

  - id: credential/shell/zshrc
    description: Zshrc configuration file access
    criticality: notable
    confidence: 0.5
    platforms: [linux, macos, unix]
    condition:
      type: string
      exact: ".zshrc"

  - id: credential/shell/profile
    description: Shell profile file access
    criticality: notable
    confidence: 0.5
    platforms: [linux, macos, unix]
    condition:
      type: string
      regex: "\\.(bash_)?profile"

composite_rules:
  - id: credential/shell/history-theft
    description: Shell history file theft
    criticality: suspicious
    confidence: 0.8
    attack: "T1552.003"
    mbc: "E1552"
    platforms: [linux, macos, unix]
    requires_any:
      - type: trait
        id: credential/shell/bash-history
      - type: trait
        id: credential/shell/zsh-history
      - type: trait
        id: credential/shell/fish-history
