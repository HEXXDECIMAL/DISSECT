# Java Credential Access Traits
# Detects credential stealing patterns in Java bytecode
# MBC: Credential Access
# ATT&CK: T1555 (Credentials from Password Stores)

traits:
  # Browser password stealing
  - id: chrome-pass-string
    description: Chrome password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    file_types: [class]
    condition:
      type: string
      exact: "chrome-pass"

  - id: firefox-pass-string
    description: Firefox password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    file_types: [class]
    condition:
      type: string
      exact: "fox-pass"

  - id: ie-pass-string
    description: Internet Explorer password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    file_types: [class]
    condition:
      type: string
      exact: "ie-pass"

  - id: all-pass-string
    description: All passwords collection indicator
    criticality: hostile
    confidence: 0.9
    mbc: "T1555"
    attack: "T1555"
    file_types: [class]
    condition:
      type: string
      exact: "all-pass"

  - id: save-all-pass-string
    description: Save all passwords indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555"
    attack: "T1555"
    file_types: [class]
    condition:
      type: string
      exact: "save-all-pass"

  # Email client passwords
  - id: outlook-pass-string
    description: Outlook password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555"
    attack: "T1555"
    file_types: [class]
    condition:
      type: string
      exact: "outlook-pass"

  - id: thunderbird-pass-string
    description: Thunderbird password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555"
    attack: "T1555"
    file_types: [class]
    condition:
      type: string
      exact: "tb-pass"

  - id: foxmail-pass-string
    description: Foxmail password stealing indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1555"
    attack: "T1555"
    file_types: [class]
    condition:
      type: string
      exact: "foxmail-pass"

  # Keylogging
  - id: keylogger-string
    description: Keylogger command indicator
    criticality: hostile
    confidence: 0.95
    mbc: "T1056.001"
    attack: "T1056.001"
    file_types: [class]
    condition:
      type: string
      exact: "keylogger"

  - id: o-keylogger-string
    description: Keylogger toggle command
    criticality: hostile
    confidence: 0.95
    mbc: "T1056.001"
    attack: "T1056.001"
    file_types: [class]
    condition:
      type: string
      exact: "o-keylogger"
