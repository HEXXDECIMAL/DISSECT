# Collection of sensitive files into archives
# ATT&CK: T1560 (Archive Collected Data)

composite_rules:
  - id: sensitive-credentials
    desc: "Reference to sensitive credentials"
    crit: notable
    any:
      - id: obj/creds/ssh/key/id-rsa
      - id: obj/creds/cloud/token/gcloud-config
      - id: obj/creds/cloud/token/gcp-default-credentials

  - id: sensitive-archiving
    desc: "Archiving of sensitive credentials or keys"
    crit: suspicious
    conf: 0.95
    attack: "T1560"
    all:
      - id: cap/data/archive/zip
      - id: cap/os/user
      - id: cap/fs/file
      - id: obj/collect/archive/sensitive-credentials