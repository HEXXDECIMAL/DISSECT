# Junk Code and Disassembler Frustration
# Detects instructions designed to crash or confuse disassemblers/analyzers
# ATT&CK: T1027 (Obfuscated Files or Information)

traits:
  - id: ud2-junk-code
    desc: Dense undefined instructions (UD2)
    crit: suspicious
    conf: 0.85
    for: [pe, elf, macho]
    if:
      type: hex
      pattern: "0F 0B"
      count_min: 20
      # per_kb_min removed - count_min is sufficient for detecting deliberate junk
    downgrade:
      any:
        - id: meta/signed/platform::apple