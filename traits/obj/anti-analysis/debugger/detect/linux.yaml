# Debugger Detection - Linux
# MBC: B0001 (Debugger Detection)
# ATT&CK: T1622

defaults:
  mbc: "B0001"
  attack: "T1622"

traits:
  - id: debugger-ptrace
    desc: Debugger detection via ptrace
    crit: suspicious
    conf: 0.66
    if:
      type: string
      substr: PTRACE_TRACEME

  # NOTE: /proc/self/status detection is in traits.yaml as 'proc-status'

  - id: gdb-ref
    desc: GDB debugger reference
    crit: inert
    conf: 0.5
    if:
      type: string
      regex: '\bgdb\b'

  - id: lldb-ref
    desc: LLDB debugger reference
    crit: inert
    conf: 0.5
    if:
      type: string
      regex: '\blldb\b'

composite_rules:
  # Debugger names alone aren't suspicious - many programs ship with debug info
  # Only suspicious in combination with other anti-debug techniques
  - id: debugger-gdb
    desc: References gdb/lldb debugger
    crit: inert
    conf: 0.4
    needs: 1
    any:
      - id: gdb-ref
      - id: lldb-ref
