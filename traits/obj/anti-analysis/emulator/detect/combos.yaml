# Composite VM/Emulator Detection Capabilities

composite_rules:
  - id: detect-vendors
    desc: VM detection via vendor/product strings
    crit: suspicious
    mbc: "B0009"
    attack: "T1497.001"
    conf: 0.9
    needs: 2
    any:
      - id: vmware-string
      - id: virtualbox-string
      - id: qemu-string
      - id: cpu-vendor

  - id: comprehensive
    desc: Virtual machine environment detection
    crit: suspicious
    mbc: "B0009"
    attack: "T1497.001"
    conf: 0.9
    needs: 2
    any:
      - id: vmware-string
      - id: virtualbox-string
      - id: qemu-string
      - id: vm-hardware
      - id: macos-vm-sysctl
