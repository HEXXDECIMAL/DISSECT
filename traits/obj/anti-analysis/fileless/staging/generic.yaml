# Fileless Execution / Memory-only Staging
# Patterns for avoiding disk-based detection
# ATT&CK: T1055, T1620
# NOTE: memfd_create is defined in mem/anonymous/create/linux.yaml

traits:
  - id: dev-shm
    desc: "/dev/shm staging (fileless execution)"
    crit: suspicious
    conf: 0.85
    mbc: "F0012"
    attack: "T1055"
    for: [elf]
    platforms: [linux]
    if:
      type: string
      substr: "/dev/shm/"

  - id: proc-self-fd
    desc: "Access /proc/self/fd for file descriptor"
    crit: notable
    conf: 0.7
    for: [elf]
    platforms: [linux]
    if:
      type: string
      regex: "/proc/self/fd/"
