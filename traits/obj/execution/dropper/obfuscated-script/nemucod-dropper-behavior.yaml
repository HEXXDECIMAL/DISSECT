composite_rules:
  - id: nemucod-wsh-indicators
    desc: Helper for Nemucod WSH objects
    crit: notable
    for: [javascript]
    any:
      - id: obj/execution/interpreter/script/wsh::adodb-fragment
      - id: obj/execution/interpreter/script/wsh::wscript-shell-fragment-short

  - id: nemucod-obfuscation-indicators
    desc: Helper for Nemucod obfuscation
    crit: notable
    for: [javascript]
    any:
      - id: obj/anti-static/obfuscation/strings/encoding::js-charat-loop
      - id: cap/code/obfuscation/js

  - id: nemucod-dropper-behavior
    desc: Detects Nemucod JScript dropper behavior (evasion loop + WSH/ADODB fragments)
    crit: hostile
    mbc: B0032
    attack: T1027
    for: [javascript]
    all:
      - id: obj/execution/interpreter/script/wsh::wscript-shell-fragments-composite
      - id: nemucod-wsh-indicators
      - id: nemucod-obfuscation-indicators
    any:
      - id: cap/time/measure/delta::js-date-diff-jitter-check
      - id: obj/execution/interpreter/script/wsh::wsh-tiny-fragment-assignment
