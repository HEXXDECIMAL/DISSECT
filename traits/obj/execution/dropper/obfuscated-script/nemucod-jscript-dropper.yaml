composite_rules:
  - id: nemucod-jscript-dropper
    desc: "Nemucod JScript Dropper with obfuscated payload download and execution"
    crit: hostile
    conf: 1.0
    for: [javascript]
    attack: "T1059.007" # Command and Scripting Interpreter: JavaScript/JScript
    mbc: "C0018" # Remote Access
    needs: 4 # Require at least 4 of these characteristics to fire
    all:
      - id: cap/code/obfuscation/string::nemucod-numeric-string-encoding
      - id: cap/code/obfuscation/js::js-dynamic-char-access
      - id: cap/data/encode/xor::js-xor-decoder-loop
      - id: cap/code/obfuscation/js::js-comma-operator-abuse
      - id: cap/code/identifier/nemucod::nemucod-decoder-key
      - id: cap/exec/shell/wsh::wscript-shell-run
      - id: cap/comm/download/wsh::adodb-stream-object
