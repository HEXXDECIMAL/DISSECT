composite_rules:
  - id: obfuscated-jscript-dropper-permutation
    desc: "Detects obfuscated JScript droppers (permutation variant) that download and execute payloads."
    crit: hostile
    all:
      - id: cap/data/encode/permutation::js-permutation-loop
      - id: cap/process/script/wsh::wsh-adodb-download
      - id: obj/execution/interpreter/script/wsh::wscript-shell

  - id: obfuscated-jscript-dropper-replace
    desc: "Detects obfuscated JScript droppers (replace gibberish variant) that download and execute payloads."
    crit: hostile
    all:
      - id: cap/evasion/obfuscation/strings/encoding::js-replace-gibberish
      - id: cap/process/script/wsh::wsh-adodb-download
      - id: obj/execution/interpreter/script/wsh::wscript-shell