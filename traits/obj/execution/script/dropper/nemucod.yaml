defaults:
  crit: hostile
  conf: 0.95
  attack: T1027
  mbc: B0032

composite_rules:
  - id: js-nemucod-string-functions
    desc: Nemucod string function pattern (helper)
    crit: suspicious
    conf: 0.8
    for: [javascript]
    any:
      - id: cap/code/obfuscation/string::function-returns-string-literal
      - id: cap/code/obfuscation/string::function-returns-variable-string

  - id: js-nemucod-dropper
    desc: Nemucod JavaScript dropper (obfuscated functions + WScript fragments)
    for: [javascript]
    all:
      - id: js-nemucod-string-functions
      - id: obj/execution/interpreter/script/wsh::wscript-dropper-fragments-composite
    any:
      - id: cap/code/dynamic/eval::new-function-iife
      - id: obj/execution/activex/com::activex-filesystem
      - id: cap/data/encode/hex::js-hex-char-array
