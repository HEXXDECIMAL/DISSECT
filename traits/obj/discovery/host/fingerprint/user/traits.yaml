# User Information Fingerprinting
# ATT&CK: T1033 (System Owner/User Discovery)
# NOTE: All neutral user query functions moved to cap/process/user/ and cap/process/env/

defaults:
  attack: "T1033"

traits:

composite_rules:
  # User info composite
  - id: user-info
    desc: User information fingerprinting
    crit: notable
    conf: 0.7
    needs: 2
    any:
      - id: cap/process/user::getlogin
      - id: cap/process/user::getpwuid
      - id: cap/process/env::getenv-user
      - id: cap/process/env::getenv-home
      - id: cap/process/user::whoami-cmd
      - id: cap/process/user::id-u-cmd
      - id: cap/fs/path/config/accounts::etc-passwd
