# Process Discovery Traits - Symbol-based Detection
# MBC: OB0007 (Discovery) â†’ E1057 (Process Discovery)
# ATT&CK: T1057 (Process Discovery)

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # User ID functions
  - id: getuid
    desc: Get real user ID of
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: getuid
    platforms: [unix, linux, macos]

  - id: geteuid
    desc: Get effective user ID of
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: geteuid
    platforms: [unix, linux, macos]

  - id: getgid
    desc: Get real group ID of
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: getgid
    platforms: [unix, linux, macos]

  - id: getegid
    desc: Get effective group ID of
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: getegid
    platforms: [unix, linux, macos]

  # Process ID functions
  - id: getpid
    desc: Get process ID of calling
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: getpid
    platforms: [unix, linux, macos]

  - id: getppid
    desc: Get parent process ID
    crit: inert
    mbc: "E1057"
    attack: "T1057"
    conf: 0.5
    if:
      type: symbol
      regex: getppid
    platforms: [unix, linux, macos]

  # User information lookup
  - id: getpwnam
    desc: Get user database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      regex: getpwnam
    platforms: [unix, linux, macos]

  - id: getpwuid
    desc: Get user database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      regex: getpwuid
    platforms: [unix, linux, macos]

  # Group information lookup
  - id: getgrnam
    desc: Get group database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      regex: getgrnam
    platforms: [unix, linux, macos]

  - id: getgrgid
    desc: Get group database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      regex: getgrgid
    platforms: [unix, linux, macos]
