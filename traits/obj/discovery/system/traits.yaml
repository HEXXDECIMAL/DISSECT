# System Information Discovery Traits
# MBC: OB0007 (Discovery) â†’ E1082 (System Information Discovery)
# ATT&CK: T1082 (System Information Discovery)

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # System control and configuration
  - id: sysctl
    desc: Get or set system information
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.6
    if:
      type: symbol
      regex: sysctl
    platforms: [unix, linux, macos]

  - id: sysctlbyname
    desc: Get or set system information
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.6
    if:
      type: symbol
      regex: sysctlbyname
    platforms: [macos]

  - id: sysctlnametomib
    desc: Convert sysctl name to MIB
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.5
    if:
      type: symbol
      regex: sysctlnametomib
    platforms: [macos]

  # Device control
  - id: ioctl
    desc: Device-specific input/output operations and control
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.5
    if:
      type: symbol
      regex: ioctl
    platforms: [unix, linux, macos]

  # System identification
  - id: uname
    desc: Get system name and information
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.6
    if:
      type: symbol
      regex: uname
    platforms: [unix, linux, macos]

  - id: gethostname
    desc: Get hostname of current machine
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.5
    if:
      type: symbol
      regex: gethostname
    platforms: [unix, linux, macos, windows]

  - id: getdomainname
    desc: Get NIS domain name
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.5
    if:
      type: symbol
      regex: getdomainname
    platforms: [unix, linux, macos]

  # Resource limits and configuration
  - id: getrlimit
    desc: Get resource limits for process
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.4
    if:
      type: symbol
      regex: getrlimit
    platforms: [unix, linux, macos]

  - id: setrlimit
    desc: Set resource limits for process
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    conf: 0.6
    if:
      type: symbol
      regex: setrlimit
    platforms: [unix, linux, macos]

  # System configuration
  - id: sysconf
    desc: Get system configuration information
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.4
    if:
      type: symbol
      regex: sysconf
    platforms: [unix, linux, macos]

  - id: confstr
    desc: Get configuration-dependent string variables
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.4
    if:
      type: symbol
      regex: confstr
    platforms: [unix, linux, macos]

  # macOS-specific system information
  - id: host_info
    desc: Get host information (macOS Mach
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.6
    if:
      type: symbol
      regex: host_info
    platforms: [macos]

  - id: host_statistics
    desc: Get host statistics (macOS Mach
    crit: notable
    mbc: "E1082"
    attack: "T1082"
    conf: 0.6
    if:
      type: symbol
      regex: host_statistics
    platforms: [macos]
