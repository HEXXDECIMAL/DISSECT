# Process Discovery Traits - Symbol-based Detection
# MBC: OB0007 (Discovery) â†’ E1057 (Process Discovery)
# ATT&CK: T1057 (Process Discovery)

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # User information lookup
  - id: getpwnam
    desc: Get user database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      pattern: getpwnam
    platforms: [unix, linux, macos]

  - id: getpwuid
    desc: Get user database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.001"
    conf: 0.6
    if:
      type: symbol
      pattern: getpwuid
    platforms: [unix, linux, macos]

  # Group information lookup
  - id: getgrnam
    desc: Get group database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      pattern: getgrnam
    platforms: [unix, linux, macos]

  - id: getgrgid
    desc: Get group database entry by
    crit: inert
    mbc: "E1087"
    attack: "T1087.002"
    conf: 0.6
    if:
      type: symbol
      pattern: getgrgid
    platforms: [unix, linux, macos]