# Action Engine / Remote Script Execution
# Detects patterns where a class or engine executes remotely-delivered scripts or actions.

traits:
  - id: action-event-script
    desc: Action event defined as execute script
    crit: notable
    conf: 0.8
    for: [javascript, typescript]
    if:
      type: string
      regex: 'ActionEvents\.executeScript|execute\.script'

  - id: execute-script-class
    desc: Class designed to execute script actions
    crit: suspicious
    conf: 0.85
    for: [javascript, typescript]
    if:
      type: string
      regex: 'ExecuteScriptAction'

composite_rules:
  - id: remote-action-engine
    desc: Remote action/script execution engine
    crit: suspicious
    conf: 0.9
    all:
      - id: cap/exec/eval/dynamic::Function-constructor
    any:
      - id: action-event-script
      - id: execute-script-class
