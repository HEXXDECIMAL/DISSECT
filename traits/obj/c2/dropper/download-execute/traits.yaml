# Download-Execute Dropper Patterns
# Detects stealthy download and execute patterns
# ATT&CK: T1105

composite_rules:
  - id: hostile-downloader-wininet
    desc: Hostile Downloader (Network -> Memory -> Process)
    crit: hostile
    conf: 0.9
    mbc: E1105
    attack: T1105
    all:
      - id: cap/comm/http/get::internet-read-file
      - id: cap/mem/allocate/executable::virtualalloc
      - id: cap/process/create/spawn::create-process-w
