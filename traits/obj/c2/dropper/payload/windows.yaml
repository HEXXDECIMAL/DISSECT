# Windows Dropper Patterns
# Detects Windows-specific dropper behaviors
# ATT&CK: T1027.002, T1059.001

composite_rules:
  - id: windows-dropper-pattern
    desc: Windows dropper with decode and execute
    crit: hostile
    conf: 0.95
    for: [python, shell]
    mbc: "B0024"
    attack: "T1027.002"
    all:
      - id: cap/process/create/launch::windows-startfile-exec
      - id: obj/anti-static/obfuscation/source::b64decode-exec
    any:
      - id: obj/anti-static/obfuscation/payload::exec-decode-pattern
      - id: cap/fs/path/temp
