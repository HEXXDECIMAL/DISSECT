# Embedded C&C Infrastructure Lists
# Detects multiple hardcoded C2 addresses in binary
# Generic indicator for botnet, worm, RAT

composite_rules:
  - id: embedded-c2-list
    desc: Multiple hardcoded C2 IP addresses
    crit: notable
    conf: 0.8
    platforms: [all]
    for: [pe, elf, macho]
    attack: "T1043"
    mbc: "C0002"
    needs: 5
    any:
      - id: cap/comm/ip

  - id: distributed-c2-redundancy
    desc: Distributed C2 infrastructure redundancy
    crit: notable
    conf: 0.85
    platforms: [all]
    for: [pe, elf, macho]
    attack: "T1043"
    mbc: "C0002"
    needs: 20
    any:
      - id: cap/comm/ip

  - id: hardcoded-c2-infrastructure
    desc: Self-contained C2 with hardcoded addresses
    crit: suspicious
    conf: 0.8
    platforms: [all]
    for: [pe, elf, macho]
    attack: "T1043"
    mbc: "C0002"
    all:
      - id: embedded-c2-list
      - id: cap/comm/tcp/connect

  - id: botnet-commander-pattern
    desc: Botnet commander with hardcoded infrastructure
    crit: notable
    conf: 0.9
    platforms: [all]
    for: [pe, elf, macho]
    attack: "T1043"
    mbc: "C0002"
    all:
      - id: distributed-c2-redundancy
      - id: cap/comm/socket

