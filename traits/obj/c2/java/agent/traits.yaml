# Java C2/RAT Traits
# Detects RAT command and control patterns in Java bytecode
# MBC: Command and Control
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # Remote execution commands
  - id: remote-cmd-string
    desc: Remote command execution indicator
    crit: suspicious
    conf: 0.95
    mbc: "B0024"
    attack: "T1059"
    for: [class]
    if:
      type: string
      exact: "remote-cmd"

  - id: power-shell-string
    desc: PowerShell execution command
    crit: suspicious
    conf: 0.95
    mbc: "B0024"
    attack: "T1059.001"
    for: [class]
    if:
      type: string
      exact: "power-shell"

  # Download and execute
  - id: down-n-exec-string
    desc: Download and execute command
    crit: suspicious
    conf: 0.98
    mbc: "B0025"
    attack: "T1105"
    for: [class]
    if:
      type: string
      exact: "down-n-exec"

  - id: up-n-exec-string
    desc: Upload and execute command
    crit: suspicious
    conf: 0.98
    mbc: "B0025"
    attack: "T1105"
    for: [class]
    if:
      type: string
      exact: "up-n-exec"

  # Remote desktop/screen
  - id: remote-screen-string
    desc: Remote screen access command
    crit: suspicious
    conf: 0.95
    mbc: "B0022"
    attack: "T1113"
    for: [class]
    if:
      type: string
      exact: "remote-screen"

  - id: hrdp-new-string
    desc: Hidden RDP session command
    crit: suspicious
    conf: 0.95
    mbc: "B0022"
    attack: "T1021.001"
    for: [class]
    if:
      type: string
      exact: "hrdp-new"

  - id: hrdp-res-string
    desc: Hidden RDP resume command
    crit: suspicious
    conf: 0.95
    mbc: "B0022"
    attack: "T1021.001"
    for: [class]
    if:
      type: string
      exact: "hrdp-res"

  # File management
  - id: file-manager-string
    desc: File manager command
    crit: suspicious
    conf: 0.9
    mbc: "E1083"
    attack: "T1083"
    for: [class]
    if:
      type: string
      exact: "file-manager"

  # Proxy/tunneling
  - id: rev-proxy-string
    desc: Reverse proxy command
    crit: suspicious
    conf: 0.95
    mbc: "B0026"
    attack: "T1090"
    for: [class]
    if:
      type: string
      exact: "rev-proxy"

  # Encryption commands (ransomware indicator)
  - id: rw-encrypt-string
    desc: Ransomware encrypt command
    crit: suspicious
    conf: 0.95
    mbc: "B0031"
    attack: "T1486"
    for: [class]
    if:
      type: string
      exact: "rw-encrypt"

  - id: rw-decrypt-string
    desc: Ransomware decrypt command
    crit: suspicious
    conf: 0.95
    mbc: "B0031"
    attack: "T1486"
    for: [class]
    if:
      type: string
      exact: "rw-decrypt"
