composite_rules:
  - id: js-prototype-downloader
    desc: Hostile JScript Downloader using String.prototype trick
    crit: hostile
    for: [javascript]
    all:
      - id: cap/data/source/obfuscation/prototype::return-this
      - id: obj/exec/interpreter/script/wsh::wscript-shell-fragments-composite
    any:
      - id: cap/fs/path/extension::scr
      - id: cap/data/source/obfuscation/names::fake-jquery-vars
      - id: obj/exec/interpreter/script/wsh::payload-handling-fragment-tiny-exact
      - id: obj/exec/interpreter/script/wsh::adodb-fragment-tiny-exact