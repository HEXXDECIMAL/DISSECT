# Ruby Dropper Behavior: Rename and Execute
# ATT&CK: T1105, T1059

defaults:
  crit: hostile
  conf: 0.95

composite_rules:
  - id: ruby-dropper-rename-exec
    desc: Ruby script renames file to executable and executes it
    all:
      - id: obj/execution/dropper/script::ruby-ast-rename-img-to-exe
      - id: cap/process/create/shell/lang::ruby-exec
    any:
      - id: obj/execution/dropper/script::ruby-ast-check-windows-regex
      - id: obj/execution/dropper/script::ruby-ast-host-os-access
      - id: obj/execution/dropper/script::windows-os-check
    needs: 1
