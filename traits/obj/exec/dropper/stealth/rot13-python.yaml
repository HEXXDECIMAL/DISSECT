# ROT13 Python Dropper
# Detects obfuscated Python droppers using ROT13 strings and stealth execution

defaults:
  for: [python]
  attack: "T1105"
  mbc: "B0032"

composite_rules:
  - id: rot13-stealth-dropper
    desc: "Obfuscated Python dropper using ROT13 and stealth execution"
    conf: 0.95
    crit: hostile
    all:
      - id: cap/data/encode/rot13::rot13-windows
      - id: cap/data/encode/base64::b64decode-call
      - id: obj/discovery/host/system/os-fingerprint::platform-system-call
    any:
      - id: obj/anti-analysis/process-hide/creation-flags::detached-process
      - id: cap/exec/command/setsid::preexec-fn

  - id: rot13-exec-dropper
    desc: "Obfuscated Python dropper using ROT13 and dynamic execution"
    conf: 0.95
    crit: hostile
    all:
      - id: cap/data/encode/rot13::rot13-windows
      - id: cap/data/encode/base64::b64decode-call
      - id: obj/anti-static/obfuscation/payload::exec-function-call
      - id: cap/comm/http/post::requests-post-call