# Ruby File Operations (Suspicious)
# Detects suspicious file manipulation patterns
# ATT&CK: T1070

defaults:
  crit: notable
  conf: 0.8
  for: [ruby]

composite_rules:
  - id: ruby-file-manipulation
    desc: Ruby file manipulation detected (rename/move)
    any:
      - id: obj/execution/dropper/script::ruby-ast-file-rename
      - id: obj/execution/dropper/script::ruby-ast-rename-to-exe
      - id: obj/execution/dropper/script::ruby-ast-rename-img-to-exe
