defaults:
  for: [rtf]
  crit: suspicious
  conf: 0.8
  mbc: B0009.029    # Document Exploit
  attack: T1203      # Exploitation for Client Execution

traits:
  - id: rtf-ole-object-embedding
    desc: "RTF contains embedded OLE object"
    if:
      type: string
      substr: '\object'
    conf: 0.75

  - id: rtf-word-document-object
    desc: "Word.Document OLE exploit vector"
    if:
      type: string
      regex: 'Word\.Document\.(8|12)'
    conf: 0.85
    crit: suspicious

  - id: rtf-objupdate-directive
    desc: "RTF objupdate auto-execution"
    if:
      type: string
      substr: '\objupdate'
    conf: 0.9
    crit: suspicious

  - id: rtf-objemb-detected
    desc: "RTF \\objemb control detected"
    if:
      type: string
      substr: '\objemb'
    conf: 0.8

  - id: rtf-ole-class-package
    desc: "Package OLE class detected"
    if:
      type: string
      regex: '\\objclass\s+"Package'
    conf: 0.9
    crit: suspicious

  - id: rtf-ole-class-formula
    desc: "Formula OLE class detected"
    if:
      type: string
      regex: '\\objclass\s+"Formula'
    conf: 0.85
    crit: suspicious

  - id: rtf-ole-class-shellfile
    desc: "ShellFile OLE class detected"
    if:
      type: string
      regex: '\\objclass\s+"(ShellFile|Shell)'
    conf: 0.9
    crit: suspicious
