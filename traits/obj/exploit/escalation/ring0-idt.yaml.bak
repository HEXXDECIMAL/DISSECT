type: rule
id: obj/exploit/escalation/ring0-idt
conf: 3.5
crit: hostile
description: Detects Ring0 escalation via IDT manipulation (sidt + int 5)
conditions:
  - type: or
    rule_id: cap/os/win/kernel::idt-manipulation
    regex:
      - 'sidt\s+\[esp-2\]'
      - 'int\s+5'
      - 'mov\s+word\s+ptr\s+\[edx\+5\*8\],\s+bx'
