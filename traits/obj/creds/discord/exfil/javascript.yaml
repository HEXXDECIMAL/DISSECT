# Discord Credential Exfiltration - JavaScript
# Detects exfiltration of credentials to Discord webhooks
# ATT&CK: T1552.001 (Credentials In Files), T1567 (Exfiltration Over Web Service)

traits:
  - id: js-sensitive-file-target
    desc: Targets sensitive configuration files
    crit: inert
    conf: 0.8
    if:
      type: raw
      regex: '["'']\.env["'']|["'']config\.json["'']|["'']ayarlar\.json["'']'

composite_rules:
  - id: js-discord-cred-exfil
    desc: Exfiltration of sensitive files to Discord
    crit: hostile
    conf: 0.98
    attack: "T1567"
    all:
      - id: obj/exfil/channel/webhook::discord-webhook-url
      - id: js-sensitive-file-target
      - id: cap/fs/file/read::read-node
