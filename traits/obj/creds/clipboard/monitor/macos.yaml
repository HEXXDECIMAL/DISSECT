# macOS Clipboard Monitoring/Stealing
# ATT&CK: T1115 (Clipboard Data)

defaults:
  for: [macho]
  platforms: [macos]

traits:
  # Placeholder for macos specific atomic traits if needed

composite_rules:
  - id: macos-clipboard-monitor
    desc: macOS clipboard monitoring
    crit: suspicious
    conf: 0.8
    attack: "T1115"
    all:
      - id: cap/hw/clipboard/access::macos-nspasteboard
      - id: cap/hw/clipboard/access::macos-pasteboard-items
    downgrade:
      any:
        - id: meta/apple/system-component

  - id: macos-clipboard-context-stealer
    desc: macOS clipboard stealing with context (window watching)
    crit: hostile
    conf: 0.95
    attack: "T1115"
    mbc: "B0042" # System Information Discovery
    all:
      - id: obj/impact/ui/manipulation::window-watcher
      - id: macos-clipboard-monitor
    downgrade:
      any:
        - id: meta/apple/system-component
