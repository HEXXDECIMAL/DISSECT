# Java Credential Access Traits
# Detects credential stealing patterns in Java bytecode
# MBC: Credential Access
# ATT&CK: T1555 (Credentials from Password Stores)

traits:
  # Browser password stealing
  - id: chrome-pass-string
    desc: Chrome password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    for: [class]
    if:
      type: string
      exact: "chrome-pass"

  - id: firefox-pass-string
    desc: Firefox password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    for: [class]
    if:
      type: string
      exact: "fox-pass"

  - id: ie-pass-string
    desc: Internet Explorer password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555.003"
    attack: "T1555.003"
    for: [class]
    if:
      type: string
      exact: "ie-pass"

  - id: all-pass-string
    desc: All passwords collection indicator
    crit: suspicious
    conf: 0.9
    mbc: "T1555"
    attack: "T1555"
    for: [class]
    if:
      type: string
      exact: "all-pass"

  - id: save-all-pass-string
    desc: Save all passwords indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555"
    attack: "T1555"
    for: [class]
    if:
      type: string
      exact: "save-all-pass"

  # Email client passwords
  - id: outlook-pass-string
    desc: Outlook password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555"
    attack: "T1555"
    for: [class]
    if:
      type: string
      exact: "outlook-pass"

  - id: thunderbird-pass-string
    desc: Thunderbird password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555"
    attack: "T1555"
    for: [class]
    if:
      type: string
      exact: "tb-pass"

  - id: foxmail-pass-string
    desc: Foxmail password stealing indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1555"
    attack: "T1555"
    for: [class]
    if:
      type: string
      exact: "foxmail-pass"

  # Keylogging
  - id: keylogger-string
    desc: Keylogger command indicator
    crit: suspicious
    conf: 0.95
    mbc: "T1056.001"
    attack: "T1056.001"
    for: [class]
    if:
      type: string
      exact: "keylogger"

  - id: o-keylogger-string
    desc: Keylogger toggle command
    crit: suspicious
    conf: 0.95
    mbc: "T1056.001"
    attack: "T1056.001"
    for: [class]
    if:
      type: string
      exact: "o-keylogger"
