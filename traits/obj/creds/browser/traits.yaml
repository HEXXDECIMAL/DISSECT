composite_rules:
  - id: hackbrowserdata
    desc: HackBrowserData tool reference
    crit: notable
    conf: 0.95
    attack: "T1555.003"
    mbc: "B0028"
    any:
      - { id: hackbrowserdata-lower }
      - { id: hackbrowserdata-camel }

  # Migrated from YARA
  - id: multi-browser-theft
    desc: Multi-browser credential theft
    crit: suspicious
    conf: 0.9
    attack: "T1555.003"
    mbc: "B0028"
    for: [python, javascript, elf, pe, macho]
    all:
      - id: all-browsers
        needs: 2
      - id: credential-files

  # Helper composite
  - id: sqlite-or-exfil
    desc: SQLite3 access or exfiltration channels
    any:
      - id: sqlite3-string
      - id: exfiltration-channels

  # Migrated from YARA
  - id: full-stealer-detected
    desc: Complete browser credential stealer (theft)
    crit: suspicious
    conf: 0.98
    attack: "T1555.003"
    mbc: "B0028"
    for: [python, javascript, elf, pe, macho]
    all:
      - id: all-browsers
        needs: 2
      - id: credential-files
        needs: 2
      - id: decryption-methods
      - id: sqlite-or-exfil

  # Migrated from YARA
  - id: python-stealer
    desc: Python-based browser credential stealer
    crit: suspicious
    conf: 0.95
    attack: "T1555.003"
    mbc: "B0028"
    for: [python]
    all:
      - id: python-imports
      - id: windows-paths
      - id: password-fields
        needs: 2
      - id: exfiltration-channels