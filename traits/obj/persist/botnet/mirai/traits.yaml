traits:
- id: mirai-target-systemd-path
  desc: References systemd binary path
  crit: notable
  conf: 0.8
  for:
  - elf
  - shell
  if:
    type: string
    regex: /usr/lib/systemd/systemd
  attack: T1547
- id: mirai-backdoor-daemons
  desc: Backdoor daemon processes
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (telnetd|sshd|dropbear|httpd)
  attack: T1021.004
- id: mirai-process-monitoring
  desc: Process monitoring
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    substr: /dev/watchdog
  attack: T1547
- id: mirai-malware-competition
  desc: Competing malware elimination
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  if:
    type: string
    regex: (SHINJI|/Killer)
  attack: T1531
- id: mirai-enable-services
  desc: Enable services on startup
  crit: suspicious
  conf: 0.8
  for:
  - elf
  - shell
  if:
    type: string
    regex: (systemctl\s+enable|chkconfig\s+.{0,80}on|update-rc\.d\s+.{0,80}enable)
  attack: T1547
composite_rules:
- id: mirai-persistence-layer-2
  desc: Mirai service persistence
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1547
  any:
  - id: mirai-target-systemd-path
  - id: mirai-enable-services
- id: mirai-persistence-layer-3
  desc: Mirai monitoring and competition
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1547
  all:
  - id: mirai-process-monitoring
  - id: mirai-malware-competition
- id: mirai-complete-persistence-chain
  desc: Mirai complete persistence
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  attack: T1547
  mbc: B0014
  all:
  - id: mirai-backdoor-daemons
  - id: mirai-persistence-layer-2
  - id: mirai-persistence-layer-3
- id: mirai-sophisticated-resilience
  desc: Mirai sophisticated resilience
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  attack: T1547
  mbc: B0014
  all:
  - id: known/malware/botnet/mirai
  - id: mirai-complete-persistence-chain
