# Setuid Privilege Escalation - Exploit Patterns
# MBC: E1548 (Abuse Elevation Control Mechanism)
# ATT&CK: T1548.001
#
# NOTE: Raw setuid/setgid capabilities are now in cap/process/identity/setuid/unix.yaml
# This file contains composite rules that detect exploitation patterns.

defaults:
  r#for: [elf, macho, so, dylib, c]

composite_rules:
  # Suspicious setuid pattern: setuid combined with shell execution
  - id: setuid-shell-exec
    desc: Setuid with shell execution
    crit: suspicious
    conf: 0.85
    attack: "T1548.001"
    all:
      - id: cap/process/identity/setuid/setuid
      - id: cap/exec/shell/bin-sh

  # Suspicious setgid pattern: setgid combined with shell execution
  - id: setgid-shell-exec
    desc: Setgid with shell execution
    crit: suspicious
    conf: 0.85
    attack: "T1548.001"
    all:
      - id: cap/process/identity/setuid/setgid
      - id: cap/exec/shell/bin-sh
