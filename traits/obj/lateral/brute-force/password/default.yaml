# Default Credential Detection
# Common default passwords used in brute-force attacks
# ATT&CK: T1110.001 (Brute Force: Password Guessing)

traits:
  - id: admin-password
    desc: "Default credential: admin variations"
    crit: notable
    conf: 0.6
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      word: "admin"
  - id: root-password
    desc: "Default credential: root variations"
    crit: notable
    conf: 0.6
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      word: "root"
    not:
      - "malloc"
      - "free"
      - "node"
  - id: numeric-123456
    desc: "Default credential: 123456"
    crit: suspicious
    conf: 0.8
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      # Avoid matching ASCII character tables (0123456789...)
      # Require 123456 not preceded by 0-5 and not followed by 7-9
      regex: "(?<![0-5])123456(?![7-9])"

  # NOTE: "password" alone is too common (system utilities, config, etc.)
  # Real credential brute-force detection requires multiple indicators
  # Match "password" only with control char delimiters suggesting credential list
  - id: literal-password
    desc: "Default credential: password"
    crit: notable
    conf: 0.4
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      # Require credential list context: control chars as delimiters or user:password format
      regex: "(?:[\\x00-\\x1f]password[\\x00-\\x1f]?|\\b\\w+:password\\b)"

  - id: admin123
    desc: "Default credential: admin123"
    crit: suspicious
    conf: 0.85
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "admin123"

  - id: literal-default
    desc: "Default credential: default"
    crit: notable
    conf: 0.5
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      # Word "default" alone is common - require it with control char prefix
      # which suggests credential list with delimiters
      regex: "[\\x00-\\x1f]default[\\x00-\\x1f]?"

  # NOTE: "support" alone is extremely common in system utilities and config
  # Removed as standalone trait - only relevant in composite credential dictionary
  # - id: credential/brute-force/password/support

  - id: guest
    desc: "Default credential: guest"
    crit: notable
    conf: 0.7
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      # Match guest in credential context (user:pass combo or with control chars)
      regex: "(?:[\\x00-\\x1f]guest[\\x00-\\x1f]?|\\bguest:)"

  - id: iot-vizxv
    desc: "Default IoT credential: vizxv (Dahua)"
    crit: suspicious
    conf: 0.95
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "vizxv"

  # === IoT ZTE credential atomic indicators ===
  - id: iot-zte521
    desc: "Default IoT credential: Zte521"
    crit: suspicious
    conf: 0.9
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "Zte521"

  - id: iot-pte521
    desc: "Default IoT credential: Pte521"
    crit: suspicious
    conf: 0.9
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "Pte521"

  - id: iot-pon521
    desc: "Default IoT credential: Pon521"
    crit: suspicious
    conf: 0.9
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "Pon521"

  - id: iot-zxic521
    desc: "Default IoT credential: Zxic521"
    crit: suspicious
    conf: 0.9
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "Zxic521"

  - id: iot-oelinux
    desc: "Default IoT credential: oelinux123"
    crit: suspicious
    conf: 0.95
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "oelinux123"

  - id: iot-xc35
    desc: "Default IoT credential: xc3511 (Hikvision)"
    crit: suspicious
    conf: 0.95
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      substr: "xc3511"

  - id: telnet-combo
    desc: "Telnet username:password combo format"
    crit: suspicious
    conf: 0.8
    attack: "T1110.001"
    for: [elf]
    if:
      type: string
      regex: "\\b(root|admin|user|guest|support):(root|admin|[a-zA-Z0-9]{4,12})\\b"

composite_rules:
  # IoT ZTE credential composite
  - id: iot-zte
    desc: "Default IoT credential: ZTE router"
    crit: suspicious
    conf: 0.95
    attack: "T1110.001"
    for: [elf]
    needs: 1
    any:
      - id: iot-zte521
      - id: iot-pte521
      - id: iot-pon521
      - id: iot-zxic521

  - id: dictionary
    desc: "Embedded credential brute-force dictionary"
    crit: suspicious
    conf: 0.9
    mbc: "E1040"
    attack: "T1110.001"
    for: [elf]
    needs: 4
    any:
      - id: admin-password
      - id: root-password
      - id: numeric-123456
      - id: literal-password
      - id: admin123
      - id: literal-default
