# Package Name Patterns
# Suspicious package names in PyPI metadata

defaults:
  crit: suspicious
  attack: "T1036.005"
  mbc: "F0004"
  for: [all]

traits:
  - id: pkginfo-name-messaging-security-lure
    desc: Package name impersonates messaging platform security tool
    crit: suspicious
    conf: 0.85
    attack: "T1036.005"
    if:
      type: kv
      path: name
      regex: "(?i)(?:discord|telegram|whatsapp|slack|signal|skype|teams)[-_.]?(?:safe|secur|protect|guard|shield|verif|checker|scan|auth|token|backup|recover)"

  - id: pkginfo-name-malware-term
    desc: PKG-INFO package name contains malware/offensive term
    crit: suspicious
    conf: 0.85
    attack: "T1036.005"
    if:
      type: kv
      path: name
      regex: "(?:hack|exploit|trojan|malware|inject|keylog|stealer|ransomware|rootkit|botnet|phish|spyware|backdoor|rat(?:tool|kit|net))"
      case_insensitive: true

  - id: pkginfo-name-contains-requests
    desc: Package name contains requests library name
    crit: notable
    conf: 0.70
    attack: "T1036.005"
    if:
      type: kv
      path: name
      regex: "(?:^|[_-])requests(?:[_-]|$)"

  - id: pkginfo-name-module-fragments
    desc: Package name with concatenated module name fragments
    crit: notable
    conf: 0.75
    attack: "T1036.005"
    if:
      type: kv
      path: name
      regex: "(?:http|url|rand|pip|tool|info|api|web|net|req|crypto|token|socket|base64|encode|decode).{0,80}(?:http|url|rand|pip|tool|info|api|web|net|req|crypto|token|socket|base64|encode|decode)"

  - id: pyproject-name-module-fragments
    desc: pyproject.toml name with concatenated module fragments
    crit: notable
    conf: 0.75
    attack: "T1036.005"
    if:
      type: kv
      path: "project.name"
      regex: "(?:http|url|rand|pip|tool|info|api|web|net|req|crypto|token|socket|base64|encode|decode).{0,80}(?:http|url|rand|pip|tool|info|api|web|net|req|crypto|token|socket|base64|encode|decode)"
