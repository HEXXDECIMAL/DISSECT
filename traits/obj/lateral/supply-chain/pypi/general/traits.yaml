# General PKG-INFO Metadata Patterns
# Platform, license, classifiers, and other general fields

defaults:
  crit: notable
  attack: "T1036.005"
  mbc: "F0004"
  for: [all]

traits:
  - id: empty-classifiers
    desc: Empty classifiers list
    crit: inert
    conf: 0.50
    for: [python]
    if:
      type: string
      regex: "classifiers.{0,50}=.{0,50}\\[\\]"

  - id: unknown-license
    desc: PKG-INFO has UNKNOWN license
    crit: notable
    conf: 0.75
    if:
      type: kv
      path: license
      exact: "UNKNOWN"

  - id: unknown-platform
    desc: PKG-INFO has UNKNOWN platform
    crit: notable
    conf: 0.70
    if:
      type: kv
      path: platform
      exact: "UNKNOWN"

  - id: is-pkginfo-file
    desc: Python PKG-INFO metadata file
    crit: inert
    conf: 1.0
    if:
      type: kv
      path: metadata-version

  - id: setup-py-file
    desc: Python setup.py file
    crit: inert
    conf: 0.9
    for: [python]
    if:
      type: string
      regex: "\\bsetup\\s*\\("

  - id: pkginfo-tiny
    desc: Extremely small PKG-INFO file
    crit: notable
    conf: 0.70
    if:
      type: filesize
      max: 200
    unless:
      - type: basename
        regex: "\\.(py|sh|js|ts|c|cpp|h|hpp|md|txt|html|css|json|yml|yaml|pyi|rtf|bat|cmd|ps1)$"
