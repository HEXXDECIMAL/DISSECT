# Cloned README Body Indicators
# Patterns that suggest PKG-INFO body is cloned from legitimate libraries

defaults:
  crit: inert
  conf: 0.70
  for: [all]

traits:
  - id: pkginfo-body-has-badges
    desc: PKG-INFO body contains CI/CD badge URLs
    if:
      type: raw
      substr: "img.shields.io"
      count_min: 2

  - id: pkginfo-body-has-sponsorship
    desc: PKG-INFO body references Tidelift sponsorship
    if:
      type: raw
      substr: "tidelift.com"

  - id: pkginfo-body-has-maintainer-list
    desc: PKG-INFO body lists GitHub @username maintainers
    if:
      type: raw
      regex: "github\\.com/[a-zA-Z0-9_-]+>"
      count_min: 3


composite_rules:
  - id: has-cloned-body-indicators
    desc: Has cloned README body indicators
    crit: inert
    conf: 0.70
    for: [all]
    needs: 2
    any:
      - { id: pkginfo-body-has-badges }
      - { id: pkginfo-body-has-sponsorship }
      - { id: pkginfo-body-has-maintainer-list }
