# Build Tool and Bundler Markers
# Indicates code was processed by legitimate build tools

traits:
  - id: webpack-bundled
    desc: Code bundled with webpack (legitimate
    crit: notable
    conf: 0.95
    for: [javascript]
    if:
      type: string
      regex: "__webpack_require__|webpackChunk|__webpack_modules__"

  # Rollup bundled
  - id: rollup-bundled
    desc: Code bundled with rollup (legitimate
    crit: notable
    conf: 0.95
    for: [javascript]
    if:
      type: string
      regex: "_interopDefaultLegacy|_interopNamespace|rollupPluginBabel"

  # esbuild bundled
  - id: esbuild-bundled
    desc: Code bundled with esbuild (legitimate
    crit: notable
    conf: 0.95
    for: [javascript]
    if:
      type: string
      regex: "__toESM|__toCommonJS|__export|__copyProps"

  # Parcel bundled
  - id: parcel-bundled
    desc: Code bundled with Parcel (legitimate
    crit: notable
    conf: 0.95
    for: [javascript]
    if:
      type: string
      regex: "parcelRequire|__parcel__"

  # Vite bundled
  - id: vite-bundled
    desc: Code bundled with Vite (legitimate
    crit: notable
    conf: 0.95
    for: [javascript]
    if:
      type: string
      regex: '__vite__|import\\.meta\\.hot'

  # TypeScript compiled marker
  - id: typescript-compiled
    desc: Code compiled from TypeScript
    crit: notable
    conf: 0.9
    for: [javascript]
    if:
      type: string
      # __esModule: use obj/lateral/supply-chain/npm/minifier/traits.yaml::esmodule-export (canonical)
      regex: 'Object\\.defineProperty.exports|tslib'

  # Babel transpiled
  - id: babel-transpiled
    desc: Code transpiled with Babel
    crit: notable
    conf: 0.9
    for: [javascript]
    if:
      type: string
      regex: "_classCallCheck|_defineProperty|_objectSpread|@babel/runtime"

  # Source map reference
  - id: has-sourcemap
    desc: Code has source map reference
    crit: notable
    conf: 0.9
    for: [javascript]
    if:
      type: string
      regex: "//# sourceMappingURL=|//@ sourceMappingURL="

  # UMD module pattern
  - id: umd-pattern
    desc: Universal Module Definition pattern
    crit: notable
    conf: 0.85
    for: [javascript]
    if:
      type: string
      regex: 'typeof exports.{0,30}===.{0,30}object.{0,30}&&.{0,30}typeof module.{0,30}!==.{0,30}undefined|function.{0,10}root,.{0,10}factory'

  # CommonJS2 export pattern
  - id: cjs2-export
    desc: CommonJS2 module export pattern
    crit: notable
    conf: 0.85
    for: [javascript]
    if:
      type: string
      regex: 'module\\.exports\\.default|exports\\.default\\s*='

  # React production build
