# Archive Evasion - Nested Archives in npm Packages
# ATT&CK: T1027 (Obfuscation)
# Detects suspicious nested archives within npm packages, which are often used
# to evade detection and analysis tools.

traits:
  # === Nested archive detection ===
  - id: nested-archive-tgz
    desc: Nested .tgz archive in package
    crit: suspicious
    conf: 0.85
    for: ["*"]
    if:
      type: string
      substr: ".tgz"
      min_count: 1
