# Professional Malware Trinity Pattern
# THE definitive pattern for professional/advanced malware
# Obfuscation + Evasion + Injection = Professional malware

composite_rules:
  - id: professional-malware-trinity
    desc: Professional malware Trinity (obfuscation + evasion + injection)
    crit: hostile
    conf: 0.95
    attack: "T1055"
    mbc: "C0041"
    platforms: [windows]
    for: [pe]
    all:
      # Layer 1: Obfuscation (must have at least one)
      - id: cap/data/encode/payload/embedded-obfuscated-payload

      # Layer 2: Evasion (multiple checks)
      - id: obj/anti-analysis/evasion-suite/evasion-aware-malware

      # Layer 3: Injection (must have at least one technique)
      - id: obj/process/injection/remote-thread-pattern
