# Social Engineering - Generic Naming Patterns
# GAP #5: Detects generic/suspicious application naming used for masquerading
# Malware often uses generic names to appear legitimate while hiding true purpose
# ATT&CK: T1036.005 (Match Legitimate Name and Location)

defaults:
  for: [macho]
  platforms: [macos, ios]
  attack: "T1036.005"
  mbc: "F0009"

traits:
  # Generic executable names
  - id: generic-executable-name
    desc: "Generic executable name"
    crit: notable
    conf: 0.6
    if:
      type: basename
      regex: "^(Application|Installer|Update|Setup|Service|Helper|Tool|Utility)$"
      case_insensitive: true

composite_rules:
  # Match bundle IDs with generic utility/app patterns
  # The meta/signed/id:: trait is already extracted by macho parser
  - id: generic-bundle-id-pattern
    desc: "Generic bundle identifier pattern"
    crit: notable
    conf: 0.75
    any:
      - id: meta/signed/id::com.utils.application
      - id: meta/signed/id::com.util.application
      - id: meta/signed/id::com.utility.application
      - id: meta/signed/id::com.app.application
      - id: meta/signed/id::com.tools.application
      - id: meta/signed/id::com.tool.application
      - id: meta/signed/id::com.helper.application
      - id: meta/signed/id::com.service.application

  # Combination of generic bundle ID + unsigned = suspicious
  - id: suspicious-generic-naming
    desc: "Suspicious generic application naming"
    crit: suspicious
    conf: 0.8
    all:
      - id: generic-bundle-id-pattern
      - id: meta/signed/adhoc::unsigned

  # Generic naming + malicious capabilities = masquerading malware
  - id: masquerading-malware-generic
    desc: "Masquerading malware with generic name"
    crit: suspicious
    conf: 0.9
    attack: "T1036.005"
    all:
      - id: generic-bundle-id-pattern
    any:
      - id: cap/exec/command/shell::c-popen
      - id: cap/exec/command/shell::c-system
      - id: obj/persist/daemon/init::daemon-fork
    none:
      - id: meta/signed/platform::apple

  # Very suspicious: generic name + ad-hoc signature + shell execution
  - id: unsigned-generic-shell-exec
    desc: "Unsigned generic app with shell"
    crit: suspicious
    conf: 0.95
    attack: "T1036.005"
    all:
      - id: meta/signed/adhoc::unsigned
      - id: generic-executable-name
      - id: cap/exec/command/shell::shell-execution
