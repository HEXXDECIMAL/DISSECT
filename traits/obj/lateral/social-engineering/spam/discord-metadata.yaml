# Discord Metadata Spam Detection
# Detects packages that exist solely to spam Discord invites
# ATT&CK: T1566.002 (Spearphishing Link)

composite_rules:
  - id: discord-spam-email
    desc: Discord URL masquerading as email address
    crit: hostile
    conf: 0.95
    all:
      - id: obj/c2/channel/discord::discord-fake-email
      - id: obj/c2/channel/discord::discord-string

  - id: discord-spam-typosquat
    desc: Typosquatting package advertising Discord
    crit: hostile
    conf: 0.95
    all:
      - id: obj/lateral/supply-chain/pypi/keywords::typosquatting-keyword
      - id: obj/c2/channel/discord::discord-string

  - id: discord-spam-license
    desc: License file contains Discord invite
    crit: suspicious
    conf: 0.8
    all:
      - id: obj/c2/channel/discord::discord-invite-string
      - id: meta/quality::licensed