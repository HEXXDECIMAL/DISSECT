traits:
  - id: rundll32-obfuscated-env-var
    desc: Obfuscated Rundll32 with environment variables
    crit: suspicious
    conf: 0.9
    for: [batch, shell]
    if:
      type: raw
      regex: '(?i)Ru(?:%[0-9]|%[^%]{1,120}%)32' # Matches Ru%132, Ru%foo%32

  - id: rundll32-obfuscated-split
    desc: Obfuscated Rundll32 split strings
    crit: suspicious
    conf: 0.8
    for: [batch, shell]
    if:
      type: raw
      regex: '(?i)R(?:\\^|%[^%]{1,120}%)?u(?:\\^|%[^%]{1,120}%)?n(?:\\^|%[^%]{1,120}%)?d(?:\\^|%[^%]{1,120}%)?l(?:\\^|%[^%]{1,120}%)?l(?:\\^|%[^%]{1,120}%)?32'