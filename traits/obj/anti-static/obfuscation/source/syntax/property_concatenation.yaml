# Property Concatenation Obfuscation
# Detects string construction using object property access {k:'v'}.k

defaults:
  crit: suspicious
  conf: 0.9
  for: [javascript]

traits:
  - id: js-property-concatenation-obfuscation
    desc: "Obfuscated string construction using property access"
    mbc: "B0032.001"
    if:
      type: raw
      regex: '\{\s*[a-zA-Z0-9_$]+\s*:\s*[''"][^''"]{1,120}[''"]\s*\}\s*\.\s*[a-zA-Z0-9_$]+'
