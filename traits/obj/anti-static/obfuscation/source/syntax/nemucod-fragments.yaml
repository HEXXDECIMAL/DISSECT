traits:
  - id: nemucod-wsh-fragments
    desc: Variable assignment of known Nemucod WSH fragments
    crit: suspicious
    for: [javascript]
    if:
      type: string
      regex: 'var\s+[a-zA-Z0-9_]+\s*=\s*"(?:Fil|eTo|Sav|ADOD|DODB|onseB|nseB|espo|ect|rea|Obj|eObj|WScr|ipt|Sle|ep|eam|re|nd|tr|B\.S|Expan|dEnvi|onmen|rings|St|ML2\.X|HTTP|Shell|Run|getMi|lise|conds|liseconds|getM|Da|te|Dat|TEMP%)";'
      case_insensitive: false

  - id: nemucod-network-fragments
    desc: Variable assignment of known Nemucod network fragments
    crit: suspicious
    for: [javascript]
    if:
      type: string
      regex: 'var\s+[a-zA-Z0-9_]+\s*=\s*"(?:op|en|se|nd|GET|POST|http|https|hard|acc|ou|ntan|ts\.co|\.uk|qw4|opd|hara|ccoun|ants|co\.uk|qw4o|pd)";'
      case_insensitive: false
