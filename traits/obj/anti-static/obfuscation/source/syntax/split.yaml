defaults:
  crit: notable
  conf: 0.8
  for: [javascript]

traits:
  - id: js-split-custom-delimiter
    desc: "Split with custom delimiter"
    if:
      type: raw
      # Matches .split("^") or .split("@") or other non-alphanumeric delimiters
      # Excludes common delimiters: = , . : ; / _ | - ` \
      regex: '\.split\(\s*["''][^a-zA-Z0-9\s=,.:;/_|`\\?&-]["'']\s*\)'

  - id: js-string-concatenation
    desc: "String concatenation (potential obfuscation)"
    crit: notable
    if:
      type: ast
      query: |
        (binary_expression)

  - id: js-split-string-property
    desc: "Property access via split string concatenation"
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: '\[\s*["''][^"'']{1,120}["'']\s*\+\s*["''][^"'']{1,120}["'']\s*\]'