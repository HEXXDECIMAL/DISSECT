defaults:
  crit: notable
  conf: 0.8
  for: [javascript]

traits:
  - id: js-useless-arithmetic
    desc: "Useless arithmetic (N-N)"
    if:
      type: ast
      query: |
        (binary_expression
          left: (number) @left
          operator: "-"
          right: (number) @right
          (#eq? @left @right))

  - id: js-obfuscated-increment
    desc: "Obfuscated increment/decrement via arithmetic"
    crit: suspicious
    conf: 0.8
    if:
      type: raw
      regex: '\(-\d+\s*\+\s*\d+\)'

  - id: js-comma-sequence-obfuscation
    desc: "Useless comma sequence (obfuscation)"
    crit: notable
    if:
      type: ast
      query: |
        (sequence_expression)
