composite_rules:
  - id: fake-gzip-loader
    desc: Obfuscated loader using fake GZIP header variables
    crit: hostile
    conf: 0.99
    attack: "T1027"
    mbc: "B0032"
    for: [javascript, typescript]
    all:
      - id: cap/data/encode/gzip::gzip-header-identifier
      - id: cap/exec/vm/sandbox::base64-long-string
    any:
      - id: obj/anti-static/obfuscation/strings/encoding::js-charat-loop
      - id: obj/anti-static/obfuscation/strings/encoding::js-array-swap
