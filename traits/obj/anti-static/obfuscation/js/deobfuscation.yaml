traits:
  - id: js-substitution-map-deobfuscation
    desc: Javascript deobfuscation using a substitution map.
    crit: suspicious
    conf: 0.9
    for: [javascript]
    if:
      type: ast
      query: |
        (program
          (for_statement
            (statement_block
              (expression_statement
                (assignment_expression
                  right: (binary_expression
                    operator: "+"
                  )
                )
              )
            )
          )
          (expression_statement
            (call_expression
              function: (identifier) @eval
              (#eq? @eval "eval")
            )
          )
        )
