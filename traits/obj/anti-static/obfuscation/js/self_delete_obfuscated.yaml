# Obfuscated JScript Self-Deletion
# Detects obfuscated self-deletion patterns in JScript

defaults:
  crit: suspicious
  conf: 0.8
  for: [javascript]

traits:
  - id: js-deletefile-obfuscated
    desc: "Obfuscated DeleteFile reference"
    if:
      type: encoded
      # Matches property concatenation pattern for "Del" (D,e,l)
      regex: '\{[^:]+:[''"]D[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]e[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]l[''"]\}'

  - id: js-scriptfullname-obfuscated
    desc: "Obfuscated ScriptFullName reference"
    if:
      type: encoded
      # Matches property concatenation pattern for "Scr" (S,c,r)
      regex: '\{[^:]+:[''"]S[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]c[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]r[''"]\}'