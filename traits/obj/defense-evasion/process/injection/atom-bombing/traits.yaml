# Atom Bombing Injection Technique
# Detects alternative process injection via Windows atom table
# ATT&CK: T1055.001 (Process Injection: Dynamic-link Library Injection)

traits:
  - id: addatoma-api
    desc: AddAtomA API atom table access
    crit: notable
    conf: 0.8
    platforms: [windows]
    for: [pe]
    if:
      type: symbol
      exact: "AddAtomA"
    mbc: "C0041"

  - id: getatomnama-api
    desc: GetAtomNameA API for atom retrieval
    crit: notable
    conf: 0.8
    platforms: [windows]
    for: [pe]
    if:
      type: symbol
      exact: "GetAtomNameA"
    mbc: "C0041"

  - id: globalgetatomname-api
    desc: GlobalGetAtomName API
    crit: notable
    conf: 0.75
    platforms: [windows]
    for: [pe]
    if:
      type: symbol
      exact: "GlobalGetAtomName"

composite_rules:
  - id: atom-bombing-capable
    desc: Atom bombing injection capability
    crit: suspicious
    conf: 0.85
    attack: "T1055.001"
    mbc: "C0041"
    platforms: [windows]
    for: [pe]
    all:
      - id: addatoma-api
      - id: getatomnama-api
