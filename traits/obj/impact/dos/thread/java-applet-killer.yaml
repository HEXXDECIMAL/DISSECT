# Detects Java AppletKiller malware that terminates all threads
# Ref: https://github.com/MalwareSourceCode/Java/blob/master/Trojan.Java.AppletKiller
# Lang: java

traits:
  - id: applet-killer-strings
    desc: Detects AppletKiller-specific strings
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: '(?i)(?:killer|killAllThreads|AppletKiller)'

composite_rules:
  - id: applet-killer-dos
    desc: Java AppletKiller thread termination logic
    crit: hostile
    conf: 1.0
    all:
      - id: cap/process/thread/terminate::stop
      - id: cap/process/thread/enumerate::get-group
      - id: cap/process/thread/enumerate::enumerate
      - id: applet-killer-strings
