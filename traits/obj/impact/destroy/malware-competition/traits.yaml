# Malware Competition Elimination
# Detects patterns where malware eliminates competing malware
# Indicates botnet turf wars and competitive engagement
# ATT&CK: T1531 (Account Access Removal)
# MBC: B0025 (Execution)

traits:
  # === Process Watchdog ===
  - id: watchdog-monitor-process
    desc: "Process watchdog"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      word: "watchdog"
    attack: "T1547"

  - id: watchdog-process-restart
    desc: "Watchdog restart mechanism"
    crit: suspicious
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "watchdog"
    attack: "T1547"

  # === Killer Process ===
  - id: killer-process-shinji
    desc: "SHINJI killer process"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    if:
      type: string
      substr: "SHINJI"
    attack: "T1531"
    mbc: "B0025"

  - id: killing-competing-malware
    desc: "Competing malware killing"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "/Killer"
    attack: "T1531"

composite_rules:
  - id: process-watchdog-monitoring
    desc: "Process watchdog monitoring"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    attack: "T1547"
    any:
      - id: watchdog-monitor-process
      - id: watchdog-process-restart

  - id: malware-killer-pattern
    desc: "Malware killer process"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    attack: "T1531"
    mbc: "B0025"
    any:
      - id: killer-process-shinji
      - id: killing-competing-malware

  - id: malware-survival-infrastructure
    desc: "Malware survival infrastructure"
    crit: hostile
    conf: 0.95
    for: [elf, shell]
    attack: "T1547"
    mbc: "B0025"
    all:
      - id: process-watchdog-monitoring
      - id: malware-killer-pattern

  - id: mirai-killer-infrastructure
    desc: "Mirai killer process infrastructure"
    crit: hostile
    conf: 0.95
    for: [elf, shell]
    attack: "T1531"
    mbc: "B0025"
    all:
      - id: known/malware/botnet/mirai
      - id: killer-process-shinji
      - id: process-watchdog-monitoring
