# Malware Competition Elimination
# Detects patterns where malware eliminates competing malware
# Indicates botnet turf wars and competitive engagement
# ATT&CK: T1531 (Account Access Removal)
# MBC: B0025 (Execution)

traits:
  # === Process Watchdog ===
  - id: watchdog-monitor-process
    desc: "Process watchdog"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      word: "watchdog"
    notes: "Monitors malware process for crashes/restarts"
    attack: "T1547"

  - id: watchdog-process-restart
    desc: "Watchdog restart mechanism"
    crit: suspicious
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "watchdog"
    notes: "Process watchdog for malware persistence"
    attack: "T1547"

  # === Killer Process ===
  - id: killer-process-shinji
    desc: "SHINJI killer process"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    if:
      type: string
      substr: "SHINJI"
    notes: "Mirai-specific killer process for competing malware"
    attack: "T1531"
    mbc: "B0025"

  - id: killing-competing-malware
    desc: "Competing malware killing"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "/Killer"
    notes: "Kill competing malware processes"
    attack: "T1531"

composite_rules:
  - id: process-watchdog-monitoring
    desc: "Process watchdog monitoring"
    crit: suspicious
    conf: 0.85
    for: [elf, shell]
    attack: "T1547"
    notes: |
      Malware uses watchdog process to monitor its own execution.
      Ensures malware survives crashes and restarts.
    any:
      - id: watchdog-monitor-process
      - id: watchdog-process-restart

  - id: malware-killer-pattern
    desc: "Malware killer process"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    attack: "T1531"
    mbc: "B0025"
    notes: |
      Malware kills competing malware processes.
      Indicates botnet ecosystem competition (turf wars).
    any:
      - id: killer-process-shinji
      - id: killing-competing-malware

  - id: malware-survival-infrastructure
    desc: "Malware survival infrastructure"
    crit: hostile
    conf: 0.95
    for: [elf, shell]
    attack: "T1547"
    mbc: "B0025"
    notes: |
      Complete malware survival infrastructure:
      1. Watchdog monitoring: Restarts if malware crashes
      2. Killer process: Eliminates competing malware

      Indicates:
      - Sophisticated persistence strategy
      - Competitive botnet landscape
      - Advanced malware design for longevity
    all:
      - id: process-watchdog-monitoring
      - id: malware-killer-pattern

  - id: mirai-killer-infrastructure
    desc: "Mirai killer process infrastructure"
    crit: hostile
    conf: 0.95
    for: [elf, shell]
    attack: "T1531"
    mbc: "B0025"
    notes: |
      Mirai botnet with complete survival infrastructure.
      SHINJI killer process targets competing malware.
      Watchdog process ensures continuous operation.
    all:
      - id: known/malware/botnet/mirai
      - id: killer-process-shinji
      - id: process-watchdog-monitoring
