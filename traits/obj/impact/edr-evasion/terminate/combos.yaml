# Impact: EDR/Security Software Evasion
# Composite rules for terminating security processes

composite_rules:
  - id: terminate-process-evasion
    desc: EDR/antivirus termination capability
    crit: suspicious
    conf: 0.85
    attack: "T1562.001"
    mbc: "B0033"
    for: ["pe", "dll"]
    all:
      - id: cap/process/terminate/kill::terminate-process
      - id: obj/exec/module/load::get-current-process
    downgrade:
      any:
        - id: meta/quality/versioned

  - id: process-termination-chain
    desc: Debugger evasion with process termination
    crit: notable
    conf: 0.80
    attack: "T1562.001"
    for: ["pe", "dll"]
    size_max: 200000
    all:
      - id: obj/exec/native/runtime::debugger-detect-api
      - id: cap/process/terminate/kill::terminate-process
      - id: cap/dylib/load::load-library-a
    downgrade:
      any:
        - id: meta/quality/versioned
