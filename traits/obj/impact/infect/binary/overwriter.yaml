defaults:
  for: [c, cpp]

composite_rules:
  - id: overwriter-virus-traversal
    desc: "Helper: DOS directory traversal"
    conf: 1.0
    crit: notable
    any:
      - id: cap/fs/directory/traverse::findfirst
      - id: cap/fs/directory/traverse::findnext

  - id: overwriter-virus-logic
    desc: Detects logic typical of overwriting viruses (file enumeration + self-read + write)
    conf: 0.9
    crit: hostile
    all:
      - id: obj/impact/infect/binary::overwriter-virus-traversal
      - id: cap/os/process/info::check-argv-0
      - id: cap/fs/file/open::open
      - id: cap/fs/file/read::read
      - id: cap/fs/file/write::write
