// Migrated from malcontent: process/chdir.yara

rule chdir: harmless {
  meta:
    description = "changes working directory"
    confidence  = "0.66"
    pledge      = "rpath"

  strings:
$chdir = "chdir" fullword
    $win   = /SetCurrentDirectory\w{0,4}/
  condition:
    any of them
}

rule chdir_shell {
  meta:
    description = "changes working directory"
    confidence  = "0.66"
    pledge      = "rpath"

  strings:
$val = /cd [\\\"\{\}\$\w\-\_\.\/ \$]{0,16}/ fullword
  condition:
    any of them
}
