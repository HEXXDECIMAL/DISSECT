---
# Ruby process manipulation
traits:
  - id: ruby-process-setuid
    description: "Set user/group ID"
    criticality: notable
    confidence: 0.93
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Process.setuid
        - Process.setgid
        - Process.seteuid
        - Process.setegid

  - id: ruby-process-kill
    description: "Kill process"
    criticality: notable
    confidence: 0.90
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Process.kill

  - id: ruby-process-daemon
    description: "Daemonize process (background)"
    criticality: notable
    confidence: 0.93
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Process.daemon

  - id: ruby-process-fork
    description: "Fork process"
    criticality: notable
    confidence: 0.88
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Process.fork
        - fork

  - id: ruby-pty
    description: "Pseudo-terminal (PTY) manipulation"
    criticality: notable
    confidence: 0.93
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - PTY.spawn
        - PTY.open
