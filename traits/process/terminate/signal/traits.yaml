# Process Termination and Signal Handling Traits
# MBC: OC0003 (Defense Evasion) / OB0006 (Execution)
# ATT&CK: T1562 (Impair Defenses) / T1059 (Command and Scripting Interpreter)

defaults:
  file_types: [elf, macho, so, dylib, c]

traits:
  # Signal sending
  - id: kill
    description: Send signal to process (terminate, stop, or control)
    crit: notable
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.6
    condition:
      type: symbol
      pattern: kill
    platforms: [unix, linux, macos]

  - id: killpg
    description: Send signal to process group
    crit: notable
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.7
    condition:
      type: symbol
      pattern: killpg
    platforms: [unix, linux, macos]

  # Signal handling
  - id: signal
    description: Install signal handler (catch or ignore signals)
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    confidence: 0.6
    condition:
      type: symbol
      pattern: signal
    platforms: [unix, linux, macos]

  - id: sigaction
    description: Examine or change signal action
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    confidence: 0.6
    condition:
      type: symbol
      pattern: sigaction
    platforms: [unix, linux, macos]

  - id: sigprocmask
    description: Examine or change blocked signals
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    confidence: 0.6
    condition:
      type: symbol
      pattern: sigprocmask
    platforms: [unix, linux, macos]

  # Process termination
  - id: abort
    description: Cause abnormal process termination
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.4
    condition:
      type: symbol
      pattern: abort
    platforms: [unix, linux, macos, windows]

  - id: exit
    description: Terminate process with status code
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.3
    condition:
      type: symbol
      pattern: exit
    platforms: [unix, linux, macos, windows]

  - id: _exit
    description: Terminate process immediately without cleanup
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    confidence: 0.4
    condition:
      type: symbol
      pattern: _exit
    platforms: [unix, linux, macos]
