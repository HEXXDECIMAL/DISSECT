defaults:
  for:
  - all
traits:
- id: ioredis-auto-pipeline
  desc: ioredis auto-pipelining commands list
  crit: inert
  if:
    type: raw
    substr: notAllowedAutoPipelineCommands
- id: ioredis-command
  desc: ioredis Command class
  crit: inert
  if:
    type: raw
    regex: Command\.FLAGS\s*=\s*\{|VALID_IN_SUBSCRIBER_MODE
- id: ioredis-utils
  desc: ioredis utility functions
  crit: inert
  if:
    type: raw
    regex: exports\.(bufferEqual|convertBufferToString|wrapMultiResult|packObject|convertObjectToArray|convertMapToArray|optimizeErrorStack|parseURL|zipMap)
composite_rules: []
