# Chrome Extension Manifest Name/Description Keywords
# Detects specific keywords in manifest name and description fields

defaults:
  for: [manifest.json]
  crit: inert
  conf: 0.5

traits:
  # === Description Crypto/Finance Keywords ===
  - id: description-crypto
    desc: Description contains 'crypto'
    if:
      type: kv
      path: 'description'
      substr: 'crypto'
      case_insensitive: true

  - id: description-wallet
    desc: Description contains 'wallet'
    if:
      type: kv
      path: 'description'
      substr: 'wallet'
      case_insensitive: true

  - id: description-blockchain
    desc: Description contains 'blockchain'
    if:
      type: kv
      path: 'description'
      substr: 'blockchain'
      case_insensitive: true

  - id: description-defi
    desc: Description contains 'defi'
    if:
      type: kv
      path: 'description'
      substr: 'defi'
      case_insensitive: true

  - id: description-token
    desc: Description contains 'token'
    if:
      type: kv
      path: 'description'
      substr: 'token'
      case_insensitive: true

  - id: description-trading
    desc: Description contains 'trading'
    if:
      type: kv
      path: 'description'
      substr: 'trading'
      case_insensitive: true

  - id: description-swap
    desc: Description contains 'swap'
    if:
      type: kv
      path: 'description'
      substr: 'swap'
      case_insensitive: true

  - id: description-nft
    desc: Description contains 'nft'
    if:
      type: kv
      path: 'description'
      substr: 'nft'
      case_insensitive: true

  - id: description-ethereum
    desc: Description contains 'ethereum'
    if:
      type: kv
      path: 'description'
      substr: 'ethereum'
      case_insensitive: true

  - id: description-solana
    desc: Description contains 'solana'
    if:
      type: kv
      path: 'description'
      substr: 'solana'
      case_insensitive: true

  - id: description-bitcoin
    desc: Description contains 'bitcoin'
    if:
      type: kv
      path: 'description'
      substr: 'bitcoin'
      case_insensitive: true

  # === Name Crypto/Finance Keywords ===
  - id: name-crypto
    desc: Name contains 'crypto'
    if:
      type: kv
      path: 'name'
      substr: 'crypto'
      case_insensitive: true

  - id: name-wallet
    desc: Name contains 'wallet'
    if:
      type: kv
      path: 'name'
      substr: 'wallet'
      case_insensitive: true

  - id: name-blockchain
    desc: Name contains 'blockchain'
    if:
      type: kv
      path: 'name'
      substr: 'blockchain'
      case_insensitive: true

  - id: name-defi
    desc: Name contains 'defi'
    if:
      type: kv
      path: 'name'
      substr: 'defi'
      case_insensitive: true

  - id: name-token
    desc: Name contains 'token'
    if:
      type: kv
      path: 'name'
      substr: 'token'
      case_insensitive: true

  - id: name-swap
    desc: Name contains 'swap'
    if:
      type: kv
      path: 'name'
      substr: 'swap'
      case_insensitive: true

  - id: name-nft
    desc: Name contains 'nft'
    if:
      type: kv
      path: 'name'
      substr: 'nft'
      case_insensitive: true

  - id: name-ethereum
    desc: Name contains 'ethereum'
    if:
      type: kv
      path: 'name'
      substr: 'ethereum'
      case_insensitive: true

  - id: name-solana
    desc: Name contains 'solana'
    if:
      type: kv
      path: 'name'
      substr: 'solana'
      case_insensitive: true

  - id: name-bitcoin
    desc: Name contains 'bitcoin'
    if:
      type: kv
      path: 'name'
      substr: 'bitcoin'
      case_insensitive: true

  # === Adblocker Keywords ===
  - id: name-adblocker-a
    desc: Name mentions ad blocker (set A)
    if:
      type: kv
      path: 'name'
      regex: 'ad\s*block|block\s*ads|remove\s*ads'
      case_insensitive: true

  - id: name-adblocker-b
    desc: Name mentions ad blocker (set B)
    if:
      type: kv
      path: 'name'
      regex: 'no\s*ads|ads\s*cleaner|sponsored'
      case_insensitive: true

  - id: description-adblocker-a
    desc: Description mentions ad blocker (set A)
    if:
      type: kv
      path: 'description'
      regex: 'ad\s*block|block\s*ads|remove\s*ads'
      case_insensitive: true

  - id: description-adblocker-b
    desc: Description mentions ad blocker (set B)
    if:
      type: kv
      path: 'description'
      regex: 'no\s*ads|ads\s*cleaner|sponsored'
      case_insensitive: true

composite_rules:
  - id: crypto-finance-description
    desc: Description mentions crypto/finance keywords
    crit: notable
    conf: 0.85
    any:
      - id: description-crypto
      - id: description-wallet
      - id: description-blockchain
      - id: description-defi
      - id: description-token
      - id: description-trading
      - id: description-swap
      - id: description-nft
      - id: description-ethereum
      - id: description-solana
      - id: description-bitcoin

  - id: crypto-finance-name
    desc: Name mentions crypto/finance keywords
    crit: notable
    conf: 0.85
    any:
      - id: name-crypto
      - id: name-wallet
      - id: name-blockchain
      - id: name-defi
      - id: name-token
      - id: name-swap
      - id: name-nft
      - id: name-ethereum
      - id: name-solana
      - id: name-bitcoin

  - id: adblocker-name
    desc: Name mentions ad blocking
    crit: notable
    conf: 0.85
    any:
      - id: name-adblocker-a
      - id: name-adblocker-b

  - id: adblocker-description
    desc: Description mentions ad blocking
    crit: notable
    conf: 0.85
    any:
      - id: description-adblocker-a
      - id: description-adblocker-b
