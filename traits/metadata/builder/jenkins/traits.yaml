# Build System - JENKINS

defaults:
  for: [all]

traits:
  # === Jenkins micro-traits ===
  - id: jenkins-url
    desc: JENKINS_URL variable
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "JENKINS_URL"

  - id: build-number
    desc: BUILD_NUMBER variable
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "BUILD_NUMBER"

  - id: job-name
    desc: JOB_NAME variable
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "JOB_NAME"

  - id: jenkinsfile
    desc: Jenkinsfile
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "Jenkinsfile"

composite_rules:
  # Jenkins composite (migrated from YARA)
  - id: jenkins
    desc: Jenkins CI artifacts
    crit: notable
    conf: 0.85
    needs: 2
    any:
      - id: jenkins-url
      - id: build-number
      - id: job-name
      - id: jenkinsfile
