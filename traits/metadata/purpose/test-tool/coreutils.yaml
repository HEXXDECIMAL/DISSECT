defaults:
  for: [all]

traits:
  - id: coreutils-copyright
    desc: Coreutils copyright string
    crit: notable
    if:
      type: raw
      substr: "Free Software Foundation, Inc."
  
  - id: exercise-basenc
    desc: "Exercise basenc comment"
    crit: notable
    if:
      type: raw
      substr: "Exercise basenc"

  - id: coreutils-test-functions
    desc: Coreutils test framework functions
    crit: notable
    for: [shell]
    if:
      type: symbol
      regex: "^(framework_failure_|require_root_|require_selinux_|print_ver_)$"

composite_rules:
  - id: coreutils-test-script
    desc: Coreutils test script
    crit: notable
    conf: 0.8
    all:
      - id: metadata/lang/shebang::perl
      - id: metadata/purpose/test-tool::coreutils-copyright
      - id: metadata/purpose/test-tool::exercise-basenc
