# Malware Family - Kubo Injector
# Reference: https://github.com/kubo/injector
# ATT&CK: T1055 (Process Injection)

traits:
  - id: injector/kubo/cloned-thread
    description: Kubo cloned thread injection
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1055"
    file_types: [elf]
    condition:
      type: string
      exact: "inject_in_cloned_thread"

  - id: injector/kubo/arch2name
    description: Kubo architecture name resolver
    criticality: suspicious
    confidence: 0.9
    family: true
    attack: "T1055"
    file_types: [elf]
    condition:
      type: string
      exact: "arch2name"

  - id: injector/kubo/remote-vcall
    description: Kubo remote virtual call
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1055"
    file_types: [elf]
    condition:
      type: string
      exact: "remote_vcall"

  - id: injector/kubo/libc-info
    description: Kubo libc information collector
    criticality: suspicious
    confidence: 0.9
    family: true
    attack: "T1055"
    file_types: [elf]
    condition:
      type: string
      exact: "collect_libc_info"

  - id: injector/kubo/shellcode-size
    description: Kubo shellcode size marker
    criticality: suspicious
    confidence: 0.9
    family: true
    attack: "T1055"
    file_types: [elf]
    condition:
      type: string
      exact: "shellcode_size"

composite_rules:
  - id: injector/kubo/detected
    description: Kubo process injector
    criticality: suspicious
    confidence: 0.95
    family: true
    reference: "https://github.com/kubo/injector"
    attack: "T1055"
    mbc: "E1055"
    file_types: [elf]
    requires_any_n:
      count: 3
      conditions:
        - 
          id: injector/kubo/cloned-thread
        - 
          id: injector/kubo/arch2name
        - 
          id: injector/kubo/remote-vcall
        - 
          id: injector/kubo/libc-info
        - 
          id: injector/kubo/shellcode-size
