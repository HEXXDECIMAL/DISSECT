traits:
  - id: known-tools/trojan/kito/encoded-strings
    desc: Kito-specific encoded wide string patterns
    crit: suspicious
    confidence: 0.9
    for: [macho]
    if:
      type: hex
      # wide strings from __const
      pattern: "77 00 00 00 4f 00 00 00 6c 00 00 00 0d 00 00 00 22 00 00 00 7a 00 00 00 6c 00 00 00 1a 00 00 00"

  - id: known-tools/trojan/kito/wide-string-artifact
    desc: Kito-specific wide string artifact "wOl\r"zl"
    crit: suspicious
    confidence: 0.8
    for: [macho]
    if:
      type: string
      exact: "wOl\r\"zl"

composite_rules:
  - id: detected-partial
    desc: Kito malware detected (partial indicators)
    crit: suspicious
    any:
      - id: known-tools/trojan/kito/encoded-strings
      - id: known-tools/trojan/kito/wide-string-artifact

  - id: known-tools/trojan/kito/detected
    desc: Kito malware detected
    crit: hostile
    mbc: "B0022"
    attack: "T1059.004"
    all:
      - id: detected-partial
      - id: exec/command/shell/shell-execution
      - id: anti-static/obfuscation/arithmetic/complex-arithmetic-loop
      - id: anti-static/obfuscation/arithmetic/arm64-sdiv-decoding-loop
