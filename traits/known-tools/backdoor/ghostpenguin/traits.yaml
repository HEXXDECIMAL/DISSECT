traits:
  - id: ghostpenguin/c2-ip
    description: "GhostPenguin C2 IP address"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    condition:
      type: string
      regex: "124[.]221[.]109[.]147|65[.]20[.]72[.]101"

  - id: ghostpenguin/c2-domain
    description: "GhostPenguin C2 domain"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "www.iytest.com"

  - id: ghostpenguin/string-format
    description: "GhostPenguin unique format strings"
    criticality: suspicious
    confidence: 1.0
    attack: "T1082"
    file_types: [elf, pe]
    condition:
      type: string
      regex: 'Bytes == %d\r\n(LanIP|GateWay|OSInfo|MachineName|DomainName|Userame|OSBits):%s'

  - id: ghostpenguin/class-name
    description: "GhostPenguin internal class names"
    criticality: suspicious
    confidence: 0.9
    attack: "T1059"
    file_types: [elf, pe]
    condition:
      type: string
      regex: "CBasicInfoGather|CTool|CMyRC5|CMyShowMessage"

composite_rules:
  - id: backdoor/ghostpenguin/detected
    description: "GhostPenguin backdoor detected"
    criticality: hostile
    confidence: 0.95
    attack: "T1071"
    mbc: "B0022"
    file_types: [elf, pe]
    requires_count: 2
    conditions:
      - id: ghostpenguin/c2-ip
      - id: ghostpenguin/c2-domain
      - id: ghostpenguin/string-format
      - id: ghostpenguin/class-name
