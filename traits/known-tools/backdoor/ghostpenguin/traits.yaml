traits:
  # === GhostPenguin C2 IP atomic indicators ===
  - id: ghostpenguin/c2-ip-1
    description: "GhostPenguin C2 IP 124.221.109.147"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "124.221.109.147"

  - id: ghostpenguin/c2-ip-2
    description: "GhostPenguin C2 IP 65.20.72.101"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "65.20.72.101"

  - id: ghostpenguin/c2-domain
    description: "GhostPenguin C2 domain"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "www.iytest.com"

  - id: ghostpenguin/string-format
    description: "GhostPenguin unique format strings"
    criticality: suspicious
    confidence: 1.0
    attack: "T1082"
    file_types: [elf, pe]
    condition:
      type: string
      regex: 'Bytes == %d\r\n(LanIP|GateWay|OSInfo|MachineName|DomainName|Userame|OSBits):%s'

  # === GhostPenguin class name atomic indicators ===
  - id: ghostpenguin/class-basicinfo
    description: "GhostPenguin CBasicInfoGather class"
    criticality: notable
    confidence: 0.8
    attack: "T1059"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "CBasicInfoGather"

  - id: ghostpenguin/class-ctool
    description: "GhostPenguin CTool class"
    criticality: notable
    confidence: 0.7
    attack: "T1059"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "CTool"

  - id: ghostpenguin/class-rc5
    description: "GhostPenguin CMyRC5 class"
    criticality: notable
    confidence: 0.8
    attack: "T1059"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "CMyRC5"

  - id: ghostpenguin/class-showmessage
    description: "GhostPenguin CMyShowMessage class"
    criticality: notable
    confidence: 0.8
    attack: "T1059"
    file_types: [elf, pe]
    condition:
      type: string
      exact: "CMyShowMessage"

composite_rules:
  # GhostPenguin C2 IP composite
  - id: ghostpenguin/c2-ip
    description: "GhostPenguin C2 IP address"
    criticality: suspicious
    confidence: 1.0
    attack: "T1071"
    file_types: [elf, pe]
    requires_count: 1
    conditions:
      - id: ghostpenguin/c2-ip-1
      - id: ghostpenguin/c2-ip-2

  # GhostPenguin class name composite
  - id: ghostpenguin/class-name
    description: "GhostPenguin internal class names"
    criticality: suspicious
    confidence: 0.9
    attack: "T1059"
    file_types: [elf, pe]
    requires_count: 1
    conditions:
      - id: ghostpenguin/class-basicinfo
      - id: ghostpenguin/class-ctool
      - id: ghostpenguin/class-rc5
      - id: ghostpenguin/class-showmessage

  - id: backdoor/ghostpenguin/detected
    description: "GhostPenguin backdoor detected"
    criticality: hostile
    confidence: 0.95
    attack: "T1071"
    mbc: "B0022"
    file_types: [elf, pe]
    requires_count: 2
    conditions:
      - id: ghostpenguin/c2-ip
      - id: ghostpenguin/c2-domain
      - id: ghostpenguin/string-format
      - id: ghostpenguin/class-name
