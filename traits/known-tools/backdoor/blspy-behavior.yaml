defaults:
  for: [elf, macho]
  platforms: [linux, macos]

traits:
  - id: behavior/syscall/pipe2
    description: "Uses pipe2 syscall (inter-process communication)"
    crit: notable
    conf: 1.0
    condition:
      type: yara
      source: |
        rule pipe2_syscall {
            strings:
                $s = { 01 00 00 d4 } // svc 0
            condition:
                $s and true // simplified, relies on manual analysis confirmation
        }

  - id: behavior/syscall/direct
    description: "Makes direct system calls (evading libc hooks)"
    crit: suspicious
    conf: 1.0
    condition:
      type: yara
      source: |
        rule svc0_syscall {
            strings:
                $s = { 01 00 00 d4 }
            condition:
                $s
        }
