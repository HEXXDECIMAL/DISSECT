# NodeJS Backdoor Behaviors
# Detects combinations of behaviors common in NodeJS backdoors

composite_rules:
  - id: backdoor/nodejs/behavior-mix
    description: "NodeJS backdoor-like behavior (Masquerading + Execution + File Perms)"
    crit: hostile
    conf: 0.85
    attack: "T1059.003"
    mbc: "B0022"
    file_types: [elf, macho]
    requires_all:
      - id: exec/process/name/nodejs-title
      - id: fs/permission/chmod/string
      - id: exec/javascript/eval/child-process-require