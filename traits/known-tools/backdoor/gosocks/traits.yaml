# GoSocks Backdoor (Go-based SOCKS5 Proxy & Shell)
# Combines SOCKS5 proxying with a reverse shell, written in Go
# ATT&CK: T1090.001 (Proxy: Internal Proxy), T1059 (Command and Scripting Interpreter)

traits:
  - id: backdoor/gosocks/unique-path
    description: "Unique Go package path for SOCKS5/Shell logic"
    criticality: suspicious
    confidence: 1.0
    attack: "T1090"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "src/mode/httpAndTcp/socket5Quick"

  - id: backdoor/gosocks/shell-module
    description: "GoSocks shell execution module"
    criticality: suspicious
    confidence: 0.95
    attack: "T1059"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "src/mode/httpAndTcp/shell/ShellLinux.Exec_shell"

  - id: backdoor/gosocks/proxy-module
    description: "GoSocks SOCKS5 proxy startup function"
    criticality: suspicious
    confidence: 0.95
    attack: "T1090"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "src/mode/httpAndTcp/socket5Quick.StartProxy"

  - id: backdoor/gosocks/forward-module
    description: "GoSocks port forwarding module"
    criticality: suspicious
    confidence: 0.95
    attack: "T1090"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "src/mode/httpAndTcp/inForward.Start"

composite_rules:
  - id: backdoor/gosocks/detected
    description: "GoSocks Backdoor detected"
    criticality: hostile
    confidence: 1.0
    attack: "T1090"
    mbc: "B0022"
    file_types: [elf, macho]
    requires_any:
      - type: trait
        id: backdoor/gosocks/unique-path
      - type: trait
        id: backdoor/gosocks/shell-module
      - type: trait
        id: backdoor/gosocks/proxy-module
      - type: trait
        id: backdoor/gosocks/forward-module
