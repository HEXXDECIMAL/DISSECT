# Generic Stealth Backdoor Patterns
# Detects combinations of anti-analysis and evasive behaviors

composite_rules:
  - id: backdoor/generic/stealth-behavior
    description: "Stealth backdoor behavior (Anti-analysis + Evasion)"
    criticality: hostile
    confidence: 0.9
    attack: "T1027"
    mbc: "B0001"
    file_types: [elf, macho, so, dylib]
    max_size: 10485760 # 10MB
    requires_count: 3
    conditions:
      - type: trait
        id: anti-analysis/debugger/detect/process-inspection
      - type: trait
        id: anti-analysis/timing/primitive
      - type: trait
        id: anti-static/obfuscation/strings-deobfuscation
      - type: trait
        id: anti-analysis/self-modify/mprotect