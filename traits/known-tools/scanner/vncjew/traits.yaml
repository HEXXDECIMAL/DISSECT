# Malware Family - VNCJew Scanner
# ATT&CK: T1046 (Network Service Scanning)

traits:
  - id: scanner/vncjew/read-vncs
    description: VNCJew VNC reader function
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1046"
    file_types: [elf]
    condition:
      type: string
      exact: "readVNCs"

  - id: scanner/vncjew/iptables-ref
    description: Reference to iptables firewall utility
    criticality: notable
    confidence: 0.7
    file_types: [elf]
    condition:
      type: string
      exact: "iptables"

  - id: scanner/vncjew/masscan-ref
    description: Reference to masscan network scanner
    criticality: notable
    confidence: 0.7
    file_types: [elf]
    condition:
      type: string
      exact: "masscan"

composite_rules:
  - id: scanner/vncjew/detected
    description: VNCJew VNC scanner
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1046"
    mbc: "B0046"
    file_types: [elf]
    requires_all:
      - type: trait
        id: scanner/vncjew/read-vncs
      - type: trait
        id: scanner/vncjew/iptables-ref
      - type: trait
        id: scanner/vncjew/masscan-ref
