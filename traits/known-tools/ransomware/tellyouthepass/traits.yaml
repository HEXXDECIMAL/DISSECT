# TellYouThePass Ransomware Detection
# ATT&CK: T1486 (Data Encrypted for Impact)
# MBC: C0027 (Encrypt Files)

traits:
  - id: ransomware/tellyouthepass/id
    desc: "TellYouThePass identifier"
    crit: suspicious
    conf: 0.95
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      exact: "tellyouthepass"
      case_insensitive: true

  - id: ransomware/tellyouthepass/tytp
    desc: "TellYouThePass short identifier"
    crit: suspicious
    conf: 0.8
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      exact: "TYTP"

  - id: ransomware/tellyouthepass/note
    desc: "TellYouThePass ransom note"
    crit: suspicious
    conf: 0.9
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      regex: "README_LOCKED|HOW_TO_DECRYPT"

composite_rules:
  - id: ransomware/tellyouthepass/detected
    desc: "TellYouThePass ransomware detected"
    crit: suspicious
    conf: 0.95
    mbc: "C0027"
    attack: "T1486"
    any:
      - id: ransomware/tellyouthepass/id
      - id: ransomware/tellyouthepass/tytp
      - id: ransomware/tellyouthepass/note