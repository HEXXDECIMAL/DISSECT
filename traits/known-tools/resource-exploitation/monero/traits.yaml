# Monero cryptocurrency detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  # Monero wallet address with word boundaries
  # Note: This uses word boundary anchors for higher precision
  - id: monero-wallet-4-bounded
    desc: Monero wallet address starting with 4 (word-bounded)
    crit: inert
    conf: 0.9
    for: [all]
    if:
      type: string
      regex: "\\b4[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{94}\\b"

composite_rules:
  # Migrated from YARA
  # Note: The filesize > 1KB constraint from YARA is not directly translatable
  # to DISSECT's trait system, but the word boundary requirement increases precision
  - id: cryptominer/monero/wallet-address
    desc: "Monero wallet address"
    crit: suspicious
    conf: 0.9
    mbc: "B0036"
    attack: "T1496"
    for: [all]
    any:
      - id: monero-wallet-4-bounded
