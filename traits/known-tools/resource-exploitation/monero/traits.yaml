# Monero cryptocurrency detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  - id: cryptominer/monero/wallet-address
    desc: "Monero wallet address"
    crit: suspicious
    conf: 0.9
    mbc: "B0036"
    attack: "T1496"
    if:
      type: yara
      # Monero addresses: 95 chars starting with 4, using Base58
      # Base58 alphabet excludes: 0, O, I, l (to avoid confusion)
      # Valid chars: 123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz
      source: |
        rule monero_wallet_address {
          strings:
            // Standard Monero address: 95 chars, starts with 4
            // Use proper Base58 alphabet (no 0, O, I, l)
            $addr = /\b4[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{94}\b/
          condition:
            $addr and filesize > 1KB
        }
