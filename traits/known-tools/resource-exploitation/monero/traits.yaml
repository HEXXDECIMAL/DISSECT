# Monero cryptocurrency detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  - id: cryptominer/monero/wallet-address
    description: "Monero wallet address"
    criticality: hostile
    confidence: 0.9
    mbc: "B0036"
    attack: "T1496"
    condition:
      type: yara
      # Monero addresses: 95 chars starting with 4, using Base58 (all alphanumeric)
      # Use YARA for better boundary detection and to reduce false positives
      # from long concatenated strings in Rust/encoding library data
      source: |
        rule monero_wallet_address {
          strings:
            // Standard Monero address: 95 chars, starts with 4
            // Require word boundaries and exclude obvious code patterns
            // Real addresses have mixed case from Base58 encoding
            $addr = /\b4[0-9A-Za-z]{94}\b/
          condition:
            // Require the match and check it's not in a code-heavy region
            // by ensuring the file isn't tiny (embedded configs are larger)
            $addr and filesize > 1KB
        }
