# Malware Family - IPRoyal Pawns (Proxyware)
# Reference: https://asec.ahnlab.com/en/37276/
# ATT&CK: T1090 (Proxy)

traits:
  - id: proxyware/pawns/gitlab-dev
    description: IPRoyal Pawns GitLab development path
    criticality: suspicious
    confidence: 0.99
    family: true
    attack: "T1090"
    file_types: [elf]
    condition:
      type: string
      exact: "gitlab.iproyal.dev/pawns/"

  - id: proxyware/pawns/mole
    description: IPRoyal Pawns mole component
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1090"
    file_types: [elf]
    condition:
      type: string
      exact: "go-pawns/mole"

  - id: proxyware/pawns/brand
    description: IPRoyal Pawns brand string
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1090"
    file_types: [elf]
    condition:
      type: string
      exact: "IPROYAL PAWNS"

  - id: proxyware/pawns/api-url
    description: IPRoyal Pawns API URL variable
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1090"
    file_types: [elf]
    condition:
      type: string
      exact: "PAWNS_API_URL"

composite_rules:
  - id: proxyware/pawns/detected
    description: IPRoyal Pawns proxyware
    criticality: suspicious
    confidence: 0.95
    family: true
    reference: "https://asec.ahnlab.com/en/37276/"
    attack: "T1090"
    mbc: "B0012"
    file_types: [elf]
    requires_any:
      - type: trait
        id: proxyware/pawns/gitlab-dev
      - type: trait
        id: proxyware/pawns/mole
      - type: trait
        id: proxyware/pawns/brand
      - type: trait
        id: proxyware/pawns/api-url
