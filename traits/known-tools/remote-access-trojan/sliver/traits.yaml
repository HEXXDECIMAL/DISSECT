# Malware Family - Sliver C2 Framework
# Reference: https://github.com/BishopFox/sliver
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # === Atomic Traits (for ML decomposition) ===

  - id: c2-framework/sliver/sliverpb
    description: Sliver protobuf package reference
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "sliverpb"

  - id: c2-framework/sliver/bishopfox
    description: BishopFox vendor reference
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "bishopfox"

  - id: c2-framework/sliver/proto-ref
    description: Sliver proto definition reference
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "sliver.proto"

  - id: c2-framework/sliver/implant-builds
    description: Sliver implant build function
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "GetImplantBuilds"

  - id: c2-framework/sliver/beacon-jitter
    description: Sliver beacon jitter function
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "GetBeaconJitter"

  - id: c2-framework/sliver/obfuscate-symbols
    description: Sliver symbol obfuscation function
    criticality: suspicious
    confidence: 0.9
    family: true
    attack: "T1027"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "GetObfuscateSymbols"

  - id: c2-framework/sliver/beacon-id
    description: Sliver beacon ID function
    criticality: suspicious
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "GetBeaconID"

  # === Obfuscated variant traits ===

  - id: c2-framework/sliver/coredump
    description: Sliver CoreDump reference
    criticality: suspicious
    confidence: 0.6
    attack: "T1071"
    platforms: [linux]
    file_types: [elf]
    condition:
      type: string
      exact: ".CoreDump"

  - id: c2-framework/sliver/gvisor-gso
    description: Sliver gVisor GSO capability check
    criticality: suspicious
    confidence: 0.7
    attack: "T1071"
    platforms: [linux]
    file_types: [elf]
    condition:
      type: string
      exact: "HasGvisorGSOCapability"

  - id: c2-framework/sliver/proxy-func
    description: Sliver proxy function reference
    criticality: suspicious
    confidence: 0.5
    attack: "T1090"
    platforms: [all]
    condition:
      type: string
      exact: "ProxyFunc"

  - id: c2-framework/sliver/set-spoofing
    description: Sliver spoofing function
    criticality: suspicious
    confidence: 0.7
    attack: "T1090"
    platforms: [all]
    condition:
      type: string
      exact: "SetSpoofing"

composite_rules:
  # Main Sliver detection via explicit markers
  - id: c2-framework/sliver/detected
    description: Sliver C2 framework implant
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://github.com/BishopFox/sliver"
    attack: "T1071"
    mbc: "B0030"
    file_types: [elf, macho, pe, go]
    requires_count: 2
    conditions:
      - type: trait
        id: c2-framework/sliver/sliverpb
      - type: trait
        id: c2-framework/sliver/bishopfox
      - type: trait
        id: c2-framework/sliver/proto-ref
      - type: trait
        id: c2-framework/sliver/implant-builds
      - type: trait
        id: c2-framework/sliver/beacon-jitter
      - type: trait
        id: c2-framework/sliver/beacon-id

  # Sliver functions detection
  - id: c2-framework/sliver/functions-detected
    description: Sliver C2 implant functions
    criticality: hostile
    confidence: 0.95
    family: true
    mbc: "B0030"
    attack: "T1071"
    file_types: [elf, macho, pe, go]
    requires_count: 2
    conditions:
      - type: trait
        id: c2-framework/sliver/implant-builds
      - type: trait
        id: c2-framework/sliver/beacon-jitter
      - type: trait
        id: c2-framework/sliver/obfuscate-symbols
      - type: trait
        id: c2-framework/sliver/beacon-id

  # Obfuscated variant detection via YARA (needs filesize constraints)
  - id: c2-framework/sliver/obfuscated-detected
    description: Sliver C2 obfuscated Linux implant
    criticality: hostile
    confidence: 0.9
    family: true
    mbc: "B0030"
    attack: "T1071"
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - type: trait
        id: c2-framework/sliver/coredump
      - type: trait
        id: c2-framework/sliver/gvisor-gso
      - type: trait
        id: c2-framework/sliver/proxy-func
      - type: trait
        id: c2-framework/sliver/set-spoofing
