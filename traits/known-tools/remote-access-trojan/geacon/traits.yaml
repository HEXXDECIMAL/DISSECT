# Malware Family - Geacon C2 Beacon
# Go implementation of Cobalt Strike beacon
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # === Atomic Traits ===

  - id: c2-framework/geacon/coded-ref
    description: Geacon coded reference
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "geacon coded"

  - id: c2-framework/geacon/path-ref
    description: Geacon package path reference
    crit: suspicious
    conf: 0.9
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "geacon/"

  - id: c2-framework/geacon/author-darkr4y
    description: Geacon author reference
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "darkr4y"

  - id: c2-framework/geacon/motto
    description: Geacon author motto
    crit: suspicious
    conf: 0.9
    family: true
    attack: "T1071"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    condition:
      type: string
      exact: "cuz life is shit"

  - id: c2-framework/geacon/change-dir
    description: Geacon change directory packet
    crit: suspicious
    conf: 0.7
    attack: "T1083"
    platforms: [all]
    condition:
      type: string
      exact: "packet.ChangeCurrentDir"

  - id: c2-framework/geacon/gbk-convert
    description: Geacon GBK string conversion
    crit: suspicious
    conf: 0.75
    family: true
    attack: "T1071"
    platforms: [all]
    condition:
      type: string
      exact: "ConvertStr2GBK"

  - id: c2-framework/geacon/fake-ie-ua
    description: Geacon fake IE user agent
    crit: suspicious
    conf: 0.5
    attack: "T1071.001"
    platforms: [all]
    condition:
      type: string
      exact: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"

composite_rules:
  - id: c2-framework/geacon/detected
    description: Geacon Go-based Cobalt Strike beacon
    crit: hostile
    conf: 0.95
    family: true
    attack: "T1071"
    mbc: "B0030"
    platforms: [all]
    file_types: [elf, macho, pe, go]
    requires_count: 2
    any:
      - id: c2-framework/geacon/coded-ref
      - id: c2-framework/geacon/path-ref
      - id: c2-framework/geacon/author-darkr4y
      - id: c2-framework/geacon/motto
      - id: c2-framework/geacon/change-dir
      - id: c2-framework/geacon/gbk-convert
