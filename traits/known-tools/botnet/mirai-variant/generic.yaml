# IoT Botnet Indicators
# MBC: OB0004 (Command & Control)
# ATT&CK: T1583.005 (Botnet)

traits:
  - id: iot-botnet/gpio-daemon
    description: GPIO daemon naming (IoT botnet indicator)
    criticality: suspicious
    confidence: 0.75
    mbc: "OB0004"
    attack: "T1583.005"
    file_types: [elf]
    condition:
      type: string
      regex: "gpio[a-z]?_daemon"

  - id: busybox
    description: BusyBox reference
    criticality: notable
    confidence: 0.70
    file_types: [elf, shell]
    condition:
      type: string
      regex: "/bin/busybox|busybox\\s"

  - id: iot-botnet/ssdp-discover
    description: SSDP M-SEARCH discovery (UPnP exploitation/scanning)
    criticality: suspicious
    confidence: 0.75
    mbc: "E1018"
    attack: "T1046"
    file_types: [elf]
    condition:
      type: string
      regex: "M-SEARCH.*ssdp:discover"

  - id: iot-botnet/telnet-brute
    description: Telnet credentials (IoT device compromise)
    criticality: suspicious
    confidence: 0.8
    mbc: "T1110"
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      regex: "(root|admin):(root|admin|toor|password|1234|12345|default|123456)|guest:guest"
      min_count: 2

  - id: iot-botnet/mirai-strings
    description: Mirai botnet-style brand strings
    criticality: suspicious
    confidence: 0.8
    mbc: "OB0004"
    attack: "T1583.005"
    file_types: [elf]
    condition:
      type: string
      regex: "\\b(LZRD|SORA|OWARI|MIRAI|BASHLITE|QBOT|TSUNAMI|GAFGYT)\\b"
      case_insensitive: true

composite_rules:
  # IoT botnet detection - requires multiple indicators
  - id: iot-botnet-detected
    description: IoT botnet variant detected (multiple indicators)
    criticality: hostile
    confidence: 0.95
    mbc: "OB0004"
    attack: "T1583.005"
    file_types: [elf]
    requires_count: 3
    conditions:
      - id: iot-botnet/gpio-daemon
      - id: iot-botnet/ssdp-discover
      - id: iot-botnet/telnet-brute
      - id: iot-botnet/mirai-strings
      - id: busybox
