# IoT Botnet Indicators
# MBC: OB0004 (Command & Control)
# ATT&CK: T1583.005 (Botnet)

traits:
  - id: iot-botnet/gpio-daemon
    description: GPIO daemon naming (IoT botnet indicator)
    criticality: hostile
    confidence: 0.90
    mbc: "OB0004"
    attack: "T1583.005"
    condition:
      type: string
      regex: "gpio[a-z]?_daemon"

  - id: busybox
    description: BusyBox reference
    criticality: notable
    confidence: 0.70
    condition:
      type: string
      regex: "/bin/busybox|busybox\\s"

  - id: iot-botnet/ssdp-discover
    description: SSDP M-SEARCH discovery (UPnP exploitation/scanning)
    criticality: hostile
    confidence: 0.85
    mbc: "E1018"
    attack: "T1046"
    condition:
      type: string
      regex: "M-SEARCH.*ssdp:discover"

  - id: iot-botnet/telnet-brute
    description: Telnet credentials (IoT device compromise)
    criticality: hostile
    confidence: 0.90
    mbc: "T1110"
    attack: "T1110.001"
    file_types: [elf]  # IoT botnets target Linux, not macOS/Windows
    condition:
      type: string
      # Require multiple default credential pairs or root/admin specific
      # Exclude generic "user:password" which appears in documentation
      regex: "(root|admin):(root|admin|toor|password|1234|12345|default|123456)|guest:guest"
      min_count: 2

  - id: iot-botnet/mirai-strings
    description: Mirai botnet-style strings
    criticality: hostile
    confidence: 0.95
    mbc: "OB0004"
    attack: "T1583.005"
    file_types: [elf]  # Mirai variants target Linux/IoT, not macOS/Windows
    condition:
      type: string
      # Word boundaries prevent matching Unicode script names like "Sora_Sompeng"
      # from regex-syntax library in Rust binaries
      regex: "\\b(LZRD|SORA|OWARI|MIRAI|BASHLITE|QBOT|TSUNAMI|GAFGYT)\\b"
      case_insensitive: true
