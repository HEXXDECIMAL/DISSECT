# Malware Family - Yakuza Botnet (Gafgyt Variant)
# Reference: https://cujo.com/blog/mirai-gafgyt-with-new-ddos-modules-discovered/
# ATT&CK: T1498 (Network Denial of Service)

traits:
  - id: botnet/yakuza/brand
    description: Yakuza botnet identifier
    criticality: suspicious
    confidence: 0.99
    family: true
    attack: "T1498"
    file_types: [elf]
    condition:
      type: string
      exact: "YakuzaBotnet"

  # Moved from composite_rules - YARA with magic bytes + filesize + string
  - id: botnet/yakuza/detected
    description: Yakuza botnet (Gafgyt variant)
    criticality: suspicious
    confidence: 0.99
    family: true
    reference: "https://cujo.com/blog/mirai-gafgyt-with-new-ddos-modules-discovered/"
    attack: "T1498"
    mbc: "B0008"
    file_types: [elf]
    condition:
      type: yara
      source: |
        rule yakuza_botnet {
          strings:
            $brand = "YakuzaBotnet"
          condition:
            uint32(0) == 0x464C457F and
            filesize > 100KB and filesize < 250KB and $brand
        }
