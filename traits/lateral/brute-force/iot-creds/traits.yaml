# IoT Default Credential Detection
# Common default credentials used in IoT botnets (Mirai, etc.)
# ATT&CK: T1110.001 (Brute Force: Password Guessing)

traits:
  # Mirai credential indicators - individual strings are suspicious
  - id: mirai-cred-admin
    description: Mirai credential variant (7ujMko0admin)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "7ujMko0admin"

  - id: mirai-cred-vizxv
    description: Mirai credential variant (7ujMko0vizxv)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "7ujMko0vizxv"

  - id: mirai-cred-juantech
    description: Mirai credential variant (juantech)
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "juantech"

  - id: mirai-cred-xc3511
    description: Mirai credential variant (xc3511)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "xc3511"

  - id: mirai-cred-jvbzd
    description: Mirai credential variant (jvbzd)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "jvbzd"

  - id: mirai-cred-smcadmin
    description: Mirai credential variant (smcadmin)
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "smcadmin"

  - id: mirai-cred-gm8182
    description: Mirai credential variant (GM8182)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "GM8182"

  - id: mirai-cred-oelinux
    description: Mirai credential variant (oelinux123)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "oelinux123"

  - id: mirai-cred-hi3518
    description: Mirai credential variant (hi3518)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "hi3518"

  # Dahua/Hikvision camera credentials
  - id: camera-cred-vizxv
    description: IP camera credential (vizxv)
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "vizxv"

  - id: camera-cred-xmhdipc
    description: IP camera credential (xmhdipc)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "xmhdipc"

  # Router default credentials
  - id: router-cred-zte
    description: Router credential (Zte521)
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "Zte521"

  - id: router-cred-huawei
    description: Router credential (telecomadmin)
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "telecomadmin"

  # Telnet bruteforce indicators
  - id: telnet-connect
    description: Telnet connection string
    criticality: suspicious
    confidence: 0.7
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      regex: "telnet (connect|scanner|brute)"
      case_insensitive: true

  - id: busybox-download
    description: BusyBox download exploitation
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      regex: "busybox (wget|tftp)"

  - id: mirai-cred-prefix
    description: Mirai credential prefix (7ujMko0)
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "7ujMko0"

  - id: telnet-port-scan
    description: Telnet port 23 scanning indicator
    criticality: suspicious
    confidence: 0.75
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      regex: "port 23 open"
      case_insensitive: true

  - id: router-shell-enable
    description: Router shell enable sequence
    criticality: suspicious
    confidence: 0.8
    attack: "T1110.001"
    file_types: [elf]
    condition:
      type: string
      exact: "enable\nshell\nsh"

composite_rules:
  # Mirai default credentials - requires 3+ credential strings
  - id: mirai-creds
    description: Mirai botnet default credential list detected
    criticality: hostile
    confidence: 0.95
    attack: "T1110.001"
    mbc: "E1017"
    file_types: [elf]
    requires_count: 3
    conditions:
      - type: trait
        id: mirai-cred-admin
      - type: trait
        id: mirai-cred-vizxv
      - type: trait
        id: mirai-cred-juantech
      - type: trait
        id: mirai-cred-xc3511
      - type: trait
        id: mirai-cred-jvbzd
      - type: trait
        id: mirai-cred-smcadmin
      - type: trait
        id: mirai-cred-gm8182
      - type: trait
        id: mirai-cred-oelinux
      - type: trait
        id: mirai-cred-hi3518

  # Camera credential list detection
  - id: camera-creds
    description: IP camera default credentials detected
    criticality: hostile
    confidence: 0.9
    attack: "T1110.001"
    mbc: "E1017"
    file_types: [elf]
    requires_count: 2
    conditions:
      - type: trait
        id: camera-cred-vizxv
      - type: trait
        id: camera-cred-xmhdipc
      - type: trait
        id: mirai-cred-vizxv
      - type: trait
        id: mirai-cred-prefix

  # Telnet bruteforce attack pattern
  - id: telnet-attack
    description: Telnet bruteforce attack pattern detected
    criticality: hostile
    confidence: 0.9
    attack: "T1110.001"
    mbc: "E1017"
    file_types: [elf]
    requires_count: 2
    conditions:
      - type: trait
        id: telnet-connect
      - type: trait
        id: busybox-download
      - type: trait
        id: telnet-port-scan
      - type: trait
        id: router-shell-enable
