# VSCode Extension Manifest (VSIX) Traits
# Detects metadata and properties in extension.vsixmanifest

traits:
  - id: identity
    description: VSCode extension identity metadata
    crit: inert
    confidence: 1.0
    file_types: [vsixmanifest]
    condition:
      type: yara
      source: |
        rule vscode_manifest_identity {
          strings:
            $identity = "<Identity" ascii
            $publisher = "Publisher=" ascii
            $id = "Id=" ascii
            $version = "Version=" ascii
          condition:
            all of them
        }

  - id: engine
    description: VSCode engine requirement
    crit: inert
    confidence: 1.0
    file_types: [vsixmanifest]
    condition:
      type: string
      regex: 'Microsoft\.VisualStudio\.Code\.Engine'

  - id: executes-code
    description: Extension explicitly marks that it executes code
    crit: notable
    confidence: 1.0
    file_types: [vsixmanifest]
    condition:
      type: string
      regex: 'Microsoft\.VisualStudio\.Code\.ExecutesCode.{0,50}Value="true"'

  - id: links
    description: Extension manifest contains external links
    crit: inert
    confidence: 0.8
    file_types: [vsixmanifest]
    condition:
      type: yara
      source: |
        rule vscode_manifest_links {
          strings:
            $link1 = "Microsoft.VisualStudio.Services.Links.Source" ascii
            $link2 = "Microsoft.VisualStudio.Services.Links.GitHub" ascii
            $link3 = "Microsoft.VisualStudio.Services.Links.Support" ascii
          condition:
            any of them
        }
