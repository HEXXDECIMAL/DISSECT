# Trojanized Vue.js Library Detection
# ATT&CK: T1195.002 (Compromise Software Supply Chain)
# Detects Vue libraries modified to include malicious capabilities

defaults:
  attack: "T1195.002"
  mbc: "B0024"
  for: [javascript]

composite_rules:
  # Vue + ActiveXObject = HOSTILE (complexity >= 4)
  - id: trojanized-activex
    desc: "Vue library with ActiveXObject (trojanized supply chain attack)"
    crit: hostile
    conf: 0.98
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
      - {id: exec/dropper/activex-object}
    explanation: |
      This file contains Vue.js library signatures but uses ActiveXObject.
      Real Vue never uses ActiveXObject for any purpose.
      This is a trojanized library - a supply chain attack.

  # Vue + Reverse Shell = HOSTILE
  - id: trojanized-reverse-shell
    desc: "Vue library with reverse shell (trojanized supply chain attack)"
    crit: hostile
    conf: 0.98
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
      - {id: c2/reverse-shell/node/socket-with-exec}
    explanation: |
      This Vue library contains reverse shell capabilities.
      Real Vue is a UI framework and doesn't create reverse shells.
      This is a trojanized library - a supply chain attack.

  # Vue + Base64 Eval = HOSTILE (hidden payload)
  - id: trojanized-base64-eval
    desc: "Vue library with base64+eval payload (trojanized supply chain attack)"
    crit: hostile
    conf: 0.95
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
      - {id: anti-static/obfuscation/base64-eval}
    explanation: |
      This Vue library uses base64+eval to hide malicious code.
      Real Vue doesn't use base64+eval obfuscation patterns.
      This is a trojanized library - a supply chain attack.

  # Vue + Credential Access = HOSTILE
  - id: trojanized-credential-access
    desc: "Vue library with credential access (trojanized supply chain attack)"
    crit: hostile
    conf: 0.98
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
    any:
      - {id: cred/browser/chromium/login-data}
      - {id: cred/browser/firefox/cookies-sqlite}
    explanation: |
      This Vue library accesses credential stores.
      Real Vue never accesses browser credentials.
      This is a trojanized library - a supply chain attack.

  # Vue + Command Execution = HOSTILE
  - id: trojanized-exec
    desc: "Vue library with command execution (trojanized supply chain attack)"
    crit: hostile
    conf: 0.98
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
    any:
      - {id: exec/command/shell}
      - {id: exec/command/node/child-process}
    explanation: |
      This Vue library executes system commands or spawns processes.
      Real Vue is a UI framework and never executes commands.
      This is a trojanized library - a supply chain attack.

  # Vue + Network Backdoor = HOSTILE
  - id: trojanized-backdoor
    desc: "Vue library with network backdoor (trojanized supply chain attack)"
    crit: hostile
    conf: 0.95
    all:
      - {id: feat/library/vue/library}
      - {id: feat/library/vue/version-string}
      - {id: c2/infrastructure/domain/suspicious}
    explanation: |
      This Vue library communicates with suspicious domains.
      This is a trojanized library - a supply chain attack.
