# Python Package Distribution
# Detects Python packaging mechanisms (setuptools, distutils)
# These are benign package distribution mechanisms

defaults:
  file_types: [python]
  criticality: notable

traits:
  # setuptools usage
  - id: setuptools
    description: "Python package distribution (setuptools)"
    confidence: 0.8
    condition:
      type: string
      regex: "from\\s+setuptools\\s+import|import\\s+setuptools"
      search_raw: true

  # distutils usage (older)
  - id: distutils
    description: "Python package distribution (distutils)"
    confidence: 0.8
    condition:
      type: string
      regex: "from\\s+distutils"
      search_raw: true

  # setup() function call
  - id: setup-call
    description: "Python package setup() definition"
    confidence: 0.85
    condition:
      type: ast_pattern
      node_type: call
      pattern: "setup("

  # Package metadata
  - id: metadata
    description: "Python package metadata definition"
    confidence: 0.7
    condition:
      type: string
      regex: "author\\s*=|version\\s*=|description\\s*=|packages\\s*="
      search_raw: true
