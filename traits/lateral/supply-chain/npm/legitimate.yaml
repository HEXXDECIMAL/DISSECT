# Legitimate Bundled/Minified Code Markers
# These patterns indicate code was bundled by legitimate tools
# Helps reduce false positives from minification being flagged as obfuscation

traits:
  # Webpack bundled
  - id: webpack-bundled
    description: Code bundled with webpack (legitimate minification)
    crit: inert
    confidence: 0.95
    file_types: [javascript]
    condition:
      type: string
      regex: '__webpack_require__|webpackChunk|__webpack_modules__'

  # Rollup bundled
  - id: rollup-bundled
    description: Code bundled with rollup (legitimate minification)
    crit: inert
    confidence: 0.95
    file_types: [javascript]
    condition:
      type: string
      regex: '_interopDefaultLegacy|_interopNamespace|rollupPluginBabel'

  # esbuild bundled
  - id: esbuild-bundled
    description: Code bundled with esbuild (legitimate minification)
    crit: inert
    confidence: 0.95
    file_types: [javascript]
    condition:
      type: string
      regex: '__toESM|__toCommonJS|__export|__copyProps'

  # Parcel bundled
  - id: parcel-bundled
    description: Code bundled with Parcel (legitimate minification)
    crit: inert
    confidence: 0.95
    file_types: [javascript]
    condition:
      type: string
      regex: 'parcelRequire|__parcel__'

  # Vite bundled
  - id: vite-bundled
    description: Code bundled with Vite (legitimate minification)
    crit: inert
    confidence: 0.95
    file_types: [javascript]
    condition:
      type: string
      regex: '__vite__|import\\.meta\\.hot'

  # TypeScript compiled marker
  - id: typescript-compiled
    description: Code compiled from TypeScript
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: '__esModule|Object\\.defineProperty\\(exports|tslib'

  # Babel transpiled
  - id: babel-transpiled
    description: Code transpiled with Babel
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: '_classCallCheck|_defineProperty|_objectSpread|@babel/runtime'

  # Source map reference
  - id: has-sourcemap
    description: Code has source map reference (professional build)
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: '//# sourceMappingURL=|//@ sourceMappingURL='

  # UMD module pattern
  - id: umd-pattern
    description: Universal Module Definition pattern
    crit: inert
    confidence: 0.85
    file_types: [javascript]
    condition:
      type: string
      regex: 'typeof exports.{0,30}===.{0,30}object.{0,30}&&.{0,30}typeof module.{0,30}!==.{0,30}undefined|\\(function\\s*\\(root,\\s*factory\\)'

  # CommonJS2 export pattern
  - id: cjs2-export
    description: CommonJS2 module export pattern
    crit: inert
    confidence: 0.85
    file_types: [javascript]
    condition:
      type: string
      regex: 'module\\.exports\\.default|exports\\.default\\s*='

  # React production build
  - id: react-production
    description: React production build markers
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: 'react\\.production\\.min|ReactDOM\\.production'

  # Vue production build
  - id: vue-production
    description: Vue production build markers
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: 'vue\\.runtime\\.esm|vue\\.esm-bundler|__VUE_PROD'

  # Angular production build
  - id: angular-production
    description: Angular production build markers
    crit: inert
    confidence: 0.9
    file_types: [javascript]
    condition:
      type: string
      regex: '@angular/core|ngDevMode|ɵɵdefineComponent'

  # Known legitimate minifier output patterns
  - id: use-strict-quote
    desc: "\"use strict\" directive"
    crit: inert
    conf: 0.6
    for: [javascript]
    if:
      type: string
      exact: "\"use strict\""

  - id: void-zero
    desc: "void 0 pattern (minifier output)"
    crit: inert
    conf: 0.6
    for: [javascript]
    if:
      type: string
      exact: "void 0"

  - id: esmodule-export
    desc: __esModule property
    crit: inert
    conf: 0.6
    for: [javascript]
    if:
      type: string
      exact: "__esModule"

  - id: object-define-property
    desc: Object.defineProperty call
    crit: inert
    conf: 0.6
    for: [javascript]
    if:
      type: string
      exact: "Object.defineProperty"

# Legitimate JavaScript Code Patterns
# These patterns are typically PRESENT in legitimate code and ABSENT in malware
# Useful for differential ML analysis

  # Has module.exports (CommonJS export)
  - id: has-cjs-export
    description: Code exports functionality via CommonJS
    crit: inert
    confidence: 0.85
    file_types: [javascript]
    condition:
      type: string
      regex: "module\\.exports\\s*=|exports\\.[a-zA-Z]"

  # Has ES module export
  - id: has-esm-export
    description: Code exports functionality via ES modules
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "^export\\s+(default|const|function|class|async|let|var|\\{)"

  # Has class definition
  - id: has-class
    description: Code defines classes
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "^class\\s+[A-Z][a-zA-Z0-9]*|export\\s+class\\s+[A-Z]"

  # Has JSDoc comments
  - id: has-jsdoc
    description: Code has JSDoc documentation
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "/\\*\\*[\\s\\S]*?@(?:param|returns?|type|typedef|example)"

  # Has proper error handling
  - id: has-try-catch
    description: Code has try-catch error handling
    crit: inert
    confidence: 0.75
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "try\\s*\\{[^}]+\\}\\s*catch"

  # Has async/await
  - id: has-async-await
    description: Code uses async/await patterns
    crit: inert
    confidence: 0.7
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "async\\s+function|async\\s*\\(|await\\s+"

  # Has Promise usage
  - id: has-promise
    description: Code uses Promises
    crit: inert
    confidence: 0.7
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "new\\s+Promise\\(|\\.then\\(|\\.catch\\(|Promise\\.(?:all|race|resolve|reject)"

  # Has named function definitions
  - id: has-named-functions
    description: Code has named function definitions
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "^(?:async\\s+)?function\\s+[a-z][a-zA-Z0-9]*\\s*\\("

  # Imports from node_modules
  - id: imports-dependencies
    description: Code imports from external packages
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"][^./][^'\"]+['\"]\\)|from\\s+['\"][^./][^'\"]+['\"]"

  # Has TypeScript types
  - id: has-typescript-types
    description: Code has TypeScript type annotations
    crit: inert
    confidence: 0.9
    file_types: [typescript]
    condition:
      type: string
      regex: ":\\s*(?:string|number|boolean|object|any|void|never|unknown|null|undefined|Array|Record|Promise)\\b"

  # Has interface/type definitions
  - id: has-type-definitions
    description: Code defines TypeScript interfaces or types
    crit: inert
    confidence: 0.9
    file_types: [typescript]
    condition:
      type: string
      regex: "^(?:export\\s+)?(?:interface|type)\\s+[A-Z]"

  # Has EventEmitter pattern
  - id: has-eventemitter
    description: Code uses EventEmitter pattern
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "extends\\s+EventEmitter|require\\(['\"]events['\"]\\)"

  # Has Stream usage
  - id: has-stream
    description: Code uses Node.js streams
    crit: inert
    confidence: 0.75
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"]stream['\"]\\)|Readable|Writable|Transform|Duplex"

  # Has Buffer with encoding (legitimate usage)
  - id: has-buffer-encoding
    description: Code uses Buffer with explicit encoding
    crit: inert
    confidence: 0.7
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "Buffer\\.from\\([^)]+,\\s*['\"](?:utf8|utf-8|ascii|hex|binary)['\"]\\)"

  # Has callback pattern
  - id: has-callback-pattern
    description: Code uses Node.js callback pattern
    crit: inert
    confidence: 0.7
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "function\\s*\\([^)]*,\\s*(?:callback|cb|done|next)\\)"

  # Has configuration object pattern
  - id: has-config-object
    description: Code uses configuration objects
    crit: inert
    confidence: 0.75
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:config|options|settings|opts)\\s*=\\s*\\{|function\\s*\\([^)]*(?:config|options|settings)\\)"

  # Has default export
  - id: has-default-export
    description: Code has default export
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "export\\s+default|module\\.exports\\s*="

  # Uses 'use strict'
  - id: use-strict
    description: Code uses strict mode
    crit: inert
    confidence: 0.75
    file_types: [javascript]
    condition:
      type: string
      exact: "'use strict'"

  # Test block patterns
  - id: describe-with-string
    desc: "describe() test block with string"
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "describe\\s*\\(\\s*['\"`]"

  - id: it-with-string
    desc: "it() test block with string"
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "it\\s*\\(\\s*['\"`]"

  - id: test-with-string
    desc: "test() block with string"
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "test\\s*\\(\\s*['\"`]"

  - id: expect-call
    desc: expect() assertion call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "expect("

  - id: assert-method
    desc: assert. method call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "assert."

  - id: should-assertion
    desc: .should. assertion pattern
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: ".should."

  # Has assertion library usage
  - id: has-assertions
    description: Code uses assertion patterns
    crit: inert
    confidence: 0.9
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:assert|expect|should)\\s*[.\\(]|toBe\\(|toEqual\\(|toMatch\\("

  # Uses popular web framework
  - id: uses-web-framework
    description: Code uses established web framework
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"](?:express|koa|fastify|hapi|next|nuxt)['\"]\\)|from ['\"](?:express|koa|fastify|hapi|next|nuxt)['\"]"

  # Has middleware pattern
  - id: has-middleware
    description: Code uses middleware pattern
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:app|router)\\.use\\(|middleware\\s*[=:]"

  # Has route definitions
  - id: has-routes
    description: Code defines HTTP routes
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:app|router)\\.(?:get|post|put|delete|patch)\\s*\\(['\"]/"

  # Has proper logging
  - id: has-logging
    description: Code uses logging library
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"](?:winston|pino|bunyan|log4js|debug)['\"]\\)|logger\\.|log\\.(?:info|warn|error|debug)"

  # Has schema validation
  - id: has-validation
    description: Code uses schema validation
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"](?:joi|yup|zod|ajv)['\"]\\)|z\\.object\\(|Joi\\.object\\("

  # Has database interaction
  - id: has-database
    description: Code interacts with database
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"](?:mongoose|sequelize|knex|pg|mysql|mongodb)['\"]\\)|prisma\\.|\\$queryRaw"

  # Has React/Vue/Angular patterns
  - id: has-frontend-framework
    description: Code uses frontend framework patterns
    crit: inert
    confidence: 0.9
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:React|Vue|Component)\\.(?:createElement|defineComponent)|@Component\\(|useEffect\\(|useState\\("

  # Has decorator patterns
  - id: has-decorators
    description: Code uses TypeScript/ES decorators
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "@(?:Controller|Injectable|Service|Module|Component|Prop|Watch)\\("

  # Has dependency injection
  - id: has-di-pattern
    description: Code uses dependency injection
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "(?:inject|provide|@Inject|container\\.resolve|inversify)"

  # Has CLI argument parsing
  - id: has-cli-args
    description: Code parses CLI arguments
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "require\\(['\"](?:commander|yargs|meow|minimist)['\"]\\)|program\\.(?:command|option)\\("

  # Has proper error class
  - id: has-error-class
    description: Code defines custom error classes
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "class\\s+\\w+Error\\s+extends\\s+Error"

  # Has getter/setter
  - id: has-accessors
    description: Code uses getters/setters
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "\\bget\\s+\\w+\\s*\\(\\)|\\bset\\s+\\w+\\s*\\("

  # Has symbol usage
  - id: has-symbols
    description: Code uses Symbol for private properties
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "Symbol\\s*\\(|Symbol\\.(?:for|iterator|asyncIterator)"

  # Has WeakMap/WeakSet (private data pattern)
  - id: has-weak-collections
    description: Code uses WeakMap/WeakSet patterns
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "new\\s+Weak(?:Map|Set)\\s*\\("

  # Has Proxy usage
  - id: has-proxy
    description: Code uses Proxy for metaprogramming
    crit: inert
    confidence: 0.8
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "new\\s+Proxy\\s*\\("

  # Has generator functions
  - id: has-generators
    description: Code uses generator functions
    crit: inert
    confidence: 0.85
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "function\\s*\\*|yield\\s+"

  # Multiple export patterns
  - id: esm-export-statement
    desc: ES module export statement
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "^export (const|function|class|let|var|async)"
      min_count: 2

  - id: cjs-exports-assignment
    desc: CommonJS exports.property assignment
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "exports\\.[a-zA-Z]+ ="
      min_count: 2

  - id: module-exports-object
    desc: "module.exports = {} object pattern"
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      regex: "module\\.exports = \\{"
# Legitimate Package File Presence Indicators
# These patterns detect file references that indicate professional package structure
# Useful for differential ML analysis

  # References README file
  - id: references-readme
    description: Package references README file
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"readme":|README\\.md|readme\\.md'

  # References LICENSE file
  - id: references-license
    description: Package references LICENSE file
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: 'LICENSE|license|LICENCE|licence|COPYING'

  # References CHANGELOG
  - id: references-changelog
    description: Package references CHANGELOG
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: 'CHANGELOG|changelog|HISTORY|history|CHANGES'

  # Has dist/lib output directory
  - id: has-build-output
    description: Package has build output directory
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"main":\\s*"(?:dist/|lib/|build/|out/)'

  # Has src directory structure
  - id: has-src-directory
    description: Package has src directory structure
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"[^"]*src/|"files":[^]]*"src"'

  # Has test directory
  - id: has-test-directory
    description: Package references test directory
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"test"|"tests"|"__tests__"|"spec"|"__mocks__"'

  # Has examples directory
  - id: has-examples
    description: Package has examples directory
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"examples"|"example"|"demo"|"demos"'

  # Has docs directory
  - id: has-docs
    description: Package has documentation directory
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"docs"|"documentation"|"doc"'

  # Has .github directory (CI/CD)
  - id: has-github-config
    description: Package references GitHub configuration
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.github|workflows|CONTRIBUTING|CODE_OF_CONDUCT|SECURITY\\.md'

  # Has TypeScript config
  - id: has-tsconfig
    description: Package has TypeScript configuration
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: 'tsconfig\\.json|tsconfig\\.build\\.json'

  # Has ESLint config
  - id: has-eslint-config
    description: Package has ESLint configuration
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.eslintrc|eslint\\.config|"eslintConfig":'

  # Has Prettier config
  - id: has-prettier-config
    description: Package has Prettier configuration
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.prettierrc|prettier\\.config|"prettier":'

  # Has Jest config
  - id: has-jest-config
    description: Package has Jest configuration
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: 'jest\\.config|"jest":\\s*\\{'

  # Has Babel config
  - id: has-babel-config
    description: Package has Babel configuration
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.babelrc|babel\\.config|"babel":'

  # Has editor config
  - id: has-editorconfig
    description: Package has editor configuration
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.editorconfig'

  # Has .npmignore or files field (publishing awareness)
  - id: has-publish-config
    description: Package has publishing configuration
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.npmignore|"files":\\s*\\['

# Legitimate Project Structure Indicators
# These patterns indicate professional development practices
# Useful for differential ML analysis

  # Has README file (detected via package.json main pointing to index)
  - id: has-index-entry
    description: Package has standard index entry point
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"main":\s*"(?:index\.js|dist/|lib/|src/)'

  # Has types entry point
  - id: has-types-entry
    description: Package has TypeScript types entry
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"types":\s*"|"typings":\s*"'

  # Has module entry (ESM)
  - id: has-module-entry
    description: Package has ESM module entry
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"module":\s*"'

  # Has sideEffects field
  - id: has-side-effects
    description: Package declares sideEffects (tree-shaking support)
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"sideEffects":\s*(?:false|\[)'

  # Has browserslist
  - id: has-browserslist
    description: Package has browser target configuration
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      exact: '"browserslist":'

  # Package entry point fields
  - id: pkg-main-field
    desc: "\"main\": field in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"main\":"

  - id: pkg-module-field
    desc: "\"module\": field in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"module\":"

  - id: pkg-exports-field-entry
    desc: "\"exports\": field in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"exports\":"

  - id: pkg-types-field
    desc: "\"types\": field in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"types\":"

  # NPM script fields
  - id: pkg-test-script-field
    desc: "\"test\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"test\":"

  - id: pkg-build-script-field
    desc: "\"build\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"build\":"

  - id: pkg-lint-script-field
    desc: "\"lint\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"lint\":"

  - id: pkg-format-script-field
    desc: "\"format\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"format\":"

  - id: pkg-dev-script-field
    desc: "\"dev\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"dev\":"

  - id: pkg-start-script-field
    desc: "\"start\": script in package.json"
    crit: inert
    conf: 0.6
    for: [packagejson]
    if:
      type: string
      exact: "\"start\":"

  # Has CI badge indicators (usually in description or homepage)
  - id: ci-badge-reference
    description: References CI service (professional project)
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: 'travis-ci\\.org|circleci\\.com|github\\.com/.{0,100}actions|codecov\\.io|coveralls\\.io'

  # Has conventional versioning
  - id: conventional-version
    description: Uses conventional version format
    crit: inert
    confidence: 0.75
    file_types: [packagejson]
    condition:
      type: string
      regex: '"version":\s*"[0-9]+\.[0-9]+\.[0-9]+(?:-(?:alpha|beta|rc|next|canary)\.[0-9]+)?"'

  # Has release/publish workflow scripts
  - id: has-release-scripts
    description: Package has release management scripts
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"(?:release|publish|version|prepublishOnly|postversion)":'

  # Has changeset or conventional commits tooling
  - id: has-changelog-tooling
    description: Package uses changelog/versioning tooling
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '@changesets/|standard-version|semantic-release|conventional-changelog'

  # Has peer dependency range (well-designed library)
  - id: peer-range
    description: Uses version ranges for peer dependencies
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"peerDependencies":\s*\{[^}]*"[>=<^~]'

  # Has optional dependencies
  - id: has-optional-deps
    description: Package has optional dependencies
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      exact: '"optionalDependencies":'

  # Has cpu/os restrictions
  - id: has-platform-restrictions
    description: Package specifies platform restrictions
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"cpu":\s*\[|"os":\s*\['

  # Uses scoped name from known org
  - id: scoped-known-org
    description: Package from known organization scope
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"name":\s*"@(?:types|babel|rollup|webpack|eslint|typescript-eslint|testing-library|storybook|angular|vue|emotion|chakra-ui)/'

  # Has npm scripts that reference node_modules/.bin
  - id: uses-bin-scripts
    description: Scripts reference node_modules binaries
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: 'node_modules/\\.bin/|npx |npm run '

  # Has husky/lint-staged (pre-commit tooling)
  - id: has-git-hooks
    description: Package uses git hooks tooling
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"husky"|"lint-staged"|"pre-commit"|"simple-git-hooks"'

# Legitimate npm Package Structure Patterns
# These patterns are typically PRESENT in legitimate packages and ABSENT in malware
# Useful for differential ML analysis

  # Has test script defined
  - id: has-test-script
    description: Package has test script (legitimate pattern)
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"test":\\s*"[^"]*(?:jest|mocha|ava|tap|vitest|node --test|npm test)'

  # Has TypeScript configuration
  - id: has-typescript
    description: Package has TypeScript support
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"typescript"|"@types/|"\\.d\\.ts"|"tsconfig"'

  # Has build script
  - id: has-build-script
    description: Package has build script (compiled package)
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"build":\\s*"[^"]*(?:tsc|rollup|webpack|esbuild|babel|vite)'

  # Has lint script
  - id: has-lint-script
    description: Package has linting configured
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"lint":\\s*"|"eslint"|"prettier"|"biome"'

  # Has prepublishOnly (good practice)
  - id: has-prepublish-only
    description: Package has prepublishOnly script (publish safety)
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      exact: '"prepublishOnly":'

  # Has repository field
  - id: has-repository
    description: Package has repository URL
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"repository":\\s*\\{|"repository":\\s*"'

  # Has proper author with email
  - id: has-author-email
    description: Package has author with email address
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"author":\\s*"[^"]*@[^"]*"|"email":\\s*"[^"]*@'

  # Has license field
  - id: has-license
    description: Package has license field
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"license":\\s*"(?:MIT|ISC|Apache|BSD|GPL|LGPL|MPL|Unlicense)'

  # Has keywords
  - id: has-keywords
    description: Package has keywords array
    crit: inert
    confidence: 0.75
    file_types: [packagejson]
    condition:
      type: string
      regex: '"keywords":\\s*\\['

  # Has engines field
  - id: has-engines
    description: Package specifies Node.js engine version
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"engines":\\s*\\{[^}]*"node"'

  # Has exports field (modern ESM)
  - id: has-exports-field
    description: Package has modern exports field
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"exports":\\s*\\{'

  # Has peerDependencies (library pattern)
  - id: has-peer-deps
    description: Package has peerDependencies (framework plugin pattern)
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      exact: '"peerDependencies":'

  # Has devDependencies (development tooling)
  - id: has-dev-deps
    description: Package has devDependencies
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      exact: '"devDependencies":'

  # Uses established test framework
  - id: uses-test-framework
    description: Package uses established testing framework
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '"jest"|"mocha"|"ava"|"vitest"|"@testing-library|"chai"|"sinon"|"tap"'

  # Has files field (explicit inclusion)
  - id: has-files-field
    description: Package explicitly lists published files
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"files":\\s*\\['

  # Mature version (not 0.0.1 or 1.0.0)
  - id: mature-version
    description: Package has mature version number
    crit: inert
    confidence: 0.7
    file_types: [packagejson]
    condition:
      type: string
      regex: '"version":\\s*"[1-9]\\.[1-9]|"version":\\s*"[0-9]+\\.[1-9]+\\.[1-9]'

  # Has meaningful description (> 20 chars)
  - id: has-description
    description: Package has meaningful description
    crit: inert
    confidence: 0.75
    file_types: [packagejson]
    condition:
      type: string
      regex: '"description":\\s*"[^"]{20,}"'

  # Has bin field (CLI tool)
  - id: has-bin-field
    description: Package provides CLI binary
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"bin":\\s*\\{|"bin":\\s*"'

  # Has funding field
  - id: has-funding
    description: Package has funding information
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      exact: '"funding":'

  # Has bugs/issues URL
  - id: has-bugs-url
    description: Package has bugs/issues URL
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"bugs":\\s*\\{|"bugs":\\s*"http'

  # Has homepage
  - id: has-homepage
    description: Package has homepage URL
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"homepage":\\s*"https?://'

  # Has contributors
  - id: has-contributors
    description: Package has contributors list
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      exact: '"contributors":'

  # Has workspaces (monorepo)
  - id: has-workspaces
    description: Package uses workspaces (monorepo pattern)
    crit: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      exact: '"workspaces":'

  # Has private field
  - id: is-private
    description: Package marked as private
    crit: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      exact: '"private": true'

  # Uses semantic versioning dependencies
  - id: semver-deps
    description: Uses semantic versioning for dependencies
    crit: inert
    confidence: 0.75
    file_types: [packagejson]
    condition:
      type: string
      regex: '"dependencies":\\s*\\{[^}]*"\\^[0-9]|"~[0-9]'

  # Has publishConfig
  - id: has-publish-config
    description: Has publish configuration
    crit: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      exact: '"publishConfig":'
# Test File Context Markers
# These patterns indicate code is in a test context
# Helps reduce false positives from test fixtures

  # Jest test file markers (atomic traits)
  - id: describe-call
    desc: describe() function call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "describe("

  - id: it-call
    desc: it() function call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "it("

  - id: test-call
    desc: test() function call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "test("

  - id: jest-word
    desc: jest keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "jest"

  - id: jest-mock-call
    desc: jest.mock call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "jest.mock"

  - id: before-each-call
    desc: beforeEach hook
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "beforeEach"

  - id: after-each-call
    desc: afterEach hook
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "afterEach"

  # Mocha test file markers (atomic traits)
  - id: before-call
    desc: before() hook
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "before("

  - id: after-call
    desc: after() hook
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "after("

  - id: chai-word
    desc: chai keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "chai"

  - id: assert-word
    desc: assert keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "assert"

  - id: should-word
    desc: should keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "should"

  # Vitest test file
  - id: vitest-test-file
    description: Vitest test file markers
    crit: inert
    confidence: 0.95
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: "from ['\"]vitest['\"]|import.{0,50}vitest|vi\\.mock|vi\\.fn"

  # Test file naming patterns
  - id: dot-test-filename
    desc: .test. in filename
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: ".test."

  - id: dot-spec-filename
    desc: .spec. in filename
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: ".spec."

  - id: underscore-test-filename
    desc: _test. in filename
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "_test."

  - id: underscore-spec-filename
    desc: _spec. in filename
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "_spec."

  - id: tests-directory
    desc: /__tests__/ directory
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "/__tests__/"

  - id: mocks-directory
    desc: /__mocks__/ directory
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "/__mocks__/"

  # Test fixture/mock data markers
  - id: fixtures-word
    desc: fixtures keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "fixtures"

  - id: testdata-word
    desc: testdata keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "testdata"

  - id: mock-data-ref
    desc: mockData reference
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "mockData"

  - id: mocks-ref
    desc: __mocks__ reference
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "__mocks__"

  - id: jest-fn-call
    desc: jest.fn() mock function
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "jest.fn()"

  - id: sinon-stub-call
    desc: sinon.stub call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "sinon.stub"

  - id: faker-word
    desc: faker keyword
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "faker"

  # Snapshot testing
  - id: snapshot-test
    description: Snapshot testing patterns
    crit: inert
    confidence: 0.95
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: 'toMatchSnapshot|toMatchInlineSnapshot|\.snap'

  # E2E test framework imports
  - id: cypress-require
    desc: require('cypress')
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('cypress')"

  - id: cypress-import
    desc: from 'cypress'
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'cypress'"

  - id: cypress-cy-command
    desc: cy. Cypress command
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "cy."

  - id: playwright-require
    desc: require('playwright')
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('playwright')"

  - id: playwright-import
    desc: from 'playwright'
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'playwright'"

  - id: playwright-scoped-import
    desc: from '@playwright
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from '@playwright"

  - id: puppeteer-require
    desc: require('puppeteer')
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('puppeteer')"

  - id: puppeteer-import
    desc: from 'puppeteer'
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'puppeteer'"

  - id: selenium-require
    desc: require('selenium import
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('selenium"

  - id: selenium-import
    desc: from 'selenium import
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'selenium"

  - id: webdriver-require
    desc: require('webdriver import
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('webdriver"

  - id: webdriver-import
    desc: from 'webdriver import
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'webdriver"

  - id: nightwatch-require
    desc: require('nightwatch')
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('nightwatch')"

  - id: nightwatch-import
    desc: from 'nightwatch'
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from 'nightwatch'"

  # Testing Library import patterns
  - id: testing-library-import
    desc: "@testing-library import"
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "@testing-library"

  - id: testing-library-from
    desc: from '@testing-library
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "from '@testing-library"

  - id: testing-library-require
    desc: require('@testing-library
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "require('@testing-library"

  # Testing Library method patterns
  - id: screen-get-by
    desc: screen.getBy query
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "screen.getBy"

  - id: screen-find-by
    desc: screen.findBy query
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "screen.findBy"

  - id: screen-query-by
    desc: screen.queryBy query
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "screen.queryBy"

  - id: screen-get-all-by
    desc: screen.getAllBy query
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "screen.getAllBy"

  - id: fire-event-method
    desc: fireEvent. method
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "fireEvent."

  - id: user-event-method
    desc: userEvent. method
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "userEvent."

  - id: render-call-test
    desc: render() call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "render("

  - id: wait-for-call
    desc: waitFor() call
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "waitFor("

  # Test configuration file markers
  - id: jest-config-ref
    desc: jest.config reference
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "jest.config"

  - id: jest-setup-files
    desc: setupFilesAfterEnv Jest option
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "setupFilesAfterEnv"

  - id: jest-test-environment
    desc: testEnvironment Jest option
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "testEnvironment"

  - id: mocharc-ref
    desc: mocharc config file
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      word: "mocharc"

  - id: karma-conf-ref
    desc: karma.conf config file
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "karma.conf"

  - id: vitest-config-ref
    desc: vitest.config reference
    crit: inert
    conf: 0.6
    for: [javascript, typescript]
    if:
      type: string
      exact: "vitest.config"

  # Coverage markers
  - id: coverage-markers
    description: Code coverage markers
    crit: inert
    confidence: 0.9
    file_types: [javascript, typescript]
    condition:
      type: string
      regex: 'istanbul|nyc|c8|coverage|__coverage__|lcov'


# === COMPOSITE RULES ===
composite_rules:
  # Terser/UglifyJS minified output
  - id: terser-minifier-helpers
    description: Minifier helper patterns
    for: [javascript]
    any:
      - {id: void-zero}
      - {id: esmodule-export}
      - {id: object-define-property}

  - id: terser-output
    description: Terser/UglifyJS minified output markers
    crit: inert
    conf: 0.85
    for: [javascript]
    all:
      - {id: use-strict-quote}
      - {id: terser-minifier-helpers}

  # Test block patterns
  - id: test-block-functions
    description: Test block functions (describe/it/test)
    for: [javascript, typescript]
    any:
      - {id: describe-with-string}
      - {id: it-with-string}
      - {id: test-with-string}

  - id: test-assertions
    description: Test assertion patterns
    for: [javascript, typescript]
    any:
      - {id: expect-call}
      - {id: assert-method}
      - {id: should-assertion}

  - id: has-test-blocks
    description: Code contains test definitions
    crit: inert
    conf: 0.95
    for: [javascript, typescript]
    all:
      - {id: test-block-functions}
      - {id: test-assertions}

  # Multiple exports
  - id: has-multiple-exports
    description: Code has multiple named exports
    crit: inert
    conf: 0.85
    for: [javascript, typescript]
    any:
      - {id: esm-export-statement}
      - {id: cjs-exports-assignment}
      - {id: module-exports-object}

  # Multiple entry points
  - id: has-multiple-entries
    description: Package has multiple entry points (complex library)
    crit: inert
    conf: 0.85
    for: [packagejson]
    count: 2
    any:
      - {id: pkg-main-field}
      - {id: pkg-module-field}
      - {id: pkg-exports-field-entry}
      - {id: pkg-types-field}

  # Development workflow scripts
  - id: has-dev-workflow
    description: Package has development workflow scripts
    crit: inert
    conf: 0.85
    for: [packagejson]
    count: 3
    any:
      - {id: pkg-test-script-field}
      - {id: pkg-build-script-field}
      - {id: pkg-lint-script-field}
      - {id: pkg-format-script-field}
      - {id: pkg-dev-script-field}
      - {id: pkg-start-script-field}

  # Jest test file
  - id: jest-test-blocks
    description: Jest test blocks
    for: [javascript, typescript]
    any:
      - {id: describe-call}
      - {id: test-call}
      - {id: it-call}

  - id: jest-assertions-or-hooks
    description: Jest assertions or lifecycle hooks
    for: [javascript, typescript]
    any:
      - {id: expect-call}
      - {id: jest-word}
      - {id: jest-mock-call}
      - {id: before-each-call}
      - {id: after-each-call}

  - id: jest-test-file
    description: Jest test file markers
    crit: inert
    conf: 0.95
    for: [javascript, typescript]
    all:
      - {id: jest-test-blocks}
      - {id: jest-assertions-or-hooks}

  # Mocha test file
  - id: mocha-test-blocks
    description: Mocha test blocks
    for: [javascript, typescript]
    all:
      - {id: describe-call}
      - {id: it-call}

  - id: mocha-assertions-or-hooks
    description: Mocha assertions or hooks
    for: [javascript, typescript]
    any:
      - {id: chai-word}
      - {id: assert-word}
      - {id: should-word}
      - {id: before-call}
      - {id: after-call}

  - id: mocha-test-file
    description: Mocha test file markers
    crit: inert
    conf: 0.95
    for: [javascript, typescript]
    all:
      - {id: mocha-test-blocks}
      - {id: mocha-assertions-or-hooks}

  # Test filename pattern
  - id: test-filename-pattern
    description: File follows test naming convention
    crit: inert
    conf: 0.9
    for: [javascript, typescript]
    any:
      - {id: dot-test-filename}
      - {id: dot-spec-filename}
      - {id: underscore-test-filename}
      - {id: underscore-spec-filename}
      - {id: tests-directory}
      - {id: mocks-directory}

  # Test fixtures
  - id: test-fixtures
    description: Test fixture or mock data markers
    crit: inert
    conf: 0.9
    for: [javascript, typescript]
    any:
      - {id: fixtures-word}
      - {id: testdata-word}
      - {id: mock-data-ref}
      - {id: mocks-ref}
      - {id: jest-fn-call}
      - {id: sinon-stub-call}
      - {id: faker-word}

  # E2E test frameworks
  - id: e2e-test
    description: E2E test framework markers
    crit: inert
    conf: 0.9
    for: [javascript, typescript]
    any:
      - {id: cypress-require}
      - {id: cypress-import}
      - {id: cypress-cy-command}
      - {id: playwright-require}
      - {id: playwright-import}
      - {id: playwright-scoped-import}
      - {id: puppeteer-require}
      - {id: puppeteer-import}
      - {id: selenium-require}
      - {id: selenium-import}
      - {id: webdriver-require}
      - {id: webdriver-import}
      - {id: nightwatch-require}
      - {id: nightwatch-import}

  # Testing Library
  - id: testing-library-imports
    description: Testing Library import patterns
    for: [javascript, typescript]
    any:
      - {id: testing-library-import}
      - {id: testing-library-from}
      - {id: testing-library-require}

  - id: testing-library-methods
    description: Testing Library methods
    for: [javascript, typescript]
    count: 2
    any:
      - {id: screen-get-by}
      - {id: screen-find-by}
      - {id: screen-query-by}
      - {id: screen-get-all-by}
      - {id: fire-event-method}
      - {id: user-event-method}
      - {id: render-call-test}
      - {id: wait-for-call}

  - id: testing-library
    description: Testing Library patterns
    crit: inert
    conf: 0.95
    for: [javascript, typescript]
    any:
      - {id: testing-library-imports}
      - {id: testing-library-methods}

  # Test configuration files
  - id: test-config
    description: Test configuration file
    crit: inert
    conf: 0.95
    for: [javascript, typescript]
    any:
      - {id: jest-config-ref}
      - {id: jest-setup-files}
      - {id: jest-test-environment}
      - {id: mocharc-ref}
      - {id: karma-conf-ref}
      - {id: vitest-config-ref}
