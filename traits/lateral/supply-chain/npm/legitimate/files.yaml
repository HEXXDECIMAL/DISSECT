# Legitimate Package File Presence Indicators
# These patterns detect file references that indicate professional package structure
# Useful for differential ML analysis

traits:
  # References README file
  - id: legitimate/references-readme
    description: Package references README file
    criticality: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"readme":|README\\.md|readme\\.md'

  # References LICENSE file
  - id: legitimate/references-license
    description: Package references LICENSE file
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: 'LICENSE|license|LICENCE|licence|COPYING'

  # References CHANGELOG
  - id: legitimate/references-changelog
    description: Package references CHANGELOG
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: 'CHANGELOG|changelog|HISTORY|history|CHANGES'

  # Has dist/lib output directory
  - id: legitimate/has-build-output
    description: Package has build output directory
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"main":\\s*"(?:dist/|lib/|build/|out/)'

  # Has src directory structure
  - id: legitimate/has-src-directory
    description: Package has src directory structure
    criticality: inert
    confidence: 0.8
    file_types: [packagejson]
    condition:
      type: string
      regex: '"[^"]*src/|"files":[^]]*"src"'

  # Has test directory
  - id: legitimate/has-test-directory
    description: Package references test directory
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"test"|"tests"|"__tests__"|"spec"|"__mocks__"'

  # Has examples directory
  - id: legitimate/has-examples
    description: Package has examples directory
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"examples"|"example"|"demo"|"demos"'

  # Has docs directory
  - id: legitimate/has-docs
    description: Package has documentation directory
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '"docs"|"documentation"|"doc"'

  # Has .github directory (CI/CD)
  - id: legitimate/has-github-config
    description: Package references GitHub configuration
    criticality: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.github|workflows|CONTRIBUTING|CODE_OF_CONDUCT|SECURITY\\.md'

  # Has TypeScript config
  - id: legitimate/has-tsconfig
    description: Package has TypeScript configuration
    criticality: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: 'tsconfig\\.json|tsconfig\\.build\\.json'

  # Has ESLint config
  - id: legitimate/has-eslint-config
    description: Package has ESLint configuration
    criticality: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.eslintrc|eslint\\.config|"eslintConfig":'

  # Has Prettier config
  - id: legitimate/has-prettier-config
    description: Package has Prettier configuration
    criticality: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.prettierrc|prettier\\.config|"prettier":'

  # Has Jest config
  - id: legitimate/has-jest-config
    description: Package has Jest configuration
    criticality: inert
    confidence: 0.9
    file_types: [packagejson]
    condition:
      type: string
      regex: 'jest\\.config|"jest":\\s*\\{'

  # Has Babel config
  - id: legitimate/has-babel-config
    description: Package has Babel configuration
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.babelrc|babel\\.config|"babel":'

  # Has editor config
  - id: legitimate/has-editorconfig
    description: Package has editor configuration
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.editorconfig'

  # Has .npmignore or files field (publishing awareness)
  - id: legitimate/has-publish-config
    description: Package has publishing configuration
    criticality: inert
    confidence: 0.85
    file_types: [packagejson]
    condition:
      type: string
      regex: '\\.npmignore|"files":\\s*\\['

