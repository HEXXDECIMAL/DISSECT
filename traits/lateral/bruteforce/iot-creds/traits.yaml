# IoT Default Credential Detection
# Common default credentials used in IoT botnets (Mirai, etc.)
# ATT&CK: T1110.001 (Brute Force: Password Guessing)

traits:
  # Mirai default credentials
  - id: lateral/bruteforce/mirai-creds
    description: Mirai botnet default credential list
    criticality: hostile
    confidence: 0.95
    attack: "T1110.001"
    condition:
      type: yara
      source: |
        rule mirai_creds {
          strings:
            $cred1 = "7ujMko0admin" ascii
            $cred2 = "7ujMko0vizxv" ascii
            $cred3 = "admin1234" ascii
            $cred4 = "juantech" ascii
            $cred5 = "xc3511" ascii
            $cred6 = "jvbzd" ascii
            $cred7 = "anko" ascii
            $cred8 = "smcadmin" ascii
            $cred9 = "GM8182" ascii
            $cred10 = "oelinux123" ascii
            $cred11 = "hi3518" ascii
          condition:
            3 of them
        }

  # Dahua/Hikvision camera credentials
  - id: lateral/bruteforce/camera-creds
    description: IP camera default credentials
    criticality: suspicious
    confidence: 0.9
    attack: "T1110.001"
    condition:
      type: yara
      source: |
        rule camera_creds {
          strings:
            $dahua1 = "vizxv" ascii
            $dahua2 = "7ujMko0" ascii
            $xmhdipc = "xmhdipc" ascii
          condition:
            any of them
        }

  # Router default credentials
  - id: lateral/bruteforce/router-creds
    description: Router default credentials
    criticality: suspicious
    confidence: 0.85
    attack: "T1110.001"
    condition:
      type: yara
      source: |
        rule router_creds {
          strings:
            $zte1 = "Zte521" ascii
            $zte2 = "Pon521" ascii
            $huawei = "telecomadmin" ascii
            $ubnt = "ubnt" ascii
          condition:
            any of them
        }

  # Telnet bruteforce patterns
  - id: lateral/bruteforce/telnet-attack
    description: Telnet bruteforce attack patterns
    criticality: suspicious
    confidence: 0.85
    attack: "T1110.001"
    condition:
      type: yara
      source: |
        rule telnet_brute {
          strings:
            // Telnet connection strings
            $telnet_conn = "telnet connect" ascii nocase
            $telnet_scan = "telnet scanner" ascii nocase
            $telnet_brute = "telnet brute" ascii nocase
            // BusyBox exploitation
            $busybox_cmd = "busybox echo" ascii
            $busybox_wget = "busybox wget" ascii
            $busybox_tftp = "busybox tftp" ascii
            // IoT exploitation patterns
            $enable_cmd = "enable\nshell\nsh" ascii
            $enable_system = "system\nshell\nsh" ascii
            // Scanner output
            $scanner1 = "port 23 open" ascii nocase
            $scanner2 = "telnet_scan" ascii
          condition:
            any of ($telnet_*) or any of ($busybox_*) or
            any of ($enable_*) or any of ($scanner*)
        }
