composite_rules:
  - id: setuid
    description: Changes user identity
    confidence: 0.9
    criticality: notable
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - type: syscall
        name: ["setuid", "setuid32", "seteuid"]
      - type: syscall
        name: ["setreuid", "setreuid32"]
      - type: syscall
        name: ["setresuid", "setresuid32"]

  - id: setgid
    description: Changes group identity
    confidence: 0.9
    criticality: notable
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - type: syscall
        name: ["setgid", "setgid32", "setegid"]
      - type: syscall
        name: ["setregid", "setregid32"]
      - type: syscall
        name: ["setresgid", "setresgid32"]

  - id: capabilities
    description: Manipulates process capabilities
    confidence: 0.85
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    condition:
      type: syscall
      name: ["capset"]
