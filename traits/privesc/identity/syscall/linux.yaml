traits:
  - id: setuid-syscall
    description: Sets user ID via setuid/seteuid
    criticality: notable
    condition:
      type: syscall
      name: ["setuid", "setuid32", "seteuid"]

  - id: setreuid-syscall
    description: Sets real and effective user ID
    criticality: notable
    condition:
      type: syscall
      name: ["setreuid", "setreuid32"]

  - id: setresuid-syscall
    description: Sets real, effective, and saved user ID
    criticality: notable
    condition:
      type: syscall
      name: ["setresuid", "setresuid32"]

  - id: setgid-syscall
    description: Sets group ID via setgid/setegid
    criticality: notable
    condition:
      type: syscall
      name: ["setgid", "setgid32", "setegid"]

  - id: setregid-syscall
    description: Sets real and effective group ID
    criticality: notable
    condition:
      type: syscall
      name: ["setregid", "setregid32"]

  - id: setresgid-syscall
    description: Sets real, effective, and saved group ID
    criticality: notable
    condition:
      type: syscall
      name: ["setresgid", "setresgid32"]

  - id: capset-syscall
    description: Sets process capabilities
    criticality: suspicious
    condition:
      type: syscall
      name: ["capset"]

composite_rules:
  - id: setuid
    description: Changes user identity
    confidence: 0.9
    criticality: notable
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - id: setuid-syscall
      - id: setreuid-syscall
      - id: setresuid-syscall

  - id: setgid
    description: Changes group identity
    confidence: 0.9
    criticality: notable
    platforms: [linux]
    file_types: [elf]
    requires_any:
      - id: setgid-syscall
      - id: setregid-syscall
      - id: setresgid-syscall

  - id: capabilities
    description: Manipulates process capabilities
    confidence: 0.85
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    condition:
      id: capset-syscall
