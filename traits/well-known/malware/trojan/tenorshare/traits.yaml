traits:
- id: ts-advertise-tracking-id
  desc: TSAdvertiseTracking bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSAdvertiseTracking
- id: ts-data-analysis-id
  desc: TSDataAnalysis bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSDataAnalysis
- id: ts-baselib-id
  desc: TSBaseLib bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSBaseLib
- id: ts-feedback-id
  desc: TSFeedback bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSFeedback
- id: ts-library-id
  desc: TSLibrary bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSLibrary
- id: ts-softwareloglib-id
  desc: libSoftwareLogLib identifier
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: libSoftwareLogLib
- id: ts-registerui-id
  desc: TSRegisterUI bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.TSRegisterUI
- id: ts-updateui-id
  desc: UpdateUI bundle ID (Tenorshare)
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.lz\.UpdateUI
- id: ts-update-domain
  desc: Tenorshare update domain
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: update\.tenorshare\.com
- id: ts-dylib-ref
  desc: Tenorshare framework reference
  crit: notable
  conf: 1.0
  for:
  - macho
  if:
    type: string
    regex: (@rpath/TSBaseLib\.framework|@rpath/TSLibrary\.framework)
- id: ts-registerlib-methods
  desc: Tenorshare RegisterLib methods
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: symbol
    regex: (launchCBSJump|writeRegInfo|removeRegisterInfo|AuthSeverManager)
- id: ts-tracking-classes
  desc: Tenorshare Tracking unique classes
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: symbol
    regex: (BuyVidFetcher|LZGALogManager|TSLoginViewController)
- id: ts-lib-c2-domains
  desc: Tenorshare library C2 domains
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: (recoverlostpassword\.com|cstr\.com|ip-api\.com)
- id: ts-lib-fingerprint-methods
  desc: Tenorshare library fingerprinting methods
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: symbol
    regex: (IOPlatformSerialNumber|IOPlatformUUID|IORegistryEntryCreateCFProperty)
- id: ts-ssziparchive-id
  desc: SSZipArchive bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: org\.cocoapods\.SSZipArchive
- id: ts-plist-build-empty-platform
  desc: Tenorshare Empty DTPlatformBuild
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>DTPlatformBuild</key>\s*<string></string>
- id: ts-plist-build-xcode
  desc: Tenorshare Build Environment (Xcode 15.4)
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>DTXcode</key>\s*<string>1540</string>
- id: ts-plist-build-os
  desc: Tenorshare Build Environment (macOS 14.5)
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>BuildMachineOSBuild</key>\s*<string>23F79</string>
- id: ts-product-names-keys
  desc: Tenorshare ProductNames configuration keys
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>package_names</key>
- id: ts-testurl-shopping-keys
  desc: Tenorshare TestURL Shopping keys
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>Shopping(Config|Icon|Version)URL</key>
- id: ts-testurl-istest
  desc: Tenorshare TestURL isTest key
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: <key>isTest</key>
- id: ts-ui-antidata-class
  desc: Tenorshare AntiData UI classes
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: AntiData(ResultView|RecoveryController)
- id: ts-ui-lzt-class
  desc: Tenorshare LZT UI class
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: LZT[A-Z][a-zA-Z0-9]+
- id: ts-ui-lzr-class
  desc: Tenorshare LZR UI class
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: LZRAlert
- id: ts-ui-w-outlets
  desc: Tenorshare W-prefixed UI outlets
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: (WmainBox|WplayBtn)
- id: ts-product-names-content
  desc: Tenorshare ProductNames configuration content
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.(tenorshare|niuxuezhang|ultfone)\.(ReiBoot|4ukey|UltFoneToolkit)
- id: ts-product-names-content-2
  desc: Tenorshare ProductNames secondary marker
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.(tenorshare|niuxuezhang|ultfone)\.iosSystemRepair
- id: ts-ui-typos
  desc: Tenorshare UI classes with typos
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: (BR(Faild|Startting)|ResotreCompleted|RestDeviceNoConnect)ViewController
- id: ts-ui-reiboot-classes
  desc: Tenorshare ReiBoot UI classes
  crit: notable
  conf: 1.0
  for:
  - all
  if:
    type: string
    regex: (TSColorButton|LZButton|Backup(?:Completed|Restore|Start)ViewController)
composite_rules:
- id: ts-advertise-tracking-suspicious
  desc: Suspicious TSAdvertiseTracking framework
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: ts-advertise-tracking-id
  - id: well-known/malware/trojan/payment2mod::payment2mod-ga-id
- id: ts-testurl-plist
  desc: Suspicious Tenorshare TestURL.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-testurl-shopping-keys
  - id: ts-testurl-istest
- id: ts-advertise-tracking-plist
  desc: Suspicious TSAdvertiseTracking Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-advertise-tracking-id
  - id: ts-plist-build-empty-platform
- id: ts-baselib-plist
  desc: Suspicious TSBaseLib Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-baselib-id
  - id: ts-plist-build-empty-platform
- id: ts-feedback-plist
  desc: Suspicious TSFeedback Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-feedback-id
  - id: ts-plist-build-empty-platform
- id: ts-library-plist
  desc: Suspicious TSLibrary Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-library-id
  - id: ts-plist-build-empty-platform
- id: ts-data-analysis-plist
  desc: Suspicious TSDataAnalysis Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-data-analysis-id
  - id: ts-plist-build-empty-platform
- id: ts-product-names-plist
  desc: Suspicious Tenorshare ProductNames.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-product-names-keys
  - id: ts-product-names-content
- id: ts-registerui-plist
  desc: Suspicious TSRegisterUI Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-registerui-id
  - id: ts-plist-build-empty-platform
- id: ts-updateui-plist
  desc: Suspicious UpdateUI Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-updateui-id
  - id: ts-plist-build-empty-platform
- id: ts-updateui-domain-plist
  desc: Suspicious UpdateUI Info.plist (Domain)
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-updateui-id
  - id: ts-update-domain
- id: ts-updateui-binary
  desc: Suspicious UpdateUI binary
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: metadata/signed/id::com.lz.UpdateUI
  - id: ts-dylib-ref
- id: ts-ssziparchive-suspicious
  desc: Suspicious SSZipArchive (Tenorshare Build)
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ssziparchive-id
  - id: ts-plist-build-empty-platform
  - id: ts-plist-build-xcode
  - id: ts-plist-build-os
- id: ts-data-analysis-suspicious
  desc: Suspicious TSDataAnalysis framework
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: ts-data-analysis-id
  - id: well-known/malware/trojan/payment2mod::payment2mod-ga-id
- id: ts-baselib-suspicious
  desc: Suspicious TSBaseLib framework with hardware fingerprinting
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: ts-baselib-id
  - id: ts-lib-fingerprint-methods
- id: ts-baselib-signed-suspicious
  desc: Suspicious TSBaseLib framework (Signed) with hardware fingerprinting
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: metadata/signed/id::com.tenorshare.TSBaseLib
  - id: ts-lib-fingerprint-methods
- id: ts-softwareloglib-suspicious
  desc: Suspicious libSoftwareLogLib with C2 and command execution
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: ts-softwareloglib-id
  - id: ts-lib-c2-domains
- id: ts-feedback-binary
  desc: Suspicious TSFeedback binary using SoftwareLogLib
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: ts-feedback-id
  - id: ts-softwareloglib-id
- id: ts-feedback-binary-signed
  desc: Suspicious TSFeedback binary using SoftwareLogLib (Signed)
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: metadata/signed/id::com.tenorshare.TSFeedback
  - id: ts-softwareloglib-id
- id: ts-registerui-binary
  desc: Suspicious TSRegisterUI binary
  crit: suspicious
  conf: 1.0
  for:
  - macho
  all:
  - id: metadata/signed/id::com.tenorshare.TSRegisterUI
  - id: ts-registerlib-methods
- id: ts-ui-antidata-nib
  desc: Suspicious AntiDataResultView Nib
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-antidata-class
  - id: metadata/format/magic::bplist
- id: ts-ui-lzt-nib
  desc: Suspicious LZT UI Nib
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-lzt-class
  - id: metadata/format/magic::bplist
- id: ts-ui-reiboot-nib
  desc: Suspicious ReiBoot UI Nib
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-reiboot-classes
  - id: metadata/format/magic::bplist
- id: ts-ui-w-outlets-nib
  desc: Suspicious Tenorshare W-outlets Nib
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-w-outlets
  - id: metadata/format/magic::bplist
- id: ts-ui-reiboot-nib-archive
  desc: Suspicious ReiBoot UI Nib (NIBArchive)
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-reiboot-classes
  - id: metadata/format/magic::nib-archive
- id: ts-ui-w-outlets-nib-archive
  desc: Suspicious Tenorshare W-outlets Nib (NIBArchive)
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-w-outlets
  - id: metadata/format/magic::nib-archive
- id: ts-ui-typos-nib
  desc: Suspicious Tenorshare Typos Nib
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-typos
  - id: metadata/format/magic::bplist
- id: ts-ui-typos-nib-archive
  desc: Suspicious Tenorshare Typos Nib (NIBArchive)
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: ts-ui-typos
  - id: metadata/format/magic::nib-archive
