traits:
- id: screenconnect-clientservice-dll
  desc: ScreenConnect ClientService
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.ClientService
  attack: T1219
  mbc: C0048
- id: screenconnect-client-dll
  desc: ScreenConnect Client DLL
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.Client.dll
  attack: T1219
  mbc: C0048
- id: screenconnect-core-dll
  desc: ScreenConnect Core DLL
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.Core
  attack: T1219
  mbc: C0048
- id: screenconnect-windows-dll
  desc: ScreenConnect Windows DLL
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.Windows
  attack: T1219
  mbc: C0048
- id: screenconnect-client-exe
  desc: ScreenConnect Client exe
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    regex: (ScreenConnect\.WindowsClient|ScreenConnect\.ClientService)
  attack: T1219
  mbc: C0048
- id: screenconnect-backstage-shell
  desc: ScreenConnect BackstageShell
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.WindowsBackstageShell
  attack: T1219
  mbc: C0048
- id: screenconnect-file-manager
  desc: ScreenConnect FileManager
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.WindowsFileManager
  attack: T1219
  mbc: C0048
- id: screenconnect-auth-package
  desc: ScreenConnect Auth Package
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.WindowsAuthenticationPackage
  attack: T1219
  mbc: C0048
- id: screenconnect-credential-provider
  desc: ScreenConnect Credential Provider
  crit: notable
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: ScreenConnect.WindowsCredentialProvider
  attack: T1219
  mbc: C0048
- id: connectwisecontrol-client-marker
  desc: ConnectWiseControl client ref
  crit: notable
  conf: 0.9
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: connectwisecontrol
  attack: T1219
  mbc: C0048
- id: connectvpn-c2-domain
  desc: ConnectVPN C2 domain
  crit: notable
  conf: 0.9
  platforms:
  - windows
  for:
  - pe
  if:
    type: string
    substr: connectvpn.ru
  attack: T1219
  mbc: C0002
composite_rules:
- id: screenconnect-component-detected
  desc: ScreenConnect component
  crit: suspicious
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  attack: T1219
  mbc: C0048
  needs: 3
  any:
  - id: screenconnect-clientservice-dll
  - id: screenconnect-client-dll
  - id: screenconnect-core-dll
  - id: screenconnect-windows-dll
  - id: screenconnect-client-exe
  - id: screenconnect-backstage-shell
  - id: screenconnect-file-manager
  - id: screenconnect-auth-package
  - id: screenconnect-credential-provider
- id: screenconnect-service-persistence
  desc: ScreenConnect service
  crit: hostile
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  attack: T1219
  mbc: C0048
  all:
  - id: screenconnect-component-detected
  - id: objectives/persistence/startup/service::service-startup
- id: screenconnect-family
  desc: ScreenConnect RAT malware
  crit: suspicious
  conf: 0.95
  platforms:
  - windows
  for:
  - pe
  attack: T1219
  mbc: C0048
  needs: 2
  any:
  - id: screenconnect-component-detected
  - id: connectwisecontrol-client-marker
  - id: connectvpn-c2-domain
