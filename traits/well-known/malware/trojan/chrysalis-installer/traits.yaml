# Known Malware: Chrysalis Installer (update.exe)
# Nullsoft NSIS installer self-extracting archive
# Deploys Chrysalis malware family components

defaults:
  for: [all]

traits:
  # === NSIS Installer Signature ===
  - id: nullsoft-installer
    desc: Nullsoft NSIS installer signature
    crit: inert
    conf: 0.95
    if:
      type: string
      substr: "Nullsoft.NSIS.exehead"

  - id: nsis-version
    desc: NSIS installer version info
    crit: inert
    conf: 0.90
    if:
      type: string
      substr: "Nullsoft Install System"

  - id: nsis-manifest
    desc: NSIS installer manifest
    crit: inert
    conf: 0.85
    if:
      type: string
      substr: "manifestVersion"

  # === 7z Compression ===
  - id: 7z-archive
    desc: 7z compression library reference
    crit: inert
    conf: 0.80
    if:
      type: string
      regex: "7z[xX]"

  # === GUI Components ===
  # Removed dialog-resources duplicate - use micro-traits/ui/dialog/prompt::dialog-box-param
  # Removed installer-gui duplicate - use micro-traits/ui/dialog/prompt::create-dialog-param

  # === Installer Specific ===
  - id: installer-type
    desc: Self-extracting installer executable
    crit: notable
    conf: 0.90
    if:
      type: string
      substr: "SelfExtracting"
