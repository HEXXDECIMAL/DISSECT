defaults:
  for:
  - all
traits:
- id: backstabbers-magic-constants__any_1
  desc: Helper raw condition
  if:
    type: raw
    regex: \b108363\b
- id: backstabbers-magic-constants__any_2
  desc: Helper raw condition
  if:
    type: raw
    regex: \b286625773\b
- id: backstabbers-magic-constants__any_3
  desc: Helper raw condition
  if:
    type: raw
    regex: \b12768\b
- id: backstabbers-magic-constants__any_4
  desc: Helper raw condition
  if:
    type: raw
    regex: \b183269\b
- id: backstabbers-magic-constants__any_5
  desc: Helper raw condition
  if:
    type: raw
    regex: \b362814\b
- id: backstabbers-magic-constants__any_6
  desc: Helper raw condition
  if:
    type: raw
    regex: \b790593\b
- id: backstabbers-magic-constants__any_7
  desc: Helper raw condition
  if:
    type: raw
    regex: \b86892\b
- id: backstabbers-magic-constants__any_8
  desc: Helper raw condition
  if:
    type: raw
    regex: \b61499\b
- id: backstabbers-magic-constants__any_9
  desc: Helper raw condition
  if:
    type: raw
    regex: \b9653\b
- id: backstabbers-magic-constants__any_10
  desc: Helper raw condition
  if:
    type: raw
    regex: \b60921\b
- id: backstabbers-magic-constants__any_11
  desc: Helper raw condition
  if:
    type: raw
    regex: \b12258\b
- id: backstabbers-magic-constants__any_12
  desc: Helper raw condition
  if:
    type: raw
    regex: \b145239\b
- id: backstabbers-magic-constants__any_13
  desc: Helper raw condition
  if:
    type: raw
    regex: \b8473\b
- id: backstabbers-magic-constants__any_14
  desc: Helper raw condition
  if:
    type: raw
    regex: \b18005\b
- id: backstabbers-magic-constants__any_15
  desc: Helper raw condition
  if:
    type: raw
    regex: \b37668\b
- id: backstabbers-magic-constants__unless_1
  desc: Helper raw condition
  if:
    type: raw
    regex: \{ ".*", \{ NULL \}, \d+, ".*" \}
composite_rules:
- id: backstabbers-magic-constants
  desc: Backstabbers obfuscation state machine constants
  mbc: E1014
  attack: T1027
  crit: suspicious
  conf: 1.0
  unless:
  - id: backstabbers-magic-constants__unless_1
  any:
  - id: backstabbers-magic-constants__any_1
  - id: backstabbers-magic-constants__any_2
  - id: backstabbers-magic-constants__any_3
  - id: backstabbers-magic-constants__any_4
  - id: backstabbers-magic-constants__any_5
  - id: backstabbers-magic-constants__any_6
  - id: backstabbers-magic-constants__any_7
  - id: backstabbers-magic-constants__any_8
  - id: backstabbers-magic-constants__any_9
  - id: backstabbers-magic-constants__any_10
  - id: backstabbers-magic-constants__any_11
  - id: backstabbers-magic-constants__any_12
  - id: backstabbers-magic-constants__any_13
  - id: backstabbers-magic-constants__any_14
  - id: backstabbers-magic-constants__any_15
