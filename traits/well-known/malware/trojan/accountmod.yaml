traits:
- id: accountmod-ui-actions
  desc: AccountMod Trojan UI action selectors
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: (buyAgainBtn|buyBtnOnClick:)
- id: accountmod-ui-typo
  desc: AccountMod Trojan UI class typo
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: AMAC_SignleLabelCellView
- id: accountmod-ui-lzt-component
  desc: AccountMod Trojan UI LZT component
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: (LZTDialogWindow|LZTButton)
- id: accountmod-ui-asset
  desc: AccountMod Trojan UI asset
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: Yassflower
- id: accountmod-string
  desc: AccountMod Trojan unique string
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: ACCOUNTMOD_[A-Za-z]+
- id: accountmod-bundle-id-raw
  desc: AccountMod Trojan bundle ID (Raw)
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: com\.tenorshare\.AccountMod
- id: accountmod-name
  desc: AccountMod Trojan name
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: string
    word: AccountMod
- id: accountmod-binary-symbols
  desc: AccountMod Trojan binary symbols
  crit: suspicious
  conf: 1.0
  for:
  - macho
  if:
    type: symbol
    regex: (AM_ProductInfoItem|AMAC_ProductPermissionsViewController)
- id: accountmod-ui-pasteboard-type
  desc: AccountMod Trojan UI pasteboard type
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: dyn\.ah62d4rv4gu8yc6durvwwa3xmrvw1gkdusm1044pxqyuha2pxsvw0e55bsmwca7d3sbwu
- id: accountmod-ui-class
  desc: AccountMod Trojan UI class name
  crit: suspicious
  conf: 1.0
  for:
  - all
  if:
    type: raw
    regex: (AMAC_(BuyAgainCellView|HistoricalOrdersViewController|SignleLabelCellView|ProductPermissions|UserInfoViewController)|AM_AccountCenter(View|Window)Controller)
composite_rules:
- id: accountmod-bundle-id
  desc: AccountMod Trojan bundle ID
  crit: notable
  conf: 1.0
  for:
  - all
  any:
  - id: accountmod-bundle-id-raw
  - id: metadata/signed/id::com.tenorshare.AccountMod
- id: accountmod-ui-nib-pasteboard
  desc: AccountMod Trojan UI NIB file (Pasteboard)
  crit: hostile
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-ui-pasteboard-type
  - id: metadata/format/magic::bplist
- id: accountmod-ui-nib
  desc: AccountMod Trojan UI NIB file
  crit: hostile
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-ui-class
  - id: accountmod-ui-actions
- id: accountmod-ui-nib-variant
  desc: AccountMod Trojan UI NIB file (Variant)
  crit: hostile
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-ui-class
  - id: accountmod-string
- id: accountmod-ui-nib-lzt
  desc: AccountMod Trojan UI NIB file (LZT)
  crit: hostile
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-ui-class
  - id: accountmod-ui-lzt-component
- id: accountmod-ui-nib-lzt-asset
  desc: AccountMod Trojan UI NIB file (LZT Asset)
  crit: hostile
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-ui-lzt-component
  - id: accountmod-ui-asset
- id: accountmod-plist-config
  desc: AccountMod Trojan Info.plist
  crit: suspicious
  conf: 1.0
  for:
  - all
  all:
  - id: accountmod-bundle-id
  - id: accountmod-name
- id: accountmod-binary
  desc: AccountMod Trojan binary
  crit: hostile
  conf: 1.0
  for:
  - macho
  all:
  - id: accountmod-bundle-id
  - id: accountmod-binary-symbols
