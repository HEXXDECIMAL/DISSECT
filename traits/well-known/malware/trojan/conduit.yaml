defaults:
  for: [all]

traits:
  - id: bundle_id
    desc: Conduit bundle identifier
    if:
      type: kv
      path: "CFBundleIdentifier"
      substr: "com.conduit."

  - id: plugin_name
    desc: Conduit plugin name
    if:
      type: kv
      path: "WebPluginName"
      substr: "Conduit Plugin"

  - id: mimetype
    desc: Conduit Safari plugin MIME type
    if:
      type: raw
      substr: "application/conduit-safari-plugin"

composite_rules:
  - id: info_plist
    desc: Conduit/Trovi/VSearch adware configuration
    crit: hostile
    conf: 1.0
    all:
      - id: bundle_id
      - id: plugin_name
      - id: mimetype
