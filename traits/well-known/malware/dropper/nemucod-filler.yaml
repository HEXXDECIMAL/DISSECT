# Nemucod JScript Dropper (Filler Variant)
# Detects the Nemucod family variants that use filler character obfuscation

composite_rules:
  - id: nemucod-filler-dropper
    desc: "Nemucod JScript dropper (filler variant) detected"
    crit: hostile
    conf: 1.0
    attack: "T1027"
    mbc: "B0032"
    for: [javascript]
    all:
      - id: micro-behaviors/data/encode/skip-step::js-skip-step-loop
      - id: micro-behaviors/data/encode/skip-step::js-loop-string-concat
    any:
      - id: objectives/anti-static/obfuscation/source/string::js-interleaved-junk-chars
      - id: objectives/anti-static/obfuscation/source/string::js-interleaved-lowercase-junk
      - id: micro-behaviors/host/interpreter/jscript::activex-object