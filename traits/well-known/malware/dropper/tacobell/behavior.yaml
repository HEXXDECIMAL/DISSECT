composite_rules:
  - id: tacobell-dropper-behavior
    desc: TacoBell dropper behavior (class + rename image to exe + exec)
    crit: hostile
    conf: 1.0
    all:
      - id: well-known/malware/dropper/tacobell::tacobell-class
      - id: objectives/execution/dropper/script::ruby-ast-rename-img-to-exe
      - id: micro-traits/process/create/shell/lang::ruby-exec

  - id: tacobell-dropper-hostile
    desc: Detects the 'TacoBell' dropper found in malicious gems (Updated)
    crit: hostile
    conf: 1.0
    any:
      - id: well-known/malware/dropper/tacobell::tacobell-class
      - id: well-known/malware/dropper/tacobell::tacobell-class-ast
      - id: well-known/malware/dropper/tacobell::tacobell-domain
      - id: well-known/malware/dropper/tacobell::tacobell-iplogger-fragmented
      - id: well-known/malware/dropper/tacobell::tacobell-class-smectis
      - id: well-known/malware/dropper/tacobell::tacobell-resolv-b64-domain
      - id: well-known/malware/dropper/tacobell::tacobell-payload-path-mimming
      - id: well-known/malware/dropper/tacobell::tacobell-autosymbiontic-path
      - id: well-known/malware/dropper/tacobell::tacobell-domains
      - id: well-known/malware/dropper/tacobell::tacobell-obfuscated-url-vars