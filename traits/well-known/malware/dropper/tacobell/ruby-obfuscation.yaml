traits:
  - id: tacobell-obfuscated-url-vars
    desc: Specific URL fragmentation variables (d="https:/", e=".")
    crit: suspicious
    conf: 0.95
    for: [ruby]
    if:
      type: ast
      query: |
        (assignment
          left: (identifier) @var
          right: (string (string_content) @val)
          (#match? @val "^https?:/$")
        )

  - id: tacobell-obfuscated-dot-var
    desc: Specific dot variable assignment (e=".")
    crit: notable
    conf: 0.8
    for: [ruby]
    if:
      type: ast
      query: |
        (assignment
          left: (identifier) @var
          right: (string (string_content) @val)
          (#eq? @val ".")
        )
