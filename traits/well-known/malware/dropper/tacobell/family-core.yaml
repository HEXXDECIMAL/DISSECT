defaults:
  for: [ruby]

traits:
  - id: tacobell-class
    desc: "TacoBell class declaration"
    crit: suspicious
    conf: 0.95
    if:
      type: ast
      query: |
        ((class
          name: (constant) @name)
         (#eq? @name "TacoBell"))

  - id: tacobell-class-ast
    desc: "TacoBell class constant"
    crit: suspicious
    conf: 0.9
    if:
      type: string
      word: "TacoBell"

  - id: tacobell-domain
    desc: "TacoBell iplogger beacon domain"
    crit: suspicious
    conf: 0.95
    if:
      type: string
      regex: "iplogger\\.(org|com|net)"

  - id: tacobell-iplogger-fragmented
    desc: "TacoBell fragmented iplogger URL"
    crit: suspicious
    conf: 0.95
    if:
      type: ast
      query: |
        ((binary
          left: (_)
          right: (string (string_content) @str))
         (#match? @str "iplogger"))

  - id: tacobell-payload-png
    desc: "TacoBell payload disguise (aaa.png)"
    crit: suspicious
    conf: 0.9
    if:
      type: string
      exact: "aaa.png"

  - id: payload-name-a-exe
    desc: "Filename 'a.exe' reference"
    if:
      type: string
      exact: "a.exe"
