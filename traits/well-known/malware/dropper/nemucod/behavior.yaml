composite_rules:
  - id: nemucod-pipe-variant
    desc: "Detects Nemucod JScript dropper using Object.prototype.pipe obfuscation"
    crit: hostile
    conf: 0.99
    all:
      - id: objectives/anti-static/obfuscation/source/prototype::pipe-return-this
    any:
      - id: objectives/execution/interpreter/script/wsh::wscript-dropper-fragments-composite
      - id: objectives/command-and-control/dropper/obfuscated::fake-jquery-dropper
      - id: objectives/anti-static/obfuscation/source/names::fake-jquery-vars
