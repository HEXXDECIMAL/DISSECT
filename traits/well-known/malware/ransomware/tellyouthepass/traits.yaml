# TellYouThePass Ransomware Detection
# ATT&CK: T1486 (Data Encrypted for Impact)
# MBC: C0027 (Encrypt Files)

defaults:
  for: [all]

traits:
  - id: id
    desc: "TellYouThePass identifier"
    crit: suspicious
    conf: 0.95
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      substr: "tellyouthepass"
      case_insensitive: true

  - id: tytp
    desc: "TellYouThePass short identifier"
    crit: suspicious
    conf: 0.8
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      exact: "TYTP"

  - id: note-readme-locked
    desc: "TellYouThePass ransom note"
    crit: suspicious
    conf: 0.9
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      exact: "README_LOCKED"
  
  - id: note-how-to-decrypt
    desc: "TellYouThePass ransom note"
    crit: suspicious
    conf: 0.9
    mbc: "C0027"
    attack: "T1486"
    if:
      type: string
      exact: "HOW_TO_DECRYPT"

composite_rules:
  - id: note
    desc: "TellYouThePass ransom note"
    crit: suspicious
    conf: 0.9
    mbc: "C0027"
    attack: "T1486"
    any:
      - id: note-readme-locked
      - id: note-how-to-decrypt

  - id: tellyouthepass-detected
    desc: "TellYouThePass ransomware detected"
    crit: notable
    conf: 0.95
    mbc: "C0027"
    attack: "T1486"
    any:
      - id: id
      - id: tytp
      - id: note
