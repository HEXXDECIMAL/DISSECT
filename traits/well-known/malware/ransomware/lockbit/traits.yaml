# LockBit Ransomware
# Detects artifacts and structural patterns unique to LockBit

defaults:
  for: [all]
  platforms: [windows]
  attack: "T1486" # Data Encrypted for Impact
  mbc: "B0031" # Impact::Ransomware

traits:
  # LockBit 3.0 (LockBit Black) Section Names with size constraints
  - id: section-dg
    desc: LockBit 3.0 custom section '.DG'' (Large)
    crit: suspicious
    conf: 0.95
    if:
      type: section
      exact: ".DG'"
      length_min: 1048576 # 1MB+

  - id: section-lj
    desc: LockBit 3.0 custom section '.LJ/'
    crit: suspicious
    conf: 0.95
    if:
      type: section
      exact: ".LJ/"

  - id: section-nw
    desc: LockBit 3.0 custom section '.nw['
    crit: suspicious
    conf: 0.95
    if:
      type: section
      exact: ".nw["

composite_rules:
  - id: lockbit-3-builder-artifact
    desc: Probable LockBit 3.0 / REvil builder artifact
    crit: hostile
    conf: 0.9
    needs: 2
    any:
      - id: well-known/malware/ransomware/lockbit::section-dg
      - id: well-known/malware/ransomware/lockbit::section-lj
      - id: well-known/malware/ransomware/lockbit::section-nw
    all:
      - id: objectives/persistence/service/install::windows-service-persistence
      - id: objectives/anti-static/obfuscation/binary-metrics::dominant-section
      - id: objectives/anti-analysis/obfuscation/instruction/junk::ud2-junk-code
