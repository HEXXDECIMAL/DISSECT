# sysrv-hello worm
# ATT&CK: T1105 (Ingress Tool Transfer), T1046 (Network Service Discovery)
# MBC: B0024 (Remote Access), B0030 (C2 Communication)

defaults:
  for: [all]

traits:
  - id: sysrv-hello-identifier
    desc: sysrv-hello identifier
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "sysrv-hello"

  - id: sysrv-hello-scan
    desc: sysrv-hello scan behavior
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "sysrv-hello scan"

  - id: sysrv-hello-kill
    desc: sysrv-hello kill behavior
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "sysrv-hello kill"

composite_rules:
  - id: sysrv-hello-worm
    desc: sysrv-hello worm detection
    crit: hostile
    conf: 1.0
    all:
      - id: sysrv-hello-identifier
      - id: objectives/impact/ransom/encrypt::go-file-encrypt-yara
    any:
      - id: sysrv-hello-scan
      - id: sysrv-hello-kill
