# JFrog Typosquatting (jrrog)
# Detects specific typosquatting of JFrog identity

traits:
  - id: typosquat-identity
    desc: Typosquatting of JFrog identity (vscode-jrrog-extension)
    crit: suspicious
    conf: 1.0
    for: [all]
    size_min: 100
    size_max: 1048576
    if:
      type: raw
      # Specific match for the known bad ID
      regex: 'Id="vscode-jrrog-extension"'
      count_max: 1

  - id: publisher-typosquat
    desc: Typosquatting of JFrog publisher
    crit: suspicious
    conf: 1.0
    for: [all]
    size_min: 100
    size_max: 1048576
    if:
      type: raw
      # Specific match for the known bad publisher
      substr: 'Publisher="Artifactory-Software-Studio"'
      count_max: 1

  - id: suspicious-jfrog-link
    desc: Suspicious JFrog link (jfrog.ai)
    crit: suspicious
    conf: 0.8
    for: [all]
    if:
      type: raw
      substr: 'https://jfrog.ai'

composite_rules:

  - id: known-typosquat-jfrog

    desc: Possible JFrog typosquatting (jrrog)

    crit: suspicious

    conf: 1.0

    for: [all]

    any:

      - id: typosquat-identity

      - id: publisher-typosquat

      - id: suspicious-jfrog-link



  - id: known-typosquat-jfrog-hostile

    desc: Confirmed JFrog typosquatting (jrrog)

    crit: hostile

    conf: 1.0

    for: [all]

    all:

      - id: typosquat-identity

      - id: publisher-typosquat


