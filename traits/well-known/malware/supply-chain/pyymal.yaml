# PyYMAL Supply Chain Malware
# A typosquatting package that mimics PyYAML but disables security checks
# and contains social engineering comments.

traits:
  - id: pyymal-comment
    desc: "Specific social engineering comment found in PyYMAL"
    crit: suspicious
    conf: 1.0
    for: [python]
    if:
      type: raw
      # Long regex match for high precision (Precision > 4.0)
      # "You don't have to looks further\n# looks further, there are no pretty code."
      regex: "You don't have to\\s*\\n\\s*#\\s*looks further, there are no pretty code\\."

composite_rules:
  - id: pyymal
    desc: "PyYMAL malicious package detected"
    crit: hostile
    conf: 1.0
    any:
      - id: pyymal-comment
      - id: micro-traits/data/serialize/yaml::yaml-duplicate-key-support
