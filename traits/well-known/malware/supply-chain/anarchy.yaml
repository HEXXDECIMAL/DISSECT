defaults:
  for: [javascript]

traits:
  - id: anarchy-ga-id
    desc: Anarchy protestware tracking ID
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "UA-48351156-4"

  - id: anarchy-ua-dependency
    desc: Requires universal-analytics
    crit: inert
    conf: 0.8
    if:
      type: string
      substr: "universal-analytics"

  - id: anarchy-rm-rf
    desc: Contains rm -rf / string
    crit: suspicious
    conf: 0.8
    if:
      type: string
      substr: "rm -rf /"

composite_rules:
  - id: anarchy-behavior
    desc: Anarchy protestware behavior
    crit: hostile
    conf: 0.9
    all:
      - id: anarchy-ua-dependency
      - id: anarchy-rm-rf