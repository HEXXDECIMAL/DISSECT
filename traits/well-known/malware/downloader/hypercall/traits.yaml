# HYPERCALL Go Downloader Detection
# UNC1069 Go-based downloader with memory injection
# Source: Google Threat Intelligence Group (GTIG)

defaults:
  platforms: [macos]
  for: [macho]

composite_rules:
  # Strict HYPERCALL detection
  - id: hypercall-strict
    desc: HYPERCALL Go downloader (exact match)
    crit: hostile
    conf: 1.0
    attack: "T1055"
    for: [go, elf, macho]
    all:
      - id: micro-traits/comm/websocket/library::gorilla-websocket
      - id: objectives/defense-evasion/process/injection/memory::inject-mac-path
      - id: objectives/defense-evasion/process/injection/memory::inject-function
      - id: objectives/defense-evasion/process/injection/memory::rc4-decode-function

  # Generalized Go memory injection behavior
  - id: go-injection-downloader
    desc: Go downloader with memory injection capability
    crit: hostile
    conf: 0.95
    for: [go, elf, macho]
    all:
      - id: objectives/defense-evasion/process/injection/memory::inject-function
      - id: micro-traits/comm/websocket/library::gorilla-websocket
