# Python 0623 Backdoor
# Unidentified Python backdoor using 0623 identifier

defaults:
  for: [all]
  crit: suspicious
  conf: 1.0

traits:
  - id: identifier-0623
    desc: Specific 0623 identifier used in variables
    if:
      type: string
      regex: "(?i)(REG|MACHINEID|PID|COMMAND|AUTO|UPLOAD)0623"

  - id: function-genuuid0623
    desc: Specific genUUID0623 function
    if:
      type: string
      exact: "genUUID0623"

  - id: function-exchange0623
    desc: Specific htxp0623Exchange function
    if:
      type: string
      regex: "htxp0623Exchange"

composite_rules:
  - id: python-0623-backdoor
    desc: Detects Python 0623 Backdoor family
    crit: hostile
    conf: 1.0
    all:
      - id: identifier-0623
      - id: function-genuuid0623
      - id: function-exchange0623