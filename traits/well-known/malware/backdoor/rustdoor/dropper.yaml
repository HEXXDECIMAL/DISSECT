# Rustdoor Dropper Script
# Detects shell script droppers associated with Rustdoor campaigns
# ATT&CK: T1059.004

defaults:
  for: [shell]

composite_rules:
  - id: rustdoor-dropper-script
    desc: "Rustdoor shell dropper indicators"
    crit: hostile
    conf: 0.95
    all:
      - id: objectives/defense-evasion/decoy/document::download-and-open-decoy
      - id: objectives/execution/dropper/script::chmod-plus-x-cmd
      - id: objectives/execution/dropper/script::execute-dot-slash
      - id: objectives/discovery/host/user::whoami