# NodeJS Backdoor Behaviors
# Detects combinations of behaviors common in NodeJS backdoors

composite_rules:
  - id: behavior-mix
    desc: "NodeJS backdoor-like behavior (Masquerading + exec)"
    crit: hostile
    conf: 0.85
    attack: "T1059.003"
    mbc: "B0022"
    for: [elf, macho]
    all:
      - id: micro-behaviors/process/name/masking::nodejs-title
      - id: micro-behaviors/fs/chmod/commands::node-chmod
      - id: micro-behaviors/process/create/shell/lang::child-process-require
