# SILENCELIFT Backdoor Detection
# UNC1069 macOS backdoor with screen lock detection and process control
# Source: Google Threat Intelligence Group (GTIG)

defaults:
  platforms: [macos]
  for: [macho, shell]

traits:
  # Atomic indicators specific to SILENCELIFT
  - id: bot-id-json
    desc: bot_id JSON structure for C2 communication
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "\\{\\s*\"bot_id\"\\s*:\\s*\""

  - id: status-json-field
    desc: status JSON field for C2 reporting
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "\",\\s*\"status\"\\s*:"

composite_rules:
  # Strict SILENCELIFT detection
  - id: silencelift-strict
    desc: SILENCELIFT backdoor (exact match)
    crit: hostile
    conf: 1.0
    attack: "T1489"
    all:
      - id: objectives/discovery/system/hardware::ioreg-screen-lock
      - id: micro-behaviors/process/control/signal::pkill-continue
      - id: micro-behaviors/process/control/signal::pkill-stop
      - id: micro-behaviors/fs/path/library::hidden-library-caches
      - id: micro-behaviors/hardware/input/keylog::evt-marker-file
      - id: bot-id-json
      - id: status-json-field
      - id: micro-behaviors/fs/path/library::hidden-library-fonts

  # Generalized SILENCELIFT-like behavior
  - id: silencelift-behavior
    desc: SILENCELIFT-like backdoor with process control
    crit: hostile
    conf: 0.95
    attack: "T1489"
    all:
      - id: micro-behaviors/process/control/signal::process-suspend-resume
      - id: micro-behaviors/fs/path/library::hidden-library-caches
      - id: bot-id-json
    any:
      - id: objectives/discovery/system/hardware::ioreg-screen-lock
      - id: micro-behaviors/hardware/input/keylog::evt-marker-file
