# GoSocks Backdoor (Go-based SOCKS5 Proxy & Shell)
# Combines SOCKS5 proxying with a reverse shell, written in Go
# ATT&CK: T1090.001 (Proxy: Internal Proxy), T1059 (Command and Scripting Interpreter)

traits:
  - id: unique-path
    desc: "Unique Go package path for"
    crit: suspicious
    conf: 1.0
    attack: "T1090"
    for: [elf, macho]
    if:
      type: string
      substr: "src/mode/httpAndTcp/socket5Quick"

  - id: shell-module
    desc: "GoSocks shell execution module"
    crit: suspicious
    conf: 0.95
    attack: "T1059"
    for: [elf, macho]
    if:
      type: string
      substr: "src/mode/httpAndTcp/shell/ShellLinux.Exec_shell"

  - id: proxy-module
    desc: "GoSocks SOCKS5 proxy startup function"
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    for: [elf, macho]
    if:
      type: string
      substr: "src/mode/httpAndTcp/socket5Quick.StartProxy"

  - id: forward-module
    desc: "GoSocks port forwarding module"
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    for: [elf, macho]
    if:
      type: string
      substr: "src/mode/httpAndTcp/inForward.Start"

composite_rules:
  - id: gosocks-detected
    desc: GoSocks backdoor detected
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    mbc: "B0022"
    for: [elf, macho]
    any:
      - id: unique-path
      - id: shell-module
      - id: proxy-module
      - id: forward-module
