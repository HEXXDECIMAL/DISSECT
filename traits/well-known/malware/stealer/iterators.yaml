# Malware: Iterators Stealer
# This family of NPM malware exfiltrates system info via DNS and HTTP to rt11.ml
# It uses specific evasion patterns against sandbox environments.

defaults:
  for: [all]

traits:
  - id: iterators-c2-domain
    desc: C2 domain used by Iterators stealer
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "rt11.ml"

  - id: iterators-evasion-vastest
    desc: Evasion check for vastest analysis path
    crit: suspicious
    if:
      type: string
      substr: "IMPOSSIBLE_MATCH_XYZZY_ITERATORS"

composite_rules:
  - id: iterators-stealer
    desc: Iterators system info stealer
    crit: hostile
    conf: 1.0
    all:
      - id: iterators-c2-domain
      - id: objectives/anti-analysis/evasion/detection::evasion-checks
    any:
      - id: objectives/command-and-control/dns/tunneling::js-dns-tunneling-exfil
      - id: objectives/lateral-movement/supply-chain/npm/behavior::npm-data-exfil
