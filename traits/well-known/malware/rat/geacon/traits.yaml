# Malware Family - Geacon C2 Beacon
# Go implementation of Cobalt Strike beacon
# ATT&CK: T1071 (Application Layer Protocol)

defaults:
  for: [all]

traits:
  # === Atomic Traits ===

  - id: coded-ref
    desc: Geacon coded reference
    crit: suspicious
    conf: 0.95
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "geacon coded"

  - id: path-ref
    desc: Geacon package path reference
    crit: suspicious
    conf: 0.9
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "geacon/"

  - id: author-darkr4y
    desc: Geacon author reference
    crit: suspicious
    conf: 0.95
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "darkr4y"

  - id: motto
    desc: Geacon author motto
    crit: suspicious
    conf: 0.9
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "cuz life is shit"

  - id: change-dir
    desc: Geacon change directory packet
    crit: suspicious
    conf: 0.7
    attack: "T1083"
    platforms: [all]
    if:
      type: string
      substr: "packet.ChangeCurrentDir"

  - id: gbk-convert
    desc: Geacon GBK string conversion
    crit: suspicious
    conf: 0.75
    attack: "T1071"
    platforms: [all]
    if:
      type: string
      substr: "ConvertStr2GBK"

  - id: fake-ie-ua
    desc: Geacon fake IE user agent
    crit: suspicious
    conf: 0.5
    attack: "T1071.001"
    platforms: [all]
    if:
      type: string
      substr: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"

composite_rules:
  - id: geacon-detected
    desc: Geacon Cobalt Strike Go implant detected
    crit: suspicious
    conf: 0.95
    attack: "T1071"
    mbc: "B0030"
    platforms: [all]
    for: [elf, macho, pe, go]
    needs: 2
    any:
      - id: coded-ref
      - id: path-ref
      - id: author-darkr4y
      - id: motto
      - id: change-dir
      - id: gbk-convert
