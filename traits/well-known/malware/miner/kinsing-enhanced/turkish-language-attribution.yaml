# Kinsing Turkish Language Indicators
# Detects Turkish language strings indicating Turkish-speaking threat actors
# ATT&CK: T1593.003 (Search Open Websites/Domains)
# Use case: Malware origin/campaign attribution

traits:
  # === Turkish Installation & Setup Strings ===
  - id: turkish-sudo-installing
    desc: Turkish "sudo installing" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "sudo kuruluyor"

  - id: turkish-privilege-authority
    desc: Turkish "privilege/authority" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "yetkisi"

  - id: turkish-group-membership
    desc: Turkish group membership phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "grubuna eklendi"

  - id: turkish-sudo-privileged
    desc: Turkish "with sudo privileges" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "sudo yetkili"

  # === Turkish Cleanup & Evasion ===
  - id: turkish-cleaning-generic
    desc: Turkish "cleaning" phrase
    crit: inert
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "temizleniyor"

  - id: turkish-profile-viruses
    desc: Turkish "profile viruses cleaning"
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "Profile virusleri temizleniyor"

  - id: turkish-systemd-cron-cleanup
    desc: Turkish "systemd and cron cleaning"
    crit: inert
    conf: 0.9
    for: [elf, shell]
    if:
      type: string
      substr: "Systemd ve cron temizleniyor"

composite_rules:
  - id: turkish-language-indicators
    desc: Turkish language content in binary
    for: [elf, shell]
    any:
      - id: turkish-sudo-installing
      - id: turkish-privilege-authority
      - id: turkish-group-membership
      - id: turkish-sudo-privileged
      - id: turkish-cleaning-generic
      - id: turkish-profile-viruses
      - id: turkish-systemd-cron-cleanup

  - id: turkish-privilege-escalation
    desc: Turkish language with privilege escalation context
    all:
      - id: turkish-sudo-installing
      - id: turkish-privilege-authority

  - id: turkish-kinsing-attribution
    desc: Kinsing with Turkish language attribution
    crit: suspicious
    conf: 0.9
    for: [elf, shell]
    attack: "T1496"
    all:
      - id: well-known/malware/miner/kinsing::kinsing-names
      - id: turkish-language-indicators

  - id: turkish-systemd-cron-specific
    desc: Turkish-language systemd and cron cleanup
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    attack: "T1070.003"
    all:
      - id: turkish-systemd-cron-cleanup
      - id: objectives/persistence/systemd/service::systemd
