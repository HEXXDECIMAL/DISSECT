traits:
- id: kinsing-identifier
  desc: Kinsing process identifier
  crit: notable
  conf: 0.9
  for:
  - elf
  - shell
  if:
    type: string
    regex: (kinsing|kdevtmpfsi|kworker)
  attack: T1496
- id: xmrig-miner-core
  desc: XMRig core miner reference
  crit: notable
  conf: 0.9
  for:
  - elf
  - shell
  if:
    type: string
    regex: (xmrig|xmrig-proxy)
  attack: T1496
- id: sshd-config-modification
  desc: SSH daemon configuration modification
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (sshd_config|PermitRootLogin)
  attack: T1098.004
- id: authorized-keys-harvesting
  desc: SSH authorized_keys harvesting
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (authorized_keys|/\.ssh/)
  attack: T1555.003
- id: backdoor-user-creation
  desc: Backdoor user account creation
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (useradd|adduser|/bin/bash)
  attack: T1136.001
- id: privilege-escalation-setup
  desc: Sudoers privilege escalation
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  if:
    type: string
    regex: (sudoers|usermod -aG wheel|usermod -aG sudo)
  attack: T1548.004
- id: systemd-service-persistence
  desc: Systemd service persistence
  crit: notable
  conf: 0.6
  for:
  - elf
  - shell
  if:
    type: string
    regex: (systemctl|systemctl enable|/etc/systemd/system/)
  attack: T1547.002
- id: cron-persistence
  desc: Cron job persistence
  crit: notable
  conf: 0.6
  for:
  - elf
  - shell
  if:
    type: string
    regex: (crontab|/var/spool/cron|/etc/cron)
  attack: T1053.006
- id: shell-rc-persistence
  desc: Shell rc file persistence
  crit: notable
  conf: 0.6
  for:
  - elf
  - shell
  if:
    type: string
    regex: (\.bashrc|\.profile|\.zshrc)
  attack: T1547.013
- id: evidence-removal
  desc: Evidence removal patterns
  crit: notable
  conf: 0.6
  for:
  - elf
  - shell
  if:
    type: string
    regex: (sed -i|grep.{0,100}deleted|pkill -9)
  attack: T1070.003
- id: competing-malware-kill
  desc: Competing malware termination
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (mirai|xmrig)
  attack: T1070.003
- id: ssh-key-harvesting
  desc: SSH private key harvesting
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - shell
  if:
    type: string
    regex: (id_rsa|known_hosts)
  attack: T1555.003
- id: turkish-language-text
  desc: Turkish language in binary
  crit: inert
  conf: 0.7
  for:
  - elf
  - shell
  if:
    type: string
    regex: (kuruluyor|yetkisi|grubuna|Systemd ve cron temizleniyor)
- id: firewall-tool-abuse
  desc: Firewall configuration abuse
  crit: suspicious
  conf: 0.8
  for:
  - elf
  - shell
  if:
    type: string
    regex: (firewall-cmd|ufw|--add-port)
  attack: T1562.004
composite_rules:
- id: kinsing-mining-capability
  desc: Kinsing cryptocurrency mining capability
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1496
  needs: 2
  any:
  - id: kinsing-identifier
  - id: xmrig-miner-core
- id: kinsing-ssh-backdoor
  desc: Kinsing SSH backdoor installation
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1098.004
  all:
  - id: sshd-config-modification
  - id: authorized-keys-harvesting
- id: kinsing-account-escalation
  desc: Kinsing account with privilege escalation
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1136.001
  all:
  - id: backdoor-user-creation
  - id: privilege-escalation-setup
- id: kinsing-persistence-suite
  desc: Kinsing multiple persistence mechanisms
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1547
  needs: 2
  any:
  - id: systemd-service-persistence
  - id: cron-persistence
  - id: shell-rc-persistence
- id: kinsing-forensics-evasion
  desc: Kinsing forensics evasion patterns
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1070.003
  needs: 2
  any:
  - id: evidence-removal
  - id: competing-malware-kill
- id: kinsing-credential-theft
  desc: Kinsing credential theft
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1555
  needs: 2
  any:
  - id: micro-behaviors/fs/path/config/accounts::etc-shadow
  - id: micro-behaviors/fs/path/config/accounts::etc-passwd
  - id: ssh-key-harvesting
- id: kinsing-complete-infection
  desc: Complete Kinsing infection pattern
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  attack: T1496
  mbc: B0014
  needs: 5
  any:
  - id: kinsing-mining-capability
  - id: kinsing-ssh-backdoor
  - id: kinsing-account-escalation
  - id: kinsing-persistence-suite
  - id: kinsing-forensics-evasion
  - id: kinsing-credential-theft
- id: kinsing-with-language-origin
  desc: Kinsing botnet with language attribution
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  all:
  - id: kinsing-complete-infection
  - id: turkish-language-text
