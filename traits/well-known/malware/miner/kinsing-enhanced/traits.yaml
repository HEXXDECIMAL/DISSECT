# Removed duplicate traits:
# - kinsing-identifier: use well-known/malware/miner/kinsing::kinsing-names instead
# - ssh-key-harvesting: use well-known/malware/miner/kinsing::ssh-files instead
# - turkish-language-text: use turkish-language-attribution::turkish-language-indicators instead

composite_rules:
- id: kinsing-mining-capability
  desc: Kinsing cryptocurrency mining capability
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1496
  needs: 2
  any:
  - id: well-known/malware/miner/kinsing::kinsing-names
  - id: well-known/malware/miner/xmrig::xmrig-name

- id: kinsing-ssh-backdoor
  desc: Kinsing SSH backdoor installation
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1098.004
  all:
  - id: well-known/malware/miner/kinsing::kinsing-names
  - id: objectives/lateral-movement/ssh-backdoor-installation/deploy::ssh-backdoor-installation

- id: kinsing-account-escalation
  desc: Kinsing account with privilege escalation
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1136.001
  all:
  - id: objectives/persistence/account/create::useradd-command
  - id: micro-behaviors/fs/path/config/privesc::sudoers-files

- id: kinsing-persistence-suite
  desc: Kinsing multiple persistence mechanisms
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1547
  needs: 2
  any:
  - id: objectives/persistence/systemd/service::systemd
  - id: objectives/persistence/cron/job::cron
  - id: objectives/persistence/shell/config::multi-file-access

- id: kinsing-forensics-evasion
  desc: Kinsing forensics evasion patterns
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1070.003
  needs: 2
  any:
  - id: objectives/evasion/self-delete/process::pkill-deleted-pattern
  - id: objectives/evasion/evidence-removal/cleanup::pkill-signal-9

- id: kinsing-credential-theft
  desc: Kinsing credential theft
  crit: suspicious
  conf: 0.9
  for:
  - elf
  - shell
  attack: T1555
  needs: 2
  any:
  - id: micro-behaviors/os/privilege/paths::etc-shadow
  - id: micro-behaviors/fs/path/config/accounts::etc-passwd
  - id: well-known/malware/miner/kinsing::ssh-files

- id: kinsing-complete-infection
  desc: Complete Kinsing infection pattern
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  attack: T1496
  mbc: B0014
  needs: 5
  any:
  - id: kinsing-mining-capability
  - id: kinsing-ssh-backdoor
  - id: kinsing-account-escalation
  - id: kinsing-persistence-suite
  - id: kinsing-forensics-evasion
  - id: kinsing-credential-theft

- id: kinsing-with-language-origin
  desc: Kinsing botnet with language attribution
  crit: hostile
  conf: 0.95
  for:
  - elf
  - shell
  all:
  - id: kinsing-complete-infection
  - id: well-known/malware/miner/kinsing-enhanced::turkish-language-indicators
