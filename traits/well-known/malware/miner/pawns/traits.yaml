# Malware Family - IPRoyal Pawns (Proxyware)
# Reference: https://asec.ahnlab.com/en/37276/
# ATT&CK: T1090 (Proxy)

traits:
  - id: gitlab-dev
    desc: IPRoyal Pawns GitLab development path
    crit: suspicious
    conf: 0.99
    attack: "T1090"
    for: [elf]
    if:
      type: string
      substr: "gitlab.iproyal.dev/pawns/"

  - id: mole
    desc: IPRoyal Pawns mole component
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    for: [elf]
    if:
      type: string
      substr: "go-pawns/mole"

  - id: pawns-brand
    desc: IPRoyal Pawns brand string
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    for: [elf]
    if:
      type: string
      substr: "IPROYAL PAWNS"

  - id: api-url
    desc: IPRoyal Pawns API URL variable
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    for: [elf]
    if:
      type: string
      substr: "PAWNS_API_URL"

composite_rules:
  - id: pawns-detected
    desc: IPRoyal Pawns proxyware
    crit: suspicious
    conf: 0.95
    attack: "T1090"
    mbc: "B0012"
    for: [elf]
    any:
      - id: gitlab-dev
      - id: mole
      - id: pawns-brand
      - id: api-url
