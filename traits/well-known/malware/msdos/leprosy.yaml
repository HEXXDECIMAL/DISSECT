defaults:
  for: [c]
  crit: suspicious
  conf: 0.9

traits:
  - id: leprosy-decryption-loop
    desc: Leprosy virus character-shift decryption loop
    if:
      type: raw
      regex: '\*p\s*-=\s*10'

  - id: leprosy-encrypted-name
    desc: Leprosy virus encrypted name (VOZ)
    if:
      type: raw
      word: "VOZ"

  - id: leprosy-author-encrypted
    desc: Leprosy virus encrypted author (ZMW<)
    if:
      type: raw
      substr: "ZMW<"

  - id: leprosy-fake-msg-encrypted
    desc: Leprosy virus encrypted fake error message
    if:
      type: raw
      substr: "Z|yq|kw"

composite_rules:
  - id: leprosy-virus-source
    desc: Leprosy Virus (MS-DOS) Source Code
    crit: hostile
    conf: 1.0
    all:
      - id: leprosy-decryption-loop
      - id: micro-behaviors/os/dos/interrupt::int-21h-inline-asm
    any:
      - id: leprosy-encrypted-name
      - id: leprosy-author-encrypted
      - id: leprosy-fake-msg-encrypted