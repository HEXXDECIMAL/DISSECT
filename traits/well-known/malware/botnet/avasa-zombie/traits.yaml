# Malware Family - Avasa-Zombie DDoS Agent
# Reference: Linux/Agent.FP variant
# ATT&CK: T1498 (Network Denial of Service)

traits:
  - id: avasa-zombie-brand
    desc: Avasa-Zombie botnet identifier
    crit: suspicious
    conf: 0.99
    attack: "T1498"
    for: [elf]
    if:
      type: string
      substr: "avasa-zombie"

  - id: motd-method
    desc: Avasa-Zombie Minecraft MOTD method
    crit: suspicious
    conf: 0.95
    attack: "T1498"
    for: [elf]
    if:
      type: string
      substr: "MotdMethod"

  - id: convert-attack
    desc: Avasa-Zombie attack converter
    crit: suspicious
    conf: 0.95
    attack: "T1498"
    for: [elf]
    if:
      type: string
      substr: "ConvertAttack"

  - id: local-attack
    desc: Avasa-Zombie local attack storage
    crit: suspicious
    conf: 0.95
    attack: "T1498"
    for: [elf]
    if:
      type: string
      substr: "localAttackStorage"

composite_rules:
  - id: avasa-zombie-detected
    desc: Avasa-Zombie DDoS Agent
    crit: suspicious
    conf: 0.95
    attack: "T1498"
    mbc: "B0008"
    for: [elf]
    needs: 3
    any:
      - id: avasa-zombie-brand
      - id: motd-method
      - id: convert-attack
      - id: local-attack
