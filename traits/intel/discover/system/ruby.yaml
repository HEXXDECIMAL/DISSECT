---
# Ruby system information gathering
traits:
  - id: intel/discover/system/ruby-dns-resolve
    description: "DNS hostname resolution"
    criticality: notable
    confidence: 0.85
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Resolv.getaddress
        - Resolv.getname

  - id: intel/discover/system/ruby-env-read
    description: "Read environment variables"
    criticality: notable
    confidence: 0.75
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - "ENV["
        - ENV.fetch

  - id: intel/discover/system/ruby-process-info
    description: "Process information access"
    criticality: notable
    confidence: 0.75
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - Process.pid
        - Process.ppid
        - Process.uid
        - Process.gid
