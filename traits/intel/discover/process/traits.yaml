# Process Discovery Traits - Symbol-based Detection
# MBC: OB0007 (Discovery) â†’ E1057 (Process Discovery)
# ATT&CK: T1057 (Process Discovery)

traits:
  # User ID functions
  - id: intel/discover/process/getuid
    description: Get real user ID of calling process
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getuid
    platforms: [unix, linux, macos]

  - id: intel/discover/process/geteuid
    description: Get effective user ID of calling process
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: geteuid
    platforms: [unix, linux, macos]

  - id: intel/discover/process/getgid
    description: Get real group ID of calling process
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getgid
    platforms: [unix, linux, macos]

  - id: intel/discover/process/getegid
    description: Get effective group ID of calling process
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getegid
    platforms: [unix, linux, macos]

  # Process ID functions
  - id: intel/discover/process/getpid
    description: Get process ID of calling process
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getpid
    platforms: [unix, linux, macos]

  - id: intel/discover/process/getppid
    description: Get parent process ID
    criticality: inert
    mbc: "E1057"
    attack: "T1057"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getppid
    platforms: [unix, linux, macos]

  # User information lookup
  - id: intel/discover/process/getpwnam
    description: Get user database entry by name
    criticality: inert
    mbc: "E1087"
    attack: "T1087.001"
    confidence: 0.6
    condition:
      type: symbol
      pattern: getpwnam
    platforms: [unix, linux, macos]

  - id: intel/discover/process/getpwuid
    description: Get user database entry by UID
    criticality: inert
    mbc: "E1087"
    attack: "T1087.001"
    confidence: 0.6
    condition:
      type: symbol
      pattern: getpwuid
    platforms: [unix, linux, macos]

  # Group information lookup
  - id: intel/discover/process/getgrnam
    description: Get group database entry by name
    criticality: inert
    mbc: "E1087"
    attack: "T1087.002"
    confidence: 0.6
    condition:
      type: symbol
      pattern: getgrnam
    platforms: [unix, linux, macos]

  - id: intel/discover/process/getgrgid
    description: Get group database entry by GID
    criticality: inert
    mbc: "E1087"
    attack: "T1087.002"
    confidence: 0.6
    condition:
      type: symbol
      pattern: getgrgid
    platforms: [unix, linux, macos]
