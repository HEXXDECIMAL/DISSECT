traits:
  - id: syscall-socket
    desc: Creates network socket
    crit: notable
    conf: 0.8
    if:
      type: syscall
      name: ["socket", "socketcall"]

  - id: syscall-bind
    desc: Binds socket to address/port
    crit: notable
    conf: 0.8
    if:
      type: syscall
      name: ["bind"]

  - id: syscall-listen
    desc: Listens for incoming connections
    crit: notable
    conf: 0.8
    if:
      type: syscall
      name: ["listen"]

  - id: syscall-accept
    desc: Accepts incoming connections
    crit: notable
    conf: 0.8
    if:
      type: syscall
      name: ["accept", "accept4"]

composite_rules:
  - id: server
    desc: Network server - binds and listens on port
    conf: 0.9
    crit: suspicious
    platforms: [linux]
    for: [elf]
    all:
      - id: syscall-socket
      - id: syscall-bind
      - id: syscall-listen

  - id: server-accept
    desc: Network server accepting connections
    conf: 0.9
    crit: suspicious
    platforms: [linux]
    for: [elf]
    all:
      - id: syscall-socket
      - id: syscall-bind
      - id: syscall-listen
      - id: syscall-accept
