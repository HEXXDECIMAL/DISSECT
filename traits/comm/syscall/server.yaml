traits:
  - id: syscall-socket
    description: Creates network socket
    criticality: notable
    confidence: 0.8
    condition:
      type: syscall
      name: ["socket", "socketcall"]

  - id: syscall-bind
    description: Binds socket to address/port
    criticality: notable
    confidence: 0.8
    condition:
      type: syscall
      name: ["bind"]

  - id: syscall-listen
    description: Listens for incoming connections
    criticality: notable
    confidence: 0.8
    condition:
      type: syscall
      name: ["listen"]

  - id: syscall-accept
    description: Accepts incoming connections
    criticality: notable
    confidence: 0.8
    condition:
      type: syscall
      name: ["accept", "accept4"]

composite_rules:
  - id: server
    description: Network server - binds and listens on port
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - id: syscall-socket
      - id: syscall-bind
      - id: syscall-listen

  - id: server-accept
    description: Network server accepting connections
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - id: syscall-socket
      - id: syscall-bind
      - id: syscall-listen
      - id: syscall-accept
