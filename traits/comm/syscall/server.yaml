composite_rules:
  - id: server
    description: Network server - binds and listens on port
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - type: syscall
        name: ["socket", "socketcall"]
      - type: syscall
        name: ["bind"]
      - type: syscall
        name: ["listen"]

  - id: server-accept
    description: Network server accepting connections
    confidence: 0.9
    criticality: suspicious
    platforms: [linux]
    file_types: [elf]
    requires_all:
      - type: syscall
        name: ["socket", "socketcall"]
      - type: syscall
        name: ["bind"]
      - type: syscall
        name: ["listen"]
      - type: syscall
        name: ["accept", "accept4"]
