# HTTP Headers
# MBC: C0002 (HTTP Communication)
# ATT&CK: T1071.001

defaults:
  mbc: "C0002"
  attack: "T1071.001"

traits:
  # === User-Agent indicators ===
  - id: ua-mozilla-old
    description: Old Mozilla 4.0 User-Agent
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      exact: "Mozilla/4.0"

  - id: ua-curl
    description: curl User-Agent
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      regex: '\bcurl/'

  - id: ua-wget
    description: wget User-Agent
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      regex: '\bWget/'

  - id: ua-python-urllib
    description: Python urllib User-Agent
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: "Python-urllib"

  # === Authorization header atomic indicators ===
  - id: auth-header
    description: Authorization header
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      exact: "Authorization:"

  - id: bearer-token
    description: Bearer token authentication
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      exact: "Bearer "

  - id: basic-auth
    description: Basic authentication
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      exact: "Basic "

  - id: headers-encoding
    description: Accept-Encoding header
    criticality: inert
    confidence: 0.66
    condition:
      type: string
      exact: Accept-Encoding

composite_rules:
  - id: headers-auth
    description: HTTP Authorization header
    criticality: notable
    confidence: 0.66
    requires_count: 1
    conditions:
      - id: auth-header
      - id: bearer-token
      - id: basic-auth

  - id: headers-useragent-fake
    description: Fake or suspicious User-Agent
    criticality: suspicious
    confidence: 0.66
    requires_count: 1
    conditions:
      - id: ua-mozilla-old
      - id: ua-curl
      - id: ua-wget
      - id: ua-python-urllib
