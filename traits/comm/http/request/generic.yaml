# HTTP Request Operations - Generic
# MBC: C0002 (HTTP Communication)
# ATT&CK: T1071.001

traits:
  # === HTTP request micro-traits (migrated from YARA) ===
  - id: http-request-func
    desc: httpRequest function reference
    crit: inert
    conf: 0.5
    mbc: "C0002"
    attack: "T1071.001"
    if:
      type: string
      exact: "httpRequest"

  - id: user-agent-header
    desc: User-Agent header
    crit: inert
    conf: 0.5
    mbc: "C0002"
    attack: "T1071.001"
    if:
      type: string
      exact: "User-Agent"

  - id: http-version
    desc: HTTP/1.x version string
    crit: inert
    conf: 0.5
    mbc: "C0002"
    attack: "T1071.001"
    if:
      type: string
      exact: "HTTP/1."

composite_rules:
  # HTTP request composite (migrated from YARA)
  - id: request
    desc: Makes HTTP requests
    crit: inert
    conf: 0.66
    mbc: "C0002"
    attack: "T1071.001"
    count: 1
    any:
      - id: http-request-func
      - id: user-agent-header
      - id: http-version
