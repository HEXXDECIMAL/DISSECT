# IP Spoofing
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

traits:
  - id: spoof
    desc: IP address spoofing capabilities
    crit: suspicious
    conf: 0.66
    if:
      type: yara
      source: |
        rule ip_spoof {
          strings:
            $spoof = "spoof" fullword
            $forge = "forge" fullword
            $hdrincl = "IP_HDRINCL"
            $raw_ip = "IPPROTO_RAW"
          condition:
            any of them
        }

  # === SYN cookie atomic indicators ===
  - id: syncookie-word
    desc: syncookie word
    crit: inert
    conf: 0.5
    if:
      type: string
      exact: "syncookie"

  - id: syn-cookie-lower
    desc: syn_cookie or syncookie
    crit: inert
    conf: 0.5
    if:
      type: string
      regex: "syn.?cookie"

  - id: syn-cookie-upper
    desc: SYN_cookie or SYNcookie
    crit: inert
    conf: 0.5
    if:
      type: string
      regex: "SYN.?cookie"

composite_rules:
  - id: syncookie
    desc: SYN cookie manipulation
    crit: suspicious
    conf: 0.66
    count: 1
    any:
      - id: syncookie-word
      - id: syn-cookie-lower
      - id: syn-cookie-upper
