# IP Spoofing
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

traits:
  - id: spoof
    description: IP address spoofing capabilities
    criticality: suspicious
    confidence: 0.66
    condition:
      type: yara
      source: |
        rule ip_spoof {
          strings:
            $spoof = "spoof" fullword
            $forge = "forge" fullword
            $hdrincl = "IP_HDRINCL"
            $raw_ip = "IPPROTO_RAW"
          condition:
            any of them
        }

  # === SYN cookie atomic indicators ===
  - id: syncookie-word
    description: syncookie word
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      exact: "syncookie"

  - id: syn-cookie-lower
    description: syn_cookie or syncookie
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      regex: "syn.?cookie"

  - id: syn-cookie-upper
    description: SYN_cookie or SYNcookie
    criticality: inert
    confidence: 0.5
    condition:
      type: string
      regex: "SYN.?cookie"

composite_rules:
  - id: syncookie
    description: SYN cookie manipulation
    criticality: suspicious
    confidence: 0.66
    requires_count: 1
    conditions:
      - id: syncookie-word
      - id: syn-cookie-lower
      - id: syn-cookie-upper
