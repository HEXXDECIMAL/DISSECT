# DNS over HTTPS (DoH)
# MBC: C0011 (DNS Communication)
# ATT&CK: T1071.004

traits:
  - id: doh
    description: DNS over HTTPS support
    criticality: notable
    confidence: 0.66
    mbc: "C0011"
    attack: "T1071.004"
    condition:
      type: yara
      source: |
        rule doh {
          strings:
            $provider = "doh.Provider"
            $class = "DnsOverHttps"
            $content = "application/dns-message"
            $url = "dns-query"
            $cloudflare = "9.9.9.9/dns-query"
            $google = "8.8.8.8/dns-query"
          condition:
            any of them
        }
