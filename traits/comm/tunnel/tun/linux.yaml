# TUN/TAP Network Tunneling
# MBC: C0001 (Socket Communication)
# ATT&CK: T1090

defaults:
  attack: "T1090"

traits:
  # === TUN/TAP atomic indicators ===
  - id: dev-tun
    desc: /dev/tun device
    crit: inert
    conf: 0.5
    if:
      type: string
      exact: "/dev/tun"

  - id: dev-tap
    desc: /dev/tap device
    crit: inert
    conf: 0.5
    if:
      type: string
      exact: "/dev/tap"

  - id: tunsetiff-ioctl
    desc: TUNSETIFF ioctl
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: "TUNSETIFF"

composite_rules:
  - id: tun
    desc: TUN/TAP device usage
    crit: notable
    conf: 0.66
    count_min: 1
    any:
      - id: dev-tun
      - id: dev-tap
      - id: tunsetiff-ioctl
