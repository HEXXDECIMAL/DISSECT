# SSL/TLS Operations
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

traits:
  - id: connect
    desc: SSL/TLS connection
    crit: inert
    conf: 0.66
    for: [elf, macho, so, dylib, c]
    if:
      type: symbol
      pattern: SSL_connect|SSL_new|SSL_CTX_new|TLS_client_method

  - id: verify-skip
    desc: Skip SSL certificate verification
    crit: suspicious
    conf: 0.66
    if:
      type: yara
      source: |
        rule ssl_verify_skip {
          strings:
            $insecure = "InsecureSkipVerify"
            $no_verify = "CERT_NONE"
            $disable = "verify_mode = ssl.CERT_NONE"
            $node = "rejectUnauthorized: false"
          condition:
            any of them
        }
