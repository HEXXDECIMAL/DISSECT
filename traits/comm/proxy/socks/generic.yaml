# SOCKS Proxy
# MBC: C0001 (Socket Communication)
# ATT&CK: T1090

defaults:
  mbc: "C0001"
  attack: "T1090"

traits:
  - id: socks4-proto
    description: SOCKS4 protocol reference
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: SOCKS4

  - id: socks5-proto
    description: SOCKS5 protocol reference
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: SOCKS5

  - id: socks-url
    description: SOCKS URL scheme
    criticality: notable
    confidence: 0.7
    condition:
      type: string
      exact: "socks://"

  - id: socks-port
    description: SOCKS default port 1080
    criticality: inert
    confidence: 0.4
    condition:
      type: string
      exact: "1080"

composite_rules:
  - id: socks
    description: SOCKS proxy usage
    criticality: notable
    confidence: 0.66
    requires_count: 1
    conditions:
      - type: trait
        id: socks4-proto
      - type: trait
        id: socks5-proto
      - type: trait
        id: socks-url
      - type: trait
        id: socks-port
