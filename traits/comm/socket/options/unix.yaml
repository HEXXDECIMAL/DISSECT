# Socket Options
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

defaults:
  file_types: [elf, macho, so, dylib, c]

traits:
  - id: options-get
    description: Get socket options
    criticality: inert
    confidence: 0.66
    condition:
      type: symbol
      pattern: getsockopt

  - id: options-set
    description: Set socket options
    criticality: inert
    confidence: 0.66
    condition:
      type: symbol
      pattern: setsockopt

  - id: options-reuseport
    description: Enable socket port reuse
    criticality: notable
    confidence: 0.66
    condition:
      type: string
      exact: SO_REUSEPORT

  - id: options-filter
    description: Socket packet filtering
    criticality: notable
    confidence: 0.66
    condition:
      type: string
      exact: SO_ATTACH_FILTER
