# Go Network Socket Detection
# Metrics-based detection of network operations in Go code

defaults:
  file_types: [go]
  attack: "T1071"

traits:
  - id: go-network-dial
    description: Creates network connections via net.Dial
    criticality: notable
    confidence: 0.75
    condition:
      type: metrics
      field: go_metrics.net_dial_count
      min: 1

  - id: go-raw-sockets
    description: Uses raw socket operations
    criticality: suspicious
    confidence: 0.85
    condition:
      type: metrics
      field: go_metrics.raw_socket_count
      min: 1

  - id: go-http-operations
    description: Performs HTTP client/server operations
    criticality: notable
    confidence: 0.7
    condition:
      type: metrics
      field: go_metrics.http_usage
      min: 1
