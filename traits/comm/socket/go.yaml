# Go Network Socket Detection
# Metrics-based detection of network operations in Go code

defaults:
  for: [go]
  attack: "T1071"

traits:
  - id: go-network-dial
    desc: Creates network connections via net.Dial
    crit: notable
    conf: 0.75
    if:
      type: metrics
      field: go_metrics.net_dial_count
      min: 1

  - id: go-raw-sockets
    desc: Uses raw socket operations
    crit: suspicious
    conf: 0.85
    if:
      type: metrics
      field: go_metrics.raw_socket_count
      min: 1

  - id: go-http-operations
    desc: Performs HTTP client/server operations
    crit: notable
    conf: 0.7
    if:
      type: metrics
      field: go_metrics.http_usage
      min: 1
