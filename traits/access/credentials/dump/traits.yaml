# Credential Dumping
# MBC: OB0005 (Credential Access) â†’ E1003 (OS Credential Dumping)
# ATT&CK: T1003 (OS Credential Dumping)

traits:
  # Unix password/shadow files
  - id: getpwnam
    description: Read user password database
    criticality: low
    mbc: "E1003.008"
    attack: "T1003.008"
    confidence: 0.7
    condition:
      type: symbol
      pattern: getpwnam
    platforms: [unix, linux, macos]

  - id: getpwuid
    description: Read user password database by UID
    criticality: low
    mbc: "E1003.008"
    attack: "T1003.008"
    confidence: 0.7
    condition:
      type: symbol
      pattern: getpwuid
    platforms: [unix, linux, macos]

  - id: getspnam
    description: Read shadow password file
    criticality: high
    mbc: "E1003.008"
    attack: "T1003.008"
    confidence: 1.0
    condition:
      type: symbol
      pattern: getspnam
    platforms: [linux, unix]
    file_types: [elf]

  - id: shadow-file
    description: Direct shadow file access
    criticality: high
    mbc: "E1003.008"
    attack: "T1003.008"
    confidence: 0.9
    condition:
      type: string
      exact: "/etc/shadow"
    platforms: [linux, unix]

  - id: passwd-file
    description: Password file access
    criticality: medium
    mbc: "E1003.008"
    attack: "T1003.008"
    confidence: 0.6
    condition:
      type: string
      exact: "/etc/passwd"
    platforms: [unix, linux, macos]
