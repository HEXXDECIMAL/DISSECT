# Environment Variable Credential Access
# MBC: OB0005 (Credential Access) â†’ E1552 (Unsecured Credentials)
# ATT&CK: T1552.001 (Unsecured Credentials: Credentials In Files)

traits:
  - id: getenv
    description: Read environment variables (may contain credentials)
    criticality: inert
    mbc: "E1552"
    attack: "T1552"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getenv
    platforms: [all]

  - id: api-key-pattern
    description: API key patterns in environment variables
    criticality: suspicious
    mbc: "E1552"
    attack: "T1552"
    confidence: 0.7
    condition:
      type: string
      regex: "(API_KEY|APIKEY|SECRET_KEY|ACCESS_TOKEN|AUTH_TOKEN)"
      case_insensitive: true

  - id: aws-credentials
    description: AWS credential environment variables
    criticality: suspicious
    mbc: "E1552"
    attack: "T1552"
    confidence: 0.9
    condition:
      type: string
      regex: "(AWS_ACCESS_KEY_ID|AWS_SECRET_ACCESS_KEY|AWS_SESSION_TOKEN)"

  - id: github-token
    description: GitHub token environment variable
    criticality: suspicious
    mbc: "E1552"
    attack: "T1552"
    confidence: 0.9
    condition:
      type: string
      exact: "GITHUB_TOKEN"
