# macOS Keychain Access
# MBC: OB0005 (Credential Access) â†’ E1555 (Credentials from Password Stores)
# ATT&CK: T1555.001 (Credentials from Password Stores: Keychain)

traits:
  - id: sec-find-generic
    description: Read passwords from macOS Keychain
    criticality: high
    mbc: "E1555.001"
    attack: "T1555.001"
    confidence: 0.9
    condition:
      type: symbol
      pattern: SecKeychainFindGenericPassword
    platforms: [macos]
    file_types: [macho, dylib]

  - id: sec-find-internet
    description: Read internet passwords from macOS Keychain
    criticality: high
    mbc: "E1555.001"
    attack: "T1555.001"
    confidence: 0.9
    condition:
      type: symbol
      pattern: SecKeychainFindInternetPassword
    platforms: [macos]
    file_types: [macho, dylib]

  - id: sec-item-copy
    description: Copy Keychain item contents
    criticality: high
    mbc: "E1555.001"
    attack: "T1555.001"
    confidence: 0.95
    condition:
      type: symbol
      pattern: SecKeychainItemCopyContent
    platforms: [macos]
    file_types: [macho, dylib]
