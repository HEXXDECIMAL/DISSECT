traits:
  - id: fake-jquery-vars
    desc: "Detects internal jQuery variable names often used for obfuscation"
    crit: suspicious
    conf: 0.8
    # These are specific internal variables from jQuery 1.x often used by malware
    # to masquerade as the library while performing malicious actions.
    # Source: https://github.com/jquery/jquery/blob/1.x-master/src/data.js
    if:
      type: symbol
      regex: 'deepDataAndEvents|rfocusMorph|fxNow|leadingRelative|rbuggyMatches|rkeyEvent|rattributeQuotes|rmouseEvent|rheaders|rquery'
    downgrade:
      any:
        - id: meta/library/jquery::domain