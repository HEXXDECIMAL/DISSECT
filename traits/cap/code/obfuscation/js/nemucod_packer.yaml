traits:
  - id: nemucod-chunked-array-sequence
    desc: Detects dense sequences of Nemucod's specific 4-byte chunked array calls (e.g. j([1,2,3,4])+j(...)).
    crit: suspicious
    conf: 0.95
    for: [javascript]
    if:
      type: raw
      # Function call with 4-element int array, followed by concatenation, repeated 5+ times.
      regex: '([a-zA-Z0-9_$]+\s*\(\s*\[\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\]\s*\)\s*\+){5,}'
