# PHP Eval Decrypted Content
# Detects eval() being called on the result of a decryption function

traits:
  - id: eval-decrypt-result
    desc: Evaluating result of a decryption function
    crit: suspicious
    conf: 0.8
    for: [php]
    if:
      type: string
      # Matches $var = Decrypt(...); eval($var);
      # or eval(Decrypt(...));
      regex: '(?i)(\$[a-zA-Z0-9_]+\s*=\s*[a-zA-Z0-9_]*Decrypt.*\(.+\);\s*eval\s*\(\s*\$[a-zA-Z0-9_]+\s*\)|eval\s*\(\s*[a-zA-Z0-9_]*Decrypt.*\(.+\)\s*\))'
