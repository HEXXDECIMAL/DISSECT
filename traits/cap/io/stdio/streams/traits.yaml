# Standard I/O Operations
# C runtime stdio operations (fprintf, fwrite, etc.)

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Formatted Output ===
  - id: fprintf
    desc: Formatted file output
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "fprintf"

  - id: vfprintf
    desc: Variadic formatted output
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "vfprintf"

  - id: printf
    desc: Formatted console output
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "printf"

  - id: vprintf
    desc: Variadic formatted console output
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "vprintf"

  # === Raw I/O ===
  # Removed fwrite duplicate - use cap/fs/file/binary::fwrite-func (symbol works across all platforms)
  # Removed fread duplicate - use cap/fs/file/binary::fread-func (symbol works across all platforms)

  - id: fopen
    desc: Open file for stdio
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "fopen"

  - id: fclose
    desc: Close stdio file
    crit: inert
    conf: 0.90
    if:
      type: symbol
      exact: "fclose"

  # === Stream Operations ===
  - id: iob-func
    desc: Get stream buffer array
    crit: inert
    conf: 0.85
    if:
      type: symbol
      exact: "__iob_func"
