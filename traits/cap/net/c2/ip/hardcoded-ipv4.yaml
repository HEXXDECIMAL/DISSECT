traits:
  - id: hardcoded-ipv4
    crit: suspicious
    desc: Hardcoded IPv4 address (network context).
    mbc: C0002
    attack: T1071.001
    for: [all]
    if:
      type: string
      # Match standalone IPv4 literals and only keep routable external addresses.
      regex: '^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$'
      external_ip: true
    not:
      - exact: "192.9.5.5"
      - exact: "123.123.123.123"

  - id: staged-tcp-query
    crit: suspicious
    conf: 0.95
    desc: HTTP staged URL with tcp arch markers.
    mbc: C0002
    attack: T1105
    for: [shell, batch, powershell, javascript]
    if:
      type: string
      regex: '(?i)https?://(?:[0-9]{1,3}\.){3}[0-9]{1,3}:[0-9]{2,5}/\?h=(?:[0-9]{1,3}\.){3}[0-9]{1,3}&p=[0-9]{2,5}&t=tcp&a=w(?:32|64)&stage=true'
