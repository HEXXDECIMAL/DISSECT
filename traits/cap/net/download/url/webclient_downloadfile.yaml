# Detects System.Net.WebClient.DownloadFile usage

defaults:
  crit: notable
  conf: 0.8
  platforms: [windows]

traits:
  - id: webclient-downloadfile
    desc: "Obfuscated System.Net.WebClient.DownloadFile call"
    if:
      type: raw
      regex: "(?i)(?:W.{0,3}e.{0,3}b.{0,3}C.{0,3}l.{0,3}i.{0,3}e.{0,3}n.{0,3}t).*?(?:D.{0,3}o.{0,3}w.{0,3}n.{0,3}l.{0,3}o.{0,3}a.{0,3}d.{0,3}F.{0,3}i.{0,3}l.{0,3}e)"