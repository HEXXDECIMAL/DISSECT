# Process Control via Signals
# ATT&CK: T1489 (Service Stop)

defaults:
  platforms: [linux, macos]
  for: [shell, elf, macho]

traits:
  - id: pkill-stop
    desc: Stop process with SIGSTOP via pkill
    crit: suspicious
    conf: 0.8
    attack: "T1489"
    if:
      type: string
      regex: "pkill\\s+-STOP"

  - id: pkill-continue
    desc: Resume stopped process with SIGCONT via pkill
    crit: notable
    conf: 0.75
    attack: "T1489"
    if:
      type: string
      regex: "pkill\\s+-CONT"

composite_rules:
  - id: process-suspend-resume
    desc: Process suspension and resumption capability
    crit: suspicious
    conf: 0.9
    attack: "T1489"
    all:
      - id: pkill-stop
      - id: pkill-continue
