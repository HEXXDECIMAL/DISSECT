# Process Forking
# MBC: C0017 (Create Process)
# ATT&CK: T1106

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: fork
    desc: Process forking
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: "^(fork|vfork|clone[0-9]?)$"

  - id: daemon
    desc: Daemonize process
    crit: notable
    conf: 0.66
    if:
      type: symbol
      # setsid: use cap/process/create/setsid/traits.yaml::c (canonical)
      exact: "daemon"
