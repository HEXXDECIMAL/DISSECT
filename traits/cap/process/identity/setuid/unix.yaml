# Process Identity - Set User/Group ID (Unix)
# These are capabilities for changing process identity.
# Used legitimately by: setuid binaries, games (for high scores), mail programs,
# daemons dropping privileges, and security tools.
# MBC: C0042 (Modify Security Privileges)

defaults:
  file_types: [elf, macho, so, dylib, c]
  platforms: [linux, macos, unix]

traits:
  - id: setuid
    description: Set user ID (capability)
    crit: notable
    confidence: 0.6
    condition:
      type: symbol
      pattern: "^(setuid|seteuid|setreuid|setresuid)$"

  - id: setgid
    description: Set group ID (capability)
    crit: notable
    confidence: 0.6
    condition:
      type: symbol
      pattern: "^(setgid|setegid|setregid|setresgid)$"

  - id: drop-privs
    description: Drop privileges (setuid after getuid)
    crit: inert
    confidence: 0.8
    condition:
      type: symbol
      pattern: "^(setuid|setgid|seteuid|setegid)$"
