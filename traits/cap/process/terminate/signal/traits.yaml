# Process Termination and Signal Handling Traits
# MBC: OC0003 (Defense Evasion) / OB0006 (Execution)
# ATT&CK: T1562 (Impair Defenses) / T1059 (Command and Scripting Interpreter)

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # Signal sending
  - id: kill
    desc: Send signal to process (terminate,
    crit: notable
    mbc: "E1562"
    attack: "T1562"
    conf: 0.6
    if:
      type: symbol
      exact: kill
    platforms: [unix, linux, macos]

  - id: killpg
    desc: Send signal to process group
    crit: notable
    mbc: "E1562"
    attack: "T1562"
    conf: 0.7
    if:
      type: symbol
      exact: killpg
    platforms: [unix, linux, macos]

  # Signal handling
  - id: signal
    desc: Install signal handler (catch or
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    conf: 0.6
    if:
      type: symbol
      exact: signal
    platforms: [unix, linux, macos]

  - id: sigaction
    desc: Examine or change signal action
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    conf: 0.6
    if:
      type: symbol
      exact: sigaction
    platforms: [unix, linux, macos]

  - id: sigprocmask
    desc: Examine or change blocked signals
    crit: notable
    mbc: "F0004"
    attack: "T1562.001"
    conf: 0.6
    if:
      type: symbol
      exact: sigprocmask
    platforms: [unix, linux, macos]

  # Process termination
  - id: abort
    desc: Cause abnormal process termination
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    conf: 0.4
    if:
      type: symbol
      exact: abort
    platforms: [unix, linux, macos, windows]

  - id: exit
    desc: Terminate process with status code
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    conf: 0.3
    if:
      type: symbol
      exact: exit
    platforms: [unix, linux, macos, windows]

  - id: _exit
    desc: Terminate process immediately without cleanup
    crit: inert
    mbc: "E1562"
    attack: "T1562"
    conf: 0.4
    if:
      type: symbol
      exact: _exit
    platforms: [unix, linux, macos]
