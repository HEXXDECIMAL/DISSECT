# Window Management Operations
# Window creation, positioning, and manipulation

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Window Creation ===
  - id: register-class
    desc: Register window class
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "RegisterClassW"

  - id: get-class-info
    desc: Get window class information
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetClassInfoW"

  - id: create-window-ex
    desc: Create window (extended)
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "CreateWindowExW"

  - id: destroy-window
    desc: Destroy window
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "DestroyWindow"

  # === Window State ===
  - id: show-window
    desc: Show or hide window
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "ShowWindow"

  - id: set-window-pos
    desc: Change window position/size
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetWindowPos"

  - id: set-foreground-window
    desc: Bring window to foreground
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetForegroundWindow"

  # === Window Information ===
  - id: is-window
    desc: Check if window exists
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "IsWindow"

  - id: is-window-visible
    desc: Check if window is visible
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "IsWindowVisible"

  - id: get-window-rect
    desc: Get window rectangle
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetWindowRect"

  - id: screen-to-client
    desc: Convert screen to client coordinates
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "ScreenToClient"

  - id: set-window-text
    desc: Set window title/text
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetWindowTextW"

  - id: get-window-long
    desc: Get window data
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetWindowLongW"

  - id: set-window-long
    desc: Set window data
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetWindowLongW"

  - id: set-class-long
    desc: Set window class data
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetClassLongW"

  - id: is-window-enabled
    desc: Check if window is enabled
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "IsWindowEnabled"

  - id: enable-window
    desc: Enable/disable window
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "EnableWindow"

  - id: invalidate-rect
    desc: Invalidate window region
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "InvalidateRect"

  # === Window Finding/Messaging ===
  - id: find-window-ex
    desc: Find window by class/title
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "FindWindowExW"

  - id: send-message
    desc: Send message to window
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SendMessageW"

  - id: send-message-timeout
    desc: Send message with timeout
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SendMessageTimeoutW"

  - id: peek-message
    desc: Peek at message queue
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "PeekMessageW"

  - id: dispatch-message
    desc: Dispatch window message
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "DispatchMessageW"

  # === Timers ===
  - id: set-timer
    desc: Create window timer
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SetTimer"

  # === Dialogs ===
  - id: get-dc
    desc: Get device context
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetDC"

  - id: release-dc
    desc: Release device context
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "ReleaseDC"

  - id: call-window-proc
    desc: Call window procedure
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "CallWindowProcW"

  - id: def-window-proc
    desc: Default window procedure
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "DefWindowProcW"

  - id: post-quit-message
    desc: Post quit message
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "PostQuitMessage"

  - id: get-message-pos
    desc: Get message cursor position
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetMessagePos"

  # === Character Input ===
  - id: char-next
    desc: Move to next character
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "CharNextW"

  - id: char-prev
    desc: Move to previous character
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "CharPrevW"

  # === Message Box ===
  - id: message-box-indirect
    desc: Custom message box
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "MessageBoxIndirectW"

  - id: exit-windows-ex
    desc: Shutdown/restart system
    crit: suspicious
    conf: 0.85
    if:
      type: symbol
      exact: "ExitWindowsEx"
