# Menu Operations
# Context menu and popup menu manipulation

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Menu Creation ===
  - id: create-popup-menu
    desc: Create popup/context menu
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "CreatePopupMenu"

  # === Menu Item Operations ===
  - id: append-menu
    desc: Add item to menu
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "AppendMenuW"

  - id: track-popup-menu
    desc: Display popup menu
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "TrackPopupMenu"

  # === System Menu ===
  - id: get-system-menu
    desc: Get window system menu
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetSystemMenu"

  - id: enable-menu-item
    desc: Enable/disable menu item
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "EnableMenuItem"
