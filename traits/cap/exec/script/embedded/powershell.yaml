# PowerShell Variables in Non-PowerShell Files
# Detects PowerShell variable syntax in JavaScript or other non-PS files

traits:
  - id: powershell-vars-in-javascript
    desc: "PowerShell variables in JavaScript strings"
    crit: suspicious
    conf: 0.9
    for: [javascript, typescript]
    if:
      type: raw
      regex: '\$[a-zA-Z]{5}'
      count_min: 5
    not:
      - "$xdOMA"
      - "$GETkE"

  - id: powershell-cmdlet-patterns
    desc: "PowerShell cmdlet naming pattern in non-PS code"
    crit: suspicious
    conf: 0.8
    for: [javascript, typescript, python]
    if:
      type: string
      regex: 'Out-File|Get-Content|Invoke-Expression|Start-Process'
      count_min: 1
    unless:
      - type: string
        regex: 'SyntaxHighlighter'
