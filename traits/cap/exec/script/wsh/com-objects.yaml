# Windows Script Host Traits
# Detects WSH-specific patterns
# Note: COM object detections are in cap/exec/activex/com/ to avoid duplication

traits:
  - id: wscript-exe
    desc: "Reference to wscript.exe script host"
    crit: notable
    conf: 0.6
    attack: "T1059.007"
    for: [javascript]
    platforms: [windows]
    if:
      type: string
      substr: "wscript.exe"

  - id: execution-policy-bypass
    desc: "PowerShell execution policy bypass"
    crit: suspicious
    conf: 0.95
    attack: "T1059.001"
    for: [javascript, powershell]
    platforms: [windows]
    if:
      type: string
      regex: 'ExecutionPolicy\s+(Bypass|Unrestricted)'
    downgrade:
      any:
        - type: raw
          substr: "require('../common')"
        - type: raw
          regex: "Copyright.*Node contributors"
