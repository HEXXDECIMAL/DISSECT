# Script File Execution
# Detects execution of script files (.sh, .bat, .ps1, etc.)
# ATT&CK: T1059

traits:
  - id: shell-script-execution
    desc: Executes a shell script file (.sh)
    crit: notable
    conf: 0.7
    attack: T1059.004
    if:
      type: string
      regex: "\\.sh$"

  - id: batch-script-execution
    desc: Executes a batch script file (.bat)
    crit: notable
    conf: 0.7
    attack: T1059.003
    if:
      type: string
      regex: "\\.bat$"

  - id: powershell-script-execution
    desc: Executes a PowerShell script file (.ps1)
    crit: notable
    conf: 0.7
    attack: T1059.001
    if:
      type: string
      regex: "\\.ps1$"