traits:
  - id: shell-symbols
    desc: Shell execution symbols
    crit: notable
    conf: 0.9
    if:
      type: symbol
      regex: "^(system|popen|execl|execle|execlp|execv|execve|execvp|execvpe)$"

  - id: go-shell-strings
    desc: Go shell execution strings
    crit: notable
    conf: 0.9
    if:
      type: string
      regex: 'exec\.\(\*Cmd\)\.Run|os/exec\.Command'

composite_rules:
  - id: go-shell-execution
    desc: Shell command execution (Go)
    crit: notable
    conf: 0.9
    any:
      - id: shell-symbols
      - id: go-shell-strings
