---
# Ruby command execution patterns

traits:
  - id: ruby-exec
    desc: exec() replaces current process
    crit: notable
    conf: 0.95
    platforms: [all]
    for: [ruby]
    if:
      type: symbol
      regex: "^(_)?exec$"

  - id: ruby-system
    desc: system() executes command
    crit: notable
    conf: 0.95
    platforms: [all]
    for: [ruby]
    if:
      type: symbol
      regex: "^(_)?system$"

  - id: ruby-spawn
    desc: spawn() creates new process
    crit: notable
    conf: 0.90
    platforms: [all]
    for: [ruby]
    if:
      type: symbol
      regex: "^(_)?spawn$"

  - id: ruby-popen
    desc: popen pipes to/from command
    crit: notable
    conf: 0.92
    platforms: [all]
    for: [ruby]
    if:
      type: symbol
      regex: "^(_)?(IO\\.)?popen$"

  - id: ruby-backtick
    desc: Backtick command execution
    crit: notable
    conf: 0.93
    platforms: [all]
    for: [ruby]
    if:
      type: symbol
      regex: "`|%x"

  - id: ruby-shell-exec
    desc: Shell execution via exec
    crit: notable
    conf: 0.85
    platforms: [all]
    for: [ruby]
    if:
      type: string
      regex: 'exec.{0,50}bin/sh|exec.{0,50}bin/bash'
