# Process detachment / daemonization
# MBC: F0003 (Process Detach)

traits:
  - id: python
    desc: "Detaches process via os.setsid"
    crit: suspicious
    conf: 0.9
    mbc: "F0003"
    attack: "T1036"
    for: [python]
    if:
      type: raw
      substr: "os.setsid"

  - id: preexec-fn
    desc: "Manipulates process via subprocess preexec_fn"
    crit: suspicious
    conf: 0.85
    mbc: "F0003"
    for: [python]
    if:
      type: raw
      substr: "preexec_fn="

  - id: c
    desc: "Calls setsid() system call"
    crit: notable
    conf: 0.8
    mbc: "F0003"
    for: [c]
    if:
      type: symbol
      pattern: setsid
