defaults:
  for: [macho, elf, pe]

traits:
  # NOTE: fgets-loop moved to cap/fs/file-ops/ as it's file I/O, not command execution.
  # Keeping ID reference for backwards compatibility in composite rules.
  - id: fgets-loop
    desc: "Line-based file reading (fgets)"
    crit: inert
    if:
      type: symbol
      exact: fgets

  - id: string-append
    desc: "Capturing data into C++ std::string"
    crit: inert
    if:
      type: symbol
      regex: "std::__1::basic_string.{0,50}(append|push_back|operator\\+=)"

  - id: popen-call
    desc: "Executes command via popen"
    crit: notable
    if:
      type: symbol
      regex: "popen"
