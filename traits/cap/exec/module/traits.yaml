# Module Enumeration Capabilities
# Runtime module and library enumeration

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Module Lookup ===
  - id: get-module-handle-by-name
    desc: Get module handle Unicode
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetModuleHandleW"

  - id: get-module-handle-ansi
    desc: Get module handle ANSI
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetModuleHandleA"

  - id: get-module-filename
    desc: Get module file path
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetModuleFileNameW"

  - id: get-module-filename-ansi
    desc: Get module file path (ANSI)
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetModuleFileNameA"

  # === Dynamic Loading ===
  - id: load-library-ex
    desc: Load library with flags
    crit: notable
    conf: 0.75
    if:
      type: symbol
      exact: "LoadLibraryExW"

  - id: load-library
    desc: Load dynamic library
    crit: notable
    conf: 0.75
    if:
      type: symbol
      exact: "LoadLibraryW"

  - id: free-library
    desc: Unload dynamic library
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "FreeLibrary"

  # === Process Information ===
  - id: get-current-process
    desc: Get current process handle
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetCurrentProcess"

  - id: get-current-process-id
    desc: Get current process ID
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetCurrentProcessId"
