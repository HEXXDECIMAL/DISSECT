# Raw Memory Access - Linux
# ATT&CK: T1003 (OS Credential Dumping)

traits:
  - id: kmem
    description: Access raw kernel memory (/dev/kmem)
    crit: suspicious
    conf: 0.9
    attack: "T1003"
    platforms: [linux, unix]
    if:
      type: string
      exact: "/dev/kmem"

  - id: dev-mem
    description: Access raw system memory (/dev/mem)
    crit: suspicious
    conf: 0.9
    attack: "T1003"
    platforms: [linux]
    if:
      type: string
      exact: "/dev/mem"
    # X11 DGA (Direct Graphics Access) libraries legitimately use /dev/mem
    # for direct video memory access - this is core DGA functionality
    downgrade:
      any:
        - id: cap/exec/load/x11-ref
        - id: cap/exec/load/x11-dga-marker

  # === Memdump atomic indicators ===
  - id: memdump-cmd
    description: memdump command reference
    crit: notable
    conf: 0.65
    attack: "T1003"
    platforms: [all]
    if:
      type: string
      word: "memdump"

  - id: dumpmem-cmd
    description: dumpmem command reference
    crit: notable
    conf: 0.65
    attack: "T1003"
    platforms: [all]
    if:
      type: string
      word: "dumpmem"

composite_rules:
  # Memdump composite
  - id: memdump-ref
    description: Memory dump utility reference
    crit: suspicious
    conf: 0.75
    attack: "T1003"
    platforms: [all]
    count_min: 1
    any:
      - id: memdump-cmd
      - id: dumpmem-cmd
