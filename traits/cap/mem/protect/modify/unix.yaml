# Memory Protection - Unix
# ATT&CK: T1055 (Process Injection)

traits:
  - id: mprotect
    desc: Change memory protection (mprotect)
    crit: notable
    conf: 1.0
    attack: "T1055"
    platforms: [linux, macos, unix]
    for: [elf, macho, so, dylib, c]
    if:
      type: symbol
      regex: "^_?mprotect$"

  - id: mprotect-string
    desc: mprotect reference in source/script
    crit: notable
    conf: 0.7
    attack: "T1055"
    platforms: [linux, macos, unix]
    for: [python, shell, c]
    if:
      type: string
      substr: "mprotect"

  - id: rwx-prot-bytes
    desc: RWX protection bytes (PROT_READ|WRITE|EXEC =
    crit: inert
    conf: 0.6
    attack: "T1055"
    platforms: [linux, macos, unix]
    for: [elf, macho, so, dylib]
    if:
      type: hex
      pattern: "07 00 00 00"
