# Windows-specific Environment Variables
# MBC: C0034 (Environment Variable)
# ATT&CK: T1548.002 (Abuse Elevation Control Mechanism: Bypass User Account Control)

defaults:
  platforms: [windows]

traits:
  - id: uac-bypass-compact-layer
    desc: UAC bypass via __COMPACT_LAYER=RunAsInvoker
    crit: suspicious
    conf: 0.95
    for: [shell, batch, python, powershell, pe, dll]
    if:
      type: raw
      regex: "__COMPACT_LAYER=RunAsInvoker"
      case_insensitive: true

  - id: comspec-env-var
    desc: Accesses ComSpec environment variable
    crit: notable
    conf: 0.8
    for: [javascript, typescript, vbs, batch, pe, dll]
    if:
      type: string
      substr: "ComSpec"

  - id: temp-env-var
    desc: "Contains %TEMP% environment variable string"
    crit: notable
    if:
      type: string
      regex: '%TEMP%'
      case_insensitive: true

