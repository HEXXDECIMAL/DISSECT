# APT Package Manager Configuration Traits
# Detects manipulation of APT keys and repositories

traits:
  - id: apt-key-add
    desc: Adds a trusted key via apt-key
    crit: notable
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: 'apt-key\s+add'
    attack: "T1098"

  - id: apt-key-export
    desc: Exports a trusted key via apt-key
    crit: inert
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: 'apt-key\s+export'

  - id: apt-sources-list-write
    desc: Writes to APT sources list
    crit: notable
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: '/etc/apt/sources\.list'
    attack: "T1072"# APT Package Manager Configuration Traits
# Detects manipulation of APT keys and repositories

traits:
  - id: apt-key-add
    desc: Adds a trusted key via apt-key
    crit: notable
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: 'apt-key\s+add'
    attack: "T1098"

  - id: apt-key-export
    desc: Exports a trusted key via apt-key
    crit: inert
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: 'apt-key\s+export'

  - id: apt-sources-list-write
    desc: Writes to APT sources list
    crit: notable
    conf: 0.8
    for: [shell, elf]
    if:
      type: raw
      regex: '/etc/apt/sources\.list'
    attack: "T1072"