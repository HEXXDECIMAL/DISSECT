# System Name and Information Functions
# Basic POSIX functions for querying system identity
# MBC: E1082 (System Information Discovery)
# ATT&CK: T1082 (System Information Discovery)

defaults:
  for: [elf, macho, so, dylib, c]
  crit: inert
  mbc: "E1082"
  attack: "T1082"

traits:
  - id: uname
    desc: Query system name and information
    conf: 0.6
    if:
      type: symbol
      regex: uname
    platforms: [unix, linux, macos]

  - id: gethostname
    desc: Get hostname of current machine
    conf: 0.5
    if:
      type: symbol
      regex: gethostname
    platforms: [unix, linux, macos, windows]

  - id: getdomainname
    desc: Get NIS domain name
    conf: 0.5
    if:
      type: symbol
      regex: getdomainname
    platforms: [unix, linux, macos]

  - id: getfqdn
    desc: Get fully qualified domain name
    conf: 0.5
    if:
      type: string
      substr: "getfqdn"
    platforms: [unix, linux, macos]
