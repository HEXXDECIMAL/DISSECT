# Windows Message Queue Operations
# Inter-thread communication via message queues

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Message Queue Reading ===
  - id: peek-message-a
    desc: Peek message (ANSI)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "PeekMessageA"

  - id: peek-message-w
    desc: Peek message (Unicode)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "PeekMessageW"

  - id: get-message-a
    desc: Get message (ANSI)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "GetMessageA"

  - id: get-message-w
    desc: Get message (Unicode)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "GetMessageW"

  # === Message Queue Posting ===
  - id: post-thread-message-a
    desc: Post message to thread (ANSI)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "PostThreadMessageA"

  - id: post-thread-message-w
    desc: Post message to thread (Unicode)
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "PostThreadMessageW"

  - id: post-message
    desc: Post message to window
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "PostMessageA"
