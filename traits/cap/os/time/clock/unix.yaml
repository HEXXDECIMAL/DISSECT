# Time and Clock Access
# MBC: B0028 (Time Discovery)
# NOTE: Go runtime uses all of these functions legitimately for its scheduler
# and time package. Downgraded to inert to avoid false positives.

defaults:
  file_types: [elf, macho, so, dylib, c]

traits:
  - id: get
    description: Get system time
    crit: inert
    confidence: 0.3
    condition:
      type: symbol
      pattern: gettimeofday|clock_gettime|time

  - id: local
    description: Convert to local time
    crit: inert
    confidence: 0.3
    condition:
      type: symbol
      pattern: localtime|gmtime|strftime

  - id: alarm
    description: Set alarm timer
    crit: inert
    confidence: 0.3
    condition:
      type: symbol
      pattern: alarm|setitimer|timer_create
