# Time and Clock Access
# MBC: B0028 (Time Discovery)
# NOTE: Go runtime uses all of these functions legitimately for its scheduler
# and time package. Downgraded to inert to avoid false positives.

defaults:
  r#for: [elf, macho, so, dylib, c]

traits:
  - id: get
    desc: Get system time
    crit: inert
    conf: 0.3
    if:
      type: symbol
      regex: gettimeofday|clock_gettime|time

  - id: local
    desc: Convert to local time
    crit: inert
    conf: 0.3
    if:
      type: symbol
      regex: localtime|gmtime|strftime

  - id: alarm
    desc: Set alarm timer
    crit: inert
    conf: 0.3
    if:
      type: symbol
      regex: alarm|setitimer|timer_create
