# C# Time-based Trigger Traits
# objective: time, behavior: trigger (potential logic bombs)

traits:
  - id: datetime-now
    description: Current time access (potential time-based
    crit: inert
    mbc: "B0003"
    confidence: 0.6
    condition:
      type: ast
      node: member_access_expression
      exact: "DateTime.Now"
    file_types: [csharp]

  - id: datetime-utcnow
    description: Current UTC time access
    crit: inert
    mbc: "B0003"
    confidence: 0.6
    condition:
      type: ast
      node: member_access_expression
      exact: "DateTime.UtcNow"
    file_types: [csharp]

  - id: hardcoded-datetime
    description: Hardcoded date/time value (potential logic
    crit: notable
    mbc: "B0003"
    attack: "T1480.001"
    confidence: 0.75
    condition:
      type: ast
      node: object_creation_expression
      exact: "new DateTime"
    file_types: [csharp]
