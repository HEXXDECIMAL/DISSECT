# C# Time-based Trigger Traits
# objective: time, behavior: trigger (potential logic bombs)

traits:
  - id: datetime-now
    desc: Current time access (potential time-based
    crit: inert
    mbc: "B0003"
    conf: 0.6
    if:
      type: ast
      node: member_access_expression
      exact: "DateTime.Now"
    for: [csharp]

  - id: datetime-utcnow
    desc: Current UTC time access
    crit: inert
    mbc: "B0003"
    conf: 0.6
    if:
      type: ast
      node: member_access_expression
      exact: "DateTime.UtcNow"
    for: [csharp]

  - id: hardcoded-datetime
    desc: Hardcoded date/time value (potential logic
    crit: notable
    mbc: "B0003"
    attack: "T1480.001"
    conf: 0.75
    if:
      type: ast
      node: object_creation_expression
      exact: "new DateTime"
    for: [csharp]
