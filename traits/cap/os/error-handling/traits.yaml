# Error Handling Operations
# Error suppression and handling mechanisms

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Error Mode ===
  - id: set-error-mode
    desc: Suppress error dialogs
    crit: suspicious
    conf: 0.80
    if:
      type: symbol
      exact: "SetErrorMode"

  - id: get-last-error
    desc: Get system error code
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "GetLastError"

  # === Process Error Handling ===
  - id: unhandled-exception-filter
    desc: Handle unhandled exceptions
    crit: notable
    conf: 0.80
    if:
      type: symbol
      exact: "UnhandledExceptionFilter"

  - id: set-unhandled-exception-filter
    desc: Register exception handler
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "SetUnhandledExceptionFilter"
