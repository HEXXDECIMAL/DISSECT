# System Administration Tools Detection
# Benign baseline for ML differentiation

traits:
  # System monitoring tools
  - id: monitoring
    desc: System monitoring utilities
    crit: inert
    conf: 0.9
    if:
      type: string
      # Match specific monitoring tool paths or command invocations
      regex: "(?:/usr/bin/(?:htop|atop|iotop|iftop|vmstat|iostat|mpstat|sar|lscpu|lsmem|lsblk)|\\b(?:htop|atop|iotop|iftop|vmstat|iostat|mpstat|lscpu|lsmem|lsblk)\\s+-)"

  # Package management
  - id: package-mgmt
    desc: Package management utilities
    crit: notable
    conf: 0.9
    if:
      type: yara
      source: |
        rule package_management {
          strings:
            // Debian/Ubuntu - require command context, not file extensions
            $apt1 = "apt-get" ascii
            $apt2 = /apt (install|remove|update|upgrade|purge|search|list|show)/ ascii
            $apt3 = /dpkg (-|--|\s+-)/ ascii
            // Red Hat/CentOS
            $yum1 = /yum (install|remove|update|search|list)/ ascii
            $yum2 = /dnf (install|remove|update|search|list)/ ascii
            $rpm1 = /rpm (-|--|\s+-)/ ascii
            // Generic
            $pkg1 = /pkg (install|delete|add|remove)/ ascii
            $pkg2 = /pacman (-S|-R|-Q|-U)/ ascii
            $pkg3 = "zypper" ascii
          condition:
            any of them
        }

  # System configuration
  - id: config
    desc: System configuration utilities
    crit: notable
    conf: 0.9
    if:
      type: yara
      source: |
        rule sysadmin_config {
          strings:
            // Service management
            $svc1 = "systemctl" ascii
            $svc2 = "service " ascii
            $svc3 = "chkconfig" ascii
            // User management
            $usr1 = "useradd" ascii
            $usr2 = "usermod" ascii
            $usr3 = "passwd" ascii
            // Network config
            $net1 = "nmcli" ascii
            $net2 = "netplan" ascii
            $net3 = "ip addr" ascii
          condition:
            any of them
        }

  # Log analysis
  - id: logs
    desc: Log analysis utilities
    crit: inert
    conf: 0.9
    if:
      type: string
      # Match specific log analysis commands or log paths
      regex: "(?:/usr/bin/(?:journalctl|dmesg|multitail)|\\bjournalctl\\s+-|\\btail\\s+-f\\s+/var/log|/var/log/(?:syslog|messages|auth\\.log))"
