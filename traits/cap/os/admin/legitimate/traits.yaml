# Legitimate System Administration Traits
# These traits indicate normal administrative operations
# Useful for differential analysis to reduce false positives

# === ATOMIC TRAITS ===
traits:
  # === systemd management patterns ===
  - id: systemctl-status
    desc: systemctl status command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemctl status"

  - id: systemctl-show
    desc: systemctl show command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemctl show"

  - id: systemctl-list
    desc: systemctl list command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemctl list"

  - id: systemctl-is-active
    desc: systemctl is-active command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemctl is-active"

  - id: systemctl-is-enabled
    desc: systemctl is-enabled command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemctl is-enabled"

  - id: journalctl-command
    desc: journalctl command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "journalctl"

  - id: systemd-journal-ref
    desc: systemd-journal reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemd-journal"

  - id: systemd-dbus-interface
    desc: org.freedesktop.systemd1 D-Bus interface
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "org.freedesktop.systemd1"

  - id: dbus-get-unit
    desc: GetUnit D-Bus method
    crit: inert
    conf: 0.6
    if:
      type: string
      word: "GetUnit"

  # === cron management patterns ===
  - id: crontab-list
    desc: crontab -l command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "crontab -l"

  - id: crontab-edit
    desc: crontab -e command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "crontab -e"

  - id: cron-d-path
    desc: /etc/cron.d/ path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/etc/cron.d/"

  - id: crontab-file
    desc: /etc/crontab file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/etc/crontab"

  - id: cron-spool-path
    desc: /var/spool/cron path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/spool/cron"

  - id: at-command-time
    desc: "at command with time specification"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      regex: "\\bat\\s+[-+\\d]"

  - id: at-command-now
    desc: "at now command"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      regex: "\\bat\\s+now"

  - id: at-command-timespec
    desc: "at command with timespec"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      regex: "\\bat\\s+\\w+"

  - id: atq-command
    desc: atq command (list at jobs)
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "atq"

  - id: batch-command
    desc: batch command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "batch"

  # === package management patterns ===
  - id: apt-get-command
    desc: apt-get command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "apt-get"

  - id: apt-install
    desc: apt install command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "apt install"

  - id: dpkg-command
    desc: dpkg command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "dpkg"

  - id: dpkg-lib-path
    desc: /var/lib/dpkg path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/lib/dpkg"

  - id: yum-install
    desc: yum install command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "yum install"

  - id: dnf-install
    desc: dnf install command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "dnf install"

  - id: rpm-command
    desc: "rpm - command"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "rpm -"

  - id: apk-add
    desc: apk add command (Alpine)
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "apk add"

  - id: pacman-install
    desc: pacman -S command (Arch)
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "pacman -S"

  - id: apt-cache-path
    desc: /var/cache/apt path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/cache/apt"

  - id: rpm-lib-path
    desc: /var/lib/rpm path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/lib/rpm"

  # === log management patterns ===
  - id: var-log-path
    desc: /var/log/ path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/log/"

  - id: syslog-ref
    desc: syslog reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "syslog"

  - id: logrotate-command
    desc: logrotate command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "logrotate"

  - id: rsyslog-ref
    desc: rsyslog reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "rsyslog"

  - id: syslog-ng-ref
    desc: syslog-ng reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "syslog-ng"

  - id: tail-follow
    desc: tail -f command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "tail -f"

  - id: less-command
    desc: "less command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      exact: "less "

  # === user management patterns ===
  - id: useradd-command
    desc: useradd command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "useradd"

  - id: usermod-command
    desc: usermod command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "usermod"

  - id: userdel-command
    desc: userdel command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "userdel"

  - id: adduser-command
    desc: adduser command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "adduser"

  - id: groupadd-command
    desc: groupadd command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "groupadd"

  - id: groupmod-command
    desc: groupmod command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "groupmod"

  - id: passwd-command
    desc: passwd command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "passwd"

  - id: chpasswd-command
    desc: chpasswd command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "chpasswd"

  - id: sudo-command
    desc: sudo command
    crit: notable
    conf: 0.5
    for: [shell]
    if:
      type: string
      word: "sudo"

  # === network configuration patterns ===
  - id: ip-addr-command
    desc: ip addr command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ip addr"

  - id: ip-route-command
    desc: ip route command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ip route"

  - id: ip-link-command
    desc: ip link command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ip link"

  - id: ifconfig-command
    desc: ifconfig command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "ifconfig"

  - id: ifup-command
    desc: ifup command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "ifup"

  - id: ifdown-command
    desc: ifdown command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "ifdown"

  - id: nmcli-command
    desc: nmcli command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "nmcli"

  - id: network-manager-ref
    desc: NetworkManager reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "NetworkManager"

  - id: resolvconf-command
    desc: resolvconf command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "resolvconf"

  - id: systemd-resolved-ref
    desc: systemd-resolved reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "systemd-resolved"

  - id: iptables-command
    desc: iptables command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "iptables"

  - id: nftables-command
    desc: nftables command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "nftables"

  - id: firewalld-service
    desc: firewalld service
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "firewalld"

  # === filesystem operations patterns ===
  - id: mount-command
    desc: "mount command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "mount "

  - id: umount-command
    desc: umount command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "umount"

  - id: fstab-file
    desc: /etc/fstab file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/etc/fstab"

  - id: lvcreate-command
    desc: lvcreate command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "lvcreate"

  - id: lvextend-command
    desc: lvextend command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "lvextend"

  - id: pvcreate-command
    desc: pvcreate command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "pvcreate"

  - id: mkfs-command
    desc: mkfs command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "mkfs"

  - id: fsck-command
    desc: fsck command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "fsck"

  - id: resize2fs-command
    desc: resize2fs command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "resize2fs"

  - id: fdisk-command
    desc: fdisk command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "fdisk"

  - id: parted-command
    desc: parted command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "parted"

  # === backup operations patterns ===
  - id: tar-command
    desc: "tar - command"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "tar -"

  - id: rsync-command
    desc: rsync command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "rsync"

  - id: cp-archive
    desc: cp -a command (archive mode)
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "cp -a"

  - id: dd-if-pattern
    desc: "dd if= pattern"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "dd if="

  - id: dump-command
    desc: dump command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "dump"

  - id: restore-command
    desc: restore command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "restore"

  - id: borg-command
    desc: "borg command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      exact: "borg "

  - id: restic-command
    desc: restic command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "restic"

  - id: duplicity-command
    desc: duplicity command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "duplicity"

  - id: backup-keyword
    desc: backup keyword
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "backup"
      case_insensitive: true

  # === process management patterns ===
  - id: ps-aux-command
    desc: ps aux command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ps aux"

  - id: ps-ef-command
    desc: ps -ef command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ps -ef"

  - id: top-command
    desc: "top - command"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "top -"

  - id: htop-command
    desc: htop command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "htop"

  - id: kill-sigkill
    desc: kill -9 command (SIGKILL)
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "kill -9"

  - id: killall-command
    desc: killall command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "killall"

  - id: nice-command
    desc: "nice command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      exact: "nice "

  - id: cp-command
    desc: cp command
    crit: inert
    conf: 0.5
    for: [shell]
    if:
      type: string
      regex: "\\bcp\\s"

  - id: renice-command
    desc: renice command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "renice"

  - id: proc-loadavg
    desc: /proc/loadavg file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/proc/loadavg"

  - id: proc-meminfo
    desc: /proc/meminfo file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/proc/meminfo"

  # === SSH administration patterns ===
  - id: sshd-config-file
    desc: sshd_config file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "sshd_config"

  - id: etc-ssh-path
    desc: /etc/ssh/ path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/etc/ssh/"

  - id: ssh-keygen-command
    desc: ssh-keygen command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ssh-keygen"

  - id: ssh-copy-id-command
    desc: ssh-copy-id command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ssh-copy-id"

  - id: authorized-keys-file
    desc: authorized_keys file
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "authorized_keys"

  - id: ssh-command
    desc: "ssh - command"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "ssh -"

  - id: scp-command
    desc: "scp command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      exact: "scp "

  - id: sftp-command
    desc: sftp command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "sftp"

  # === container management patterns ===
  - id: docker-command
    desc: "docker command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "docker "

  - id: docker-compose-command
    desc: docker-compose command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "docker-compose"

  - id: docker-sock-path
    desc: /var/run/docker.sock path
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "/var/run/docker.sock"

  - id: podman-command
    desc: "podman command (with space)"
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "podman "

  - id: buildah-command
    desc: buildah command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "buildah"

  - id: kubectl-command
    desc: kubectl command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "kubectl"

  - id: kubelet-command
    desc: kubelet command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "kubelet"

  - id: kubeadm-command
    desc: kubeadm command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "kubeadm"

  - id: crictl-command
    desc: crictl command
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "crictl"

  # === monitoring tool patterns ===
  - id: prometheus-ref
    desc: prometheus reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "prometheus"

  - id: node-exporter-ref
    desc: node_exporter reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      substr: "node_exporter"

  - id: alertmanager-ref
    desc: alertmanager reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "alertmanager"

  - id: grafana-ref
    desc: grafana reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "grafana"

  - id: nagios-ref
    desc: nagios reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "nagios"

  - id: zabbix-ref
    desc: zabbix reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "zabbix"

  - id: icinga-ref
    desc: icinga reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "icinga"

  - id: elasticsearch-ref
    desc: elasticsearch reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "elasticsearch"

  - id: logstash-ref
    desc: logstash reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "logstash"

  - id: fluentd-ref
    desc: fluentd reference
    crit: inert
    conf: 0.6
    for: [shell]
    if:
      type: string
      word: "fluentd"

# === COMPOSITE RULES ===
composite_rules:
  # systemd management
  - id: systemctl-commands
    desc: systemctl commands
    for: [shell]
    any:
      - {id: systemctl-status}
      - {id: systemctl-show}
      - {id: systemctl-list}
      - {id: systemctl-is-active}
      - {id: systemctl-is-enabled}

  - id: systemd-journal-tools
    desc: systemd journal tools
    for: [shell]
    any:
      - {id: journalctl-command}
      - {id: systemd-journal-ref}

  - id: systemd-dbus-api
    desc: systemd D-Bus API usage
    all:
      - {id: systemd-dbus-interface}
      - {id: dbus-get-unit}

  - id: systemd-management
    desc: Legitimate systemd service management
    crit: benign
    conf: 0.75
    for: [shell]
    any:
      - {id: systemctl-commands}
      - {id: systemd-journal-tools}
      - {id: systemd-dbus-api}

  # cron management
  - id: cron-commands
    desc: cron commands and paths
    for: [shell]
    any:
      - {id: crontab-list}
      - {id: crontab-edit}
      - {id: cron-d-path}
      - {id: crontab-file}
      - {id: cron-spool-path}

  - id: at-commands
    desc: at scheduling commands
    for: [shell]
    any:
      - {id: at-command-time}
      - {id: at-command-now}
      - {id: at-command-timespec}
      - {id: atq-command}
      - {id: batch-command}

  - id: cron-management
    desc: Legitimate cron job management
    crit: benign
    conf: 0.7
    for: [shell]
    any:
      - {id: cron-commands}
      - {id: at-commands}

  # package management
  - id: package-management
    desc: Legitimate package management operations
    crit: benign
    conf: 0.85
    for: [shell]
    any:
      - {id: apt-get-command}
      - {id: apt-install}
      - {id: dpkg-command}
      - {id: dpkg-lib-path}
      - {id: yum-install}
      - {id: dnf-install}
      - {id: rpm-command}
      - {id: apk-add}
      - {id: pacman-install}
      - {id: apt-cache-path}
      - {id: rpm-lib-path}

  # log management
  - id: log-viewers
    desc: Log viewing commands
    for: [shell]
    any:
      - {id: tail-follow}
      - {id: less-command}
      - {id: journalctl-command}

  - id: log-with-viewer
    desc: Log path with viewing command
    for: [shell]
    all:
      - {id: var-log-path}
      - {id: log-viewers}

  - id: syslog-tools
    desc: Syslog management tools
    for: [shell]
    any:
      - {id: syslog-ref}
      - {id: logrotate-command}
      - {id: rsyslog-ref}
      - {id: syslog-ng-ref}

  - id: log-management
    desc: Legitimate log file management
    crit: benign
    conf: 0.8
    for: [shell]
    any:
      - {id: log-with-viewer}
      - {id: syslog-tools}

  # user management
  - id: user-commands
    desc: User account commands
    for: [shell]
    any:
      - {id: useradd-command}
      - {id: usermod-command}
      - {id: userdel-command}
      - {id: adduser-command}

  - id: group-commands
    desc: Group management commands
    for: [shell]
    any:
      - {id: groupadd-command}
      - {id: groupmod-command}

  - id: password-commands
    desc: Password management commands
    for: [shell]
    any:
      - {id: passwd-command}
      - {id: chpasswd-command}

  - id: user-management
    desc: Legitimate user account management
    crit: benign
    conf: 0.75
    for: [shell]
    any:
      - {id: user-commands}
      - {id: group-commands}
      - {id: password-commands}

  # network configuration
  - id: ip-commands
    desc: ip command usage
    for: [shell]
    any:
      - {id: ip-addr-command}
      - {id: ip-route-command}
      - {id: ip-link-command}

  - id: ifconfig-commands
    desc: ifconfig-based network commands
    for: [shell]
    any:
      - {id: ifconfig-command}
      - {id: ifup-command}
      - {id: ifdown-command}

  - id: network-manager-tools
    desc: NetworkManager tools
    for: [shell]
    any:
      - {id: nmcli-command}
      - {id: network-manager-ref}

  - id: dns-tools
    desc: DNS configuration tools
    for: [shell]
    any:
      - {id: resolvconf-command}
      - {id: systemd-resolved-ref}

  - id: firewall-tools
    desc: Firewall management tools
    for: [shell]
    any:
      - {id: iptables-command}
      - {id: nftables-command}
      - {id: firewalld-service}

  - id: network-config
    desc: Legitimate network configuration
    crit: benign
    conf: 0.8
    for: [shell]
    any:
      - {id: ip-commands}
      - {id: ifconfig-commands}
      - {id: network-manager-tools}
      - {id: dns-tools}
      - {id: firewall-tools}

  # filesystem operations
  - id: filesystem-ops
    desc: Legitimate filesystem administration
    crit: benign
    conf: 0.75
    for: [shell]
    any:
      - {id: mount-command}
      - {id: umount-command}
      - {id: fstab-file}
      - {id: lvcreate-command}
      - {id: lvextend-command}
      - {id: pvcreate-command}
      - {id: mkfs-command}
      - {id: fsck-command}
      - {id: resize2fs-command}
      - {id: fdisk-command}
      - {id: parted-command}

  # backup operations
  - id: backup-ops
    desc: Legitimate backup and restore operations
    crit: benign
    conf: 0.85
    for: [shell]
    any:
      - {id: tar-command}
      - {id: rsync-command}
      - {id: cp-archive}
      - {id: dd-if-pattern}
      - {id: dump-command}
      - {id: restore-command}
      - {id: borg-command}
      - {id: restic-command}
      - {id: duplicity-command}
      - {id: backup-keyword}

  # process management
  - id: process-management
    desc: Legitimate process management
    crit: benign
    conf: 0.8
    for: [shell]
    any:
      - {id: ps-aux-command}
      - {id: ps-ef-command}
      - {id: top-command}
      - {id: htop-command}
      - {id: kill-sigkill}
      - {id: killall-command}
      - {id: nice-command}
      - {id: renice-command}
      - {id: proc-loadavg}
      - {id: proc-meminfo}

  # SSH administration
  - id: ssh-admin
    desc: Legitimate SSH server administration
    crit: benign
    conf: 0.8
    for: [shell]
    any:
      - {id: sshd-config-file}
      - {id: etc-ssh-path}
      - {id: ssh-keygen-command}
      - {id: ssh-copy-id-command}
      - {id: authorized-keys-file}
      - {id: ssh-command}
      - {id: scp-command}
      - {id: sftp-command}

  # container management
  - id: container-management
    desc: Legitimate container management (Docker/Podman/K8s)
    crit: benign
    conf: 0.85
    for: [shell]
    any:
      - {id: docker-command}
      - {id: docker-compose-command}
      - {id: docker-sock-path}
      - {id: podman-command}
      - {id: buildah-command}
      - {id: kubectl-command}
      - {id: kubelet-command}
      - {id: kubeadm-command}
      - {id: crictl-command}

  # monitoring
  - id: monitoring
    desc: Legitimate system monitoring tools
    crit: benign
    conf: 0.85
    for: [shell]
    any:
      - {id: prometheus-ref}
      - {id: node-exporter-ref}
      - {id: alertmanager-ref}
      - {id: grafana-ref}
      - {id: nagios-ref}
      - {id: zabbix-ref}
      - {id: icinga-ref}
      - {id: elasticsearch-ref}
      - {id: logstash-ref}
      - {id: fluentd-ref}
