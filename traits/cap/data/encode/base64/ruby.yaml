# Ruby Base64 Decoding Detection
# Detects Base64 decode operations in Ruby
# ATT&CK: T1140 (Deobfuscate/Decode Files or Information)

defaults:
  crit: notable
  attack: "T1140"
  for: [ruby]

traits:
  # === Base64 Decode ===
  - id: base64-decode
    desc: Ruby Base64 decode
    conf: 0.90
    if:
      type: content
      regex: "Base64\\.(decode64|urlsafe_decode64|strict_decode64)"

  - id: base64-urlsafe-decode
    desc: Ruby urlsafe Base64 decode
    conf: 0.90
    if:
      type: content
      regex: "Base64\\.urlsafe_decode64"
