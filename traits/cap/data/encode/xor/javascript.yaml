traits:
  # Removed fragmented-hex-xor-decoder duplicate - use cap/data/encode/hex_xor::fragmented-hex-xor-decoder

  - id: js-obfuscated-fragment-xor-decode
    desc: Obfuscated fragment XOR decode in JS
    crit: suspicious
    conf: 0.8
    if:
      type: ast
      language: javascript
      query: |
        (binary_expression
          operator: "^"
          right: (number) @hex
        )
        (#match? @hex "^0x")
