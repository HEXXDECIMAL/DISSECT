# JavaScript Hex/Int Array Obfuscation Patterns
# Used in obfuscated downloaders/droppers

defaults:
  platforms: [javascript]

traits:
  - id: js-hex-char-array
    desc: JavaScript array initialized with many hex-encoded characters
    crit: notable
    conf: 0.8
    for: [javascript]
    if:
      type: raw
      # Matches new Array("\x66","\x75"...) - relaxed to match just the start and a few elements
      regex: 'new Array\("\\x[0-9a-fA-F]{2}",\s*"\\x[0-9a-fA-F]{2}"'

  - id: js-large-int-array
    desc: Large integer array initialization
    crit: inert
    conf: 0.6
    for: [javascript]
    if:
      type: raw
      # Matches = [0,1,2,3...] with at least 50 elements
      regex: '=\s*\[(\d{1,3},){50,}'