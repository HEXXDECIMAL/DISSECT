traits:
  - id: ast-bracket-charat-access
    desc: Accessing charAt property on a string literal
    crit: suspicious
    conf: 0.98
    mbc: "B0032"
    attack: "T1027"
    for: [javascript, typescript]
    if:
      type: ast
      query: |
        (subscript_expression
          object: (string) @literal
          index: (string
            (string_fragment) @index
            (#eq? @index "charAt")
          )
        )