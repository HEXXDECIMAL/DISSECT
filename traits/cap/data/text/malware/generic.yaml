# Malware Terminology
# Generic keywords and phrases related to malware and infection

traits:
  - id: infected-marker
    desc: References being infected
    crit: notable
    conf: 0.7
    attack: "T1204"
    for: [all]
    if:
      type: string
      regex: "(?i)\binfected\b"

  - id: infection-marker
    desc: References infection
    crit: notable
    conf: 0.7
    attack: "T1204"
    for: [all]
    if:
      type: string
      substr: "infection"

  - id: virus-marker
    desc: Virus reference
    crit: notable
    conf: 0.7
    attack: "T1204"
    for: [all]
    if:
      type: string
      regex: "(?i)\bvirus\b"

  - id: worm-marker
    desc: Worm malware type reference
    crit: notable
    conf: 0.7
    attack: "T1204"
    for: [all]
    if:
      type: string
      regex: "(?i)\bworm\b"

  - id: trojan-marker
    desc: Trojan reference
    crit: notable
    conf: 0.7
    attack: "T1204"
    for: [all]
    if:
      type: string
      regex: "(?i)\btrojan\b"

  # NOTE: Requires word boundaries to avoid FPs like "operations" matching "rat"
  # Avoid matching game contexts (backdoor = secret door in dungeons)
  - id: suspicious-repo-name
    desc: Suspicious repository name
    crit: notable
    conf: 0.75
    if:
      type: raw
      # Match malware terms in repo/package context, not generic game strings
      # backdoor requires adjacent tech context (shell, c2, etc)
      regex: "(?:grabber|stealer|keylogger|\\brat\\b|trojan)[_-]?(?:bot|tool|kit|v?\\d|py|go|rs)?\\b|backdoor[_-]?(?:shell|c2|trojan|server)"
      case_insensitive: true

