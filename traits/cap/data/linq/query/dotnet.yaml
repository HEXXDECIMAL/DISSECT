# .NET LINQ and Expression Patterns

traits:
  # === LINQ expressions atomic indicators ===
  - id: system-linq-expressions
    desc: System.Linq.Expressions namespace
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "System.Linq.Expressions"

  - id: expression-visitor
    desc: ExpressionVisitor class
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "ExpressionVisitor"

  - id: lambda-expression
    desc: LambdaExpression class
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "LambdaExpression"

  - id: linq-queries
    desc: LINQ query operations
    crit: notable
    conf: 0.70
    if:
      type: string
      substr: "System.Linq"

  # === Expression compilation atomic indicators ===
  - id: compile-call
    desc: Compile() call
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "Compile\\("

  - id: expression-lambda
    desc: Expression.Lambda call
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "Expression.Lambda"

composite_rules:
  - id: linq-expressions
    desc: LINQ expression tree manipulation
    crit: notable
    conf: 0.75
    any:
      - id: system-linq-expressions
      - id: expression-visitor
      - id: lambda-expression

  - id: expression-compilation
    desc: Runtime expression compilation
    crit: notable
    conf: 0.80
    any:
      - id: compile-call
      - id: expression-lambda
