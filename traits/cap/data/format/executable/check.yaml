# Executable Format Detection
# Detects checks or references to executable file formats (e.g., MZ, ELF)

defaults:
  crit: notable
  conf: 0.8

traits:
  - id: mz-header-check
    desc: "Check for MZ executable header"
    mbc: "C0017" # Check for Magic Bytes
    if:
      type: encoded
      # Matches literal MZ or == "MZ" or obfuscated concatenation
      regex: 'MZ|(?:==|===)\s*[''"]MZ[''"]|(?:==|===)\{[^:]+:[''"]M[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]Z[''"]\}\.[a-zA-Z0-9_$]+'
