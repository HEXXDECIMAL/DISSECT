# SSL/TLS Operations
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

traits:
  # === SSL/TLS Connection ===
  - id: connect
    desc: SSL/TLS connection
    crit: inert
    conf: 0.66
    for: [elf, macho, so, dylib, c]
    if:
      type: symbol
      pattern: SSL_connect|SSL_new|SSL_CTX_new|TLS_client_method

  # === Certificate Verification Skip ===
  - id: insecure-skip-verify
    desc: InsecureSkipVerify (Go)
    crit: suspicious
    conf: 0.8
    if:
      type: string
      exact: "InsecureSkipVerify"

  - id: cert-none
    desc: CERT_NONE (Python)
    crit: suspicious
    conf: 0.8
    if:
      type: string
      exact: "CERT_NONE"

  - id: verify-mode-none
    desc: verify_mode = ssl.CERT_NONE (Python)
    crit: suspicious
    conf: 0.85
    if:
      type: string
      exact: "verify_mode = ssl.CERT_NONE"

  - id: reject-unauthorized-false
    desc: rejectUnauthorized false (Node.js)
    crit: suspicious
    conf: 0.8
    if:
      type: string
      exact: "rejectUnauthorized: false"

composite_rules:
  # Skip SSL certificate verification (migrated from YARA)
  - id: verify-skip
    desc: Skip SSL certificate verification
    crit: suspicious
    conf: 0.66
    count_min: 1
    any:
      - id: insecure-skip-verify
      - id: cert-none
      - id: verify-mode-none
      - id: reject-unauthorized-false
