traits:
  - id: form-data-new
    desc: Creates FormData object
    crit: inert
    conf: 0.6
    if:
      type: raw
      regex: 'new\s+FormData\('

  - id: form-data-append
    desc: Appends data to FormData
    crit: inert
    conf: 0.6
    if:
      type: raw
      regex: '\.append\('

  - id: fs-create-read-stream
    desc: Creates file read stream
    crit: inert
    conf: 0.6
    if:
      type: raw
      regex: "fs\\.createReadStream"

composite_rules:
  - id: form-data-stream-upload
    desc: Uploads file stream via FormData
    crit: suspicious
    conf: 0.8
    all:
      - id: form-data-new
      - id: form-data-append
      - id: fs-create-read-stream