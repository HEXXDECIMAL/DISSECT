# SOCKS Proxy
# MBC: C0001 (Socket Communication)
# ATT&CK: T1090

defaults:
  mbc: "C0001"
  attack: "T1090"

traits:
  - id: socks4-proto
    desc: SOCKS4 protocol reference
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: SOCKS4

  - id: socks5-proto
    desc: SOCKS5 protocol reference
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: SOCKS5

  - id: socks5-string
    desc: socks5 string
    crit: inert
    conf: 0.5
    if:
      type: string
      word: "socks5"

  - id: socks4-string
    desc: socks4 string
    crit: inert
    conf: 0.5
    if:
      type: string
      word: "socks4"

  - id: socks-url
    desc: SOCKS URL scheme
    crit: notable
    conf: 0.7
    if:
      type: string
      exact: "socks://"

  - id: socks-port
    desc: SOCKS default port 1080
    crit: inert
    conf: 0.4
    if:
      type: string
      exact: "1080"

composite_rules:
  - id: socks
    desc: SOCKS proxy usage
    crit: notable
    conf: 0.66
    count_min: 1
    any:
      - id: socks4-proto
      - id: socks5-proto
      - id: socks5-string
      - id: socks4-string
      - id: socks-url
      - id: socks-port
