# IP Address Parsing
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: parse
    desc: Parse IP addresses
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: inet_pton|inet_ntop|inet_addr|inet_aton

  - id: parse-string
    desc: IP address string patterns
    crit: inert
    conf: 0.66
    if:
      type: string
      regex: "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"

  - id: byte-order
    desc: Network byte order conversion
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: htons|htonl|ntohs|ntohl
