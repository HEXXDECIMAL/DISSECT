# Ruby DNS Resolution Detection
# Detects Ruby DNS lookup operations
# MBC: C0011 (Network Service Scanning)

defaults:
  crit: inert
  for: [ruby]
  conf: 0.7

traits:
  # DNS resolution via Resolv
  - id: resolv-getaddress
    desc: Resolv.getaddress method
    if:
      type: string
      regex: 'Resolv\.getaddress'

  - id: resolv-getname
    desc: Resolv.getname method
    if:
      type: string
      regex: 'Resolv\.getname'

composite_rules:
  - id: dns-resolve
    desc: DNS hostname resolution
    crit: notable
    conf: 0.85
    any:
      - id: resolv-getaddress
      - id: resolv-getname
