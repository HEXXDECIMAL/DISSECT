traits:
  - id: wscript-shell-run
    desc: "WScript.Shell.Run method call"
    crit: suspicious
    conf: 0.9
    for: [javascript]
    if:
      type: string
      # Detects both literal "Run(" and dynamic invocation like `variable[method_name_variable](`
      regex: '(?:WScript\.Shell|\w+)\[?[''"]?Run[''"]?\]?\('
    attack: "T1059.007" # Command and Scripting Interpreter: JavaScript/JScript
    mbc: "C0018" # Remote Access
