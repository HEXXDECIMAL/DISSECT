traits:
  - id: js-array-index-concatenation
    desc: JScript array index concatenation (URL obfuscation)
    crit: suspicious
    conf: 0.9
    for: [javascript]
    if:
      type: raw
      regex: '[a-zA-Z0-9_]{2,}\s*\[\s*(?:[2-9]|\d{2,})\s*\]\s*\+\s*[a-zA-Z0-9_]{2,}\s*\[\s*(?:[2-9]|\d{2,})\s*\]'
      count_min: 10
    unless:
      - id: meta/library/jquery::domain
      - id: meta/library/jquery::version-string
      - id: meta/library/jquery::copyright
      - id: meta/library/jquery::fn-extend
      - id: meta/library/d3::d3-detection
