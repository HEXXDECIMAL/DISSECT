# Mount Filesystem (shell command detection)
# MBC: E1222 (File Permission Modification)
# ATT&CK: T1222

traits:
  - id: mount-keyword
    description: mount command keyword
    crit: notable
    conf: 0.6
    mbc: E1222
    attack: T1222
    if:
      type: string
      word: "mount"

  - id: fstab-file
    description: fstab file reference (filesystem table)
    crit: notable
    conf: 0.7
    mbc: E1222
    attack: T1222
    if:
      type: string
      word: "fstab"

  - id: remount-keyword
    description: remount keyword (remount filesystem)
    crit: notable
    conf: 0.7
    mbc: E1222
    attack: T1222
    if:
      type: string
      word: "remount"

composite_rules:
  - id: mount-context
    description: Mount-related keywords (options, fstab, remount)
    crit: notable
    conf: 0.6
    mbc: E1222
    attack: T1222
    any:
      - id: fstab-file
      - id: remount-keyword

  - id: mount-command
    description: Mount file systems with command
    crit: notable
    conf: 0.66
    mbc: E1222
    attack: T1222
    all:
      - id: mount-keyword
      - id: mount-context
