# Device Paths
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: dev-path-pattern
    desc: /dev/ device path pattern
    crit: notable
    conf: 0.7
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: '/dev/[\w.\-/]{1,16}'

  - id: dev-null
    desc: /dev/null (legitimate discard device)
    crit: inert
    conf: 1.0
    if:
      type: string
      exact: "/dev/null"

  - id: dev-shm
    desc: /dev/shm/ (shared memory, legitimate)
    crit: inert
    conf: 1.0
    if:
      type: string
      exact: "/dev/shm/"

  - id: dev-sda
    description: /dev/sda device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/sda"

  - id: dev-hda
    description: /dev/hda device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/hda"

  - id: dev-nvme
    description: /dev/nvme device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/nvme"

composite_rules:
  - id: device-dev
    desc: Reference to /dev devices (excludes
    crit: notable
    conf: 0.66
    mbc: E1083
    attack: T1083
    all:
      - id: dev-path-pattern
    none:
      - id: dev-null
      - id: dev-shm

