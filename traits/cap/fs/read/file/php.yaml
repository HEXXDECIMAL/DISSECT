# PHP Filesystem Read Traits
# MBC: C0051 (Read File)

traits:
  - id: file-get-contents
    description: File read via file_get_contents
    crit: notable
    conf: 0.75
    mbc: "C0051"
    for: [php]
    if:
      type: string
      exact: file_get_contents

  - id: fread
    description: File read via fread
    crit: notable
    conf: 0.75
    mbc: "C0051"
    for: [php]
    if:
      type: string
      regex: "\\bfread\\s*\\("

  - id: fgets
    description: Line read via fgets
    crit: inert
    conf: 0.6
    for: [php]
    if:
      type: string
      regex: "\\bfgets\\s*\\("

  - id: readfile
    description: Output file contents via readfile
    crit: notable
    conf: 0.75
    mbc: "C0051"
    for: [php]
    if:
      type: string
      exact: readfile

  - id: fopen
    description: File open operation
    crit: inert
    conf: 0.6
    for: [php]
    if:
      type: string
      regex: "\\bfopen\\s*\\("

  - id: realpath
    description: Resolve real file path
    crit: inert
    conf: 0.6
    for: [php]
    if:
      type: string
      exact: realpath
