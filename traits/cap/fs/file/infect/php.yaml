traits:
  - id: php-payload-include
    description: "Detects PHP code string containing include/require statement"
    crit: suspicious
    attack: T1546
    if:
      type: raw
      regex: '["'']\s*(?:include|require)(?:_once)?\s*[(]'
      case_insensitive: true

  - id: php-append-self
    description: "Detects PHP code referencing its own filename for inclusion"
    crit: suspicious
    attack: T1546
    if:
      type: raw
      regex: '(?:include|require)(?:_once)?\s*[(]\s*__FILE__'
      case_insensitive: true