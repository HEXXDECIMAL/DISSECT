# File Delete Operations - Windows
# MBC: C0047 (Delete File)
# ATT&CK: T1070.004

traits:
  - id: delete-win
    desc: Delete files (Windows API)
    crit: notable
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      regex: DeleteFile|DeleteFileA|DeleteFileW
  - id: del-command
    desc: 'File deletion using "del" command.'
    crit: notable
    conf: 0.7
    for: [batch]
    if:
      type: string
      regex: 'del %?[A-Za-z0-9_]+%?(\.exe)?' # Detects "del %var%" or "del filename.exe"

