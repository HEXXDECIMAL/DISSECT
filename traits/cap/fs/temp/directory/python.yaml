# Temporary Directory Operations - Python
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: directory-python
    desc: Temp directory string lookup
    crit: inert
    conf: 0.66
    if:
      type: string
      substr: gettempdir

  - id: directory-python-symbol
    desc: Gets temp directory path
    crit: inert
    conf: 0.75
    if:
      type: symbol
      exact: "tempfile.gettempdir"

composite_rules:
  - id: temp-directory
    desc: Gets system temp directory
    crit: inert
    conf: 0.75
    any:
      - id: directory-python
      - id: directory-python-symbol
