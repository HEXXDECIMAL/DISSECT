# Asymmetric Cryptography Traits
# Detects RSA, Ed25519, and other asymmetric algorithm patterns

defaults:
  for: [elf, macho, pe, so, dylib, dll]

traits:
  - id: ed25519-constant-bytes
    desc: "Ed25519 algorithm constant bytes"
    crit: inert
    conf: 0.85
    if:
      type: hex
      pattern: "79 07 4D C9 D3 14 79 51"

  # === RSA traits ===
  - id: rsa-public-decrypt
    desc: RSA_public_decrypt reference
    crit: notable
    conf: 0.6
    if:
      type: string
      substr: "RSA_public_decrypt"

  - id: rsa-public-encrypt
    desc: RSA_public_encrypt reference
    crit: notable
    conf: 0.6
    if:
      type: string
      substr: "RSA_public_encrypt"

  - id: evp-pkey-ref
    desc: EVP_PKEY reference
    crit: inert
    conf: 0.4
    if:
      type: string
      substr: "EVP_PKEY"

composite_rules:
  - id: rsa-operations
    desc: RSA cryptographic operations
    crit: notable
    conf: 0.6
    any:
      - id: rsa-public-decrypt
      - id: rsa-public-encrypt
      - id: evp-pkey-ref
