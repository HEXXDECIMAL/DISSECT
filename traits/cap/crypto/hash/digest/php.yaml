# PHP Cryptographic Hash Traits
# MBC: C0029 (Cryptographic Hash)

traits:
  - id: md5
    desc: MD5 hash computation
    crit: inert
    conf: 0.7
    mbc: "C0029"
    for: [php]
    if:
      type: string
      regex: "\\bmd5\\s*\\("

  - id: sha1
    desc: SHA1 hash computation
    crit: inert
    conf: 0.7
    mbc: "C0029"
    for: [php]
    if:
      type: string
      regex: "\\bsha1\\s*\\("

  - id: sha256
    desc: SHA256 hash computation
    crit: inert
    conf: 0.7
    mbc: "C0029"
    for: [php]
    if:
      type: string
      regex: "hash\\s*\\(['\"]sha256['\"]"

  - id: hash-generic
    desc: Generic hash function usage
    crit: inert
    conf: 0.65
    mbc: "C0029"
    for: [php]
    if:
      type: string
      regex: "\\bhash\\s*\\("

  - id: password-hash
    desc: Password hashing (bcrypt/argon2)
    crit: inert
    conf: 0.6
    for: [php]
    if:
      type: string
      substr: password_hash

  - id: password-verify
    desc: Password verification
    crit: notable
    conf: 0.7
    for: [php]
    if:
      type: string
      substr: password_verify
