traits:
  - id: encrypt-fn
    desc: encrypt function
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "encrypt"

  - id: cipher-keyword
    desc: cipher keyword
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "cipher"

  - id: create-cipheriv
    desc: createCipheriv function
    crit: notable
    conf: 0.5
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "createCipheriv"

  - id: aes-keyword
    desc: AES keyword
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      exact: "AES"

  - id: blowfish-keyword
    desc: Blowfish keyword
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "Blowfish"

  - id: fixed-iv-deezer
    desc: Hardcoded IV (Deezer/predictable)
    crit: suspicious
    conf: 0.7
    for: [python, javascript, ruby]
    if:
      type: raw
      regex: '(IV|iv).{0,32}0001020304050607'

  - id: fixed-iv-common
    desc: Hardcoded IV (common test pattern)
    crit: suspicious
    conf: 0.7
    for: [python, javascript, ruby]
    if:
      type: string
      regex: '0001020304050607|0123456789abcdef'

composite_rules:
  - id: encryption-functions
    desc: Encryption functions
    crit: notable
    conf: 0.5
    for: [javascript, typescript, python]
    any:
      - id: encrypt-fn
      - id: cipher-keyword
      - id: create-cipheriv
      - id: aes-keyword
      - id: blowfish-keyword
