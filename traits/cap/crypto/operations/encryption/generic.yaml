traits:
  - id: encrypt-fn
    desc: encrypt function
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "encrypt"

  - id: cipher-keyword
    desc: cipher keyword
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "cipher"

  - id: create-cipheriv
    desc: createCipheriv function
    crit: notable
    conf: 0.5
    for: [javascript, typescript, python]
    if:
      type: string
      substr: "createCipheriv"

  - id: aes-keyword
    desc: AES keyword
    crit: notable
    conf: 0.4
    for: [javascript, typescript, python]
    if:
      type: string
      exact: "AES"

composite_rules:
  - id: encryption-functions
    desc: Encryption functions
    crit: notable
    conf: 0.5
    for: [javascript, typescript, python]
    any:
      - id: encrypt-fn
      - id: cipher-keyword
      - id: create-cipheriv
      - id: aes-keyword
