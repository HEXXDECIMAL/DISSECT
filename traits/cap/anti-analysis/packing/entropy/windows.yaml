# Packing and Entropy-based Detection
# Detects high entropy and structural indicators of packing

defaults:
  for: [pe]
  platforms: [windows]

traits:
  - id: high-entropy-section
    desc: High entropy executable section (possible packing)
    crit: suspicious
    conf: 0.85
    if:
      type: section
      section: "."
      min: 7.8
    unless:
      - id: cap/exec/reflection/invoke::namespace-import
      - id: meta/format/pe/dotnet::dotnet-assembly
