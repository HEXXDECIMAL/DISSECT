# Large Loop Counter (Anti-Sandbox)
# Detects loops checking against large numbers (> 10,000,000)

defaults:
  crit: suspicious
  conf: 0.8
  for: [javascript, c, cpp, csharp, java, go, rust, python]

traits:
  - id: large-loop-counter
    desc: "Loop check against large number"
    mbc: "B0003.003" # Evasion::Stalling
    attack: "T1497.003" # Virtualization/Sandbox Evasion::Time Based Evasion
    if:
      type: raw
      # Matches: if (var == 12345678) or while (var < 12345678)
      # Regex looks for comparison operators followed by at least 8 digits
      regex: '(?:if|while|for)\s*\([^)]+(?:==|!=|<|>|<=|>=)\s*[1-9][0-9]{7,}'
