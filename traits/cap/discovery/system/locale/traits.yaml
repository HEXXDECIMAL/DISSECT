# System Locale and Language Discovery
# ATT&CK: T1082 (System Information Discovery)
# MBC: E1082

defaults:
  for: [javascript, python, ruby, shell]
  attack: "T1082"
  mbc: "E1082"

traits:
  - id: js-locale-discovery
    desc: Discover JavaScript environment locale
    crit: notable
    conf: 0.9
    if:
      type: string
      regex: "resolvedOptions\\(\\)\\.locale|Intl\\.DateTimeFormat"

  - id: js-locale-symbol
    desc: JavaScript locale symbol access
    crit: notable
    conf: 0.9
    if:
      type: symbol
      substr: "DateTimeFormat.resolvedOptions"

  - id: env-locale-discovery
    desc: Discover locale via environment variables
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "\\b(LANG|LC_ALL|LC_MESSAGES)\\b"
# System Locale and Language Discovery
# ATT&CK: T1082 (System Information Discovery)
# MBC: E1082

defaults:
  for: [javascript, python, ruby, shell]
  attack: "T1082"
  mbc: "E1082"

traits:
  - id: js-locale-discovery
    desc: Discover JavaScript environment locale
    crit: notable
    conf: 0.9
    if:
      type: string
      regex: "resolvedOptions\\(\\)\\.locale|Intl\\.DateTimeFormat"

  - id: js-locale-symbol
    desc: JavaScript locale symbol access
    crit: notable
    conf: 0.9
    if:
      type: symbol
      substr: "DateTimeFormat.resolvedOptions"

  - id: env-locale-discovery
    desc: Discover locale via environment variables
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "\\b(LANG|LC_ALL|LC_MESSAGES)\\b"