# Malware Family - VNCJew Scanner
# ATT&CK: T1046 (Network Service Scanning)

traits:
  - id: scanner/vncjew/read-vncs
    desc: VNCJew VNC reader function
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1046"
    r#for: [elf]
    if:
      type: string
      exact: "readVNCs"

  - id: scanner/vncjew/iptables-ref
    desc: Reference to iptables firewall utility
    crit: notable
    conf: 0.7
    r#for: [elf]
    if:
      type: string
      exact: "iptables"

  - id: scanner/vncjew/masscan-ref
    desc: Reference to masscan network scanner
    crit: notable
    conf: 0.7
    r#for: [elf]
    if:
      type: string
      exact: "masscan"

composite_rules:
  - id: scanner/vncjew/detected
    desc: VNCJew VNC scanner
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1046"
    mbc: "B0046"
    r#for: [elf]
    all:
      - id: scanner/vncjew/read-vncs
      - id: scanner/vncjew/iptables-ref
      - id: scanner/vncjew/masscan-ref
