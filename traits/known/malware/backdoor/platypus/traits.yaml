# Malware Family - Platypus Reverse Shell Backdoor
# Reference: https://github.com/WangYihang/Platypus
# ATT&CK: T1059 (Command and Scripting Interpreter)

traits:
  - id: backdoor/platypus/remove-self
    desc: Platypus self-removal function
    crit: suspicious
    conf: 0.95
    attack: "T1070.004"
    for: [elf, macho]
    if:
      type: string
      substr: "RemoveSelfExecutable"

  - id: backdoor/platypus/daemon-mode
    desc: Platypus daemon mode startup
    crit: suspicious
    conf: 0.95
    attack: "T1543"
    for: [elf, macho]
    if:
      type: string
      substr: "StartDaemonMode"

  - id: backdoor/platypus/brand
    desc: Platypus GitHub reference
    crit: suspicious
    conf: 0.99
    attack: "T1059"
    for: [elf, macho]
    if:
      type: string
      substr: "WangYihang/Platypus"

  - id: backdoor/platypus/tunnel-connect
    desc: Platypus tunnel connection
    crit: suspicious
    conf: 0.95
    attack: "T1572"
    for: [elf, macho]
    if:
      type: string
      substr: "BodyPullTunnelConnec"

composite_rules:
  - id: backdoor/platypus/detected
    desc: Platypus reverse shell backdoor
    crit: suspicious
    conf: 0.95
    attack: "T1059"
    mbc: "B0022"
    for: [elf, macho]
    needs: 3
    any:
      - id: backdoor/platypus/remove-self
      - id: backdoor/platypus/daemon-mode
      - id: backdoor/platypus/brand
      - id: backdoor/platypus/tunnel-connect
