# Generic Stealth Backdoor Patterns
# Detects combinations of anti-analysis and evasive behaviors

composite_rules:
  - id: backdoor/generic/stealth-behavior
    description: "Stealth backdoor behavior (Anti-analysis +"
    crit: hostile
    conf: 0.9
    attack: "T1027"
    mbc: "B0001"
    for: [elf, macho, so, dylib]
    max_size: 10485760 # 10MB
    count_min: 3
    any:
      - id: obj/anti-analysis/debugger/detect/process-inspection
      - id: obj/anti-analysis/timing/primitive
      - id: obj/anti-static/obfuscation/strings-deobfuscation
      - id: obj/anti-analysis/self-modify/mprotect
