# DeimosC2 - Go-based C2 framework
# Reference: https://github.com/DeimosC2/DeimosC2

traits:
  - id: project-path
    desc: DeimosC2 GitHub project path
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "github.com/DeimosC2/DeimosC2"

  - id: agent-functions
    desc: DeimosC2 agent function names
    crit: suspicious
    conf: 0.9
    if:
      type: string
      regex: 'DeimosC2/agents/resources/agentfunctions\.(ShouldIDie|SleepDelay|CheckTime)'

  - id: shell-execute
    desc: DeimosC2 shell execution
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "DeimosC2/agents/resources/shellexec.ShellExecute"

  - id: self-destruction
    desc: DeimosC2 self-destruction/self-delete
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "DeimosC2/agents/resources/selfdestruction.SelfDelete"

  - id: shell-inject
    desc: DeimosC2 shellcode injection
    crit: suspicious
    conf: 0.95
    if:
      type: string
      substr: "DeimosC2/agents/resources/shellinject.ShellInject"

composite_rules:
  - id: deimos-c2-agent
    desc: DeimosC2 command and control agent
    crit: hostile
    conf: 1.0
    for: [go, elf]
    all:
      - id: project-path
      - id: shell-execute
    any:
      - id: agent-functions
      - id: self-destruction
      - id: shell-inject
