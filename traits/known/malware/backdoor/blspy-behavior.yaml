defaults:
  for: [elf, macho]
  platforms: [linux, macos]

traits:
  # NOTE: The SVC 0 instruction is ARM64's syscall instruction used for ALL
  # syscalls, not just pipe2. Go runtime uses direct syscalls legitimately.
  # Downgraded to inert to avoid false positives.
  - id: behavior/syscall/pipe2
    description: "Uses pipe2 syscall (inter-process communication)"
    crit: inert
    conf: 0.3
    condition:
      type: yara
      source: |
        rule pipe2_syscall {
            strings:
                $s = { 01 00 00 d4 } // svc 0
            condition:
                $s and true // simplified, relies on manual analysis confirmation
        }

  # NOTE: Go runtime always uses direct syscalls (SVC instruction on ARM64)
  # This is not inherently suspicious - downgraded to inert
  - id: behavior/syscall/direct
    description: "Makes direct system calls"
    crit: inert
    conf: 0.3
    condition:
      type: yara
      source: |
        rule svc0_syscall {
            strings:
                $s = { 01 00 00 d4 }
            condition:
                $s
        }
