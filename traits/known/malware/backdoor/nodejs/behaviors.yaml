# NodeJS Backdoor Behaviors
# Detects combinations of behaviors common in NodeJS backdoors

composite_rules:
  - id: backdoor/nodejs/behavior-mix
    desc: "NodeJS backdoor-like behavior (Masquerading +"
    crit: hostile
    conf: 0.85
    attack: "T1059.003"
    mbc: "B0022"
    r#for: [elf, macho]
    all:
      - id: cap/exec/process/name/nodejs-title
      - id: cap/fs/permission/chmod/string
      - id: cap/exec/javascript/eval/child-process-require
