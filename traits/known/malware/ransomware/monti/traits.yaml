# Monti ransomware family traits
# ESXi-targeting ransomware with characteristic identifiers

traits:
  # Monti strain identifier in ransom message
  - id: strain-identifier
    desc: Monti ransomware strain identifier
    crit: suspicious
    conf: 0.99
    for: [elf]
    if:
      type: string
      regex: '(encrypted by|strain).{0,20}MONTI'
      case_insensitive: true

  # Monti onion domain pattern
  - id: onion-domain
    desc: Monti ransomware Tor domain
    crit: suspicious
    conf: 0.99
    for: [elf]
    if:
      type: string
      regex: 'monti[a-z0-9]+\.onion'

composite_rules:
  # Monti ransomware detection - complexity 4 (for:1 + all:3)
  - id: detected
    desc: Monti ransomware detected
    crit: hostile
    conf: 0.99
    for: [elf]
    all:
      - id: cap/vm/detect/vmware::esxcli-tool
      - id: obj/impact/ransom/encrypt::ransom-note-text
    any:
      - id: strain-identifier
      - id: onion-domain
