# GonnaCry ransomware family detection
# GonnaCry is an open-source Linux ransomware that encrypts files using
# Blowfish CBC and adds the .GNNCRY extension. Known for taunting ransom notes.

traits:
  # GonnaCry file extension marker
  - id: extension-marker
    desc: GonnaCry extension marker
    crit: suspicious
    conf: 0.99
    if:
      type: string
      exact: ".GNNCRY"

  # GonnaCry source file indicator
  - id: source-file
    desc: GonnaCry source file name
    crit: suspicious
    conf: 0.95
    if:
      type: string
      exact: "gonnacry.c"

  # GonnaCry ransom note text
  - id: ransom-note
    desc: GonnaCry ransom note text
    crit: suspicious
    conf: 0.95
    if:
      type: string
      regex: '(files below have been encrypted|Sup brother.{0,60}encrypted)'

composite_rules:
  # GonnaCry ransomware detection - complexity 4 (all:2 + any:2)
  - id: detected
    desc: GonnaCry ransomware detected
    crit: hostile
    conf: 0.99
    for: [elf]
    all:
      - id: extension-marker
      - id: obj/impact/ransom/encrypt-func-symbol
    any:
      - id: source-file
      - id: ransom-note
      - id: obj/impact/ransom/crypto-openssl-encrypt
