# Conti ransomware family detection
# Conti is a notorious ransomware-as-a-service (RaaS) operation known for
# double-extortion attacks targeting enterprises and critical infrastructure

traits:
  # Conti strain identification
  - id: strain-marker
    desc: Conti strain identification
    crit: suspicious
    conf: 0.99
    if:
      type: string
      regex: 'CONTI strain|encrypted by CONTI'
      case_insensitive: true

  # Conti ransom note filename
  - id: readme-filename
    desc: Conti ransom note filename
    crit: suspicious
    conf: 0.95
    if:
      type: string
      substr: "CONTI_README.txt"

  # Conti file extension
  - id: file-extension
    desc: Conti file extension
    crit: suspicious
    conf: 0.95
    for: [elf, pe, macho]
    if:
      type: string
      regex: '\.conti\b'
      case_insensitive: true

  # Conti onion domain
  - id: onion-domain
    desc: Conti onion domain
    crit: suspicious
    conf: 0.95
    if:
      type: string
      regex: 'conti[a-z]{0,20}\.{1,3}[a-z0-9]{1,30}\.onion'
      case_insensitive: true

composite_rules:
  # Conti ransomware detection - complexity 4 (all:2 + any:2)
  - id: detected
    desc: Conti ransomware detected
    crit: hostile
    conf: 0.99
    for: [elf, pe, macho]
    all:
      - id: strain-marker
      - id: obj/impact/ransom/ransom-note-text
    any:
      - id: readme-filename
      - id: file-extension
      - id: onion-domain
