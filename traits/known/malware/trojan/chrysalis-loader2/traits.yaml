# Known Malware: Chrysalis loader2.exe
# Thread-based launcher variant of Chrysalis malware family
# Compiled with MinGW-w64 GCC 9.3 (cross-platform)

traits:
  # === Binary Signatures ===
  - id: mingw-compiler
    desc: MinGW-w64 GCC compiler signature
    crit: inert
    conf: 0.90
    if:
      type: string
      substr: "GCC: (GNU)"

  - id: small-executable
    desc: Small executable (~19KB)
    crit: inert
    conf: 0.70
    if:
      type: string
      substr: "loader2"

  # === Message Queue Pattern ===
  - id: message-queue-pattern
    desc: Peek/Post message queue usage
    crit: suspicious
    conf: 0.80
    if:
      type: symbol
      exact: "PeekMessageA"
