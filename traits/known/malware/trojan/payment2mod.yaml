traits:
  - id: payment2mod-id
    desc: Payment2Mod bundle ID
    crit: suspicious
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'com\.tenorshare\.Payment2Mod'

  - id: payment2mod-name
    desc: Payment2Mod bundle name
    crit: notable
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'Payment2Mod'

  - id: payment2mod-ga-id
    desc: Payment2Mod Google Analytics ID
    crit: suspicious
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'UA-248588405-1'

  - id: payment2mod-ui-components
    desc: Payment2Mod unique UI components
    crit: suspicious
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: '(DinDanInfoDataListViewCell|DingDanItemViewController|DingDanViewController|LunXunData|LZTButton)'

  - id: payment2mod-method-names
    desc: Payment2Mod unique method names
    crit: suspicious
    conf: 1.0
    for: [macho]
    if:
      type: symbol
      regex: '(sendYanZhengMaButtonClick:|sendBuyRequest|woHaoLeDingDanViewController:)'

composite_rules:
  - id: payment2mod-plist-config
    desc: Payment2Mod Trojan Info.plist
    crit: suspicious
    conf: 1.0
    for: [all]
    all:
      - id: payment2mod-id
      - id: payment2mod-name

  - id: payment2mod-binary
    desc: Payment2Mod Trojan binary
    crit: suspicious
    conf: 1.0
    for: [macho]
    all:
      - id: payment2mod-id
      - id: payment2mod-ga-id

  - id: payment2mod-binary-hostile
    desc: Payment2Mod Trojan binary (High Confidence)
    crit: hostile
    conf: 1.0
    for: [macho]
    all:
      - id: payment2mod-id
      - id: payment2mod-method-names