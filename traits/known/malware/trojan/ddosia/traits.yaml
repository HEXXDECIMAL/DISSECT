traits:
  - id: obfuscated-main-func
    desc: DDosia-specific obfuscated main function
    crit: suspicious
    conf: 1.0
    for: [macho, elf]
    if:
      type: symbol
      exact: "_main.eQXmL_r2ajy"

  - id: obfuscated-helper-func
    desc: DDosia-specific obfuscated helper function
    crit: suspicious
    conf: 1.0
    for: [macho, elf]
    if:
      type: symbol
      exact: "_main.bAMC5TpWtN"

  - id: obfuscated-helper-func-2
    desc: DDosia-specific obfuscated helper function 2
    crit: suspicious
    conf: 1.0
    for: [macho, elf]
    if:
      type: symbol
      exact: "_main.tWFG2DsBaEON"

  - id: target-id-json
    desc: References target_id in JSON context
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "json:\"target_id\""

  - id: target-cpu-fraction
    desc: References target_cpu_fraction (DDosia performance tuning)
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "target_cpu_fraction"

composite_rules:
  - id: ddosia-detected
    desc: DDosia DDoS malware detected
    crit: hostile
    mbc: "B0030"
    attack: "T1498"
    all:
      - id: obfuscated-main-func
      - id: target-id-json
      - id: target-cpu-fraction
      - id: obfuscated-helper-func
      - id: obfuscated-helper-func-2
      - id: obj/c2/ddos/attack/generic/ddos-terminology
      - id: obj/c2/ddos/attack/generic/ddos-mechanics
