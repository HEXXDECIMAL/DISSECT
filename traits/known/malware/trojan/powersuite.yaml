defaults:
  for: [all]

traits:
  - id: powersuite-credits-text-1
    desc: "PowerSuite credits text 'Hopefully not nobody'"
    crit: inert
    if:
      type: raw
      substr: "Hopefully not nobody"

  - id: powersuite-credits-text-2
    desc: "PowerSuite credits text 'With special thanks to'"
    crit: inert
    if:
      type: raw
      substr: "With special thanks to:"

  - id: powersuite-credits-text-3
    desc: "PowerSuite credits text 'Mom'"
    crit: inert
    if:
      type: raw
      substr: "Mom"

  - id: powersuite-credits-text-4
    desc: "PowerSuite credits text 'Some people'"
    crit: inert
    if:
      type: raw
      substr: "Some people"

  - id: powersuite-prresource-plist
    desc: PowerSuite malware 'PRResource.plist' marker
    crit: suspicious
    conf: 1.0
    if:
      type: basename
      exact: "PRResource.plist"

  - id: powersuite-bundle-id
    desc: PowerSuite malware bundle identifier
    crit: suspicious
    conf: 1.0
    if:
      type: kv
      path: "CFBundleIdentifier"
      exact: "com.Fireebok.PowerSuite"

  - id: powersuite-bundle-id-raw
    desc: PowerSuite malware bundle identifier (raw string)
    crit: suspicious
    conf: 0.8
    if:
      type: raw
      substr: "com.Fireebok.PowerSuite"

composite_rules:
  - id: powersuite-lazy-credits
    desc: "PowerSuite malware 'lazy' credits file detected"
    crit: hostile
    conf: 1.0
    needs: 3
    any:
      - id: known/malware/trojan::powersuite-credits-text-1
      - id: known/malware/trojan::powersuite-credits-text-2
      - id: known/malware/trojan::powersuite-credits-text-3
      - id: known/malware/trojan::powersuite-credits-text-4

  - id: powersuite-components
    desc: PowerSuite malware component detected
    crit: suspicious
    conf: 1.0
    any:
      - id: known/malware/trojan::powersuite-prresource-plist
      - id: known/malware/trojan::powersuite-bundle-id
      - id: known/malware/trojan::powersuite-bundle-id-raw
      - id: cap/ui/menu/typo::fackbook-action
      - id: cap/ui/menu/stealth::hide-dock-icon-action
