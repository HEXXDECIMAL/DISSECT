# WormGPT Malware Family
# WormGPT is a malicious tool/stealer targeting macOS users.
# It often uses string encryption and direct syscalls.
# ATT&CK: T1027 (Obfuscated Files or Information), T1106 (Native API)

traits:
  - id: wormgpt-bundle-id
    desc: Known WormGPT bundle ID (com.utils.wormgpt)
    crit: suspicious
    for: [plist]
    if:
      type: kv
      path: "CFBundleIdentifier"
      exact: "com.utils.wormgpt"

  - id: wormgpt-bundle-name
    desc: Known WormGPT bundle name (WormGPT)
    crit: suspicious
    for: [plist]
    if:
      type: kv
      path: "CFBundleName"
      exact: "WormGPT"

  - id: wormgpt-bundle-exec
    desc: Known WormGPT executable name (WormGPT)
    crit: suspicious
    for: [plist]
    if:
      type: kv
      path: "CFBundleExecutable"
      exact: "WormGPT"

composite_rules:

  - id: wormgpt-behavior

    desc: "WormGPT behavioral indicators"

    crit: hostile

    for: [macho]

    all:

      - id: obj/anti-static/obfuscation/source::xor-ror-decryption-loop

      - id: obj/anti-static/obfuscation/payload::extreme-string-sparsity-macos


  - id: wormgpt-family
    desc: "WormGPT Malware Family"
    crit: hostile
    for: [plist] # Explicitly target plist files
    any:
      - id: wormgpt-bundle-id
      - id: wormgpt-bundle-name
      - id: wormgpt-bundle-exec