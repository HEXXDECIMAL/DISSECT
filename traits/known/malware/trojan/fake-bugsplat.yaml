traits:
  - id: fake-bugsplat-id
    desc: BugsplatMac bundle ID (Raw)
    crit: notable
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'com\.bugsplat\.BugsplatMac'

  - id: fake-bugsplat-copyright-old
    desc: BugsplatMac old copyright (2016)
    crit: notable
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'Copyright Â© 2016 Bugsplat'

  - id: fake-bugsplat-sdk-new
    desc: BugsplatMac built with recent SDK
    crit: notable
    conf: 1.0
    for: [all]
    if:
      type: raw
      regex: 'macosx1[2-9]'

composite_rules:
  - id: fake-bugsplat-identifier
    desc: BugsplatMac Identifier
    crit: notable
    conf: 1.0
    for: [all]
    any:
      - id: fake-bugsplat-id
      - id: meta/signed/id::com.bugsplat.BugsplatMac

  - id: fake-bugsplat-plist-mismatch
    desc: Fake BugsplatMac framework (Copyright/SDK mismatch)
    crit: suspicious
    conf: 1.0
    for: [all]
    all:
      - id: fake-bugsplat-identifier
      - id: fake-bugsplat-copyright-old
      - id: fake-bugsplat-sdk-new

  - id: fake-bugsplat-binary-stealer
    desc: Fake BugsplatMac framework (Stealer behavior)
    crit: suspicious
    conf: 1.0
    for: [macho]
    all:
      - id: fake-bugsplat-identifier
      - id: 'cap/os/security/mac/keychain::find-generic-password'
