# Malware Family - Kubo Injector
# Reference: https://github.com/kubo/injector
# ATT&CK: T1055 (Process Injection)

traits:
  - id: injector/kubo/cloned-thread
    desc: Kubo cloned thread injection
    crit: suspicious
    conf: 0.95
    attack: "T1055"
    for: [elf]
    if:
      type: string
      substr: "inject_in_cloned_thread"

  - id: injector/kubo/arch2name
    desc: Kubo architecture name resolver
    crit: suspicious
    conf: 0.9
    attack: "T1055"
    for: [elf]
    if:
      type: string
      substr: "arch2name"

  - id: injector/kubo/remote-vcall
    desc: Kubo remote virtual call
    crit: suspicious
    conf: 0.95
    attack: "T1055"
    for: [elf]
    if:
      type: string
      substr: "remote_vcall"

  - id: injector/kubo/libc-info
    desc: Kubo libc information collector
    crit: suspicious
    conf: 0.9
    attack: "T1055"
    for: [elf]
    if:
      type: string
      substr: "collect_libc_info"

  - id: injector/kubo/shellcode-size
    desc: Kubo shellcode size marker
    crit: suspicious
    conf: 0.9
    attack: "T1055"
    for: [elf]
    if:
      type: string
      substr: "shellcode_size"

composite_rules:
  - id: injector/kubo/detected
    desc: Kubo process injector
    crit: suspicious
    conf: 0.95
    attack: "T1055"
    mbc: "E1055"
    for: [elf]
    needs: 3
    any:
      - id: injector/kubo/cloned-thread
      - id: injector/kubo/arch2name
      - id: injector/kubo/remote-vcall
      - id: injector/kubo/libc-info
      - id: injector/kubo/shellcode-size
