traits:
  - id: property-demo-loader-pattern
    desc: Matches the unique combination of atob environment decoding and function constructor execution.
    crit: hostile
    conf: 1.0
    if:
      all:
        - type: raw
          substr: "atob(process.env.DEV_API_KEY"
        - type: raw
          substr: "new (Function.constructor)('require'"

composite_rules:
  - id: property-demo-infection
    desc: Matches various markers of the Property-demo malware family.
    crit: hostile
    conf: 1.0
    any:
      - id: property-demo-loader-pattern
      - id: traits/cap/exec/load/obfuscated::font-steganography-hex
      - id: traits/obj/anti-static/obfuscate/node::export-iife-injection
      - id: traits/obj/anti-static/obfuscate/node::suspicious-env-atob-axios
