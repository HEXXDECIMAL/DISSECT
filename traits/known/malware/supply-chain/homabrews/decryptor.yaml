# Homabrews Malware Decryptor
# Detects tools/scripts associated with the Homabrews supply chain attack (2026)
# ATT&CK: T1195 (Supply Chain Compromise)

traits:
  - id: homabrews-xor-key
    desc: Hardcoded Homabrews XOR key
    crit: suspicious
    conf: 1.0
    attack: T1027
    if:
      type: string
      exact: "fYztZORL5VNS7nCUH1ktn5UoJ8VSgaf"

  - id: homabrews-agent-filename
    desc: Filename of Homabrews payload
    crit: suspicious
    conf: 0.8
    attack: T1027
    if:
      type: string
      regex: '["'']brew_agent["'']'

  - id: homabrews-ru-string-search
    desc: RU string search logic
    crit: suspicious
    conf: 0.8
    attack: T1027
    if:
      type: string
      regex: 'target\s*=\s*["'']RU["'']'

composite_rules:
  - id: homabrews-tool-match
    desc: Detected Homabrews analysis tool
    crit: hostile
    conf: 0.9
    attack: T1027
    all:
      - id: homabrews-agent-filename
      - id: homabrews-ru-string-search
