traits:
  - id: property-demo-env-key
    desc: Reference to Property-demo specific DEV_API_KEY
    crit: notable
    conf: 1.0
    if:
      type: raw
      substr: "atob(process.env.DEV_API_KEY"

composite_rules:
  - id: property-demo-loader-pattern
    desc: Property-demo specific loader pattern
    crit: hostile
    conf: 1.0
    all:
      - id: property-demo-env-key
      - id: cap/exec/load/obfuscated::function-constructor-require

  - id: property-demo-infection
    desc: Property-demo infection markers
    crit: suspicious
    conf: 1.5
    any:
      - id: property-demo-loader-pattern
      - id: cap/exec/load/obfuscated::font-steganography-hex
      - id: obj/anti-static/obfuscate/dynamic::export-iife-injection
      - id: obj/anti-static/obfuscate/dynamic::suspicious-env-atob-axios