traits:
  - id: property-demo-atob-env
    desc: atob environment variable decoding
    crit: suspicious
    conf: 0.9
    if:
      type: raw
      substr: "atob(process.env.DEV_API_KEY"

  # Removed property-demo-function-constructor duplicate - use cap/dylib/load/obfuscated/node::function-constructor-require

composite_rules:
  - id: property-demo-loader-pattern
    desc: Property-demo unique loader combination
    crit: hostile
    conf: 1.0
    all:
      - id: property-demo-atob-env
      - id: cap/dylib/load/obfuscated/node::function-constructor-require

  - id: property-demo-infection
    desc: Matches various markers of the Property-demo malware family.
    crit: hostile
    conf: 1.0
    any:
      - id: property-demo-loader-pattern
      - id: cap/dylib/obfuscated::font-steganography-hex
      - id: obj/anti-static/obfuscate/dynamic::export-iife-injection
      - id: obj/anti-static/obfuscate/dynamic::suspicious-env-atob-axios
