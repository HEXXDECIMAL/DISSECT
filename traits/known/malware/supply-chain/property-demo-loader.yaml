traits:
  - id: property-demo-atob-env
    desc: atob environment variable decoding
    crit: suspicious
    conf: 0.9
    if:
      type: raw
      substr: "atob(process.env.DEV_API_KEY"

  - id: property-demo-function-constructor
    desc: Function constructor execution pattern
    crit: suspicious
    conf: 0.9
    if:
      type: raw
      substr: "new (Function.constructor)('require'"

composite_rules:
  - id: property-demo-loader-pattern
    desc: Property-demo unique loader combination
    crit: hostile
    conf: 1.0
    all:
      - id: property-demo-atob-env
      - id: property-demo-function-constructor

  - id: property-demo-infection
    desc: Matches various markers of the Property-demo malware family.
    crit: hostile
    conf: 1.0
    any:
      - id: property-demo-loader-pattern
      - id: cap/exec/load/obfuscated::font-steganography-hex
      - id: obj/anti-static/obfuscate/dynamic::export-iife-injection
      - id: obj/anti-static/obfuscate/dynamic::suspicious-env-atob-axios
