# Aobo Keylogger (Baoba)
# A commercial keylogger/spyware for macOS by Everywhere Monitoring (EM).
# It often uses ConnectionKit for exfiltration.

defaults:
  platforms: [macos]

traits:
  - id: bundle-id
    desc: Aobo Keylogger bundle identifier (com.dlsxtreme.connection)
    crit: suspicious
    conf: 1.0
    if:
      type: raw
      substr: "com.dlsxtreme.connection"

  - id: em-keychain-item
    desc: Objective-C class EMKeychainItem
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "objc_class_name_EMKeychainItem"

  - id: em-generic-keychain
    desc: Objective-C class EMGenericKeychainItem
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "objc_class_name_EMGenericKeychainItem"

  - id: em-internet-keychain
    desc: Objective-C class EMInternetKeychainItem
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "objc_class_name_EMInternetKeychainItem"

  - id: em-keychain-proxy
    desc: Everywhere Monitoring keychain proxy class
    crit: suspicious
    conf: 0.9
    if:
      type: string
      substr: "objc_class_name_EMKeychainProxy"

  - id: abk-pro-path
    desc: Aobo Keylogger Pro path component
    crit: notable
    conf: 0.8
    if:
      type: string
      substr: "AbkPro.app"

  - id: dlsxtreme-string
    desc: References to DLS Xtreme (Aobo developer)
    crit: suspicious
    conf: 0.9
    if:
      type: raw
      substr: "dlsxtreme"

composite_rules:
  - id: em-keychain
    desc: Everywhere Monitoring keychain components
    crit: suspicious
    all:
      - id: em-keychain-proxy
      - id: em-keychain-item
      - id: em-generic-keychain

  - id: bundle-metadata
    desc: Aobo Keylogger bundle metadata
    crit: suspicious
    all:
      - id: bundle-id
      - id: dlsxtreme-string

  - id: aobo-keylogger
    desc: Aobo Keylogger (Baoba) detection
    crit: hostile
    conf: 1.0
    attack: "T1056.001"
    mbc: "B0002"
    any:
      - id: em-keychain
      - id: bundle-metadata
