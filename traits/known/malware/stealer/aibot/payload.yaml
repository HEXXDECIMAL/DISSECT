# AiBot/PCS Ultimate Bot Stealer Payload
# The background payload (one.py) that performs the actual stealing.

traits:
  - id: payload-zip-password
    desc: AiBot premium.zip password
    crit: notable
    conf: 1.0
    if:
      type: raw
      regex: "setpassword\\(b'@\\*@'\\)"

  - id: payload-notes-stealer
    desc: AiBot Notes stealer (mediax)
    crit: notable
    conf: 1.0
    if:
      type: raw
      regex: "def mediax\\(temp_dir\\):"

  - id: payload-stickies-stealer
    desc: AiBot Stickies stealer
    crit: notable
    conf: 1.0
    if:
      type: raw
      regex: "copy_stickies(_database)?\\(temp_dir\\)"

  - id: payload-premium-zip
    desc: AiBot premium.zip filename
    crit: notable
    conf: 1.0
    if:
      type: string
      exact: "premium.zip"

  - id: payload-extensions-list
    desc: AiBot target file extensions
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\['\\.txt', '\\.csv', '\\.json', '\\.config', '\\.env', '\\.example'\\]"

composite_rules:
  - id: payload
    desc: AiBot Stealer Payload
    crit: hostile
    conf: 1.0
    needs: 2
    any:
      - id: payload-zip-password
      - id: payload-notes-stealer
      - id: payload-stickies-stealer
      - id: payload-premium-zip
