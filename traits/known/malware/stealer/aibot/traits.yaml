# AiBot/PCS Ultimate Bot Stealer
# Dropper UI that mimics a bot starter to hide background stealing activity.

traits:
  - id: ui-warning-string
    desc: AiBot fake installation warning
    crit: notable
    conf: 1.0
    if:
      type: string
      exact: "Interrupting the installation can cause permanent errors."

  - id: ui-password-prompt
    desc: AiBot password creation prompt
    crit: notable
    conf: 1.0
    if:
      type: string
      exact: "To start using the bot securely, please create a password."

  - id: ui-window-title
    desc: AiBot window title
    crit: notable
    conf: 1.0
    if:
      type: string
      regex: "(Ai Bot Starter|PCS Ultimate Bot Starter|MHT Bot Starter)"

  - id: delayed-execution
    desc: Delayed execution using QTimer
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "QTimer\\.singleShot\\(\\d+, self\\.[a-zA-Z0-9_]+\\)"

  - id: loader-one-main
    desc: Loads 'one.main' in a thread
    crit: notable
    conf: 0.8
    if:
      type: string
      regex: "threading\\.Thread\\(target=one\\.main\\)\\.start\\(\\)"

composite_rules:
  - id: dropper-ui
    desc: AiBot Stealer Dropper UI
    crit: hostile
    conf: 1.0
    all:
      - id: ui-warning-string
      - id: ui-password-prompt
      - id: ui-window-title
    any:
      - id: delayed-execution
      - id: loader-one-main
      - id: cap/data/text/keywords::password
