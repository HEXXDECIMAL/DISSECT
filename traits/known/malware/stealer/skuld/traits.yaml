# Malware Family - Skuld Stealer
# Go-based cryptocurrency and credential stealer
# Reference: https://github.com/hackirby/skuld
# ATT&CK: T1555 (Credentials from Password Stores)

traits:
  - id: skuld-brand-name
    desc: Skuld stealer brand string
    crit: suspicious
    conf: 0.9
    attack: "T1555"
    for: [elf, macho, pe]
    if:
      type: string
      substr: "skuld"

  - id: wallet-injection
    desc: Skuld wallet injection function
    crit: suspicious
    conf: 0.95
    attack: "T1055"
    for: [elf, macho, pe]
    if:
      type: string
      substr: "walletsinjection"

composite_rules:
  - id: skuld-detected
    desc: Skuld cryptocurrency stealer
    crit: suspicious
    conf: 0.95
    attack: "T1555"
    mbc: "B0028"
    for: [elf, macho, pe]
    all:
      - id: skuld-brand-name
      - id: wallet-injection
