traits:
  # === Roblox exploit atomic indicators ===
  - id: synapse-xtra
    desc: SynapseXtra exploit reference
    crit: notable
    conf: 0.85
    for: [pe]
    if:
      type: string
      substr: "SynapseXtra"

  - id: synapse-x
    desc: SynapseX exploit reference
    crit: notable
    conf: 0.85
    for: [pe]
    if:
      type: string
      substr: "SynapseX"

  - id: execute-script
    desc: ExecuteScript reference
    crit: inert
    conf: 0.6
    for: [pe]
    if:
      type: string
      substr: "ExecuteScript"

  - id: search-scripts
    desc: SearchScripts reference
    crit: inert
    conf: 0.6
    for: [pe]
    if:
      type: string
      substr: "SearchScripts"

  - id: roblox-ref
    desc: Roblox reference
    crit: inert
    conf: 0.5
    for: [pe]
    if:
      type: string
      substr: "Roblox"

  - id: scriptware
    desc: ScriptWare exploit reference
    crit: notable
    conf: 0.85
    for: [pe]
    if:
      type: string
      substr: "ScriptWare"

  - id: script-ware-hyphen
    desc: Script-Ware exploit reference
    crit: notable
    conf: 0.85
    for: [pe]
    if:
      type: string
      substr: "Script-Ware"

  - id: sentinel
    desc: Sentinel exploit reference
    crit: notable
    conf: 0.8
    for: [pe]
    size_max: 200000
    if:
      type: string
      regex: "Sentinel.{0,20}(Exploit|Executor|Roblox|Script)"

  - id: wave-executor
    desc: WaveExecutor exploit reference
    crit: notable
    conf: 0.85
    for: [pe]
    if:
      type: string
      substr: "WaveExecutor"

composite_rules:
  # Roblox exploit artifact composite
  - id: roblox-artifact
    desc: Roblox exploit artifact or functionality
    crit: suspicious
    conf: 0.9
    for: [pe]
    any:
      - id: synapse-xtra
      - id: synapse-x
      - id: execute-script
      - id: search-scripts
      - id: scriptware
      - id: script-ware-hyphen
      - id: sentinel
      - id: wave-executor
