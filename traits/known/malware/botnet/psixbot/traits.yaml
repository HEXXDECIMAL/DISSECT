# PsiXBot Botnet Traits
# Detects PsiXBot malware based on specific obfuscated strings and C2 indicators.
# ATT&CK: T1027 (Obfuscated Files or Information), T1071 (Application Layer Protocol)

defaults:
  for: [pe]
  attack: "T1027"

traits:
  - id: psixbot-c2-ips
    desc: "PsiXBot C2 IP:Port Pattern"
    crit: suspicious
    conf: 0.95
    attack: "T1071"
    if:
      type: string
      regex: "19\\.97\\.214\\.99:48324|123\\.132\\.49\\.230:55068|52\\.65\\.228\\.17:29108"

composite_rules:
  - id: psixbot-obfuscated-api
    desc: "PsiXBot Obfuscated API Strings"
    crit: hostile
    conf: 0.95
    any:
      - id: obj/anti-static/obfuscation/strings

  - id: psixbot-suspicious-imports
    desc: "PsiXBot Suspicious Import Combination (Active Directory UI + Terminal Services + Packer)"
    crit: suspicious
    conf: 0.8
    all:
      - id: cap/dylib/load/dsprop
      - id: cap/dylib/load/wtsapi
      - id: obj/anti-static/obfuscation/binary-metrics::dominant-section