# Mirai Sora Loader Variants
# Identifies specific Mirai loader variants for attribution
# ATT&CK: T1547 (Boot or Logon Autostart Execution)
# MBC: B0041 (Execution)

traits:
  # === Sora Loader Variants ===
  - id: sora-loader-37
    desc: "Sora loader 37 variant"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    if:
      type: string
      substr: "37SoraLOADER"
    attack: "T1547"
    mbc: "B0041"

  - id: niggerd0nks-variant
    desc: "NiGGeRd0nks1337 variant"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    if:
      type: string
      substr: "NiGGeRd0nks1337"
    attack: "T1547"
    mbc: "B0041"

  - id: x19i-variant
    desc: "X19I239124UIU variant"
    crit: suspicious
    conf: 0.9
    for: [elf, shell]
    if:
      type: string
      substr: "X19I239124UIU"
    attack: "T1547"

  - id: iu-ygujeiqn-variant
    desc: "IuYgujeIqn variant"
    crit: suspicious
    conf: 0.9
    for: [elf, shell]
    if:
      type: string
      substr: "IuYgujeIqn"
    attack: "T1547"

composite_rules:
  - id: mirai-sora-loader-family
    desc: "Mirai Sora loader family"
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    attack: "T1547"
    mbc: "B0041"
    any:
      - id: sora-loader-37
      - id: niggerd0nks-variant
      - id: x19i-variant
      - id: iu-ygujeiqn-variant

  - id: mirai-sora-with-dvr-targeting
    desc: "Mirai Sora targeting DVR devices"
    crit: hostile
    conf: 0.95
    for: [elf, shell]
    attack: "T1546"
    mbc: "B0041"
    all:
      - id: known/malware/botnet/mirai
