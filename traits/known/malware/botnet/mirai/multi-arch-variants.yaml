# Multi-Architecture Mirai Variants
# Detects different CPU architecture variants of Mirai malware
# Indicates sophisticated distribution across multiple platforms
# ATT&CK: T1106 (Execution through API)
# MBC: B0041 (Execution)

traits:
  # === Architecture Identifiers ===
  - id: mao-m68k-variant
    desc: "MAO m68k variant"
    crit: suspicious
    conf: 0.95
    for: [elf]
    if:
      type: string
      substr: "mao.m68k"
    attack: "T1106"

  # Additional variants would be detected in ARM/x86 samples
  # These patterns anticipate discovery of other architecture variants

  - id: multi-arch-bot-naming
    desc: "Multi-architecture bot naming"
    crit: suspicious
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "mao."
    attack: "T1106"

composite_rules:
  - id: multi-architecture-distribution
    desc: "Multi-architecture distribution"
    crit: notable
    conf: 0.9
    for: [elf]
    attack: "T1106"
    mbc: "B0041"
    all:
      - id: known/malware/botnet/mirai
