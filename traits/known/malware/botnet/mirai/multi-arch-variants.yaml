# Multi-Architecture Mirai Variants
# Detects different CPU architecture variants of Mirai malware
# Indicates sophisticated distribution across multiple platforms
# ATT&CK: T1106 (Execution through API)
# MBC: B0041 (Execution)

traits:
  # === Architecture Identifiers ===
  - id: mao-m68k-variant
    desc: "MAO m68k variant"
    crit: suspicious
    conf: 0.95
    for: [elf]
    if:
      type: string
      substr: "mao.m68k"
    notes: "Motorola 68020 architecture variant"
    attack: "T1106"

  # Additional variants would be detected in ARM/x86 samples
  # These patterns anticipate discovery of other architecture variants

  - id: multi-arch-bot-naming
    desc: "Multi-architecture bot naming"
    crit: suspicious
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "mao."
    notes: "MAO bot family (likely multiple architectures)"
    attack: "T1106"

composite_rules:
  - id: motorola-architecture-support
    desc: "Motorola architecture support"
    crit: suspicious
    conf: 0.95
    for: [elf]
    attack: "T1106"
    notes: |
      Mirai malware compiled for Motorola 68020 architecture.
      Indicates:
      - DVR/embedded system targeting
      - Big-endian architecture support
      - Multi-platform distribution capability
    all:
      - id: known/malware/botnet/mirai
      - id: mao-m68k-variant

  - id: multi-architecture-distribution
    desc: "Multi-architecture distribution"
    crit: hostile
    conf: 0.9
    for: [elf]
    attack: "T1106"
    mbc: "B0041"
    notes: |
      Mirai malware with multi-architecture support.
      The MAO bot family name suggests variants for:
      - m68k (Motorola 68020 - embedded/DVR)
      - ARM (common in IoT devices)
      - x86 (generic Linux systems)

      Pattern indicates:
      - Large-scale operation
      - Sophisticated build infrastructure
      - Coverage across diverse device platforms
      - Professional malware distribution
    all:
      - id: known/malware/botnet/mirai
      - id: multi-arch-bot-naming

  - id: mirai-embedded-targeting
    desc: "Mirai targeting embedded systems"
    crit: hostile
    conf: 0.95
    for: [elf]
    attack: "T1106"
    mbc: "B0041"
    notes: |
      Mirai malware targeting embedded/legacy systems.
      m68k architecture indicates:
      - DVR/CCTV device targeting
      - Legacy network appliances
      - Non-standard CPU architectures
      - Sophisticated reverse engineering capability

      Suggests access to specialized development resources.
    all:
      - id: motorola-architecture-support
      - id: known/malware/botnet/mirai
