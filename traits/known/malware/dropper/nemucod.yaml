composite_rules:
  - id: nemucod-jscript-dropper-legacy
    desc: "Nemucod JScript dropper detected (substitution cipher + evaluation) - Legacy"
    crit: hostile
    conf: 1.0
    all:
      - id: obj/anti-static/obfuscation/js::nemucod-substitution-map
      - id: obj/anti-static/obfuscation/js::nemucod-array-eval

  - id: nemucod-jscript-dropper-ast
    desc: "Nemucod JScript dropper detected (substitution cipher + evaluation) - AST"
    crit: hostile
    conf: 1.0
    all:
      - id: obj/anti-static/obfuscation/js::nemucod-var-init-ast
      - id: obj/anti-static/obfuscation/js::nemucod-array-init-ast
      - id: obj/anti-static/obfuscation/js::js-dynamic-property-concat
