traits:
  - id: stefan-str
    desc: "Stefan string"
    crit: notable
    if:
      type: string
      substr: "Stefan"
  - id: biad-str
    desc: "Biad string"
    crit: notable
    if:
      type: string
      substr: "Biad"
  - id: gavbo-str
    desc: "gavbo string"
    crit: notable
    if:
      type: string
      substr: "gavbo"
  - id: limma-str
    desc: "Limma string"
    crit: notable
    if:
      type: string
      substr: "Limma"
  - id: create-img-str
    desc: "CreateNonIndexedImage string"
    crit: notable
    if:
      type: string
      substr: "CreateNonIndexedImage"
  - id: hiding-str
    desc: "HIDING string"
    crit: notable
    if:
      type: string
      substr: "HIDING"
  - id: fill-zeros-str
    desc: "FILL_WITH_ZEROS string"
    crit: notable
    if:
      type: string
      substr: "FILL_WITH_ZEROS"
  - id: entropy-str
    desc: "Generate256BitsOfRandomEntropy string"
    crit: notable
    if:
      type: string
      substr: "Generate256BitsOfRandomEntropy"

composite_rules:
  - id: stefan-biad-group-1
    desc: "Stefan Biad Group 1"
    crit: notable
    all:
      - id: stefan-str
      - id: biad-str
      - id: gavbo-str

  - id: stefan-biad-group-2
    desc: "Stefan Biad Group 2"
    crit: notable
    all:
      - id: create-img-str
      - id: hiding-str
      - id: fill-zeros-str

  - id: stefan-biad-group-3
    desc: "Stefan Biad Group 3"
    crit: notable
    all:
      - id: limma-str
      - id: biad-str

  - id: stefan-biad-group-4
    desc: "Stefan Biad Group 4"
    crit: notable
    all:
      - id: stefan-str
      - id: entropy-str

  - id: stefan-class
    desc: "Detects StefanStego .NET dropper/loader by unique class and method names"
    crit: hostile
    conf: 1.0
    mbc: "B0027"
    attack: "T1027.003"
    any:
      - id: stefan-biad-group-1
      - id: stefan-biad-group-2
      - id: stefan-biad-group-3
      - id: stefan-biad-group-4