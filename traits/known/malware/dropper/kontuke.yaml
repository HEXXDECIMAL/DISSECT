# Kontuke PowerShell Dropper
# A PowerShell-based dropper family that uses numeric character array joining
# to obfuscate its primary payload delivery commands.

traits:
  - id: kontuke-wrapper
    desc: Kontuke-specific PowerShell wrapper
    crit: suspicious
    conf: 0.95
    for: [batch, powershell]
    if:
      type: content
      regex: '(?i)powershell\.exe.{0,100}-c\s+iex\s*\(-join\s*\[char\[\]\]@\('

composite_rules:
  - id: known/malware/dropper/kontuke
    desc: Kontuke PowerShell dropper
    crit: hostile
    conf: 1.0
    all:
      - id: cap/exec/dropper/windows/powershell-exe
      - id: cap/exec/dropper/windows/powershell-command
      - id: cap/exec/eval/invoke/iex
      - id: obj/anti-static/obfuscation/strings/ps-numeric-chararray