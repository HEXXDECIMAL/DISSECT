# Kontuke PowerShell Dropper
# A PowerShell-based dropper family that uses numeric character array joining
# to obfuscate its primary payload delivery commands.

traits:
  - id: kontuke-wrapper
    desc: Kontuke-specific PowerShell wrapper
    crit: suspicious
    conf: 0.95
    for: [batch, powershell]
    if:
      type: raw
      regex: '(?i)powershell\.exe.{0,100}-c\s+iex\s*\(-join\s*\[char\[\]\]@\('

composite_rules:
  - id: kontuke
    desc: Kontuke PowerShell dropper
    crit: hostile
    conf: 1.0
    all:
      - id: obj/execution/dropper/script::powershell-exe
      - id: obj/execution/dropper/script::powershell-command
      - id: obj/execution/interpreter/eval/invoke::iex
      - id: obj/anti-static/obfuscation/strings/concatenation::ps-numeric-chararray