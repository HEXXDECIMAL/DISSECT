traits:
  - id: tacobell-class-smectis
    desc: Detects 'Smectis' class definition (TacoBell variant)
    crit: suspicious
    if:
      type: ast
      query: |
        ((class
          name: (constant) @name)
         (#eq? @name "Smectis"))

  - id: tacobell-resolv-b64-domain
    desc: Detects 'Resolv.getaddress(Base64.decode64(...))' pattern (TacoBell variant)
    crit: suspicious
    if:
      type: ast
      query: |
        ((call
          receiver: (constant) @const
          method: (identifier) @method
          arguments: (argument_list
            (call
              receiver: (constant) @b64
              method: (identifier) @dec)))
         (#eq? @const "Resolv")
         (#eq? @method "getaddress")
         (#eq? @b64 "Base64")
         (#eq? @dec "decode64"))

  - id: tacobell-payload-path-mimming
    desc: Detects '/mimming' payload path (TacoBell variant)
    crit: suspicious
    if:
      type: raw
      substr: "/mimming"

  - id: tacobell-autosymbiontic-path
    desc: Detects '/tmp/autosymbiontic' path (TacoBell variant)
    crit: suspicious
    if:
      type: raw
      substr: "/tmp/autosymbiontic"