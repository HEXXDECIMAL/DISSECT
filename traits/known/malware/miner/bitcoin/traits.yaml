# Bitcoin cryptocurrency detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  - id: wallet-address
    desc: "Bitcoin wallet address"
    crit: suspicious
    conf: 0.85
    mbc: "B0036"
    attack: "T1496"
    if:
      type: string
      # Bitcoin address formats:
      # - P2PKH: starts with 1, 26-35 chars total
      # - P2SH: starts with 3, 26-35 chars total
      # - Bech32: starts with bc1, 42-62 chars total
      # Base58 excludes: 0, O, I, l (to avoid visual confusion)
      #
      # Simplified: Match any valid Base58Check format without lookahead.
      # Bech32 addresses or addresses starting with 1 or 3
      regex: "\\b(?:bc1[ac-hj-np-z02-9]{38,58}|[13][a-km-zA-HJ-NP-Z1-9]{25,34})\\b"
    not:
      - regex: "1[a-z]{4,}"  # Filter out likely identifiers like "1buildVersion"
      - regex: "^[0-9a-fA-F]+$" # Filter out purely hex strings (likely hashes/keys)
