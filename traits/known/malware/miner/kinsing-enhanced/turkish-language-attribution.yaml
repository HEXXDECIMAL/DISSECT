# Kinsing Turkish Language Indicators
# Detects Turkish language strings indicating Turkish-speaking threat actors
# ATT&CK: T1593.003 (Search Open Websites/Domains)
# Use case: Malware origin/campaign attribution

traits:
  # === Turkish Installation & Setup Strings ===
  - id: turkish-sudo-installing
    desc: Turkish "sudo installing" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "sudo kuruluyor"
    notes: "Turkish language indicator: 'sudo installing'"

  - id: turkish-privilege-authority
    desc: Turkish "privilege/authority" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "yetkisi"
    notes: "Turkish language: 'yetkisi' (privilege/authority)"

  - id: turkish-group-membership
    desc: Turkish group membership phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "grubuna eklendi"
    notes: "Turkish: 'added to group', context indicates privilege escalation"

  - id: turkish-sudo-privileged
    desc: Turkish "with sudo privileges" phrase
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "sudo yetkili"
    notes: "Turkish: '(with sudo)'- indicates backdoor account setup"

  # === Turkish Cleanup & Evasion ===
  - id: turkish-cleaning-generic
    desc: Turkish "cleaning" phrase
    crit: inert
    conf: 0.8
    for: [elf, shell]
    if:
      type: string
      substr: "temizleniyor"
    notes: "Turkish: 'temizleniyor' (cleaning)"

  - id: turkish-profile-viruses
    desc: Turkish "profile viruses cleaning"
    crit: inert
    conf: 0.85
    for: [elf, shell]
    if:
      type: string
      substr: "Profile virusleri temizleniyor"
    notes: "Turkish: 'Cleaning profile viruses'"

  - id: turkish-systemd-cron-cleanup
    desc: Turkish "systemd and cron cleaning"
    crit: inert
    conf: 0.9
    for: [elf, shell]
    if:
      type: string
      substr: "Systemd ve cron temizleniyor"
    notes: "Turkish: 'Systemd and cron cleaning' - strong indicator of Kinsing"

composite_rules:
  - id: turkish-language-indicators
    desc: Turkish language content in binary
    for: [elf, shell]
    any:
      - id: turkish-sudo-installing
      - id: turkish-privilege-authority
      - id: turkish-group-membership
      - id: turkish-sudo-privileged
      - id: turkish-cleaning-generic
      - id: turkish-profile-viruses
      - id: turkish-systemd-cron-cleanup

  - id: turkish-privilege-escalation
    desc: Turkish language with privilege escalation context
    all:
      - id: turkish-sudo-installing
      - id: turkish-privilege-authority

  - id: turkish-kinsing-attribution
    desc: Kinsing with Turkish language attribution
    crit: suspicious
    conf: 0.9
    for: [elf, shell]
    attack: "T1496"
    notes: |
      Turkish language indicators suggest Turkish-speaking threat actor.
      Pattern: Malware with Turkish language strings for cleanup and privilege escalation.
    all:
      - id: kinsing-identifier
      - id: turkish-language-indicators

  - id: turkish-systemd-cron-specific
    desc: Turkish-language systemd and cron cleanup
    crit: suspicious
    conf: 0.95
    for: [elf, shell]
    attack: "T1070.003"
    notes: |
      Strong indicator of Kinsing malware.
      Turkish phrase "Systemd ve cron temizleniyor" is specific to Kinsing campaigns.
    all:
      - id: turkish-systemd-cron-cleanup
      - id: systemd-service-persistence
