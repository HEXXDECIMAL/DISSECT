# Malware Family - IPRoyal Pawns (Proxyware)
# Reference: https://asec.ahnlab.com/en/37276/
# ATT&CK: T1090 (Proxy)

traits:
  - id: proxyware/pawns/gitlab-dev
    desc: IPRoyal Pawns GitLab development path
    crit: suspicious
    conf: 0.99
    family: true
    attack: "T1090"
    r#for: [elf]
    if:
      type: string
      substr: "gitlab.iproyal.dev/pawns/"

  - id: proxyware/pawns/mole
    desc: IPRoyal Pawns mole component
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1090"
    r#for: [elf]
    if:
      type: string
      substr: "go-pawns/mole"

  - id: proxyware/pawns/brand
    desc: IPRoyal Pawns brand string
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1090"
    r#for: [elf]
    if:
      type: string
      substr: "IPROYAL PAWNS"

  - id: proxyware/pawns/api-url
    desc: IPRoyal Pawns API URL variable
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1090"
    r#for: [elf]
    if:
      type: string
      substr: "PAWNS_API_URL"

composite_rules:
  - id: proxyware/pawns/detected
    desc: IPRoyal Pawns proxyware
    crit: suspicious
    conf: 0.95
    family: true
    reference: "https://asec.ahnlab.com/en/37276/"
    attack: "T1090"
    mbc: "B0012"
    r#for: [elf]
    any:
      - id: proxyware/pawns/gitlab-dev
      - id: proxyware/pawns/mole
      - id: proxyware/pawns/brand
      - id: proxyware/pawns/api-url
