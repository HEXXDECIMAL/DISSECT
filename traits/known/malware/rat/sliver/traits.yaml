# Malware Family - Sliver C2 Framework
# Reference: https://github.com/BishopFox/sliver
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # === Atomic Traits (for ML decomposition) ===

  - id: c2-framework/sliver/sliverpb
    desc: Sliver protobuf package reference
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "sliverpb"

  - id: c2-framework/sliver/bishopfox
    desc: BishopFox vendor reference
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "bishopfox"

  - id: c2-framework/sliver/proto-ref
    desc: Sliver proto definition reference
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "sliver.proto"

  - id: c2-framework/sliver/implant-builds
    desc: Sliver implant build function
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "GetImplantBuilds"

  - id: c2-framework/sliver/beacon-jitter
    desc: Sliver beacon jitter function
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "GetBeaconJitter"

  - id: c2-framework/sliver/obfuscate-symbols
    desc: Sliver symbol obfuscation function
    crit: suspicious
    conf: 0.9
    family: true
    attack: "T1027"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "GetObfuscateSymbols"

  - id: c2-framework/sliver/beacon-id
    desc: Sliver beacon ID function
    crit: suspicious
    conf: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    for: [elf, macho, pe, go]
    if:
      type: string
      substr: "GetBeaconID"

  # === Obfuscated variant traits ===

  - id: c2-framework/sliver/coredump
    desc: Sliver CoreDump reference
    crit: suspicious
    conf: 0.6
    attack: "T1071"
    platforms: [linux]
    for: [elf]
    if:
      type: string
      substr: ".CoreDump"

  - id: c2-framework/sliver/gvisor-gso
    desc: Sliver gVisor GSO capability check
    crit: suspicious
    conf: 0.7
    attack: "T1071"
    platforms: [linux]
    for: [elf]
    if:
      type: string
      substr: "HasGvisorGSOCapability"

  - id: c2-framework/sliver/set-spoofing
    desc: Sliver spoofing function
    crit: suspicious
    conf: 0.7
    attack: "T1090"
    platforms: [all]
    if:
      type: string
      substr: "SetSpoofing"

composite_rules:
  # Main Sliver detection via explicit markers
  - id: c2-framework/sliver/detected
    desc: Sliver C2 framework implant
    crit: suspicious
    conf: 0.95
    family: true
    reference: "https://github.com/BishopFox/sliver"
    attack: "T1071"
    mbc: "B0030"
    for: [elf, macho, pe, go]
    count_min: 2
    any:
      - id: c2-framework/sliver/sliverpb
      - id: c2-framework/sliver/bishopfox
      - id: c2-framework/sliver/proto-ref
      - id: c2-framework/sliver/implant-builds
      - id: c2-framework/sliver/beacon-jitter
      - id: c2-framework/sliver/beacon-id

  # Sliver functions detection
  - id: c2-framework/sliver/functions-detected
    desc: Sliver C2 implant functions
    crit: suspicious
    conf: 0.95
    family: true
    mbc: "B0030"
    attack: "T1071"
    for: [elf, macho, pe, go]
    count_min: 2
    any:
      - id: c2-framework/sliver/implant-builds
      - id: c2-framework/sliver/beacon-jitter
      - id: c2-framework/sliver/obfuscate-symbols
      - id: c2-framework/sliver/beacon-id

  # Obfuscated variant detection via YARA (needs filesize constraints)
  - id: c2-framework/sliver/obfuscated-detected
    desc: Sliver C2 obfuscated Linux implant
    crit: suspicious
    conf: 0.9
    family: true
    mbc: "B0030"
    attack: "T1071"
    platforms: [linux]
    for: [elf]
    all:
      - id: c2-framework/sliver/coredump
      - id: c2-framework/sliver/gvisor-gso
      - id: cap/comm/proxy/proxy-func
      - id: c2-framework/sliver/set-spoofing
