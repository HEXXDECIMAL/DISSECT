defaults:
  for: [pe]

traits:
  - id: decoy-finance-1
    desc: "DarkTortilla financial decoy keyword 'emergency buffer'"
    crit: notable
    if:
      type: raw
      substr: "emergency buffer"

  - id: decoy-finance-2
    desc: "DarkTortilla financial decoy keyword 'budget overruns'"
    crit: notable
    if:
      type: raw
      substr: "budget overruns"

  - id: decoy-finance-3
    desc: "DarkTortilla financial decoy keyword 'FreelancerNegotiationEngine'"
    crit: notable
    if:
      type: raw
      substr: "FreelancerNegotiationEngine"

  - id: decoy-finance-4
    desc: "DarkTortilla financial decoy keyword 'EXPENSE BREAKDOWN'"
    crit: notable
    if:
      type: raw
      substr: "EXPENSE BREAKDOWN"

  - id: decoy-finance-5
    desc: "DarkTortilla financial decoy keyword 'SubmitProposal'"
    crit: notable
    if:
      type: raw
      substr: "SubmitProposal"

composite_rules:
  - id: darktortilla-loader
    desc: "DarkTortilla multi-stage loader detected"
    crit: hostile
    conf: 0.95
    all:
      - id: cap/exec/reflection/invoke::activator
      - id: cap/exec/reflection/invoke::namespace-import
    any:
      - id: known/malware/loader/darktortilla/
      - id: obj/anti-analysis/timing/evasion/
      - id: obj/anti-analysis/vm/detect/
