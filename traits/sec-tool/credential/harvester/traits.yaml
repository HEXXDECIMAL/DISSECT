# Security Tools - Credential Extraction
# Used for both legitimate security testing and malicious purposes

traits:
  # === Atomic: Mimikatz ===

  - id: sec-tool/credential/mimikatz-logonpasswords
    description: Mimikatz logonpasswords command
    criticality: suspicious
    confidence: 0.98
    attack: "T1003.001"
    platforms: [windows]
    condition:
      type: string
      regex: "sekurlsa::logonpasswords"
      case_insensitive: true

  - id: sec-tool/credential/mimikatz-error
    description: Mimikatz error string signature
    criticality: suspicious
    confidence: 0.95
    attack: "T1003.001"
    platforms: [windows]
    condition:
      type: string
      exact: "ERROR kuhl"

  # === Atomic: Keyloggers ===

  - id: sec-tool/credential/backtrack-keylogger
    description: BackTrack keylogger (macOS)
    criticality: suspicious
    confidence: 0.9
    attack: "T1056.001"
    platforms: [macos]
    condition:
      type: yara
      source: |
        rule backtrack_keylogger {
          strings:
            $modesitt = "Modesitt Software"
            $modesitt_web = "www.modesittsoftware"
            $backtrack = "BackTrack"
          condition:
            $backtrack and ($modesitt or $modesitt_web)
        }

composite_rules:
  - id: sec-tool/credential/mimikatz
    description: Mimikatz credential extraction tool
    criticality: suspicious
    confidence: 0.98
    attack: "T1003.001"
    mbc: "E1003"
    platforms: [windows]
    requires_any:
      - type: trait
        id: sec-tool/credential/mimikatz-logonpasswords
      - type: trait
        id: sec-tool/credential/mimikatz-error
