# HTTP Client Library Detection
# Useful for ML baseline - legitimate HTTP usage patterns

traits:
  # Go net/http
  - id: lib/http/go-stdlib
    description: Go standard library HTTP client
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule go_http_stdlib {
          strings:
            $http1 = "net/http" ascii
            $http2 = "http.Get" ascii
            $http3 = "http.Post" ascii
            $http4 = "http.Client" ascii
            $http5 = "http.Transport" ascii
          condition:
            2 of them
        }

  # Python requests
  - id: lib/http/python-requests
    description: Python requests library
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule python_requests {
          strings:
            $req1 = "import requests" ascii
            $req2 = "requests.get" ascii
            $req3 = "requests.post" ascii
            $req4 = "requests.Session" ascii
          condition:
            any of them
        }

  # Python urllib
  - id: lib/http/python-urllib
    description: Python urllib library
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule python_urllib {
          strings:
            $url1 = "urllib.request" ascii
            $url2 = "urllib2" ascii
            $url3 = "urlopen" ascii
            $url4 = "urllib.parse" ascii
          condition:
            any of them
        }

  # Rust reqwest
  - id: lib/http/rust-reqwest
    description: Rust reqwest HTTP client
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule rust_reqwest {
          strings:
            $req1 = "reqwest::" ascii
            $req2 = "reqwest::Client" ascii
            $req3 = "reqwest::get" ascii
          condition:
            any of them
        }

  # curl/libcurl
  - id: lib/http/libcurl
    description: libcurl HTTP library
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule libcurl_http {
          strings:
            $curl1 = "libcurl" ascii
            $curl2 = "curl_easy" ascii
            $curl3 = "CURLOPT_" ascii
            $curl4 = "curl_init" ascii
          condition:
            any of them
        }

  # Node.js HTTP
  - id: lib/http/nodejs
    description: Node.js HTTP modules
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule nodejs_http {
          strings:
            $http1 = "require('http')" ascii
            $http2 = "require('https')" ascii
            $axios = "axios" ascii
            $fetch1 = "node-fetch" ascii
            $fetch2 = "got" ascii
          condition:
            any of them
        }

  # Java HTTP clients
  - id: lib/http/java
    description: Java HTTP client libraries
    criticality: benign
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule java_http {
          strings:
            $http1 = "HttpURLConnection" ascii
            $http2 = "HttpClient" ascii
            $http3 = "OkHttpClient" ascii
            $http4 = "apache.http" ascii
            $http5 = "java.net.http" ascii
          condition:
            any of them
        }

  # Standard User-Agent patterns
  - id: lib/http/standard-useragent
    description: Standard/legitimate User-Agent patterns
    criticality: benign
    confidence: 0.85
    condition:
      type: yara
      source: |
        rule standard_useragent {
          strings:
            $ua1 = "Mozilla/5.0" ascii
            $ua2 = "Chrome/" ascii
            $ua3 = "Firefox/" ascii
            $ua4 = "Safari/" ascii
            $ua5 = "curl/" ascii
            $ua6 = "Go-http-client" ascii
            $ua7 = "python-requests" ascii
          condition:
            any of them
        }
