# Collection - Browser Data Access
# ATT&CK: T1005 (Data from Local System), T1185 (Browser Session Hijacking)

traits:
  # === Atomic: LocalStorage ===

  - id: localstorage-get
    desc: Browser localStorage access
    crit: notable
    conf: 0.7
    attack: "T1005"
    platforms: [all]
    for: [javascript]
    if:
      type: ast_pattern
      node_type: call_expression
      pattern: "localStorage.get"

  - id: localstorage-set
    desc: Browser localStorage write
    crit: notable
    conf: 0.6
    attack: "T1005"
    platforms: [all]
    for: [javascript]
    if:
      type: ast_pattern
      node_type: call_expression
      pattern: "localStorage.set"

  # === Atomic: IndexedDB ===

  - id: indexeddb
    desc: Browser IndexedDB access
    crit: notable
    conf: 0.6
    attack: "T1005"
    platforms: [all]
    for: [javascript]
    if:
      type: ast_pattern
      node_type: call_expression
      pattern: "indexedDB"

  # === Atomic: Analytics ===

  - id: google-analytics-id
    desc: Hardcoded Google Analytics ID
    crit: suspicious
    conf: 0.8
    attack: "T1005"
    platforms: [all]
    if:
      type: string
      regex: "UA-\\d{5,9}-\\d{1,3}"
