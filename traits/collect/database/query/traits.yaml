# Collection - Database Access
# ATT&CK: T1005 (Data from Local System)

traits:
  # === Atomic: SQLite ===

  - id: sqlite
    description: SQLite database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      regex: "\\bsqlite3?\\b"

  # === Atomic: MySQL ===

  - id: mysql
    description: MySQL database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      exact: "mysql"

  # === PostgreSQL atomic indicators ===

  - id: postgresql-str
    description: postgresql string
    criticality: inert
    confidence: 0.6
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      exact: "postgresql"

  - id: go-pg-import
    description: github.com/go-pg import
    criticality: inert
    confidence: 0.6
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      exact: "github.com/go-pg"

  # === Atomic: LevelDB ===

  - id: leveldb
    description: LevelDB database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      regex: "\\b[Ll]evel[Dd][Bb]\\b"

composite_rules:
  # PostgreSQL composite
  - id: postgresql
    description: PostgreSQL database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    requires_count: 1
    conditions:
      - id: postgresql-str
      - id: go-pg-import
