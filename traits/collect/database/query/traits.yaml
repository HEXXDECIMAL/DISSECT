# Collection - Database Access
# ATT&CK: T1005 (Data from Local System)

traits:
  # === Atomic: SQLite ===

  - id: collect/database/sqlite
    description: SQLite database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      regex: "\\bsqlite3?\\b"

  # === Atomic: MySQL ===

  - id: collect/database/mysql
    description: MySQL database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      exact: "mysql"

  # === Atomic: PostgreSQL ===

  - id: collect/database/postgresql
    description: PostgreSQL database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      regex: "postgresql|github\\.com/go-pg"

  # === Atomic: LevelDB ===

  - id: collect/database/leveldb
    description: LevelDB database access
    criticality: notable
    confidence: 0.7
    attack: "T1005"
    platforms: [all]
    condition:
      type: string
      regex: "\\b[Ll]evel[Dd][Bb]\\b"
