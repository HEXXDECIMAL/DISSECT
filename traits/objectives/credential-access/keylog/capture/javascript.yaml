# Keylogging - JavaScript/Node.js
# ATT&CK: T1056.001 (Input Capture: Keylogging)

composite_rules:
    - id: js-keylogger-exfil
      desc: JavaScript keylogger with exfiltration
      crit: hostile
      conf: 0.95
      attack: "T1056.001"
      mbc: "B0015"
      for: [javascript]
      all:
        - id: micro-traits/comm/http/request::axios-post-call
      any:
        - id: micro-traits/hw/input/keyboard::node-keyboard-listener
        - id: micro-traits/hw/input/keyboard::global-keyboard-listener
  