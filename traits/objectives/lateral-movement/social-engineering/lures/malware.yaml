defaults:
  for: [all]

traits:
  - id: password-protected-archive-lure
    desc: Mention of password-protected archive in instructions
    crit: suspicious
    conf: 0.8
    if:
      type: string
      regex: "(extract|open|zip|archive).{0,30}pass(word)?[:\\s]+['\"]?\\w+['\"]?"
      case_insensitive: true
    not:
      - regex: "--password\\s+request"
    downgrade:
      any:
        - id: metadata/sign/apple::platform
        - id: metadata/apple/system-component

  - id: installer-masquerade
    desc: Masquerading as a system installer package
    crit: suspicious
    conf: 0.85
    attack: T1036.005
    if:
      type: string
      substr: "Installer-Package:"

  - id: moltbook-lure
    desc: Moltbook AI agent social lure
    crit: suspicious
    conf: 1.0
    if:
      type: string
      substr: "moltbook"
      case_insensitive: true