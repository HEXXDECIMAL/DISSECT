defaults:
  for:
  - all
traits:
- id: sideloading-host-bugreport
  desc: Common side-loading host binary (BugReport.exe)
  crit: notable
  conf: 0.8
  if:
    type: basename
    exact: BugReport.exe
- id: sideloading-host-generic
  desc: Potential side-loading host binary name
  crit: notable
  conf: 0.6
  if:
    type: basename
    regex: (?i)^BugReport\.exe$|(?i)^CrashReport\.exe$|(?i)^Update\.exe$|(?i)^Setup\.exe$|(?i)^Install\.exe$|(?i)^OneDriveStandaloneUpdater\.exe$
composite_rules:
- id: minimalist-hostile-dll
  desc: Hostile DLL with minimal imports and high entropy
  crit: suspicious
  conf: 0.8
  all:
  - id: metadata/format::few-functions
  - id: objectives/anti-analysis/packing/entropy::high-entropy-section
  - id: micro-traits/dylib/lookup::get-proc-address
  unless:
  - id: metadata/sign/certificate::verified
  - id: file/archive/self-extracting
- id: suspicious-sideloading-host
  desc: Suspicious side-loading host with minimal logic
  crit: suspicious
  conf: 0.8
  all:
  - id: sideloading-host-generic
  - id: objectives/anti-analysis/vm/detect::sparse-logic-density
