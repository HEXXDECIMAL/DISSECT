# Dependency Confusion Indicators in Summary Field
# Patterns indicating supply-chain attack attempts

defaults:
  crit: suspicious
  attack: "T1195.002"
  for: [all]

traits:
  - id: summary-mentions-victim
    desc: Package summary explicitly mentions victims
    conf: 0.90
    if:
      type: kv
      path: summary
      substr: victim
      case_insensitive: true

  - id: summary-poc-research-1
    desc: Summary claims POC/Research (POC/Research)
    if:
      type: kv
      path: summary
      regex: "(proof.of.concept|\\bpoc\\b|security.research)"
      case_insensitive: true

  - id: summary-poc-research-2
    desc: Summary claims POC/Research (Bounty/Confusion)
    if:
      type: kv
      path: summary
      regex: "(bug.bounty|dependency.confusion)"
      case_insensitive: true

  - id: summary-confirms-install
    desc: Summary mentions confirming package installation
    conf: 0.90
    if:
      type: kv
      path: summary
      regex: "confirm.{0,30}install"
      case_insensitive: true

  - id: summary-beacon
    desc: Summary mentions beacon functionality
    conf: 0.90
    if:
      type: kv
      path: summary
      regex: "\\bbeacon\\b"
      case_insensitive: true

composite_rules:
  - id: summary-poc-research
    desc: Summary claims proof of concept or research
    conf: 0.85
    any:
      - id: summary-poc-research-1
      - id: summary-poc-research-2
