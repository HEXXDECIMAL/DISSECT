defaults:
  crit: suspicious
  attack: T1036.005
  mbc: F0004
  for:
  - all
traits:
- id: pkginfo-name-contains-requests
  desc: Package name contains requests library name
  crit: notable
  conf: 0.7
  attack: T1036.005
  if:
    type: kv
    path: name
    regex: (?:^|[_-])requests(?:[_-]|$)
- id: pkginfo-name-messaging-security-lure
  desc: Package name impersonates messaging platform security tool
  crit: suspicious
  conf: 0.85
  attack: T1036.005
  if:
    type: kv
    path: name
    regex: (?i)(?:discord|telegram|whatsapp|signal)[-_.]?(?:safe|secur|auth|token)
- id: pkginfo-name-module-fragments
  desc: Package name with concatenated module name fragments
  crit: notable
  conf: 0.75
  attack: T1036.005
  if:
    type: kv
    path: name
    regex: (?:http|api|web|crypto|token).{0,80}(?:http|api|web|crypto|token)
- id: pyproject-name-module-fragments
  desc: pyproject.toml name with concatenated module fragments
  crit: notable
  conf: 0.75
  attack: T1036.005
  if:
    type: kv
    path: project.name
    regex: (?:http|api|web|crypto|token).{0,80}(?:http|api|web|crypto|token)
- id: pkginfo-name-malware-term
  desc: PKG-INFO name malware term set A
  crit: suspicious
  conf: 0.85
  attack: T1036.005
  if:
    type: kv
    path: name
    case_insensitive: true
    regex: \b(?:hack|exploit|trojan|malware)\b
- id: pkginfo-name-malware-term-b
  desc: PKG-INFO name malware term set B
  crit: suspicious
  conf: 0.85
  attack: T1036.005
  if:
    type: kv
    path: name
    case_insensitive: true
    regex: \b(?:inject|keylog|stealer|ransomware)\b
- id: pkginfo-name-malware-term-c
  desc: PKG-INFO name malware term set C
  crit: suspicious
  conf: 0.85
  attack: T1036.005
  if:
    type: kv
    path: name
    case_insensitive: true
    exact: backdoor
composite_rules:
- id: pkginfo-name-malware-term-any
  desc: PKG-INFO package name contains malware/offensive term
  crit: suspicious
  conf: 0.85
  attack: T1036.005
  any:
  - id: pkginfo-name-malware-term
  - id: pkginfo-name-malware-term-b
  - id: pkginfo-name-malware-term-c
