# Command Injection Detection
# Detects format string injection executed via system calls
# ATT&CK: T1059 (Command and Scripting Interpreter)

composite_rules:
  - id: command-injection-format-exec
    desc: Format string executed via system()
    crit: hostile
    conf: 0.90
    mbc: "E1059"
    attack: "T1059"
    for: [c, elf, macho]
    all:
      - id: micro-traits/process/create/shell::format-string-injection
      - id: micro-traits/process/create/shell::system-fn
      - id: micro-traits/comm/socket/create::create
      - id: micro-traits/comm/socket/connect::connect
