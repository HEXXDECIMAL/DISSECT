defaults:
  for: [javascript, typescript]

traits:
  - id: window-expose-sensitive-1
    desc: Exposing sensitive functions to window (getToken/login/auth)
    if:
      type: string
      regex: 'window\.(getToken|login|auth)\s*='
      case_insensitive: true

  - id: window-expose-sensitive-2
    desc: Exposing sensitive functions to window (key/secret/token)
    if:
      type: string
      regex: 'window\.(key|secret|token)\s*='
      case_insensitive: true

composite_rules:
  - id: window-expose-sensitive
    desc: Exposing sensitive functions to window object
    crit: suspicious
    conf: 0.8
    for: [javascript, typescript]
    any:
      - id: window-expose-sensitive-1
      - id: window-expose-sensitive-2
