defaults:
  crit: suspicious
  attack: T1110.001
  mbc: B0028
  for:
  - elf
  - macho
  - shell
  - python
  - go
traits:
- id: router-default-admin-1
  desc: Default router admin credentials (1)
  if:
    type: string
    regex: ^(admin123|admin1234|root123)$
- id: router-default-admin-2
  desc: Default router admin credentials (2)
  if:
    type: string
    regex: ^(1234567890|123456)$
- id: mirai-style-credential-access-1
  desc: Mirai-style credential patterns (1)
  if:
    type: string
    regex: ^(ubnt|root621|root123|admin1234)$
- id: mirai-style-credential-access-2
  desc: Mirai-style credential patterns (2)
  if:
    type: string
    regex: ^(888888|666666|7ujMko0)$
- id: busybox-command-injection-1
  desc: Busybox command injection (Bot names)
  if:
    type: string
    regex: /bin/busybox\s+(FASTCAT|ECCHI|MIRAI)
- id: busybox-command-injection-2
  desc: Busybox command injection (Tools)
  if:
    type: string
    regex: /bin/busybox\s+(wget|tftp)
- id: shell-injection-pattern-1
  desc: Shell injection pattern (1)
  if:
    type: string
    regex: ^(ping; sh|; sh|/bin/sh;|enable\nshell)$
- id: shell-injection-pattern-2
  desc: Shell injection pattern (2)
  if:
    type: string
    regex: ^(system\nshell|linuxshell)$
- id: iot-vendor-credential-access-1
  desc: IoT vendor default credentials (1)
  if:
    type: string
    regex: ^(hikvision|cisco123|vstarcam2015)$
- id: iot-vendor-credential-access-2
  desc: IoT vendor default credentials (2)
  if:
    type: string
    regex: ^(icatch99|hslwificam|ipcam_rt5350)$
composite_rules:
- id: router-default-admin
  desc: Default router admin credentials
  crit: notable
  conf: 0.85
  size_max: 10000
  any:
    - id: router-default-admin-1
    - id: router-default-admin-2
  not:
  - id: metadata/signed/platform::apple
  unless:
  - type: raw
    regex: pandas|pytest|def test_
- id: mirai-style-credential-access
  desc: Mirai-style credential patterns
  crit: suspicious
  conf: 0.95
  any:
    - id: mirai-style-credential-access-1
    - id: mirai-style-credential-access-2
- id: busybox-command-injection
  desc: Busybox command injection pattern
  crit: suspicious
  conf: 0.95
  any:
    - id: busybox-command-injection-1
    - id: busybox-command-injection-2
- id: shell-injection-pattern
  desc: Shell injection via service prompt
  crit: suspicious
  conf: 0.9
  any:
    - id: shell-injection-pattern-1
    - id: shell-injection-pattern-2
- id: iot-vendor-credential-access
  desc: IoT vendor default credentials
  crit: suspicious
  conf: 0.9
  any:
    - id: iot-vendor-credential-access-1
    - id: iot-vendor-credential-access-2
- id: iot-botnet-scanner-vendor
  desc: IoT botnet scanner (vendor credential-access)
  crit: hostile
  conf: 0.95
  attack: T1110.001
  all:
  - id: iot-vendor-credential-access
  - id: micro-traits/fs/proc/info::proc-net-tcp
  - id: busybox-command-injection
  - id: micro-traits/process/create/shell::bin-sh
- id: iot-botnet-scanner-mirai
  desc: IoT botnet scanner (mirai credential-access)
  crit: hostile
  conf: 0.95
  attack: T1110.001
  all:
  - id: mirai-style-credential-access
  - id: micro-traits/fs/proc/info::proc-net-tcp
  - id: busybox-command-injection
  - id: micro-traits/process/create/shell::bin-sh
- id: iot-botnet-scanner-shell-inject
  desc: IoT botnet scanner (shell inject)
  crit: hostile
  conf: 0.95
  attack: T1110.001
  all:
  - id: iot-vendor-credential-access
  - id: micro-traits/fs/proc/info::proc-net-tcp
  - id: shell-injection-pattern
  - id: micro-traits/process/create/shell::bin-sh
- id: iot-credential-spray
  desc: IoT default credential collection
  crit: suspicious
  conf: 0.9
  attack: T1110.001
  all:
  - id: iot-vendor-credential-access
  - id: micro-traits/fs/proc/info::proc-net-tcp
