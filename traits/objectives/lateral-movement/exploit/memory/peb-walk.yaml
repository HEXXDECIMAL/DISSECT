traits:
  - id: peb-access-x64
    desc: "Direct PEB access (GS segment)"
    crit: suspicious
    conf: 0.95
    for: [pe, dll]
    if:
      type: hex
      # mov rax, qword ptr gs:[0x60] (Get PEB)
      pattern: "65 48 8b 04 25 60 00 00 00"

  - id: ldr-walk
    desc: "Manual LDR module list traversal"
    crit: suspicious
    conf: 0.9
    for: [pe, dll]
    if:
      type: hex
      # mov [reg], [reg + 0x18] (Ldr)
      # mov [reg], [reg + 0x20] (InMemoryOrderModuleList)
      pattern: "48 8b ?? 18 00 00 00 48 8b ?? 20 00 00 00"
