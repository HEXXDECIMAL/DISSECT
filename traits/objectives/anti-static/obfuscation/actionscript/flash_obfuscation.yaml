composite_rules:
  - id: flash-obfuscation-high
    desc: Heavily obfuscated Flash/ActionScript component
    crit: hostile
    conf: 0.95
    any:
      - id: micro-traits/data/source/syntax/actionscript::obfuscated-identifier-section
    unless:
      - id: metadata/lang::is-c-file

  - id: flash-xor-decryption-loop
    desc: Flash/ActionScript XOR decryption loop
    crit: suspicious
    conf: 0.8
    all:
      - id: micro-traits/data/encoding/actionscript::actionscript-writebyte
      - id: micro-traits/data/encoding/actionscript::actionscript-bytearray
      - id: micro-traits/data/source/syntax/keyword::js-keyword-xor