# Broken/Obfuscated API Strings
# Detects strings that resemble Windows API names but are obfuscated via character replacement/insertion.
# Used by malware (e.g., PsiXBot) to evade static analysis of imports/strings.
# ATT&CK: T1027 (Obfuscated Files or Information)

defaults:
  for: [pe]
  crit: suspicious
  attack: "T1027"

traits:
  - id: broken-loadlibrary
    desc: "Obfuscated LoadLibrary string (p_adLibraryA)"
    conf: 0.95
    if:
      type: string
      exact: "p_adLibraryA"

  - id: broken-writeprocessmemory
    desc: "Obfuscated WriteProcessMemory string (pritePro_____e_ory)"
    conf: 0.95
    if:
      type: string
      exact: "pritePro_____e_ory"

  - id: broken-heapcreate
    desc: "Obfuscated HeapCreate string (rejpCreate)"
    conf: 0.95
    if:
      type: string
      exact: "rejpCreate"

  - id: broken-wtsapi
    desc: "Obfuscated wtsapi32.dll string (vpidsapi.dll)"
    conf: 0.95
    if:
      type: string
      exact: "vpidsapi.dll"
