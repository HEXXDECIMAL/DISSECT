traits:
  - id: js-dynamic-char-access
    desc: "JavaScript dynamic charAt/charCodeAt access via function return"
    crit: suspicious
    conf: 0.9
    for: [javascript]
    if:
      type: string
      # Matches patterns like `variable[functionCall()]` which resolves to `variable["charAt"]`
      # This captures the dynamic construction of the method name.
      regex: '\w+\[(CUJ|lVJ|SNm)\(\)\]\('
    attack: "T1027" # Obfuscated Files or Information
    mbc: "B0032" # Deobfuscate/Decode
