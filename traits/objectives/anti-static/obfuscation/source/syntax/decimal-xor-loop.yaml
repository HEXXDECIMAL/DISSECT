traits:
  - id: js-decimal-xor-loop
    desc: Loop parsing integers and XORing (Nemucod pattern)
    crit: suspicious
    for: [javascript]
    if:
      type: ast
      language: javascript
      query: |
        (while_statement
          body: (statement_block
            (expression_statement
              (assignment_expression
                right: (call_expression
                  function: (identifier) @fn
                )
              )
            )
            (expression_statement
              (assignment_expression
                right: (binary_expression
                  operator: "^"
                )
              )
            )
          )
        )
        (#eq? @fn "parseInt")
