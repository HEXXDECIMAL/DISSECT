traits:
- id: js-many-tiny-strings
  desc: Many tiny strings (1-3 chars)
  crit: notable
  for:
  - javascript
  if:
    type: string
    regex: ^.{1,3}$
    count_min: 50

- id: js-fragmented-prop-single
  desc: Computed property access using concatenation (single quotes)
  crit: notable
  conf: 0.8
  for:
  - javascript
  if:
    type: raw
    regex: '[\w$]+\s*\[\s*''[^'']{0,200}''\s*\+\s*''[^'']{0,200}''\s*\]'

- id: js-fragmented-prop-double
  desc: Computed property access using concatenation (double quotes)
  crit: notable
  conf: 0.8
  for:
  - javascript
  if:
    type: raw
    regex: '[\w$]+\s*\[\s*"[^"]{0,200}"\s*\+\s*"[^"]{0,200}"\s*\]'

- id: js-fragmented-prop-backtick
  desc: Computed property access using concatenation (backticks)
  crit: notable
  conf: 0.8
  for:
  - javascript
  if:
    type: raw
    regex: '[\w$]+\s*\[\s*`[^`]{0,200}`\s*\+\s*`[^`]{0,200}`\s*\]'

composite_rules:
- id: js-fragmented-property-access
  desc: Computed property access using concatenation (obfuscation)
  crit: suspicious
  conf: 0.8
  for:
  - javascript
  attack: T1027
  mbc: B0032
  any:
  - id: js-fragmented-prop-single
  - id: js-fragmented-prop-double
  - id: js-fragmented-prop-backtick
