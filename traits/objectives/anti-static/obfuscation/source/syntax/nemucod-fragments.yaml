traits:
- id: nemucod-wsh-fragment-adod
  desc: Nemucod WSH fragment ADOD
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"ADOD";

- id: nemucod-wsh-fragment-wscr
  desc: Nemucod WSH fragment WScr
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"WScr";

- id: nemucod-wsh-fragment-http
  desc: Nemucod WSH fragment HTTP
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"HTTP";

- id: nemucod-wsh-fragment-shell
  desc: Nemucod WSH fragment Shell
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"Shell";

- id: nemucod-wsh-fragment-run
  desc: Nemucod WSH fragment Run
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"Run";

- id: nemucod-wsh-fragment-temp
  desc: Nemucod WSH fragment TEMP%
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"TEMP%";

- id: nemucod-network-fragment-getpost
  desc: Nemucod network fragment GET or POST
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"(GET|POST)";

- id: nemucod-network-fragment-http
  desc: Nemucod network fragment http or https
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"(http|https)";

- id: nemucod-network-fragment-opense
  desc: Nemucod network fragment op/en/se/nd
  crit: suspicious
  for:
  - javascript
  if:
    type: string
    regex: var\s+\w+\s*=\s*"(op|en|se|nd)";

composite_rules:
  - id: nemucod-wsh-fragments
    desc: Variable assignment of known Nemucod WSH fragments
    crit: suspicious
    for:
    - javascript
    any:
    - id: nemucod-wsh-fragment-adod
    - id: nemucod-wsh-fragment-wscr
    - id: nemucod-wsh-fragment-http
    - id: nemucod-wsh-fragment-shell
    - id: nemucod-wsh-fragment-run
    - id: nemucod-wsh-fragment-temp

  - id: nemucod-network-fragments
    desc: Variable assignment of known Nemucod network fragments
    crit: suspicious
    for:
    - javascript
    any:
    - id: nemucod-network-fragment-getpost
    - id: nemucod-network-fragment-http
    - id: nemucod-network-fragment-opense
