# Embedded Code Detection via Metrics
# Detects high ratios of code-like content in strings

traits:
  - id: high-embedded-code-ratio
    desc: "High ratio of embedded code in strings"
    crit: suspicious
    conf: 0.8
    for: [javascript, typescript, python]
    if:
      type: metrics
      field: "strings.embedded_code_candidates"
      min: 5

  - id: very-high-embedded-code
    desc: "Extremely high embedded code count"
    crit: suspicious
    conf: 0.9
    for: [javascript, typescript, python, powershell]
    if:
      type: metrics
      field: "strings.embedded_code_candidates"
      min: 10

  - id: high-string-entropy
    desc: "High string entropy indicating obfuscation"
    crit: notable
    conf: 0.6
    for: [javascript, typescript, python]
    if:
      type: metrics
      field: "strings.high_entropy_count"
      min: 10
