traits:
- id: very-low-strings
  desc: Very few extracted strings
  crit: notable
  conf: 0.7
  for:
  - pe
  - elf
  if:
    type: string_count
    max: 20
    min_length: 4
- id: extremely-low-strings
  desc: Extremely few extracted strings
  crit: suspicious
  conf: 0.8
  for:
  - pe
  - elf
  if:
    type: string_count
    max: 10
    min_length: 4
  unless:
  - id: objectives/anti-static/hardening/detection::stripped-binary-struct
composite_rules:
- id: minimal-imports-suspicious-apis
  desc: Minimal imports with suspicious API combination
  crit: notable
  conf: 0.75
  for:
  - pe
  attack: T1027
  needs: 3
  any:
  - id: micro-traits/dylib/load::load-library-a
  - id: micro-traits/dylib/lookup::get-proc-address
  - id: micro-traits/process/create/methods::shell-execute-a
  - id: micro-traits/process/create/methods::shell-execute
  - id: micro-traits/process/create/methods::shell-execute-ex
  - id: micro-traits/crypto/certificate/store::cert-open-store
  - id: objectives/execution/native/runtime::heap-alloc
  unless:
  - id: objectives/anti-static/obfuscation/imports/minimal-concealment::minimal-imports-suspicious-apis__unless_1
- id: concealed-capabilities-pe
  desc: Concealed capabilities via import minimization
  crit: suspicious
  conf: 0.85
  for:
  - pe
  attack: T1027
  mbc: B0032
  all:
  - id: very-low-strings
  needs: 4
  any:
  - id: micro-traits/dylib/load::load-library-a
  - id: micro-traits/dylib/lookup::get-proc-address
  - id: micro-traits/process/create/methods::shell-execute-a
  - id: micro-traits/process/create/methods::shell-execute
  - id: micro-traits/crypto/certificate/store::cert-open-store
  - id: objectives/execution/native/runtime::heap-alloc
  - id: micro-traits/mem/protect/modify::virtual-protect
  unless:
  - id: objectives/anti-static/obfuscation/imports/minimal-concealment::concealed-capabilities-pe__unless_1
- id: import-concealed-ransomware-pattern
  desc: Ransomware with concealed import table
  crit: hostile
  conf: 0.9
  for:
  - pe
  attack: T1486
  mbc: C0027
  all:
  - id: extremely-low-strings
  - id: micro-traits/crypto/certificate/store::cert-open-store
  needs: 2
  any:
  - id: micro-traits/dylib/load::load-library-a
  - id: micro-traits/dylib/lookup::get-proc-address
  - id: micro-traits/process/create/methods::shell-execute-a
  - id: micro-traits/mem/protect/modify::virtual-protect
  - id: micro-traits/fs
  unless:
  - id: objectives/anti-static/obfuscation/imports/minimal-concealment::import-concealed-ransomware-pattern__unless_1
- id: import-concealed-dropper-pattern
  desc: Dropper with heavily minimized imports
  crit: hostile
  conf: 0.9
  for:
  - pe
  attack: T1027
  mbc: B0032
  all:
  - id: extremely-low-strings
  - id: micro-traits/dylib/load::load-library-a
  - id: micro-traits/dylib/lookup::get-proc-address
  needs: 2
  any:
  - id: micro-traits/process/create/methods::shell-execute-a
  - id: micro-traits/process/create/methods::shell-execute
  - id: micro-traits/crypto/certificate/store::cert-open-store
  - id: micro-traits/mem/protect/modify::virtual-protect
  - id: micro-traits/fs
  unless:
  - id: objectives/anti-static/obfuscation/imports/minimal-concealment::import-concealed-dropper-pattern__unless_1
