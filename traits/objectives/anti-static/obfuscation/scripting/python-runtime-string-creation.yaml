defaults:
  crit: suspicious
  conf: 0.85
  for:
  - python
  attack: T1027
  mbc: E1014
traits:
- id: join-map-getattr
  desc: String reconstruction via join(map(getattr(...)))
  crit: suspicious
  conf: 0.9
  if:
    type: raw
    regex: \.join\s*\(\s*map\s*\(\s*getattr
- id: obfuscated-chr-lookup
  desc: Obfuscated lookup of 'chr' function
  crit: suspicious
  conf: 0.95
  if:
    type: raw
    regex: (oct|hex)\.__str__\(\)\[[^\]]{1,120}\].{0,40}copyright\.__str__\(\)
- id: builtin-str-slice-construction
  desc: Constructs strings by slicing builtin type representations
  crit: suspicious
  conf: 0.9
  if:
    type: raw
    regex: "[a-z]{3,12}\\.__(str|repr)__\\s*\\(\\s*\\)\\s*\\[[^\\]]{1,120}\\]"
- id: getattr-builtins-bitwise
  desc: getattr on builtins with bitwise operations
  crit: suspicious
  conf: 0.9
  if:
    type: raw
    regex: getattr\s*\(\s*__builtins__\s*,[^,]{1,120}(<<|>>|&|\^)[^,]{1,120}\)
composite_rules: []
