defaults:
  for: [all]

traits:
  - id: xor-string-raw
    desc: Raw XOR string match
    crit: notable
    if:
      type: string
      regex: "xor [ -~]{8,}"
      section: ".text"
      min_entropy: 4.0

composite_rules:
  - id: xor-encoded-malware
    desc: XOR-encoded string commonly found in malware.
    crit: suspicious
    conf: 0.7
    all:
      - id: xor-string-raw
    unless:
      - id: metadata/lang::is-c-file
      - id: metadata/purpose/test-tool::coreutils-copyright
