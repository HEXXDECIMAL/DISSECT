# Cron Persistence
# MBC: B0028 (Scheduled Task/Job)
# ATT&CK: T1053.003

defaults:
  for: [all]

traits:
  - id: crontab-command
    desc: crontab command (schedule/view cron jobs)
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    for: [elf, macho, pe, so, dylib, dll, shell]
    if:
      type: string
      word: "crontab"

  - id: etc-cron-path
    desc: /etc/cron directory path (system cron
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      substr: "/etc/cron"

  - id: var-spool-cron-path
    desc: /var/spool/cron directory path (user cron
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      substr: "/var/spool/cron"

  - id: cron-d-path
    desc: /etc/cron.d directory path (additional system
    crit: notable
    conf: 0.7
    mbc: B0028
    attack: T1053.003
    if:
      type: string
      substr: "/etc/cron.d"

composite_rules:
  - id: cron
    desc: Cron job persistence (command or
    crit: notable
    conf: 0.66
    mbc: B0028
    attack: T1053.003
    any:
      - id: crontab-command
      - id: etc-cron-path
      - id: var-spool-cron-path
      - id: cron-d-path
