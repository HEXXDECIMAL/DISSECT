# Decoy Document Execution
# Detects opening of documents (PDF, DOC, etc.) often used to distract from malicious activity
# ATT&CK: T1036 (Masquerading), T1204.002 (User Execution: Malicious File)

defaults:
  for: [shell]

traits:
  - id: open-decoy-doc-macos
    desc: "Opening generic document file (macOS)"
    crit: notable
    conf: 0.7
    attack: "T1204.002"
    if:
      type: raw
      regex: 'open\s+[^|& ]{0,220}\.(pdf|doc|docx|xls|xlsx|ppt|pptx|rtf|txt)'

composite_rules:
  - id: download-and-open-decoy
    desc: "Download and open decoy document"
    crit: suspicious
    conf: 0.9
    attack: "T1036"
    all:
      - id: objectives/execution/dropper/script::curl-download-file
      - id: open-decoy-doc-macos
