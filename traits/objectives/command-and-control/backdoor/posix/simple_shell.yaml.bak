# Simple POSIX Backdoor Logic
composite_rules:
  - id: simple-udp-bind-shell
    desc: UDP Bind Shell (bind+dup2+system)
    crit: suspicious
    conf: 0.85
    all:
      - id: micro-behaviors/comm/socket/udp/unix::sock-dgram
      - id: micro-behaviors/comm/socket/bind::bind
      - id: micro-behaviors/process/fd/dup::dup2
      - any:
          - id: micro-behaviors/process/create/shell::system-fn
          - id: micro-behaviors/process/create/shell::shell-symbols

  - id: hostile-udp-bind-shell
    desc: Hostile UDP Bind Shell (w/ Malware Strings)
    crit: hostile
    conf: 0.95
    all:
      - id: simple-udp-bind-shell
      - id: micro-behaviors/data/text/malware/backdoor::generic-terms
