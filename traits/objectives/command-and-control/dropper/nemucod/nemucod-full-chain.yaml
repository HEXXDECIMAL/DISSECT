composite_rules:
  - id: nemucod-full-chain
    desc: Comprehensive detection for Nemucod JScript dropper, combining VM evasion, advanced obfuscation, and full download-and-execute chain.
    crit: hostile
    conf: 0.99
    attack: T1059.007, T1105, T1027, T1497
    mbc: B0017, B0018, B0032, B0008
    for: [javascript]
    all:
      - id: micro-behaviors/host/interpreter/jscript::is-jscript
      - id: objectives/anti-analysis/timing/nemucod::nemucod-jitter-check
      - id: objectives/execution/dropper/obfuscated-script::nemucod-dropper
      - id: objectives/command-and-control/dropper/nemucod::fragmented-url-dropper
      - id: objectives/anti-static/obfuscation/source/syntax::js-string-literal-charat-access
      - id: objectives/anti-static/obfuscation/source/syntax::ast-bracket-charat-access
