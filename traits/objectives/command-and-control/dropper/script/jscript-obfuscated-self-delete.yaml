composite_rules:
  - id: jscript-obfuscated-http-dropper-self-delete
    desc: Obfuscated JScript HTTP dropper with self-delete
    crit: hostile
    conf: 0.95
    for: [javascript]
    attack: "T1105"
    mbc: "B0021"
    all:
      - id: micro-traits/host/interpreter/jscript::is-jscript
      - id: micro-traits/host/interpreter/jscript::activex-object
      - id: micro-traits/data/encode/string::decimal-string-blob
      - id: micro-traits/data/control-flow/analysis::js-dynamic-method-call
      - id: micro-traits/fs/delete/file::js-self-delete-obfuscated
