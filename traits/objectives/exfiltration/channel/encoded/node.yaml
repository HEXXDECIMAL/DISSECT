# Node.js Data Encoding for Exfiltration
# Behavioral composites that combine encoding with exfiltration indicators
# ATT&CK: T1041 (Exfiltration Over C2 Channel), T1132 (Data Encoding)
#
# Note: Atomic encoding traits moved to data/encoding/node.yaml
# This file contains only behavioral composites that indicate exfiltration

defaults:
  for: [javascript, typescript]
  attack: "T1041"

composite_rules:
  # Encode then exfil pattern
  - id: node-encode-exfil
    desc: Encodes data then sends via
    crit: suspicious
    conf: 0.9
    all:
      - id: micro-traits/data/encode/base64
      - id: micro-traits/comm/http/request::http-client-usage
    unless:
      - id: micro-traits/os/admin/legitimate/http-tools/package-manager
      - id: micro-traits/os/admin/legitimate/http-tools/ci-cd-pipeline
