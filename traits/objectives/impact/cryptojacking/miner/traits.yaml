defaults:
  for:
  - all
traits:
- id: stratum-tcp
  desc: stratum+tcp protocol
  crit: notable
  conf: 0.6
  mbc: B0041
  attack: T1496
  if:
    type: string
    substr: stratum+tcp
- id: miner-word
  desc: miner keyword
  crit: notable
  conf: 0.4
  if:
    type: string
    word: miner
- id: hashrate-str
  desc: hashrate keyword
  crit: notable
  conf: 0.5
  if:
    type: string
    substr: hashrate
- id: wallet-ref
  desc: wallet keyword
  crit: notable
  conf: 0.4
  if:
    type: string
    word: wallet
- id: coinhive-str
  desc: coinhive reference
  crit: notable
  conf: 0.6
  if:
    type: string
    substr: coinhive
- id: cryptonight-str
  desc: cryptonight algorithm
  crit: notable
  conf: 0.6
  if:
    type: string
    substr: cryptonight
- id: monero-lower
  desc: monero cryptocurrency reference
  crit: notable
  conf: 0.5
  if:
    type: string
    exact: monero

composite_rules:
- id: miner
  desc: Cryptocurrency mining patterns
  crit: suspicious
  conf: 0.66
  mbc: B0041
  attack: T1496
  needs: 2
  any:
  - id: stratum-tcp
  - id: micro-behaviors/communications/http/miner-pool::mining-pool-url
  - id: miner-word
  - id: well-known/malware/miner/xmrig::xmrig-name
  - id: monero-lower
  - id: hashrate-str
  - id: wallet-ref
  - id: coinhive-str
  - id: cryptonight-str
