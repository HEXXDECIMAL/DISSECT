traits:
- id: destructive-gameplay-warning
  desc: Warns that destructive gameplay will delete files
  crit: suspicious
  conf: 0.95
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: string
    regex: (killing|playing).{0,50}delete.{0,50}files
    case_insensitive: true
- id: deleteFile-function
  desc: deleteFile function call
  crit: suspicious
  conf: 0.8
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: symbol
    regex: deleteFile
- id: deleteSelf-function
  desc: deleteSelf function call
  crit: suspicious
  conf: 0.85
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: symbol
    regex: deleteSelf
- id: explicit-file-deletion-warning-1
  desc: Explicit warning of file/data deletion (delete/destroy)
  crit: suspicious
  conf: 0.95
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: string
    regex: (delete|destroy).{0,80}(files|data|documents)
    case_insensitive: true
- id: explicit-file-deletion-warning-2a
  desc: Explicit warning of file/data deletion (wipe/erase/eliminate files/data)
  crit: suspicious
  conf: 0.95
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: string
    regex: (wipe|erase|eliminate).{0,80}(files|data)
    case_insensitive: true
- id: explicit-file-deletion-warning-2b
  desc: Explicit warning of file/data deletion (wipe/erase/eliminate documents)
  crit: suspicious
  conf: 0.95
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  if:
    type: string
    regex: (wipe|erase|eliminate).{0,80}documents
    case_insensitive: true
composite_rules:
- id: explicit-file-deletion-warning
  desc: Explicit warning that program deletes files
  crit: suspicious
  any:
    - id: explicit-file-deletion-warning-1
    - id: explicit-file-deletion-warning-2a
    - id: explicit-file-deletion-warning-2b
- id: intentional-file-destruction
  desc: Intentional file destruction pattern
  crit: hostile
  conf: 0.9
  for:
  - elf
  - macho
  - pe
  - dll
  - dylib
  - so
  attack: T1485
  mbc: C0047
  all:
  - id: explicit-file-deletion-warning
  - id: deleteFile-function
