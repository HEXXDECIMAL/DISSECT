composite_rules:
  - id: applet-killer
    desc: Hostile applet designed to kill other threads (DoS)
    crit: hostile
    conf: 1.0
    for: [java]
    all:
      - id: micro-behaviors/process/thread/enumerate::get-group
      - id: micro-behaviors/process/thread/enumerate::enumerate
      - id: micro-behaviors/process/thread/terminate::stop
    any:
      - id: micro-behaviors/process/thread/priority::set-max
      - id: micro-behaviors/process/thread/lifecycle::respawn
      - id: well-known/malware/dos::strings