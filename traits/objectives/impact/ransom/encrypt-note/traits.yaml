# Ransomware Encryption Note Indicators
# ATT&CK: T1486 (Data Encrypted for Impact)

defaults:
  for: [all]

traits:
  - id: completion_msg
    desc: "Declarative encryption completion message"
    crit: suspicious
    conf: 0.7
    attack: "T1486"
    if:
      type: string
      substr: "Encryption complete. Your files have been encrypted."

  - id: files-encrypted
    desc: "Your files have been encrypted"
    crit: notable
    conf: 0.6
    if:
      type: string
      substr: "Your files have been encrypted"

  - id: restore-files
    desc: "restore your files"
    crit: notable
    conf: 0.6
    if:
      type: string
      substr: "restore your files"

  - id: contact-us
    desc: "contact us"
    crit: notable
    conf: 0.4
    if:
      type: string
      substr: "contact us"

  - id: pay-ransom
    desc: "pay the ransom"
    crit: notable
    conf: 0.6
    if:
      type: string
      substr: "pay the ransom"

composite_rules:
  - id: generic_msg
    desc: "Generic ransom note string"
    crit: notable
    conf: 0.6
    any:
      - id: files-encrypted
      - id: restore-files
      - id: contact-us
      - id: pay-ransom
