# Process enumeration for security product targeting
# Malware enumerates processes to identify and terminate AV/EDR products

composite_rules:
  - id: process-enumeration-terminate
    desc: Process enumeration with termination capability
    crit: suspicious
    conf: 0.85
    for: [pe, dll]
    platforms: [windows]
    attack: "T1057"
    mbc: "B0036"
    all:
      - id: micro-traits/process/enumerate/snapshot::create-toolhelp32-snapshot
      - id: micro-traits/process/enumerate/snapshot::process32-first
    any:
      - id: micro-traits/process/terminate/kill::terminate-process
      - id: micro-traits/process/create/spawn::open-process
