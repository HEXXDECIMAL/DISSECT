defaults:
  for: [all]

traits:
- id: anti-forensics-cleanup-a
  desc: Cleanup and clear activity
  crit: notable
  conf: 0.8
  if:
    type: string
    regex: (?i)(cleanup|clear|remove)
    not: ["DeleteOnClose"]
  attack: T1070
  mbc: E1070
  unless:
    - id: metadata/dev/testing::is-test
- id: anti-forensics-cleanup-b
  desc: Delete and wipe activity
  crit: notable
  conf: 0.8
  if:
    type: string
    regex: (?i)(delete|wipe)
    not: ["DeleteOnClose"]
  attack: T1070
  mbc: E1070
  unless:
    - id: metadata/dev/testing::is-test
composite_rules:
- id: anti-forensics-cleanup
  desc: Anti-forensics cleanup activity
  crit: notable
  conf: 0.8
  attack: T1070
  mbc: E1070
  any:
  - id: anti-forensics-cleanup-a
  - id: anti-forensics-cleanup-b
