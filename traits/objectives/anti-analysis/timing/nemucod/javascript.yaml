composite_rules:
  - id: nemucod-jitter-check
    desc: Detects Nemucod-specific timing jitter check for VM evasion
    crit: hostile
    for: [javascript]
    all:
      - id: micro-traits/host/interpreter/jscript::is-jscript
      - id: micro-traits/time/measure/delta::js-subtraction-func-regex
    any:
      - id: objectives/anti-static/obfuscation/source/syntax::nemucod-wsh-fragments
        count_min: 3
      - id: objectives/anti-static/obfuscation/source/syntax::js-many-tiny-strings
