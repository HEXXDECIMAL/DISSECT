composite_rules:
  - id: driver-hidden-api
    desc: Kernel driver hides critical APIs using encoding
    crit: hostile
    conf: 0.95
    all:
      - id: micro-traits/os/kernel/routines::dynamic-resolution
    any:
      - id: micro-traits/os/kernel/hiding/exec::thread-manipulation-enc
      - id: micro-traits/os/kernel/hiding/mem::mem-protect-enc
      - id: micro-traits/os/kernel/hiding/mem::pe-header-enc
      - id: micro-traits/os/kernel/hiding/mem::pe-data-enc
    needs: 2

  - id: driver-suspicious-path
    desc: Kernel driver references suspicious System32 binary
    crit: suspicious
    conf: 0.8
    all:
      - id: micro-traits/fs/path/system::system32-bin
      - id: micro-traits/os/kernel/routines::dynamic-resolution