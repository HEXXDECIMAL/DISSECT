# SSH Remote Session Detection
# ATT&CK: T1497 (Virtualization/Sandbox Evasion)
# Detects checking for SSH environment variables (remote session detection)

defaults:
  crit: notable
  conf: 0.7
  attack: "T1497"
  platforms: [linux, unix, macos]

composite_rules:
  - id: ssh-check
    desc: Checks SSH variables (remote session detection)
    # Any SSH_* env var indicates checking for remote session
    any:
      - id: micro-behaviors/os/env/vars/ssh
