composite_rules:
  - id: deezer-credential-harvester-args
    desc: Detects python scripts that use click to harvest deezer credentials via arguments.
    crit: suspicious
    all:
      - id: metadata/import/python::click
      - id: micro-traits/cli/argument/credential::suspicious-arg-gmail
      - id: micro-traits/cli/argument/credential::suspicious-arg-passw

  - id: deezer-credential-harvester
    desc: Detects python scripts that use click to harvest deezer credentials.
    crit: suspicious
    any:
      - id: deezer-credential-harvester-args
      - id: micro-traits/fs/path/webserver::hardcoded-path-var-www-html
