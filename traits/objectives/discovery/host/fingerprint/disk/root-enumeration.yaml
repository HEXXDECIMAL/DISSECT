composite_rules:
  - id: root-dir-enumeration
    desc: Iterates over root directories (C:, D:, /, /home) to list files
    crit: hostile
    all:
      - id: micro-traits/fs/enumerate/directory::root-paths-array
    any:
      - id: micro-traits/fs/enumerate/directory::fs-readdir
      - id: objectives/impact/ransomware/behavior::readdir-sync
      - id: objectives/impact/ransomware/behavior::readdir-fn
    unless:
      - id: metadata/library/syntaxhighlighter::syntaxhighlighter-brush
      - id: metadata/library::commander
      - id: metadata/dev/testing/node::node-common-require