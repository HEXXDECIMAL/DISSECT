# Application Reconnaissance (Browsers, Office, Dev Tools)
# ATT&CK: T1057 (Process Discovery)
# MBC: E1592

composite_rules:
  - id: process-enum-method
    desc: Process enumeration method
    crit: notable
    conf: 0.6
    any:
      - id: objectives/discovery/host/process::tasklist-shell
      - id: objectives/discovery/host/process::psutil-enum

  - id: process-enum-targets
    desc: Target application strings
    crit: notable
    conf: 0.6
    any:
      - id: micro-behaviors/process/enumerate/apps::browser-apps
      - id: micro-behaviors/process/enumerate/apps::office-apps
      - id: micro-behaviors/process/enumerate/apps::dev-apps

  - id: process-app-enumeration
    desc: Enumerates specific target applications (browsers, office) in process list
    crit: suspicious
    conf: 0.85
    all:
      - id: process-enum-method
      - id: process-enum-targets