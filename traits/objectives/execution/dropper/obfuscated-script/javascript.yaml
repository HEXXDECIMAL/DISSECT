defaults:
  for: [javascript, typescript]

composite_rules:
  - id: obfuscated-jscript-dropper
    desc: "Obfuscated JScript dropper behavior (conditional compilation + eval + string manipulation)"
    crit: hostile
    conf: 0.85
    all:
      - id: objectives/execution/interpreter/scripting/jscript::jscript-cc-eval
    any:
      - id: objectives/anti-static/obfuscation/source/syntax::js-split-string-property
      - id: objectives/anti-static/obfuscation/code-metrics/structure::very-long-lines
      - id: objectives/anti-static/obfuscation/source/syntax::js-comma-sequence-obfuscation-v2
    needs: 1
    attack: "T1027"
    mbc: "B0032"
