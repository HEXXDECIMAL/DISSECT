# CVE-2018-4878 Flash Dropper (LoadSWF)
# Detects the specific dropper/downloader component used in CVE-2018-4878 campaigns.

composite_rules:
  - id: cve-2018-4878-flash-dropper
    desc: CVE-2018-4878 Flash Dropper (LoadSWF)
    crit: hostile
    conf: 0.95
    mbc: "B0029"
    attack: "T1105"
    all:
      - id: micro-traits/data/source/markers/actionscript::loadswf-xor-loop
    any:
      - id: micro-traits/data/source/markers/actionscript::loadswf-typos
      - id: micro-traits/data/source/markers/actionscript::loadswf-class-name
      - id: micro-traits/data/source/markers/actionscript::loadswf-fingerprint-params