# Obfuscated WSH Patterns
# Detects obfuscated calls to WScript methods

defaults:
  crit: suspicious
  conf: 0.8
  for: [javascript]
  platforms: [windows]

traits:
  - id: wscript-shell-obfuscated
    desc: Obfuscated WScript.Shell creation (hex escape or concat)
    if:
      type: raw
      # Matches .Shel\x6c or .Shell via concatenation
      regex: '\.Shel(\\x6c|["'']\+["'']l)'

  - id: wscript-quit-obfuscated
    desc: Obfuscated WScript.Quit call
    if:
      type: raw
      # Matches ["Q"+"u"+"it"] or ["Q"+"uit"] etc.
      regex: '\[["'']Q["'']\+["'']u["'']\+["'']it["'']\]|\[["'']Q["'']\+["'']uit["'']\]'
