composite_rules:
  - id: js-downloader-wsh-classic
    crit: hostile
    conf: 0.95
    desc: JavaScript WSH downloader with file drop and execute
    for: [javascript]
    platforms: [windows]
    all:
      - id: objectives/execution/interpreter/script/wsh::wscript-shell
      - id: micro-traits/net/http/client::http-client-any
      - id: micro-traits/process/create/exec::file-execution
      - id: micro-traits/fs/file/write::file-write

  - id: js-downloader-wsh-obfuscated
    crit: hostile
    conf: 0.95
    desc: Obfuscated JavaScript WSH downloader execution chain
    for: [javascript]
    platforms: [windows]
    all:
      - id: objectives/execution/interpreter/script/wsh::wscript-shell-fragment
      - id: objectives/execution/interpreter/script/wsh::adodb-fragment
      - id: objectives/execution/interpreter/script/wsh::response-body-fragment
      - id: objectives/execution/interpreter/script/wsh::expand-env-fragment
      - id: micro-traits/process/create/exec::file-execution
