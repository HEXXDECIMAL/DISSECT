# Node.js Data Encoding for Exfiltration
# Behavioral composites that combine encoding with exfiltration indicators
# ATT&CK: T1041 (Exfiltration Over C2 Channel), T1132 (Data Encoding)
#
# Note: Atomic encoding traits moved to data/encoding/node.yaml
# This file contains only behavioral composites that indicate exfiltration

defaults:
  for: [javascript, typescript]
  attack: "T1041"

composite_rules:
  # Encode then exfil pattern
  - id: node-encode-exfil
    desc: Encodes data then sends via
    crit: suspicious
    conf: 0.9
    all:
      - id: data/encoding/node/node-base64-encode
      - id: comm/http/request/javascript/http-client-usage
    unless:
      - id: os/admin/legitimate/http-tools/package-manager
      - id: os/admin/legitimate/http-tools/ci-cd-pipeline
