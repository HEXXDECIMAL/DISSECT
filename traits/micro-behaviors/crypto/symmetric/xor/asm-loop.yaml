defaults:
  for:
  - elf
  - pe
  - macho
  - dll
  - so
  - dylib
traits:
- id: asm-loop-op
  conf: 0.7
  crit: suspicious
  desc: Detects arithmetic op used in encryption loops
  if:
    type: raw
    regex: (xor|sub|add)\s+(byte|dword)\s+ptr\s+\[.+?\],
- id: asm-loop-reg
  conf: 0.7
  crit: suspicious
  desc: Detects register operands common in encryption loops
  if:
    type: raw
    regex: \],\s+(?:al|e[abcd]x)
- id: asm-loop-control-transfer
  conf: 0.7
  crit: inert
  desc: Detects loop/jump control transfer in assembly
  if:
    type: raw
    regex: (loop|jb|jmp)\s+\w+
composite_rules:
- id: asm-loop-any
  desc: Detects simple XOR/SUB/ADD encryption loop in assembly
  crit: suspicious
  conf: 0.7
  all:
  - id: asm-loop
  - id: asm-loop-control-transfer
- id: asm-loop
  conf: 0.7
  crit: suspicious
  desc: Detects simple XOR/SUB/ADD encryption loop in assembly
  all:
  - id: asm-loop-op
  - id: asm-loop-reg
