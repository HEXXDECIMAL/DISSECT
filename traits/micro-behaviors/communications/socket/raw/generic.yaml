# Raw Socket Operations
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

defaults:
  for: [all]
  mbc: "C0001"
  attack: "T1011"

traits:
  - id: raw-socket-ref
    desc: Raw socket terminology
    crit: notable
    conf: 0.7
    for: [c, go, rust, python, shell, elf, macho]
    if:
      type: string
      regex: "raw.?socket"
      case_insensitive: true

  # Removed proc-net-raw duplicate - use micro-behaviors/fs/proc/info::proc-net-raw

composite_rules:
  - id: raw
    desc: Create raw network sockets
    crit: notable
    conf: 0.8
    any:
      - id: raw-socket-ref
      - id: micro-behaviors/fs/proc/info::proc-net-raw
