# Socket Connect - Go
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

defaults:
  for: [go, elf, macho, pe]
  mbc: "C0001"
  attack: "T1071"

traits:
  - id: dial
    desc: Go net.Dial call
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "net.Dial"

  - id: dialer-dial
    desc: Go net.Dialer.Dial call
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "net.(*Dialer).Dial"

  - id: dial-tcp
    desc: Go net.DialTCP call
    crit: notable
    conf: 0.85
    if:
      type: symbol
      exact: "net.DialTCP"

composite_rules:
  - id: go-dial-methods
    desc: Go network dial methods
    any:
      - id: dial
      - id: dialer-dial
      - id: dial-tcp
