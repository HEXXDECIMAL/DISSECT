traits:
  - id: dnr-modify
    desc: DNR action type modifyHeaders
    crit: notable
    conf: 0.6
    for: [all]
    if:
      type: string
      substr: '"modifyHeaders"'

  - id: dnr-remove
    desc: DNR operation remove
    crit: notable
    conf: 0.6
    for: [all]
    if:
      type: string
      substr: '"remove"'

  - id: dnr-origin
    desc: DNR header origin
    crit: notable
    conf: 0.6
    for: [all]
    if:
      type: string
      substr: '"origin"'

composite_rules:
  - id: dnr-origin-strip
    desc: DeclarativeNetRequest rule to strip Origin header
    crit: suspicious
    conf: 0.95
    for: [all]
    all:
      - id: dnr-modify
      - id: dnr-remove
      - id: dnr-origin
