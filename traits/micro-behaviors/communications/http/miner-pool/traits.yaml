# Cryptocurrency Mining Pool Patterns
# Detects references to mining pools and stratum protocols

defaults:
  for: [all]
  crit: notable
  conf: 0.7

traits:
  - id: pool-subdomain
    desc: pool. subdomain prefix
    if:
      type: string
      regex: 'pool\.[a-z0-9-]+\.[a-z]{2,10}'

  - id: stratum-protocol
    desc: stratum+tcp or stratum+ssl protocol
    if:
      type: string
      regex: 'stratum\+(tcp|ssl)://'

  - id: pool-keyword-in-url
    desc: pool keyword in URL
    if:
      type: string
      regex: '(?:https?|stratum\+tcp|stratum\+ssl)://[^\s]{1,120}pool'

composite_rules:
  - id: mining-pool-url
    desc: Mining pool URL reference
    any:
      - id: pool-subdomain
      - id: stratum-protocol
      - id: pool-keyword-in-url
