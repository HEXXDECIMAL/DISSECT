# HTTP Request Operations - Python urllib library
# MBC: C0002 (HTTP Communication)
# ATT&CK: T1071.001

defaults:
  for: [python]

traits:
  - id: urllib-word
    desc: urllib module reference
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "urllib"

  - id: urllib-urlopen
    desc: urllib.request.urlopen call
    crit: inert
    conf: 0.7
    if:
      type: string
      substr: "urllib.request.urlopen"

  - id: urllib-urlopen-py2
    desc: urllib.urlopen call (Python 2)
    crit: inert
    conf: 0.7
    if:
      type: string
      substr: "urllib.urlopen"

  # GuardDog: urlretrieve for downloading files
  - id: urllib-urlretrieve
    desc: urllib.request.urlretrieve call
    crit: notable
    conf: 0.80
    mbc: "C0002"
    attack: "T1105"
    if:
      type: symbol
      regex: 'urllib\.(request\.)?urlretrieve'
