defaults:
  for:
  - all
traits:
- id: sock-stream
  desc: SOCK_STREAM socket type
  crit: inert
  conf: 0.5
  if:
    type: string
    substr: SOCK_STREAM
- id: net-dial
  desc: net.Dial Go function
  crit: inert
  conf: 0.5
  if:
    type: string
    substr: net.Dial
- id: tcp-conn
  desc: TCPConn type
  crit: inert
  conf: 0.5
  if:
    type: string
    substr: TCPConn
- id: create-socket
  desc: CreateSocket function
  crit: inert
  conf: 0.5
  if:
    type: string
    substr: CreateSocket
- id: go-net-error-endpoint
  desc: Go net error - endpoint issues
  crit: inert
  conf: 0.6
  if:
    type: string
    regex: transport endpoint is (not|already) connected
- id: go-net-error-connection-refused
  desc: Go net error - connection refused
  crit: inert
  conf: 0.6
  if:
    type: string
    substr: "connection refused"
- id: go-net-error-connection-timeout
  desc: Go net error - connection timed out
  crit: inert
  conf: 0.6
  if:
    type: string
    substr: "connection timed out"
- id: go-net-error-connection-reset
  desc: Go net error - reset by peer
  crit: inert
  conf: 0.6
  if:
    type: string
    substr: "connection reset by peer"
- id: go-net-error-connection-abort
  desc: Go net error - connection abort
  crit: inert
  conf: 0.6
  if:
    type: string
    regex: "connection (?:abort|dropped)"
composite_rules:
- id: connect
  desc: TCP connection operations
  crit: inert
  conf: 0.66
  any:
  - id: sock-stream
  - id: net-dial
  - id: tcp-conn
  - id: create-socket
  - id: go-net-error-connection
  - id: go-net-error-endpoint
- id: go-net-error-connection
  desc: Go net error - connection issues
  crit: inert
  conf: 0.6
  any:
  - id: go-net-error-connection-refused
  - id: go-net-error-connection-timeout
  - id: go-net-error-connection-reset
  - id: go-net-error-connection-abort
