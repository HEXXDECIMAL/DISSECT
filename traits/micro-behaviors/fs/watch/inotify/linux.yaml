# Inotify Filesystem Monitoring (Linux-specific)
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: inotify-init
    desc: Monitor filesystem events via inotify
    crit: inert
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "inotify_init"

  - id: inotify-init1
    desc: Monitor filesystem events via inotify
    crit: inert
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "inotify_init1"

  - id: inotify-add-watch
    desc: Monitor filesystem events via inotify
    crit: inert
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "inotify_add_watch"

  - id: inotify-rm-watch
    desc: Monitor filesystem events via inotify
    crit: inert
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "inotify_rm_watch"

composite_rules:
  - id: inotify
    desc: Monitor filesystem events via inotify
    crit: inert
    conf: 0.66
    any:
      - id: inotify-init
      - id: inotify-init1
      - id: inotify-add-watch
      - id: inotify-rm-watch
