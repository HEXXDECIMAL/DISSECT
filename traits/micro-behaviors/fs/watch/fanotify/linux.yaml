# Fanotify Filesystem Monitoring (Linux-specific)
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: fanotify-init
    desc: Filesystem-wide event monitoring via fanotify
    crit: notable
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "fanotify_init"

  - id: fanotify-mark
    desc: Filesystem-wide event monitoring via fanotify
    crit: notable
    conf: 0.66
    for: [elf, so, c]
    if:
      type: symbol
      exact: "fanotify_mark"

composite_rules:
  - id: fanotify
    desc: Filesystem-wide event monitoring via fanotify
    crit: notable
    conf: 0.66
    any:
      - id: fanotify-init
      - id: fanotify-mark
