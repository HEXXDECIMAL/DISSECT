# Directory Creation - Windows
# MBC: C0046 (Create File)
# ATT&CK: T1083

traits:
  - id: create-directory
    desc: Create directories (Windows API)
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "CreateDirectory"

  - id: create-directory-a
    desc: Create directories (Windows API ANSI)
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "CreateDirectoryA"

  - id: create-directory-w
    desc: Create directories (Windows API Unicode)
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "CreateDirectoryW"

  - id: create-directory-ex
    desc: Create directories (Windows API)
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      regex: "^CreateDirectoryEx(A|W)?$"

composite_rules:
  - id: mkdir-win
    desc: Create directories (Windows API)
    crit: inert
    conf: 0.66
    any:
      - id: create-directory
      - id: create-directory-a
      - id: create-directory-w
      - id: create-directory-ex
