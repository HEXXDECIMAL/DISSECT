# Directory Traversal with Delete Operations
# Micro-behaviors for iterating directories with deletion operations

defaults:
  crit: inert
  conf: 0.85

traits:
  - id: traverse-readdir-walk-find
    desc: Directory traversal operation
    for: [javascript, typescript, python, shell]
    if:
      type: raw
      regex: fs\.readdirSync|os\.walk|find\s+\.

  - id: delete-unlink-node-py
    desc: File deletion operation (Node.js/Python)
    for: [javascript, typescript, python]
    if:
      type: raw
      regex: unlinkSync|os\.(remove|unlink)

  - id: delete-flag-shell
    desc: Delete flag in shell command
    for: [shell]
    if:
      type: raw
      regex: -delete

  - id: rm-rf-cmd
    desc: rm -rf command
    for: [shell]
    conf: 0.6
    if:
      type: raw
      regex: rm\s+-rf

composite_rules:
  - id: delete-shell
    desc: Shell deletion operation
    crit: inert
    conf: 0.85
    for: [shell]
    any:
      - id: delete-flag-shell
      - id: rm-rf-cmd
