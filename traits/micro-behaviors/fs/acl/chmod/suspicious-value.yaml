defaults:
  for: [all]

traits:
  - id: suspicious-value
    crit: suspicious
    attack: T1222
    desc: "Detects dangerous chmod values (world writable)"
    if:
      type: string
      regex: "chmod\\s+(0?777|0?666|0?775|0?888)"

  - id: chmod-exec-symbolic
    crit: notable
    attack: T1222
    desc: "Detects chmod +x variants"
    if:
      type: string
      regex: "chmod\\s+(\\+x|u\\+x|a\\+x)"

  - id: chmod-exec-numeric
    crit: notable
    attack: T1222
    desc: "Detects chmod 755 variants"
    if:
      type: string
      regex: "chmod\\s+(755|0755)"

composite_rules:
  - id: chmod-exec
    crit: notable
    attack: T1222
    desc: "Detects chmod making file executable"
    any:
      - id: chmod-exec-symbolic
      - id: chmod-exec-numeric
