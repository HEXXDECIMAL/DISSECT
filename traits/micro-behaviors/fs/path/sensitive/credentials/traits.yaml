# Sensitive Credential File Paths
# GuardDog-inspired: Detects access to common credential files

defaults:
  crit: suspicious
  conf: 0.95
  attack: "T1552.001"

traits:
  # === Cloud Provider Credentials ===

  - id: aws-credentials
    desc: AWS credentials file path
    for: [all]
    if:
      type: string
      regex: '\.aws/credentials'

  - id: aws-config
    desc: AWS config file path
    for: [all]
    if:
      type: string
      regex: '\.aws/config'

  - id: gcloud-credentials
    desc: Google Cloud credentials path
    for: [all]
    if:
      type: string
      regex: '\.config/gcloud'

  - id: azure-credentials
    desc: Azure credentials path
    for: [all]
    if:
      type: string
      regex: '\.azure/credentials'

  # === Container & Docker ===

  - id: docker-config
    desc: Docker config.json path
    for: [all]
    if:
      type: string
      regex: '\.docker/config\.json'

  - id: kube-config
    desc: Kubernetes config path
    for: [all]
    if:
      type: string
      regex: '\.kube/config'

  # === SSH Keys ===

  - id: ssh-private-key
    desc: SSH private key path
    for: [all]
    if:
      type: string
      regex: '\.ssh/id_(?:rsa|dsa|ecdsa|ed25519)'

  - id: ssh-dir
    desc: .ssh directory path
    for: [all]
    if:
      type: string
      regex: '\.ssh/'

  # === Git Credentials ===

  - id: git-credentials
    desc: Git credentials file
    for: [all]
    if:
      type: string
      regex: '\.git-credentials'

  - id: netrc
    desc: .netrc credentials file
    for: [all]
    if:
      type: string
      regex: '\.netrc'

composite_rules:
  # Cloud credentials
  - id: cloud-credentials
    desc: Cloud provider credential file paths
    crit: suspicious
    conf: 0.95
    attack: "T1552.001"
    any:
      - id: aws-credentials
      - id: aws-config
      - id: gcloud-credentials
      - id: azure-credentials

  # Container credentials
  - id: container-credentials
    desc: Container/orchestration credential paths
    crit: suspicious
    conf: 0.95
    attack: "T1552.001"
    any:
      - id: docker-config
      - id: kube-config

  # SSH credentials
  - id: ssh-credentials
    desc: SSH credential file paths
    crit: suspicious
    conf: 0.95
    attack: "T1552.001"
    any:
      - id: ssh-private-key
      - id: ssh-dir
