# Windows Path Detection
# Capabilities related to handling Windows file paths

defaults:
  for: [all]

traits:
  - id: hardcoded-windows-root-pattern
    desc: Hardcoded Windows root path pattern
    crit: inert
    conf: 0.8
    if:
      type: raw
      regex: '["''][A-Z]:[\\/]+'

composite_rules:
  - id: hardcoded-windows-root
    desc: Hardcoded Windows root path (C:\, D:\, etc.)
    crit: notable
    conf: 0.8
    all:
      - id: hardcoded-windows-root-pattern
    unless:
      - id: metadata/library/vscode::vscode-extension
      - id: metadata/library/test::test-framework
    downgrade:
      any:
        - id: metadata/library::botocore-lib
        - id: metadata/import/python::boto3
        - id: micro-behaviors/comm/ssh/connect::paramiko
