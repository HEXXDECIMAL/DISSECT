defaults:
  for: [php]

traits:
  - id: php-file-write-func
    description: "Writes data to a file via functions"
    crit: notable
    attack: T1546
    if:
      type: raw
      regex: '[$]?(?:fwrite|fputs|file_put_contents|fopen)\s*[(]'
      case_insensitive: true

  - id: php-file-write-spl
    description: "Writes data to a file via SplFileObject"
    crit: notable
    attack: T1546
    if:
      type: string
      word: SplFileObject
      case_insensitive: true

composite_rules:
  - id: php-file-write
    description: "Writes data to a file"
    crit: notable
    attack: T1546
    any:
      - id: php-file-write-func
      - id: php-file-write-spl
