# Embedded Help/Usage Text
# Detects presence of usage and help strings
# Indicates a legitimate CLI tool with documentation
# Most malware lacks comprehensive help text
#
# Use for ML analysis: legitimate tools typically embed help/usage text,
# while malware often lacks these strings

defaults:
  for: [all]

traits:
  # usage:: use metadata/quality/help/traits.yaml::usage-lower (canonical)
  # --help: use metadata/quality/help/traits.yaml::help-long-flag (canonical)
  - id: usage-help
    desc: Short -h help flag
    crit: inert
    conf: 0.7
    if:
      type: string
      regex: "-h[^a-z]"

  - id: version-text
    desc: Version information string
    crit: inert
    conf: 0.7
    if:
      type: string
      regex: "--version|^version [0-9]|^v[0-9]+\\.[0-9]"
      case_insensitive: true
