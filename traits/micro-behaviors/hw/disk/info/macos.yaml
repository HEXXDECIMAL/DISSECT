# Disk Information - macOS
# ATT&CK: T1082 (System Information Discovery)

traits:
  - id: da-disk-copy-description
    desc: macOS DiskArbitration framework API
    crit: notable
    conf: 0.7
    attack: "T1082"
    platforms: [macos]
    for: [macho, dylib, c]
    if:
      type: symbol
      exact: "DADiskCopyDescription"

  - id: da-disk-create-from-bsd-name
    desc: macOS DiskArbitration framework
    crit: notable
    conf: 0.7
    attack: "T1082"
    platforms: [macos]
    for: [macho, dylib, c]
    if:
      type: symbol
      exact: "DADiskCreateFromBSDName"

composite_rules:
  - id: diskarbitration
    desc: macOS DiskArbitration framework
    crit: notable
    conf: 0.7
    attack: "T1082"
    any:
      - id: da-disk-copy-description
      - id: da-disk-create-from-bsd-name
