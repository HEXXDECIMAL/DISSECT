# Clipboard Access Capabilities
# Clipboard manipulation APIs

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Clipboard Access ===
  - id: open-clipboard
    desc: Open clipboard access
    crit: suspicious
    conf: 0.75
    if:
      type: symbol
      exact: "OpenClipboard"

  - id: close-clipboard
    desc: Close clipboard
    crit: inert
    conf: 0.65
    if:
      type: symbol
      exact: "CloseClipboard"

  # === Clipboard Manipulation ===
  - id: set-clipboard-data
    desc: Write data to clipboard
    crit: suspicious
    conf: 0.80
    if:
      type: symbol
      exact: "SetClipboardData"

  - id: get-clipboard-data
    desc: Read data from clipboard
    crit: suspicious
    conf: 0.75
    if:
      type: symbol
      exact: "GetClipboardData"

  - id: empty-clipboard
    desc: Clear clipboard contents
    crit: suspicious
    conf: 0.75
    if:
      type: symbol
      exact: "EmptyClipboard"

  # === MacOS Clipboard Access ===
  - id: macos-nspasteboard-class
    desc: NSPasteboard class reference
    crit: notable
    conf: 0.8
    for: [macho]
    if:
      type: string
      substr: "NSPasteboard"

  - id: macos-general-pasteboard
    desc: generalPasteboard reference
    crit: notable
    conf: 0.8
    for: [macho]
    if:
      type: string
      substr: "generalPasteboard"

  - id: macos-pasteboard-items
    desc: Iterates macOS pasteboard items
    crit: notable
    conf: 0.8
    for: [macho]
    if:
      type: string
      substr: "pasteboardItems"

composite_rules:
  - id: macos-nspasteboard
    desc: Accesses macOS NSPasteboard
    crit: notable
    conf: 0.8
    for: [macho]
    any:
      - id: macos-nspasteboard-class
      - id: macos-general-pasteboard
