defaults:
  crit: inert
  for:
  - '*'
traits:
- id: backup-script
  desc: HTTP backup script pattern
  conf: 0.8
  if:
    type: raw
    regex: curl\s+.{0,100}backup|wget\s+.{0,100}backup|aws\s+s3\s+cp.{0,100}backup
- id: installer-script
  desc: HTTP installer script pattern
  conf: 0.8
  if:
    type: raw
    regex: curl\s+.{0,100}install|wget\s+.{0,100}install|install\.sh
- id: package-manager
  desc: Package manager HTTP usage
  conf: 0.9
  if:
    type: raw
    regex: apt-get\s+update|apk\s+add|brew\s+install
- id: ci-cd-pipeline
  desc: CI/CD pipeline HTTP usage
  conf: 0.8
  if:
    type: raw
    regex: jenkins|gitlab-ci|github-actions|travis-ci
- id: health-check-fetch
  desc: HTTP health check fetch command
  conf: 0.9
  if:
    type: raw
    regex: (curl|wget)\s+[^|&]{0,120}health
- id: health-check-local
  desc: Localhost health endpoint
  conf: 0.9
  if:
    type: raw
    regex: http://(?:localhost|127\.0\.0\.1).{0,50}/health
composite_rules:
- id: health-check
  desc: HTTP health check pattern
  conf: 0.9
  any:
  - id: health-check-fetch
  - id: health-check-local
