# Credential Environment Variables
# Known credential/secret environment variable patterns
# Prefixes: AWS_, GITHUB_, GH_, GITLAB_, AZURE_, GOOGLE_, DOCKER_, etc.
# Suffixes: _TOKEN, _KEY, _SECRET, _PASSWORD, _CREDENTIALS, _AUTH

defaults:
  for: [all]
  crit: inert
  conf: 0.7

traits:
  # Specific known credentials
  - id: ssh-private-key
    desc: SSH_PRIVATE_KEY environment variable
    if:
      type: string
      exact: "SSH_PRIVATE_KEY"

  - id: jwt-secret
    desc: JWT_SECRET environment variable
    if:
      type: string
      exact: "JWT_SECRET"

  - id: session-secret
    desc: SESSION_SECRET environment variable
    if:
      type: string
      exact: "SESSION_SECRET"

  - id: cookie-secret
    desc: COOKIE_SECRET environment variable
    if:
      type: string
      exact: "COOKIE_SECRET"

  - id: root-password
    desc: ROOT_PASSWORD environment variable
    if:
      type: string
      exact: "ROOT_PASSWORD"

  - id: admin-password
    desc: ADMIN_PASSWORD environment variable
    if:
      type: string
      exact: "ADMIN_PASSWORD"

  - id: service-account-key
    desc: SERVICE_ACCOUNT_KEY environment variable
    if:
      type: string
      exact: "SERVICE_ACCOUNT_KEY"

  # Pattern-based detection for provider credentials
  - id: aws-credentials
    desc: AWS credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^AWS_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: github-credentials
    desc: GitHub credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^(GITHUB_|GH_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: gitlab-credentials
    desc: GitLab credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^GITLAB_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: azure-credentials
    desc: Azure credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^AZURE_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: google-credentials
    desc: Google credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^GOOGLE_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: docker-credentials
    desc: Docker credential environment variables
    conf: 0.8
    if:
      type: string
      regex: '^DOCKER_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: database-credentials-generic
    desc: Generic database credential variables
    conf: 0.8
    if:
      type: string
      regex: '^(DATABASE_|DB_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: database-credentials-redis
    desc: Redis database credential variables
    conf: 0.8
    if:
      type: string
      regex: '^REDIS_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: database-credentials-sql
    desc: SQL database credential variables
    conf: 0.8
    if:
      type: string
      regex: '^(POSTGRES_|MYSQL_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: database-credentials-nosql
    desc: MongoDB credential variables
    conf: 0.8
    if:
      type: string
      regex: '^MONGO_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: package-registry-credentials-npm
    desc: NPM/PyPI registry credentials
    conf: 0.7
    if:
      type: string
      regex: '^(NPM_|PYPI_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: package-registry-credentials-enterprise
    desc: Enterprise registry credentials
    conf: 0.7
    if:
      type: string
      regex: '^(NUGET_|ARTIFACTORY_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: chat-api-credentials
    desc: Chat/messaging API credentials
    conf: 0.7
    if:
      type: string
      regex: '^(SLACK_|DISCORD_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: ai-api-credentials
    desc: AI service API credentials
    conf: 0.7
    if:
      type: string
      regex: '^(OPENAI_|ANTHROPIC_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: payment-api-credentials-stripe
    desc: Stripe payment API credentials
    conf: 0.7
    if:
      type: string
      regex: '^STRIPE_.{0,50}_(TOKEN|KEY|SECRET)$'

  - id: payment-api-credentials-messaging
    desc: Messaging service API credentials
    conf: 0.7
    if:
      type: string
      regex: '^(TWILIO_|SENDGRID_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: security-tool-credentials-scanning
    desc: Security scanning tool credentials
    conf: 0.7
    if:
      type: string
      regex: '^(SONAR_|SNYK_).{0,50}_(TOKEN|KEY|SECRET)$'

  - id: security-tool-credentials-vault
    desc: Vault/secrets management credentials
    conf: 0.7
    if:
      type: string
      regex: '^(VAULT_|HASHICORP_).{0,50}_(TOKEN|KEY|SECRET)$'
