# Environment Variable Access - Go
# ATT&CK: T1082 (System Information Discovery)

defaults:
  for: [go, elf, macho, pe]
  crit: notable
  attack: "T1082"

traits:
  # GuardDog: os.Getenv() - read environment variable
  - id: os-getenv
    desc: os.Getenv() environment variable
    conf: 0.80
    if:
      type: symbol
      exact: "os.Getenv"

  # GuardDog: os.LookupEnv() - check environment variable
  - id: os-lookupenv
    desc: os.LookupEnv() environment lookup
    conf: 0.80
    if:
      type: symbol
      exact: "os.LookupEnv"

  # GuardDog: os.Environ() - all environment variables
  - id: os-environ
    desc: os.Environ() all environment variables
    conf: 0.85
    if:
      type: symbol
      exact: "os.Environ"

composite_rules:
  # Environment access capability
  - id: env-access
    desc: Environment variable access
    crit: notable
    conf: 0.80
    any:
      - id: os-getenv
      - id: os-lookupenv
      - id: os-environ
