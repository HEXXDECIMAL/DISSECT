# Raw Memory Access - Linux
# ATT&CK: T1003 (OS Credential Dumping)

defaults:
  for: [all]

traits:
  - id: kmem
    desc: Access raw kernel memory (/dev/kmem)
    crit: suspicious
    conf: 0.9
    attack: "T1003"
    platforms: [linux, unix]
    if:
      type: string
      substr: "/dev/kmem"

  - id: dev-mem
    desc: Access raw system memory (/dev/mem)
    crit: suspicious
    conf: 0.9
    attack: "T1003"
    platforms: [linux]
    if:
      type: string
      substr: "/dev/mem"
    # X11 DGA (Direct Graphics Access) libraries legitimately use /dev/mem
    # for direct video memory access - this is core DGA functionality
    downgrade:
      any:
        - id: micro-behaviors/dylib/load/x11-ref
        - id: micro-behaviors/dylib/load/x11-dga-marker

  # === Memdump atomic indicators ===
  - id: memdump-cmd
    desc: memdump command reference
    crit: notable
    conf: 0.65
    attack: "T1003"
    platforms: [all]
    if:
      type: string
      word: "memdump"

  - id: dumpmem-cmd
    desc: dumpmem command reference
    crit: notable
    conf: 0.65
    attack: "T1003"
    platforms: [all]
    if:
      type: string
      word: "dumpmem"

composite_rules:
  # Memdump composite
  - id: memdump-ref
    desc: "Reference to memory dump tools"
    crit: notable
    conf: 0.65
    any:
      - id: memdump-cmd
      - id: dumpmem-cmd
