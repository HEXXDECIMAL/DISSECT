defaults:
  for: [javascript]

traits:
  - id: js-large-int-array
    desc: Array of large integers (potential char codes)
    crit: notable
    conf: 0.8
    if:
      type: ast
      language: javascript
      query: |
        (array
          (number) @num
        )
        (#match? @num "^[0-9]{2,}$")
    unless:
      - type: raw
        regex: "require\\(['\"]\\.\\./common['\"]\\)"

  - id: js-hex-number-array
    desc: Array of hex char codes
    crit: notable
    conf: 0.8
    if:
      type: ast
      language: javascript
      query: |
        (array
          (number) @num
        )
        (#match? @num "^0x[0-9a-fA-F]{2,}$")
