# Database Connection - ORM

defaults:
  for: [all]

traits:
  # === ORM micro-behaviors ===
  - id: gorm-io
    desc: gorm.io ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "gorm.io"

  - id: sqlalchemy
    desc: SQLAlchemy ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "sqlalchemy"

  - id: hibernate
    desc: Hibernate ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "hibernate"

  - id: django-db
    desc: django.db ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "django.db"

  - id: sequelize
    desc: Sequelize ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "sequelize"

  - id: prisma
    desc: Prisma ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "prisma"

  - id: typeorm
    desc: TypeORM ORM
    crit: notable
    conf: 0.85
    if:
      type: string
      substr: "typeorm"

composite_rules:
  # ORM composite (migrated from YARA)
  - id: orm
    desc: ORM framework usage
    crit: notable
    conf: 0.85
    any:
      - id: gorm-io
      - id: sqlalchemy
      - id: hibernate
      - id: django-db
      - id: sequelize
      - id: prisma
      - id: typeorm
