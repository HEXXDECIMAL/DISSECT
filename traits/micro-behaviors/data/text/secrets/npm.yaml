defaults:
  for: [javascript, typescript]
  mbc: E1059
  attack: T1552.001

traits:
  - id: npm-auth-token-extraction
    desc: NPM auth token extraction via string replace
    crit: suspicious
    conf: 1.0
    # Matches: content.replace("//registry.npmjs.org/:_authToken=", "")
    if:
      type: raw
      regex: \.replace\(\s*['"]//registry\.npmjs\.org/:_authToken=['"]\s*,

  - id: npm-auth-token-key-raw
    desc: NPM auth token key string
    crit: notable
    conf: 0.8
    if:
      type: string
      substr: "//registry.npmjs.org/:_authToken="
