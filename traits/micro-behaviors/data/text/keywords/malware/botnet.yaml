defaults:
  for: [all]

traits:
  - id: c2-polling-param-prefix-a
    desc: Common C2 status/task query key
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(\\?|&)(status|task)=[0-9a-zA-Z]"

  - id: c2-polling-param-prefix-b
    desc: Common C2 status/task query key
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(\\?|&)(job|cmd)=[0-9a-zA-Z]"

  - id: c2-polling-param-command
    desc: Common HTTP parameter for C2 status/task checks
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(\\?|&)command=[0-9a-zA-Z]"

composite_rules:
  - id: c2-polling-params
    desc: Common HTTP parameter for C2 status/task checks
    crit: notable
    conf: 0.6
    any:
      - id: c2-polling-param-prefix-a
      - id: c2-polling-param-prefix-b
      - id: c2-polling-param-command
