# Generic Text Patterns - Neutral Building Blocks
# These terms have no standalone malicious meaning - they only gain
# significance when combined with contextual indicators in composite rules.
# Placed here to avoid ML pipelines incorrectly weighting them as indicators.

defaults:
  crit: inert
  conf: 0.2
  for: ["*"]

traits:
  # === Memory/Buffer Terms ===
  - id: overflow
    desc: overflow keyword
    if:
      type: string
      substr: "overflow"

  - id: offset
    desc: offset keyword
    if:
      type: string
      substr: "offset"

  - id: address
    desc: address keyword
    if:
      type: string
      substr: "address"

  - id: padding
    desc: padding keyword
    if:
      type: string
      substr: "padding"

  - id: buffer
    desc: buffer keyword
    if:
      type: string
      substr: "buffer"

  # === Cryptocurrency Terms ===
  - id: crypto-word
    desc: crypto keyword (word match)
    if:
      type: string
      word: "crypto"

  - id: crypto-substr
    desc: crypto keyword (substr, catches imports)
    if:
      type: string
      substr: "crypto"

  # === Credential Terms ===
  - id: token
    desc: token keyword
    if:
      type: string
      regex: "(?i)token"

  - id: password
    desc: password keyword
    if:
      type: string
      substr: "password"
      case_insensitive: true

  - id: password-weak
    desc: weak password keyword (password12345678)
    crit: notable
    conf: 0.8
    if:
      type: string
      substr: "password12345678"

  - id: pwd
    desc: pwd keyword
    if:
      type: string
      exact: "pwd"

  - id: credential
    desc: credential keyword
    if:
      type: string
      substr: "credential"
      case_insensitive: true

  - id: secret
    desc: secret keyword
    if:
      type: string
      substr: "secret"
      case_insensitive: true

  # === Command/Execution Terms ===
  - id: command
    desc: command keyword
    if:
      type: string
      substr: "command"

  - id: pipe
    desc: pipe keyword
    if:
      type: string
      exact: "pipe"

  - id: output
    desc: output keyword
    if:
      type: string
      substr: "output"

  - id: execute
    desc: execute keyword
    if:
      type: string
      substr: "execute"

  - id: payload
    desc: payload keyword
    if:
      type: string
      substr: "payload"

  - id: isrc
    desc: ISRC (International Standard Recording Code) keyword
    if:
      type: string
      substr: "isrc"
      case_insensitive: true

  - id: exploit
    desc: exploit keyword
    if:
      type: string
      substr: "exploit"

  # === Network Terms ===
  # Removed socket duplicate - use objectives/command-and-control/reverse-shell/pty::python-socket or micro-behaviors/communications/socket patterns

  - id: connect
    desc: connect keyword
    if:
      type: string
      substr: "connect"

  - id: send
    desc: send keyword
    if:
      type: string
      exact: "send"

  - id: recv
    desc: recv keyword
    if:
      type: string
      exact: "recv"

  # === Security/Evasion Terms ===
  - id: bypass
    desc: bypass keyword
    if:
      type: string
      word: "bypass"
      case_insensitive: true

  - id: hide
    desc: hide keyword
    if:
      type: string
      word: "hide"
      case_insensitive: true

  # === Script Engine Terms ===
  - id: powershell
    desc: powershell keyword
    if:
      type: string
      substr: "powershell"
      case_insensitive: true

  # Removed cmd duplicate - use objectives/command-and-control/reverse-shell/socket/go::cmd-plain or specific patterns

  # === Misc Generic Terms ===
  # Removed runtime duplicate - use metadata/hardening::hardened-runtime or specific patterns

  - id: tmp
    desc: tmp keyword
    if:
      type: string
      exact: "tmp"

  - id: temp
    desc: temp keyword
    if:
      type: string
      exact: "temp"
