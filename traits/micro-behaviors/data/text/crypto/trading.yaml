# Crypto Trading Terminology
# Common terms used in crypto trading bots and DeFi protocols

defaults:
  crit: notable
  conf: 0.5
  for: [all]

traits:
  - id: defi-protocol-dex
    desc: DEX protocol references (Uniswap/Sushiswap/Pancakeswap)
    if:
      type: string
      regex: "(?i)(uniswap|sushiswap|pancakeswap)"

  - id: defi-protocol-lending
    desc: DeFi lending protocol references (Curve/Aave/Compound)
    if:
      type: string
      regex: "(?i)(curve|aave|compound)"

  - id: swap-operations
    desc: Token swap operation patterns
    if:
      type: string
      regex: "(?i)(swapExact|swap_tokens|swapTokensFor)"

  - id: contract-query
    desc: Smart contract query methods (getReserves/getPair)
    if:
      type: string
      regex: "(getReserves|calculatePrice|getPairContract|getTokenAndContract)"

  - id: arbitrage-terms-arbitrage
    desc: Arbitrage trading term (arbitrage)
    if:
      type: string
      word: "arbitrage"
      case_insensitive: true

  - id: arbitrage-terms-arb-for
    desc: Arbitrage trading term (arb_for)
    if:
      type: string
      word: "arb_for"
      case_insensitive: true

  - id: arbitrage-terms-arb-against
    desc: Arbitrage trading term (arb_against)
    if:
      type: string
      word: "arb_against"
      case_insensitive: true

  - id: arbitrage-terms-price-diff
    desc: Arbitrage trading term (price_difference)
    if:
      type: string
      word: "price_difference"
      case_insensitive: true

  - id: arbitrage-terms-flash-loan
    desc: Arbitrage trading term (flash_loan)
    if:
      type: string
      word: "flash_loan"
      case_insensitive: true

composite_rules:
  - id: arbitrage-terms
    desc: Arbitrage trading terms
    any:
      - id: arbitrage-terms-arbitrage
      - id: arbitrage-terms-arb-for
      - id: arbitrage-terms-arb-against
      - id: arbitrage-terms-price-diff
      - id: arbitrage-terms-flash-loan
