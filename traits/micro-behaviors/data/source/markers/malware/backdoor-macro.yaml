# Backdoor Source Code Indicators
# Detects suspicious macros and definitions in C/C++ source code

defaults:
  for: [c, cpp]

traits:
  - id: backdoor-macro-def
    desc: C macro defining a backdoor constant
    crit: suspicious
    if:
      type: raw
      regex: '#define\s+[A-Z0-9_]*BACKDOOR(?:_[A-Z0-9_]+)?\s+'

  - id: passwd-file-macro
    desc: C macro defining PASSWD_FILE constant
    crit: notable
    if:
      type: raw
      regex: '#define\s+PASSWD_FILE\s+'

  - id: shadow-file-macro
    desc: C macro defining SHADOW_FILE constant
    crit: suspicious
    if:
      type: raw
      regex: '#define\s+SHADOW_FILE\s+'
