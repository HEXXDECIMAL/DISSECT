traits:
  - id: loop-step-2
    desc: Loop with step 2
    crit: inert
    for:
      - js
      - vbs
    if:
      type: raw
      regex: 'for\s*\([^;]{0,50};\s*[^;]{0,50};\s*[^)]{0,50}\+=\s*2\)'

  - id: loop-structure
    desc: Loop structure (for/while)
    crit: inert
    for:
      - js
      - vbs
    if:
      type: raw
      regex: '(for|while)\s*\([^)]{0,50}\)'

  - id: parseint-16
    desc: parseInt with radix 16
    crit: inert
    for:
      - js
      - vbs
    if:
      type: raw
      regex: 'parseInt\s*\([^,]{0,50},\s*16\)'

  - id: fromcharcode
    desc: String.fromCharCode
    crit: inert
    for:
      - js
      - vbs
    if:
      type: raw
      regex: 'String\.fromCharCode'

  - id: substr-2
    desc: substr with length 2
    crit: inert
    for:
      - js
      - vbs
    if:
      type: raw
      regex: 'substr\s*\([^,]{0,50},\s*2\)'

composite_rules:
  - id: jscript-hex-decoder-loop
    desc: JScript loop structure consistent with hex decoding
    conf: 0.9
    crit: suspicious
    all:
      - id: loop-structure
      - id: parseint-16
      - id: fromcharcode
      - id: substr-2
