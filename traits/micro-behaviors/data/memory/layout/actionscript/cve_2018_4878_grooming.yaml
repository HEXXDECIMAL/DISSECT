defaults:
  for: [all]

traits:
  - id: cve-2018-4878-grooming-4369
    desc: Grooming constant 4369 (0x1111)
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\b(4369|0x1111)\\b"

  - id: cve-2018-4878-grooming-8738
    desc: Grooming constant 8738 (0x2222)
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\b(8738|0x2222)\\b"

  - id: cve-2018-4878-grooming-13107
    desc: Grooming constant 13107 (0x3333)
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\b(13107|0x3333)\\b"

  - id: cve-2018-4878-grooming-17476
    desc: Grooming constant 17476 (0x4444)
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\b(17476|0x4444)\\b"

  - id: cve-2018-4878-grooming-21845
    desc: Grooming constant 21845 (0x5555)
    crit: notable
    conf: 0.8
    if:
      type: raw
      regex: "\\b(21845|0x5555)\\b"

composite_rules:
  - id: cve-2018-4878-grooming-constants
    desc: "Detects specific integer constants (0x1111-0x5555) used for"
    crit: suspicious
    conf: 0.8
    needs: 3
    any:
      - id: cve-2018-4878-grooming-4369
      - id: cve-2018-4878-grooming-8738
      - id: cve-2018-4878-grooming-13107
      - id: cve-2018-4878-grooming-17476
      - id: cve-2018-4878-grooming-21845
