# WScript Script Host Patterns
# Detects markers for WScript and Windows Script Host execution

defaults:
  for: [all]
  crit: notable
  conf: 0.7

traits:
  - id: wscript-shell
    desc: WScript.Shell object reference
    if:
      type: string
      substr: "WScript.Shell"
      exclude_patterns:
        - "Interaction\\.Shell"
        - "Shellexec\\.ShellExecute"
        - "Shellinject\\.ShellInject"

  - id: wscript-exe
    desc: wscript.exe executable reference
    if:
      type: string
      substr: "wscript.exe"

  - id: cscript-exe
    desc: cscript.exe executable reference
    if:
      type: string
      substr: "cscript.exe"

composite_rules:
  - id: wscript-engine-markers
    desc: WScript engine identification markers
    any:
      - id: wscript-shell
      - id: wscript-exe
      - id: cscript-exe
