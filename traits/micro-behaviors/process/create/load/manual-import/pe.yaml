defaults:
  for:
  - all
traits:
- id: asm-manual-import-export-dir
  conf: 0.9
  crit: suspicious
  desc: Manual import parsing marker IMAGE_EXPORT_DIRECTORY
  if:
    type: string
    word: IMAGE_EXPORT_DIRECTORY
- id: asm-manual-import-addr-names
  conf: 0.9
  crit: suspicious
  desc: Manual import parsing marker AddressOfNames
  if:
    type: string
    word: AddressOfNames
- id: asm-manual-import-addr-functions
  conf: 0.9
  crit: suspicious
  desc: Manual import parsing marker AddressOfFunctions
  if:
    type: string
    word: AddressOfFunctions
- id: asm-manual-import-addr-ordinals
  conf: 0.9
  crit: suspicious
  desc: Manual import parsing marker AddressOfOrdinals
  if:
    type: string
    word: AddressOfOrdinals
composite_rules:
- id: asm-manual-import-parsing
  conf: 0.9
  crit: suspicious
  desc: Manually parses Export Table (often shellcode/malware)
  needs: 2
  any:
  - id: asm-manual-import-export-dir
  - id: asm-manual-import-addr-names
  - id: asm-manual-import-addr-functions
  - id: asm-manual-import-addr-ordinals
