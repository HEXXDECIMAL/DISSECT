traits:
- id: taskkill-av-process-a
  desc: Kill AV process via taskkill A
  crit: suspicious
  conf: 0.9
  for:
  - php
  if:
    type: string
    regex: (?i)taskkill.{0,220}\/im\s+(nod32|mcshield|kav|avg)
- id: taskkill-av-process-b
  desc: Kill AV process via taskkill B
  crit: suspicious
  conf: 0.9
  for:
  - php
  if:
    type: string
    regex: (?i)taskkill.{0,220}\/im\s+(avast|norton|sophos)
- id: delete-av-directory
  desc: Attempting to remove AV installation directories
  crit: suspicious
  conf: 0.9
  for:
  - php
  if:
    type: string
    regex: (?i)(rmdir|del|erase).{0,220}Program Files.{0,220}(Norton|McAfee)
composite_rules:
- id: taskkill-av-process
  desc: Attempting to kill AV processes via taskkill
  crit: suspicious
  conf: 0.9
  for:
  - php
  any:
  - id: taskkill-av-process-a
  - id: taskkill-av-process-b
