# DLL Injection Methods
# Detects common APIs and techniques for DLL/SO injection
# MBC: F0003 (Process Injection)
# ATT&CK: T1055.001 (Dynamic-link Library Injection)

defaults:
  for: [python, javascript, typescript]
  crit: suspicious
  conf: 0.95
  attack: "T1055.001"
  mbc: "F0003"

traits:
  - id: write-process-memory
    desc: WriteProcessMemory API reference
    if:
      type: symbol
      regex: 'WriteProcessMemory'

  - id: create-remote-thread
    desc: CreateRemoteThread API reference
    if:
      type: symbol
      regex: 'CreateRemoteThread'

  - id: load-library-a
    desc: LoadLibraryA API reference
    if:
      type: symbol
      regex: 'LoadLibraryA'
