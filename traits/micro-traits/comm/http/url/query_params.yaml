defaults:
  for:
  - all
  crit: notable
  conf: 0.8
traits:
- id: dropper-common-params
  desc: Common dropper URL parameters (add, uuid)
  if:
    type: encoded
    regex: '[?&]add=[a-zA-Z0-9]{10,}'
- id: dropper-uuid-param
  desc: UUID-like query parameter seen in droppers
  if:
    type: encoded
    regex: '[?&]uuid=[a-zA-Z0-9]{10,}'
- id: dropper-obfuscated-add-param
  desc: Obfuscated add parameter construction
  if:
    type: encoded
    regex: '[?&]\{[^:]+:[''"]a[''"]\}\.[a-zA-Z0-9_$]+\+\{[^:]+:[''"]d[''"]\}\.[a-zA-Z0-9_$]+'
composite_rules:
- id: dropper-common-params-any
  desc: Common dropper URL parameters (add, uuid)
  crit: notable
  conf: 0.8
  any:
  - id: dropper-common-params
  - id: dropper-uuid-param
  - id: dropper-obfuscated-add-param
