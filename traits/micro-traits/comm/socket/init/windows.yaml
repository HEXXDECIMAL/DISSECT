# Windows Sockets (Winsock) initialization
# Required before using socket functions on Windows
defaults:
  for: [pe, dll]
  platforms: [windows]

traits:
  - id: wsa-startup
    desc: Initialize Winsock library
    crit: notable
    conf: 0.9
    if:
      type: symbol
      exact: "WSAStartup"

  - id: wsa-cleanup
    desc: Cleanup Winsock library
    crit: inert
    conf: 0.9
    if:
      type: symbol
      exact: "WSACleanup"

  - id: wsa-get-last-error
    desc: Get last Windows socket error
    crit: inert
    conf: 0.85
    if:
      type: symbol
      exact: "WSAGetLastError"

  - id: wsa-set-last-error
    desc: Set Windows socket error code
    crit: inert
    conf: 0.85
    if:
      type: symbol
      exact: "WSASetLastError"
