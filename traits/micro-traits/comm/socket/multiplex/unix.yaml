# Socket Multiplexing
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # epoll_create/epoll_ctl/epoll_wait/kqueue/kevent: use micro-traits/comm/async/library/traits.yaml (canonical)
  - id: select-multiplex
    desc: select() I/O multiplexing
    crit: inert
    conf: 0.5
    if:
      type: symbol
      exact: "select"

  - id: poll-multiplex
    desc: poll() I/O multiplexing
    crit: inert
    conf: 0.5
    if:
      type: symbol
      exact: "poll"

composite_rules:
  - id: multiplex
    desc: I/O multiplexing on sockets
    crit: inert
    conf: 0.66
    any:
      - id: select-multiplex
      - id: poll-multiplex
      - id: micro-traits/comm/async/library
