# DNS Lookup Operations (Unix/C)
# MBC: C0011 (DNS Communication)
# ATT&CK: T1071.004
#
# Type-specific lookups are in subdirectories:
#   txt/     - TXT record lookups
#   reverse/ - Reverse DNS lookups

defaults:
  for: [elf, macho, so, dylib, c]
  mbc: "C0011"
  attack: "T1071.004"

traits:
  - id: lookup-res-query
    desc: Uses res_query DNS API
    crit: notable
    conf: 0.66
    if:
      type: symbol
      exact: res_query

  - id: lookup-res-search
    desc: Uses res_search DNS API
    crit: notable
    conf: 0.66
    if:
      type: symbol
      exact: res_search

  - id: lookup-resolv
    desc: Reads DNS resolver configuration
    crit: notable
    conf: 0.66
    if:
      type: string
      substr: resolv.conf

composite_rules:
  - id: lookup
    desc: Uses DNS (Domain Name Service)
    crit: notable
    conf: 0.66
    any:
      - id: lookup-res-query
      - id: lookup-res-search
