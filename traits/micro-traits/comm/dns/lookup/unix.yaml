# DNS Lookup Operations (Unix/C)
# MBC: C0011 (DNS Communication)
# ATT&CK: T1071.004
#
# Type-specific lookups are in subdirectories:
#   txt/     - TXT record lookups
#   reverse/ - Reverse DNS lookups

defaults:
  for: [elf, macho, so, dylib, c]
  mbc: "C0011"
  attack: "T1071.004"

traits:
  - id: lookup
    desc: Uses DNS (Domain Name Service)
    crit: notable
    conf: 0.66
    if:
      type: symbol
      regex: res_query|res_search|getaddrinfo|gethostbyname

  - id: lookup-resolv
    desc: Reads DNS resolver configuration
    crit: notable
    conf: 0.66
    if:
      type: string
      substr: resolv.conf
