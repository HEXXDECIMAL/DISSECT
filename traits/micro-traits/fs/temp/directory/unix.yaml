# Temporary Directory Operations - Unix
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: directory-create
    desc: Create temporary directory
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: mkdtemp

  - id: tmpdir-env-var
    desc: TMPDIR environment variable name
    crit: inert
    conf: 0.7
    if:
      type: string
      word: "TMPDIR"

composite_rules:
  - id: directory-env
    desc: Read temp directory from TMPDIR
    crit: inert
    conf: 0.66
    for: [elf, macho, so, dylib, c]
    mbc: E1083
    attack: T1083
    all:
      - id: tmpdir-env-var
      - id: micro-traits/os/env/vars::getenv
