# Temporary Directory Operations - Windows
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: get-temp-path
    desc: Look up temp directory via GetTempPath
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "GetTempPath"

  - id: get-temp-path-a
    desc: Look up temp directory via GetTempPathA
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "GetTempPathA"

  - id: get-temp-path-w
    desc: Look up temp directory via
    crit: inert
    conf: 0.66
    for: [pe, dll, c]
    if:
      type: symbol
      exact: "GetTempPathW"

composite_rules:
  - id: directory-windows
    desc: Look up temp directory via GetTempPath
    crit: inert
    conf: 0.66
    any:
      - id: get-temp-path
      - id: get-temp-path-a
      - id: get-temp-path-w
