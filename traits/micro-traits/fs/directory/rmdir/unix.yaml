# Directory Removal
# MBC: C0047 (Delete File)
# ATT&CK: T1070.004

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: rmdir-base
    desc: Remove directories
    crit: inert
    conf: 0.66
    if:
      type: symbol
      exact: "rmdir"

  - id: unlinkat-dir
    desc: Remove directories
    crit: inert
    conf: 0.66
    if:
      type: symbol
      exact: "unlinkat"

composite_rules:
  - id: rmdir
    desc: Remove directories
    crit: inert
    conf: 0.66
    any:
      - id: rmdir-base
      - id: unlinkat-dir
