# Shell-Based File Operations
# Windows shell APIs for file and folder operations

defaults:
  for: ["pe", "dll"]
  platforms: ["windows"]

traits:
  # === Shell File Operations ===
  - id: shell-file-operation
    desc: Perform file operation through shell
    crit: suspicious
    conf: 0.75
    if:
      type: symbol
      exact: "SHFileOperationW"

  # === Folder Browsing ===
  - id: browse-for-folder
    desc: Display folder browse dialog
    crit: notable
    conf: 0.70
    if:
      type: symbol
      exact: "SHBrowseForFolderW"

  # === Path Extraction ===
  - id: get-path-from-idlist
    desc: Extract file path
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SHGetPathFromIDListW"

  # === File Information ===
  - id: get-file-info
    desc: Get file information and icon
    crit: inert
    conf: 0.70
    if:
      type: symbol
      exact: "SHGetFileInfoW"
