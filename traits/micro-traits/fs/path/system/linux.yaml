# System Paths (Linux)
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [all]

traits:
  - id: system-boot
    desc: Reference to /boot
    crit: notable
    conf: 0.66
    if:
      type: string
      regex: "/boot/[\\%\\w\\.\\-/]{4,32}"

  - id: system-var
    desc: Reference to /var
    crit: inert
    conf: 0.66
    if:
      type: string
      regex: "/var/[\\w\\.\\-/]+"

  - id: system-lib64
    desc: Reference to /lib64
    crit: inert
    conf: 0.66
    if:
      type: string
      regex: "/lib64/[\\w\\.\\-/]+"

  - id: system-lib-python
    desc: Reference to Python library paths
    crit: inert
    conf: 0.66
    if:
      type: string
      regex: "/usr/lib/python[\\d\\.]+/[\\w\\.\\-/]+"

  - id: system-var-containers
    desc: Reference to container paths
    crit: notable
    conf: 0.66
    if:
      type: string
      regex: "/var/(lib/)?(docker|containers)/[\\w\\.\\-/]+"

  # === Generic Unix/Linux system paths ===
  # /boot: use objectives/impact/system/directory/traits.yaml::boot-dir-ref (canonical)
  - id: unix-system-paths
    desc: Common system path reference
    crit: inert
    conf: 0.5
    if:
      type: string
      regex: '/usr/lib(32|64|exec)?|/usr/s?bin|/proc|/dev|/sys'
