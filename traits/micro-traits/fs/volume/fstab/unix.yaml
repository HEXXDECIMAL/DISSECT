# Mount Table Reading
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # === Mount table file atomic indicators ===
  - id: etc-fstab
    desc: /etc/fstab mount table file
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "/etc/fstab"

  - id: etc-mtab
    desc: /etc/mtab mount table file
    crit: inert
    conf: 0.6
    if:
      type: string
      substr: "/etc/mtab"

  - id: fstab-mntent
    desc: Parse mount table entries via
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: setmntent|getmntent|endmntent

  - id: fstab-mntinfo
    desc: Get information on mounted volumes
    crit: inert
    conf: 0.66
    if:
      type: symbol
      regex: getmntinfo

composite_rules:
  # Mount table files composite
  - id: fstab-files
    desc: Reads mount table files (/etc/fstab,
    crit: inert
    conf: 0.66
    any:
      - id: etc-fstab
      - id: etc-mtab
