type: content
id: micro-behaviors/os/win/kernel::idt-manipulation
conf: 0.9
crit: suspicious
description: Detects IDT manipulation sequence (sidt + int 5) used for Ring0 escalation on Win9x
filters:
  - type: or
    regex:
      - 'sidt\s+\[esp-2\]'
      - 'int\s+5'
      - 'mov\s+word\s+ptr\s+\[edx\+5\*8\],\s+bx'
