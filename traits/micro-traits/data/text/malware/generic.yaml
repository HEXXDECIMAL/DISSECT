defaults:
  for:
  - all
traits:
- id: infected-marker
  desc: References being infected
  crit: notable
  conf: 0.7
  attack: T1204
  for:
  - all
  if:
    type: string
    regex: "(?i)\binfected\b"
- id: infection-marker
  desc: References infection
  crit: notable
  conf: 0.7
  attack: T1204
  for:
  - all
  if:
    type: string
    substr: infection
- id: virus-marker
  desc: Virus reference
  crit: notable
  conf: 0.7
  attack: T1204
  for:
  - all
  if:
    type: string
    regex: "(?i)\bvirus\b"
- id: worm-marker
  desc: Worm malware type reference
  crit: notable
  conf: 0.7
  attack: T1204
  for:
  - all
  if:
    type: string
    regex: "(?i)\bworm\b"
- id: trojan-marker
  desc: Trojan reference
  crit: notable
  conf: 0.7
  attack: T1204
  for:
  - all
  if:
    type: string
    regex: "(?i)\btrojan\b"
- id: cyber-warfare-marker
  desc: Cyber warfare reference
  crit: notable
  conf: 0.8
  if:
    type: raw
    regex: (?i)cyber.?warfare
- id: suspicious-repo-name-a
  desc: Suspicious repository name
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:grabber|stealer|keylogger)\b|\brat\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-a1
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:grabber|stealer)[_-]?(?:bot|tool)\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-a2
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:keylogger|\brat\b)[_-]?(?:bot|tool)\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-a3
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:grabber|stealer)[_-]?(?:kit|py)\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-a4
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:keylogger|\brat\b)[_-]?(?:kit|py)\b
    case_insensitive: true
- id: suspicious-repo-name-trojan
  desc: Suspicious repository name
  crit: notable
  conf: 0.75
  if:
    type: string
    word: trojan
    case_insensitive: true
- id: suspicious-repo-name-suffixed-b1
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:grabber|stealer)[_-]?(?:go|rs|\d+)\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-b2
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: (?:keylogger|\brat\b)[_-]?(?:go|rs|\d+)\b
    case_insensitive: true
- id: suspicious-repo-name-suffixed-b3
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: trojan[_-]?(?:go|rs|\d+)\b
    case_insensitive: true
- id: suspicious-backdoor-repo-name
  desc: Backdoor-focused suspicious repository name
  crit: notable
  conf: 0.75
  if:
    type: raw
    regex: backdoor[_-]?(?:shell|c2|trojan|server)
    case_insensitive: true
composite_rules:
- id: suspicious-repo-name
  desc: Suspicious repository name
  crit: notable
  conf: 0.75
  any:
  - id: suspicious-repo-name-a
  - id: suspicious-repo-name-trojan
- id: suspicious-repo-name-suffixed
  desc: Suspicious repository name with common malware suffix
  crit: notable
  conf: 0.75
  any:
  - id: suspicious-repo-name-suffixed-a1
  - id: suspicious-repo-name-suffixed-a2
  - id: suspicious-repo-name-suffixed-a3
  - id: suspicious-repo-name-suffixed-a4
  - id: suspicious-repo-name-suffixed-b1
  - id: suspicious-repo-name-suffixed-b2
  - id: suspicious-repo-name-suffixed-b3
