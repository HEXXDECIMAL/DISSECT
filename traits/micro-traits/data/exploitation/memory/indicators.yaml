defaults:
  for: [all]

traits:
  - id: actionscript-large-length-check
    desc: ActionScript check for a very large length
    crit: suspicious
    conf: 0.9
    if:
      type: raw
      regex: '(?i)\.length\s*[=!]=\s*(4294967295|0xFFFFFFFF)'

  - id: actionscript-memory-scan-loop
    desc: ActionScript loop searching memory for an object
    crit: suspicious
    conf: 0.8
    if:
      type: raw
      regex: 'while\(.{0,220}readUnsignedInt\(.{0,220}!=.{0,220}\[0\]\)'

  - id: cve-2018-4878-symbol
    desc: Symbols associated with CVE-2018-4878 Flash exploit
    crit: suspicious
    conf: 0.9
    unless:
      - id: metadata/lang/shebang::perl
    if:
      type: raw
      regex: 'Mem_Arr|DRM_obj|gadget\.flash20|UAFGenerator|flash21|flash25|flash26'