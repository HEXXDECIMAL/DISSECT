# Database Connection - SQLITE

defaults:
  for: [all]

traits:
  # === SQLite micro-traits ===
  - id: sqlite3-string
    desc: sqlite3 string
    crit: notable
    conf: 0.9
    if:
      type: string
      substr: "sqlite3"

  - id: sqlite3-open
    desc: sqlite3_open function
    crit: notable
    conf: 0.9
    if:
      type: symbol
      regex: "sqlite3_open"

  - id: go-sqlite3
    desc: mattn/go-sqlite3 driver
    crit: notable
    conf: 0.9
    if:
      type: string
      substr: "mattn/go-sqlite3"

  - id: rusqlite
    desc: rusqlite Rust driver
    crit: notable
    conf: 0.9
    if:
      type: string
      substr: "rusqlite"

  - id: sqlite-format
    desc: SQLite format header
    crit: notable
    conf: 0.9
    if:
      type: string
      substr: "SQLite format"

composite_rules:
  # SQLite composite (migrated from YARA)
  - id: sqlite
    desc: SQLite database
    crit: notable
    conf: 0.9
    any:
      - id: sqlite3-string
      - id: sqlite3-open
      - id: go-sqlite3
      - id: rusqlite
      - id: sqlite-format
