defaults:
  for: [all]

traits:
  - id: asm-rol-not-loop
    conf: 0.9
    crit: suspicious
    desc: Detects assembly ROL/NOT encryption loop used in
    if:
      type: raw
      # lodsb; rol al, cl; not al; stosb; loop
      regex: 'lodsb\s+rol\s+al,\s*cl\s+not\s+al\s+stosb\s+loop'