# Java Process Creation (Source Code)
# Detects Runtime.exec and ProcessBuilder usage in Java source
# MBC: E1203 (Execute Code)
# ATT&CK: T1059 (Command and Scripting Interpreter)

defaults:
  for: [all]

traits:
  - id: java-runtime-exec-source
    desc: Java Runtime.exec() call in source
    crit: suspicious
    conf: 0.8
    mbc: "E1203"
    attack: "T1059"
    if:
      type: string
      substr: 'Runtime.getRuntime().exec'

  - id: java-processbuilder-source
    desc: Java ProcessBuilder usage in source
    crit: suspicious
    conf: 0.8
    mbc: "E1203"
    attack: "T1059"
    if:
      type: string
      substr: 'new ProcessBuilder'