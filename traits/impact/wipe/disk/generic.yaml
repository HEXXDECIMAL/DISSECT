# Disk Wiper Detection - Generic
# MBC: E1561 (Disk Wipe)
# ATT&CK: T1561

traits:
  - id: wipe-disk
    description: wipe disk phrase
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)wipe disk"

  - id: wipe-drive
    description: wipe drive phrase
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)wipe drive"

  - id: disk-wipe
    description: disk wipe phrase
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)disk wipe"

  - id: secure-erase
    description: secure erase phrase
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)secure erase"

  - id: mbr-ref
    description: MBR reference
    crit: notable
    conf: 0.6
    if:
      type: string
      word: "MBR"

  - id: boot-sector
    description: boot sector reference
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)boot sector"

  - id: master-boot-record
    description: master boot record reference
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)master boot record"

  - id: dev-sda
    description: /dev/sda device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/sda"

  - id: dev-hda
    description: /dev/hda device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/hda"

  - id: dev-nvme
    description: /dev/nvme device
    crit: notable
    conf: 0.6
    if:
      type: string
      exact: "/dev/nvme"

  - id: physicaldrive
    description: PhysicalDrive reference
    crit: notable
    conf: 0.6
    if:
      type: string
      regex: "(?i)PhysicalDrive"

composite_rules:
  - id: disk-terms
    description: Disk wiper terminology
    crit: suspicious
    conf: 0.75
    mbc: "E1561"
    attack: "T1561"
    count_min: 1
    any:
      - id: wipe-disk
      - id: wipe-drive
      - id: disk-wipe
      - id: secure-erase
      - id: mbr-ref
      - id: boot-sector
      - id: master-boot-record
      - id: dev-sda
      - id: dev-hda
      - id: dev-nvme
      - id: physicaldrive
