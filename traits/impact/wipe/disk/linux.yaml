# Disk Wiper Detection - Linux
# MBC: E1561 (Disk Wipe)
# ATT&CK: T1561

traits:
  # NOTE: "shred" alone is too generic - it's present in glibc
  # Require command-line context or disk device patterns to reduce false positives
  - id: disk
    description: Disk wiper patterns
    criticality: suspicious
    confidence: 0.66
    mbc: "E1561"
    attack: "T1561"
    condition:
      type: yara
      source: |
        rule disk_wiper {
          strings:
            $dd_zero = "dd if=/dev/zero"
            $dd_random = "dd if=/dev/urandom"
            // shred requires command-line flags or device path to avoid glibc false positive
            $shred_cmd = "shred -" ascii
            $shred_dev = /shred.{0,20}\/dev\// ascii
            $shred_force = "shred --force" ascii
          condition:
            any of them
        }

  - id: disk-device
    description: Direct disk device access
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      regex: "/dev/(sda|hda|nvme|vda)"
