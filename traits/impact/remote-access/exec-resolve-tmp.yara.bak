// Migrated from malcontent: impact/remote_access/exec_resolve_tmp.yara

rule fexecve_gethostbyname_realpath_tmp: critical {
  meta:
    description = "Runs programs, resolves hosts and paths, uses /tmp"
    confidence  = "0.66"

  strings:
$f1  = "fexecve" fullword
    $f2  = "gethostbyname" fullword
    $f3  = "realpath" fullword
    $tmp = "/tmp/"
  condition:
    $tmp and all of ($f*) in (1000..3000)
}
