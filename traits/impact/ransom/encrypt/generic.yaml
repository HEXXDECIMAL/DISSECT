# Ransomware Detection
# MBC: B0040 (Encryption for Impact)
# ATT&CK: T1486

traits:
  - id: impact/ransom/encrypt
    description: Ransomware encryption patterns
    criticality: suspicious
    confidence: 0.66
    mbc: "B0040"
    attack: "T1486"
    condition:
      type: yara
      source: |
        rule ransomware {
          strings:
            $locked = "locked" fullword
            $encrypt = "encrypt" fullword
            $readme = "README" fullword
            $tor = "torproject.org"
            $onion = /\w\.onion\W/
            $btc = "BTC" fullword
            $ransom = "ransom"
            $decrypt = "decrypt"
          condition:
            filesize < 25MB and 3 of them
        }

  - id: impact/ransom/encrypt-decryptor
    description: References decryptor
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      exact: decryptor

  - id: impact/ransom/encrypt-note
    description: Ransom note patterns
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      regex: "(your files|files have been|pay.*bitcoin|decrypt.*files)"
