# Impact - System Degradation
# ATT&CK: T1499 (Endpoint Denial of Service)

traits:
  - id: forkbomb
    description: Fork bomb pattern
    criticality: suspicious
    confidence: 0.95
    attack: "T1499"
    file_types: [shell]
    condition:
      type: string
      regex: ":\\(\\) \\{\\s*:\\|:&\\s*\\\\};:"

  - id: bluescreen
    description: Windows BSOD trigger
    criticality: suspicious
    confidence: 0.95
    attack: "T1499"
    file_types: [python, pe]
    condition:
      type: string
      exact: "RtlAdjustPrivilege(19, 1,"

  # NOTE: EDR-specific traits (stopservice, edr-kill) are defined in impact/degrade/edr/
  # Use impact/degrade/edr directory reference in composite rules

  - id: terminate-process
    description: TerminateProcess API
    criticality: suspicious
    confidence: 0.8
    attack: "T1489"
    file_types: [pe]
    condition:
      type: string
      exact: "TerminateProcess"

  - id: osascript-quit
    description: macOS application quit via osascript
    criticality: suspicious
    confidence: 0.85
    attack: "T1489"
    file_types: [macho, shell]
    condition:
      type: string
      regex: "osascript.*tell.*application.*quit"

# NOTE: EDR bypass composite rule is defined in impact/degrade/edr/