# Impact - System Degradation
# ATT&CK: T1499 (Endpoint Denial of Service)

traits:
  - id: forkbomb
    description: Fork bomb pattern
    crit: suspicious
    conf: 0.95
    attack: "T1499"
    for: [shell]
    if:
      type: string
      regex: ":\\(\\) \\{\\s*:\\|:&\\s*\\\\};:"

  - id: bluescreen
    description: Windows BSOD trigger
    crit: suspicious
    conf: 0.95
    attack: "T1499"
    for: [python, pe]
    if:
      type: string
      exact: "RtlAdjustPrivilege(19, 1,"

  # NOTE: EDR-specific traits (stopservice, edr-kill) are defined in impact/degrade/edr/
  # Use impact/degrade/edr directory reference in composite rules

  - id: terminate-process
    description: TerminateProcess API
    crit: suspicious
    conf: 0.8
    attack: "T1489"
    for: [pe]
    if:
      type: string
      exact: "TerminateProcess"

  - id: osascript-quit
    description: macOS application quit via osascript
    crit: suspicious
    conf: 0.85
    attack: "T1489"
    for: [macho, shell]
    if:
      type: string
      regex: "osascript.{0,50}tell.{0,50}application.{0,50}quit"

# NOTE: EDR bypass composite rule is defined in impact/degrade/edr/