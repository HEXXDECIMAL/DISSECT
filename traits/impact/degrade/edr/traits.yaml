# Impact - EDR/Antivirus Degradation
# ATT&CK: T1562.001 (Impair Defenses: Disable or Modify Tools)

traits:
  - id: impact/degrade/edr/stopper
    description: EDR/Antivirus service stopper
    criticality: suspicious
    confidence: 0.95
    attack: "T1562.001"
    file_types: [pe, shell]
    condition:
      type: string
      exact: "stopservice"

  - id: impact/degrade/edr/kill
    description: EDR process termination
    criticality: suspicious
    confidence: 0.9
    attack: "T1562.001"
    file_types: [elf, pe]
    condition:
      type: string
      regex: "(?i)(kill|terminate).*(defender|malwarebytes|kaspersky|avast|norton|mcafee|bitdefender|eset|sophos)"

composite_rules:
  - id: impact/degrade/edr/bypass-detected
    description: EDR/Antivirus bypass attempt
    criticality: suspicious
    confidence: 0.95
    attack: "T1562.001"
    mbc: "F0004"
    file_types: [pe, elf]
    condition:
      type: yara
      source: |
        rule edr_bypass {
          strings:
            $stop = "stopservice" nocase
            $kill = "TerminateProcess"
            $edr1 = "malwarebytes" nocase
            $edr2 = "defender" nocase
            $edr3 = "kaspersky" nocase
            $edr4 = "bitdefender" nocase
            $edr5 = "avast" nocase
            $edr6 = "norton" nocase
            $edr7 = "mcafee" nocase
            $edr8 = "sophos" nocase
            $edr9 = "eset" nocase
          condition:
            filesize < 5MB and
            any of ($stop, $kill) and any of ($edr*)
        }
