# Java Impact Traits
# Detects destructive/impact patterns in Java bytecode
# MBC: Impact
# ATT&CK: T1529 (System Shutdown/Reboot)

traits:
  # System control
  - id: reboot-string
    description: System reboot command
    criticality: suspicious
    confidence: 0.85
    mbc: "B0029"
    attack: "T1529"
    file_types: [class]
    condition:
      type: string
      exact: "reboot"

  - id: shutdown-string
    description: System shutdown command
    criticality: suspicious
    confidence: 0.85
    mbc: "B0029"
    attack: "T1529"
    file_types: [class]
    condition:
      type: string
      exact: "shutdown"

  - id: uninstall-string
    description: Self-uninstall command
    criticality: suspicious
    confidence: 0.9
    mbc: "F0007"
    attack: "T1070.004"
    file_types: [class]
    condition:
      type: string
      exact: "uninstall"

  - id: disconnect-string
    description: Disconnect from C2 command
    criticality: notable
    confidence: 0.8
    mbc: "B0030"
    file_types: [class]
    condition:
      type: string
      exact: "disconnect"

  # Process management
  - id: processes-string
    description: Process listing command
    criticality: notable
    confidence: 0.8
    mbc: "E1057"
    attack: "T1057"
    file_types: [class]
    condition:
      type: string
      exact: "processes"

  # Persistence
  - id: startup-list-string
    description: Startup persistence command
    criticality: suspicious
    confidence: 0.9
    mbc: "F0004"
    attack: "T1547"
    file_types: [class]
    condition:
      type: string
      exact: "startup-list"

  # Privilege escalation
  - id: chk-priv-string
    description: Check privileges command
    criticality: suspicious
    confidence: 0.85
    mbc: "B0014"
    attack: "T1134"
    file_types: [class]
    condition:
      type: string
      exact: "chk-priv"

  - id: req-priv-string
    description: Request elevated privileges command
    criticality: suspicious
    confidence: 0.9
    mbc: "B0014"
    attack: "T1134"
    file_types: [class]
    condition:
      type: string
      exact: "req-priv"
