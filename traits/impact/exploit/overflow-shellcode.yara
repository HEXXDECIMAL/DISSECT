// Migrated from malcontent: impact/exploit/overflow-shellcode.yara

rule exploit: high {
  meta:
    description = "Buffer overflow exploit"
    mbc         = "OB0010"
    attack      = "T1498"
    confidence  = "0.66"

  strings:
$n_padding = "padding" fullword
    $n_address = "address" fullword
    $n_offset  = "offset" fullword
    $shellcode = "shellcode" fullword

    $not_fishshell  = "fishshell"
    $not_powershell = "powershell"
  condition:
    filesize < 3MB and $shellcode and 2 of ($n*) and none of ($not*)
}

rule execute_shellcode: high {
  meta:
    description = "Executes shell code"
    confidence  = "0.66"

  strings:
$ref  = "execute shellcode"
    $ref2 = "exec_shellcode"
    $ref3 = "execute_shellcode"
  condition:
    any of them
}
