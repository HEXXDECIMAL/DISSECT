# File Ownership Change - Windows
# MBC: E1222 (File Permission Modification)
# ATT&CK: T1222

traits:
  # === takeown atomic indicators ===
  - id: takeown-lower
    description: takeown command (lowercase)
    criticality: inert
    confidence: 0.55
    condition:
      type: string
      exact: "takeown"

  - id: takeown-upper
    description: TAKEOWN command (uppercase)
    criticality: inert
    confidence: 0.55
    condition:
      type: string
      exact: "TAKEOWN"

  - id: chown-takeown-force
    description: Forcibly take ownership of files recursively
    criticality: suspicious
    confidence: 0.66
    condition:
      type: yara
      source: |
        rule takeown_force {
          strings:
            $takeown_fr = /(takeown|TAKEOWN).{1,8}\/[fF].{1,8}\/[rR] .{0,32}[yY]/
            $takeown_rf = /(takeown|TAKEOWN).{1,8}\/[rR].{1,8}\/[fF] .{0,32}[yY]/
          condition:
            any of them
        }

composite_rules:
  # takeown composite
  - id: chown-takeown
    description: Take ownership of files (Windows takeown)
    criticality: notable
    confidence: 0.66
    requires_count: 1
    conditions:
      - id: takeown-lower
      - id: takeown-upper
