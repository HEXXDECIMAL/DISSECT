# File Ownership Change - Windows
# MBC: E1222 (File Permission Modification)
# ATT&CK: T1222

traits:
  # === takeown atomic indicators ===
  - id: takeown-lower
    description: takeown command (lowercase)
    crit: inert
    conf: 0.55
    if:
      type: string
      exact: "takeown"

  - id: takeown-upper
    description: TAKEOWN command (uppercase)
    crit: inert
    conf: 0.55
    if:
      type: string
      exact: "TAKEOWN"

  - id: chown-takeown-force
    description: Forcibly take ownership of files recursively
    crit: suspicious
    conf: 0.66
    if:
      type: string
      regex: "(takeown|TAKEOWN).{1,8}/[fFrR].{1,8}/[rRfF] .{0,32}[yY]"

composite_rules:
  # takeown composite
  - id: chown-takeown
    description: Take ownership of files (Windows takeown)
    crit: notable
    conf: 0.66
    requires_count: 1
    any:
      - id: takeown-lower
      - id: takeown-upper
