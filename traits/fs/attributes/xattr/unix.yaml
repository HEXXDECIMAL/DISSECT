# Extended Attributes (xattr) - Symbol-based
# MBC: E1222 (File Permission Modification)
# ATT&CK: T1222

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: xattr-set
    description: Set extended file attribute value
    crit: notable
    conf: 0.66
    if:
      type: symbol
      pattern: setxattr|fsetxattr|lsetxattr

  - id: xattr-get
    description: Get extended file attribute value
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: getxattr|fgetxattr|lgetxattr

  - id: xattr-remove
    description: Remove extended file attribute value
    crit: notable
    conf: 0.66
    if:
      type: symbol
      pattern: removexattr|fremovexattr|lremovexattr

  - id: xattr-list
    description: List extended file attributes
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: listxattr|flistxattr|llistxattr
