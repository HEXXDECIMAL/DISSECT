# File Delete Operations - Shell
# MBC: C0047 (Delete File)
# ATT&CK: T1070.004

traits:
  - id: rm-force-tmp-var-dev
    desc: rm -f command targeting /tmp, /var, or /dev directories
    crit: notable
    conf: 0.7
    mbc: C0047
    attack: T1070.004
    if:
      type: string
      regex: 'rm +\-[a-zA-Z]{,1}f[a-zA-Z]{,1} \/(tmp|var|dev)\/[\w\/\.\-\%]{0,64}'

composite_rules:
  - id: delete-rm-hardcoded
    desc: Deletes files in /tmp, /var, or /dev directories (excludes legitimate apt)
    crit: suspicious
    conf: 0.66
    mbc: C0047
    attack: T1070.004
    all:
      - id: rm-force-tmp-var-dev
    none:
      - id: fs/path/package-manager/apt-lists
