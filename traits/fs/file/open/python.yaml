# File Open Operations - Python
# MBC: C0046 (Create File)
# ATT&CK: T1005

traits:
  - id: generic
    description: "Opens a file"
    criticality: inert
    confidence: 0.9
    file_types: [python]
    condition:
      type: string
      regex: '\bopen\('

  - id: sensitive-path
    description: "Accesses sensitive browser or wallet files"
    criticality: suspicious
    confidence: 0.95
    file_types: [python]
    condition:
      type: yara
      source: |
        rule python_sensitive_file_access {
          strings:
            $open = /\bopen\(/
            $path1 = "Login Data"
            $path2 = "Cookies"
            $path3 = "key4.db"
            $path4 = "exodus.wallet"
            $path5 = "wallet.dat"
          condition:
            $open and any of ($path*)
        }
