# Malicious File System Patterns
# Detects patterns of file creation followed by execution

traits:
  - id: temp-dir-reference
    description: "Reference to a temporary directory path or variable"
    criticality: notable
    confidence: 0.8
    condition:
      type: string
      regex: 'tmp|tempfile|environ\[[''"]TMP'

composite_rules:
  - id: execute-temp-file
    description: "Creates and executes a file from a temporary directory (Staging)"
    criticality: hostile
    confidence: 0.95
    near_lines: 50
    requires_all:
      - type: trait
        id: fs/file/open/generic
      - type: trait
        id: exec/command/subprocess/run
      - type: trait
        id: temp-dir-reference
