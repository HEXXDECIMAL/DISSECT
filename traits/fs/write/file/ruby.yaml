---
# Ruby file write operations
traits:
  - id: fs/write/file/ruby-file-open-write-binary
    description: "Write binary file"
    criticality: notable
    confidence: 0.92
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - "'wb"
        - "\"wb"
        - "'wb+"
        - "\"wb+"

  - id: fs/write/file/ruby-file-binmode
    description: "Binary file mode"
    criticality: notable
    confidence: 0.90
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - .binmode

  - id: fs/write/file/ruby-file-write-tmp
    description: "Write to /tmp directory"
    criticality: notable
    confidence: 0.88
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - /tmp/

  - id: fs/write/file/ruby-file-chmod
    description: "Modify file permissions"
    criticality: notable
    confidence: 0.90
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - File.chmod
        - .chmod(

  - id: fs/write/file/ruby-chmod-777
    description: "Make file world-executable (chmod 777)"
    criticality: suspicious
    confidence: 0.95
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - chmod(0777)
        - chmod 0777
        - chmod(0o777)

  - id: fs/write/file/ruby-file-delete
    description: "Delete file"
    criticality: notable
    confidence: 0.90
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - File.delete
        - File.unlink

  - id: fs/write/file/ruby-rm-rf
    description: "Recursive directory deletion"
    criticality: notable
    confidence: 0.93
    platforms:
      - all
    file_types:
      - ruby
    condition:
      type: symbol_or_string
      any:
        - FileUtils.rm_rf
