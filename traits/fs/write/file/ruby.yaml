---
# Ruby file write operations
traits:
  - id: ruby-file-open-write-binary
    description: "Write binary file"
    crit: notable
    conf: 0.92
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - "'wb"
        - '"wb'
        - "'wb+"
        - '"wb+'

  - id: ruby-file-binmode
    description: "Binary file mode"
    crit: notable
    conf: 0.90
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - .binmode

  - id: ruby-file-write-tmp
    description: "Write to /tmp directory"
    crit: notable
    conf: 0.88
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - /tmp/

  - id: ruby-file-chmod
    description: "Modify file permissions"
    crit: notable
    conf: 0.90
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - File.chmod
        - .chmod(

  - id: ruby-chmod-777
    description: "Make file world-executable (chmod 777)"
    crit: suspicious
    conf: 0.95
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - chmod(0777)
        - chmod 0777
        - chmod(0o777)

  - id: ruby-file-delete
    description: "Delete file"
    crit: notable
    conf: 0.90
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - File.delete
        - File.unlink

  - id: ruby-rm-rf
    description: "Recursive directory deletion"
    crit: notable
    conf: 0.93
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - FileUtils.rm_rf

  - id: ruby-fileutils
    description: "Imports FileUtils library (mkdir, cp, mv, rm, touch)"
    crit: notable
    conf: 0.6
    platforms:
      - all
    for:
      - ruby
    if:
      type: symbol_or_string
      any:
        - "'fileutils'"
        - '"fileutils"'
