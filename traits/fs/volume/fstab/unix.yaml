# Mount Table Reading
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  file_types: [elf, macho, so, dylib, c]

traits:
  # === Mount table file atomic indicators ===
  - id: etc-fstab
    description: /etc/fstab mount table file
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: "/etc/fstab"

  - id: etc-mtab
    description: /etc/mtab mount table file
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: "/etc/mtab"

  - id: fstab-mntent
    description: Parse mount table entries via mntent API
    criticality: inert
    confidence: 0.66
    condition:
      type: symbol
      pattern: setmntent|getmntent|endmntent

  - id: fstab-mntinfo
    description: Get information on mounted volumes (BSD)
    criticality: inert
    confidence: 0.66
    condition:
      type: symbol
      pattern: getmntinfo

composite_rules:
  # Mount table files composite
  - id: fstab-files
    description: Reads mount table files (/etc/fstab, /etc/mtab)
    criticality: inert
    confidence: 0.66
    requires_count: 1
    conditions:
      - id: etc-fstab
      - id: etc-mtab
