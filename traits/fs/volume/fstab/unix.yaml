# Mount Table Reading
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  # === Mount table file atomic indicators ===
  - id: etc-fstab
    description: /etc/fstab mount table file
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: "/etc/fstab"

  - id: etc-mtab
    description: /etc/mtab mount table file
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: "/etc/mtab"

  - id: fstab-mntent
    description: Parse mount table entries via
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: setmntent|getmntent|endmntent

  - id: fstab-mntinfo
    description: Get information on mounted volumes
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: getmntinfo

composite_rules:
  # Mount table files composite
  - id: fstab-files
    description: Reads mount table files (/etc/fstab,
    crit: inert
    conf: 0.66
    count_min: 1
    any:
      - id: etc-fstab
      - id: etc-mtab
