# File System Read/Write Traits
# MBC: OB0009 (File System) â†’ E1083 (File and Directory Discovery)
# ATT&CK: T1083 (File and Directory Discovery), T1005 (Data from Local System)

traits:
  # Symbolic link operations
  - id: fs/read-write/operation/readlink
    description: Read value of symbolic link
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.5
    condition:
      type: symbol
      pattern: readlink
    platforms: [unix, linux, macos]

  - id: fs/read-write/operation/realpath
    description: Resolve absolute pathname (follows symlinks)
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.5
    condition:
      type: symbol
      pattern: realpath
    platforms: [unix, linux, macos]

  - id: fs/read-write/operation/symlink
    description: Create symbolic link
    criticality: notable
    mbc: "E1222"
    attack: "T1222"
    confidence: 0.6
    condition:
      type: symbol
      pattern: symlink
    platforms: [unix, linux, macos]

  - id: fs/read-write/operation/link
    description: Create hard link to file
    criticality: notable
    mbc: "E1222"
    attack: "T1222"
    confidence: 0.6
    condition:
      type: symbol
      pattern: link
    platforms: [unix, linux, macos]

  # File metadata operations
  - id: fs/read-write/operation/stat
    description: Get file status and metadata
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.4
    condition:
      type: symbol
      pattern: stat|lstat|fstat
    platforms: [unix, linux, macos]

  - id: fs/read-write/operation/access
    description: Check file accessibility and permissions
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.5
    condition:
      type: symbol
      pattern: access
    platforms: [unix, linux, macos]

  # Extended attributes (macOS/Linux)
  - id: fs/read-write/operation/getxattr
    description: Get extended file attributes
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.5
    condition:
      type: symbol
      pattern: getxattr
    platforms: [macos, linux]

  - id: fs/read-write/operation/listxattr
    description: List extended file attributes
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.5
    condition:
      type: symbol
      pattern: listxattr
    platforms: [macos, linux]

  - id: fs/read-write/operation/setxattr
    description: Set extended file attributes
    criticality: notable
    mbc: "E1222"
    attack: "T1222"
    confidence: 0.6
    condition:
      type: symbol
      pattern: setxattr
    platforms: [macos, linux]

  - id: fs/read-write/operation/removexattr
    description: Remove extended file attributes
    criticality: notable
    mbc: "E1222"
    attack: "T1222"
    confidence: 0.6
    condition:
      type: symbol
      pattern: removexattr
    platforms: [macos, linux]

  # File locking
  - id: fs/read-write/operation/flock
    description: Apply or remove advisory lock on file
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.4
    condition:
      type: symbol
      pattern: flock
    platforms: [unix, linux, macos]

  - id: fs/read-write/operation/fcntl
    description: File descriptor manipulation and control
    criticality: inert
    mbc: "E1083"
    attack: "T1083"
    confidence: 0.4
    condition:
      type: symbol
      pattern: fcntl
    platforms: [unix, linux, macos]
