# Windows Paths
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: default-user-appdata
    description: Default User Application Data path
    crit: notable
    conf: 0.7
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: 'Default User.{0,32}Application Data'

  - id: localservice-appdata
    description: LocalService Application Data path
    crit: notable
    conf: 0.7
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: 'LocalService.{0,32}Application Data'

  - id: networkservice-appdata
    description: NetworkService Application Data path
    crit: notable
    conf: 0.7
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: 'NetworkService.{0,32}Application Data'

  - id: windows-root
    description: C:\\Windows\\ directory path
    crit: inert
    conf: 0.66
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: '[Cc]:\\Windows\\[\w\\]+'

  - id: windows-system32
    description: C:\\Windows\\System32\\ directory path
    crit: notable
    conf: 0.66
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: '[Cc]:\\Windows\\System32\\[\w.]+'

composite_rules:
  - id: windows-appdata
    description: Windows Application Data paths (user profiles)
    crit: notable
    conf: 0.66
    mbc: E1083
    attack: T1083
    any:
      - type: trait
        id: default-user-appdata
      - type: trait
        id: localservice-appdata
      - type: trait
        id: networkservice-appdata
