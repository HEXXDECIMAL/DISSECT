# User Home Directory Paths - Linux
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: user-home
    description: Reference to /home directories
    crit: inert
    conf: 0.66
    if:
      type: string
      regex: "/home/[\\w\\-/]+"

  - id: user-root
    description: Reference to /root directory
    crit: notable
    conf: 0.66
    if:
      type: string
      regex: "/root/[\\w\\-/]+"

  # === Home config directory atomic indicators ===
  - id: config-dir-ref
    description: Reference to .config directory
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "\\.config/[\\w\\-/]+"

  - id: local-dir-ref
    description: Reference to .local directory
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "\\.local/[\\w\\-/]+"

  - id: cache-dir-ref
    description: Reference to .cache directory
    crit: inert
    conf: 0.6
    if:
      type: string
      regex: "\\.cache/[\\w\\-/]+"

composite_rules:
  - id: user-home-config
    description: Reference to home config directories
    crit: inert
    conf: 0.66
    requires_count: 1
    any:
      - id: config-dir-ref
      - id: local-dir-ref
      - id: cache-dir-ref
