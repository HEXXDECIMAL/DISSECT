# Device Paths
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

traits:
  - id: dev-path-pattern
    description: /dev/ device path pattern
    crit: notable
    conf: 0.7
    mbc: E1083
    attack: T1083
    if:
      type: string
      regex: '/dev/[\w.\-/]{1,16}'

  - id: dev-null
    description: /dev/null (legitimate discard device)
    crit: inert
    conf: 1.0
    if:
      type: string
      exact: "/dev/null"

  - id: dev-shm
    description: /dev/shm/ (shared memory, legitimate)
    crit: inert
    conf: 1.0
    if:
      type: string
      exact: "/dev/shm/"

composite_rules:
  - id: device-dev
    description: Reference to /dev devices (excludes /dev/null and /dev/shm)
    crit: notable
    conf: 0.66
    mbc: E1083
    attack: T1083
    all:
      - id: dev-path-pattern
    none:
      - id: dev-null
      - id: dev-shm

  - id: device-null
    description: Reference to /dev/null device
    crit: inert
    conf: 0.66
    mbc: E1083
    attack: T1083
    any:
      - id: dev-null
