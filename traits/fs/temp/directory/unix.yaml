# Temporary Directory Operations - Unix
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: directory-create
    description: Create temporary directory
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: mkdtemp

  - id: tmpdir-env-var
    description: TMPDIR environment variable name
    crit: inert
    conf: 0.7
    if:
      type: string
      word: "TMPDIR"

composite_rules:
  - id: directory-env
    description: Read temp directory from TMPDIR environment variable
    crit: inert
    conf: 0.66
    for: [elf, macho, so, dylib, c]
    mbc: E1083
    attack: T1083
    all:
      - id: tmpdir-env-var
      - id: os/env/vars/getenv
