# Temporary Directory Operations - Unix
# MBC: E1083 (File and Directory Discovery)
# ATT&CK: T1083

defaults:
  for: [elf, macho, so, dylib, c]

traits:
  - id: directory-create
    description: Create temporary directory
    crit: inert
    conf: 0.66
    if:
      type: symbol
      pattern: mkdtemp

  - id: directory-env
    description: Read temp directory from TMPDIR environment
    crit: inert
    conf: 0.66
    if:
      type: yara
      source: |
        rule temp_env {
          strings:
            $tmpdir = "TMPDIR" fullword
            $getenv = "getenv"
          condition:
            all of them
        }
