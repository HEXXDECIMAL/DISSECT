# C2 Communication Channels
# MBC: OB0004 (Command & Control) â†’ B0030 (C2 Communication)
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # Messaging platforms
  - id: telegram-api
    description: Telegram Bot API
    criticality: high
    mbc: "B0030.001"
    attack: "T1567.001"
    confidence: 1.0
    condition:
      type: string
      exact: "api.telegram.org"

  - id: telegram-send
    description: Telegram send methods
    criticality: medium
    mbc: "B0030.001"
    confidence: 0.9
    condition:
      type: string
      regex: "/(sendMessage|sendDocument|sendPhoto)"

  - id: discord-webhook
    description: Discord webhook URL
    criticality: high
    mbc: "B0030.001"
    attack: "T1567.001"
    confidence: 1.0
    condition:
      type: string
      regex: "(discordapp\\.com|discord\\.com)/api/webhooks"

  # HTTP C2
  - id: http-post
    description: HTTP POST requests (potential C2)
    criticality: low
    mbc: "B0030"
    attack: "T1071.001"
    confidence: 0.5
    condition:
      type: symbol
      pattern: http_post|POST|HttpPost

  - id: user-agent-custom
    description: Custom User-Agent string (C2 indicator)
    criticality: medium
    mbc: "B0030"
    attack: "T1071.001"
    confidence: 0.6
    condition:
      type: string
      regex: "User-Agent:"

  # DNS C2
  - id: dns-query
    description: DNS queries (potential C2 channel)
    criticality: low
    mbc: "B0030"
    attack: "T1071.004"
    confidence: 0.4
    condition:
      type: symbol
      pattern: res_query|dns_query
