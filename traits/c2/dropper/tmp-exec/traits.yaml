# Download to /tmp, chmod, execute pattern
# MBC: B0024 (Dropper)
# ATT&CK: T1059 (Command and Scripting Interpreter)

traits:
  - id: tmp-path
    description: "Reference to /tmp directory for execution"
    criticality: notable
    confidence: 0.7
    condition:
      type: string
      regex: '"/tmp/[a-zA-Z_][a-zA-Z0-9_]*"'

composite_rules:
  - id: python
    description: "Download to /tmp, chmod, execute (supply chain attack)"
    confidence: 0.95
    criticality: hostile
    mbc: "B0024"
    attack: "T1059.006"
    file_types: [python]
    requires_count: 3
    conditions:
      - type: string
        regex: '"/tmp/[a-zA-Z_]+'
      - type: string
        regex: "os\\.chmod\\("
      - type: string
        regex: "subprocess\\.(Popen|run|call)\\("
      - type: string
        regex: "os\\.remove\\("
