# HTTP download and execute patterns (Python)
# MBC: B0024 (Dropper)
# ATT&CK: T1105 (Ingress Tool Transfer)

composite_rules:
  - id: c2/dropper/http/dropper
    description: "HTTP download and execute pattern"
    confidence: 0.9
    criticality: suspicious
    mbc: "B0024"
    attack: "T1105"
    file_types: [python]
    requires_count: 3
    conditions:
      - type: string
        regex: "requests\\.(get|post)|urllib\\.request|http\\.client"
      - type: string
        regex: '"/tmp/|tempfile\\.'
      - type: string
        regex: "os\\.chmod\\("
      - type: string
        regex: "subprocess\\.(Popen|run|call)\\("
