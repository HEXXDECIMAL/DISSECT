# GitHub blob API dropper (unusual download pattern)
# ATT&CK: T1195.002 (Supply Chain Compromise: Compromise Software Supply Chain)

traits:
  - id: blob-api
    description: "GitHub blob API download (unusual pattern)"
    criticality: suspicious
    confidence: 0.85
    condition:
      type: string
      regex: "api\\.github\\.com.*/git/blobs"

composite_rules:
  - id: execute
    description: "Download from GitHub blob API and execute"
    confidence: 0.95
    criticality: hostile
    mbc: "B0024"
    attack: "T1195.002"
    requires_count: 2
    conditions:
      - type: string
        regex: "api\\.github\\.com.*/git/blobs"
      - type: string
        regex: "os\\.chmod\\(|subprocess\\.(Popen|run|call)\\("
