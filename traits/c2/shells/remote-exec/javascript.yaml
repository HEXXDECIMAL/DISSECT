# Remote Execution - JavaScript/Node.js
# ATT&CK: T1059.003 (Command and Scripting Interpreter: Windows Command Shell)

traits:
  - id: c2/shells/remote-exec/js-output-command-var
    description: "Variable names suggesting command output handling"
    criticality: notable
    confidence: 0.8
    condition:
      type: string
      regex: "output|command"

composite_rules:
  - id: js-http-backdoor
    description: Remote shell backdoor (Poll C2 + Execute + Exfil)
    criticality: hostile
    confidence: 0.98
    attack: "T1059.003"
    requires_all:
      - id: comm/http/request/js-axios-get
      - id: exec/command/shell/js-execsync
      - id: comm/http/request/js-axios-post
      - id: c2/shells/remote-exec/js-output-command-var
