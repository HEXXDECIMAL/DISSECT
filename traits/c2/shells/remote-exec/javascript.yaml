# Remote Execution - JavaScript/Node.js
# ATT&CK: T1059.003 (Command and Scripting Interpreter: Windows Command Shell)

traits:
  # === Output/command variable atomic indicators ===
  - id: output-var
    description: output variable name
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: "output"

  - id: command-var
    description: command variable name
    criticality: inert
    confidence: 0.6
    condition:
      type: string
      exact: "command"

composite_rules:
  # Output/command variable composite
  - id: c2/shells/remote-exec/js-output-command-var
    description: Variable names suggesting command output handling
    criticality: notable
    confidence: 0.8
    requires_count: 1
    conditions:
      - id: output-var
      - id: command-var

  - id: js-http-backdoor
    description: Remote shell backdoor (Poll C2 + Execute + Exfil)
    criticality: suspicious
    confidence: 0.98
    attack: "T1059.003"
    requires_all:
      - id: comm/http/request/js-axios-get
      - id: exec/command/shell/js-execsync
      - id: comm/http/request/js-axios-post
      - id: c2/shells/remote-exec/js-output-command-var
