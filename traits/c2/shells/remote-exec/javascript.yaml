# Remote Execution - JavaScript/Node.js
# ATT&CK: T1059.003 (Command and Scripting Interpreter: Windows Command Shell)

traits:
  # === Output/command variable atomic indicators ===
  - id: output-var
    desc: output variable name
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: "output"

  - id: command-var
    desc: command variable name
    crit: inert
    conf: 0.6
    if:
      type: string
      exact: "command"

composite_rules:
  # Output/command variable composite
  - id: c2/shells/remote-exec/js-output-command-var
    desc: Variable names suggesting command output handling
    crit: notable
    conf: 0.8
    count: 1
    any:
      - id: output-var
      - id: command-var

  - id: js-http-backdoor
    desc: Remote shell backdoor (Poll C2 + Execute + Exfil)
    crit: suspicious
    conf: 0.98
    attack: "T1059.003"
    all:
      - id: comm/http/request/js-axios-get
      - id: exec/command/shell/js-execsync
      - id: comm/http/request/js-axios-post
      - id: c2/shells/remote-exec/js-output-command-var
