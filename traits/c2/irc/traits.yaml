# IRC Bot/C2 Detection Patterns
# ATT&CK: T1071.001 (Application Layer Protocol: Web Protocols)

traits:
  # IRC bot C2
  - id: c2/irc/bot-logic
    description: IRC-based command and control logic
    criticality: suspicious
    confidence: 0.8
    condition:
      type: yara
      source: |
        rule irc_bot_logic {
          strings:
            $irc1 = "PRIVMSG" ascii
            $irc2 = "NICK " ascii
            $irc3 = "USER " ascii
            $cmd1 = ".login" ascii
            $cmd2 = ".udp" ascii
            $cmd3 = ".tcp" ascii
            $cmd4 = ".shell" ascii
          condition:
            (all of ($irc*)) and any of ($cmd*)
        }

  # Tsunami/Kaiten IRC bot artifacts
  - id: malware/bot/irc/tsunami-artifact
    description: Tsunami/Kaiten IRC bot identifier
    criticality: notable
    confidence: 0.7
    condition:
      type: yara
      source: |
        rule tsunami_id {
          strings:
            $name1 = "tsunami" ascii nocase fullword
            $name2 = "kaiten" ascii nocase fullword
          condition:
            any of them
        }

  - id: comm/attack/flood/irc-ddos
    description: IRC-controlled DDoS attack logic
    criticality: hostile
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule irc_ddos {
          strings:
            $irc1 = "PRIVMSG" ascii
            $irc2 = "NICK" ascii
            $atk1 = "PAN" ascii
            $atk2 = "UDP" ascii
            $ddos1 = "flood" ascii nocase
            $ddos2 = "attack" ascii nocase
          condition:
            any of ($irc*) and 2 of ($atk*) and any of ($ddos*)
        }