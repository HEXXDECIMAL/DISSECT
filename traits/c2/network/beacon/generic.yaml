# C2 Network Communication Patterns
# MBC: B0030 (C2 Communication)
# ATT&CK: T1071.001 (Web Protocols)

traits:
  - id: c2/http-template
    description: HTTP request template with placeholders (C2 communication)
    criticality: suspicious
    confidence: 0.85
    mbc: "B0030"
    attack: "T1071.001"
    condition:
      type: string
      regex: "(POST|GET)\\s+%s\\s+HTTP"

  - id: c2/hardcoded-ip
    description: Hardcoded IP address (potential C2 server)
    criticality: suspicious
    confidence: 0.75
    mbc: "B0030"
    condition:
      type: string
      regex: "\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
      exclude_patterns:
        - "^127\\."
        - "^0\\."
        - "^255\\."
        - "^192\\.168\\."
        - "^10\\."
        - "^172\\.(1[6-9]|2[0-9]|3[01])\\."

  - id: c2/user-agent-rotation
    description: Multiple User-Agent strings (evasion technique)
    criticality: suspicious
    confidence: 0.80
    mbc: "F0001.004"
    attack: "T1036"
    condition:
      type: string
      regex: "User-Agent:"
      min_count: 3

  - id: c2/bot-user-agent
    description: Search engine bot User-Agent (DDoS/evasion)
    criticality: suspicious
    confidence: 0.85
    mbc: "B0030"
    attack: "T1071.001"
    condition:
      type: string
      regex: "(Googlebot|bingbot|Baiduspider|YandexBot|DuckDuckBot)"

  - id: c2/wget-download
    description: wget download command (payload fetching)
    criticality: suspicious
    confidence: 0.80
    mbc: "E1105"
    attack: "T1105"
    condition:
      type: string
      regex: "wget\\s+https?://"
