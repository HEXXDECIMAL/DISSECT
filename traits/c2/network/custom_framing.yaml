# Custom C2 Framing Protocols
# ATT&CK: T1071

traits:
  - id: text_headers
    desc: "Custom text-based C2 protocol framing headers"
    crit: suspicious
    conf: 0.8
    attack: "T1071"
    if:
      type: yara
      source: |
        rule c2_text_framing {
          strings:
            $h1 = "Bytes == %d" ascii
            $h2 = "iDataSize == %d" ascii
          condition:
            any of them
        }
