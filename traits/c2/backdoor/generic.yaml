# Backdoor Detection
# MBC: B0033 (Adversary-in-the-Middle)
# ATT&CK: T1543

traits:
  - id: backdoor
    description: References a backdoor
    criticality: suspicious
    confidence: 0.66
    attack: "T1543"
    condition:
      type: yara
      source: |
        rule backdoor {
          strings:
            $ref = /[bB]ackdoor/
            $not_vcpu = "VCPUInfoBackdoor"
            $not_vmware = "gGuestBackdoorOps"
            $not_comment = "# backdoor:"
          condition:
            filesize < 40MB and $ref and none of ($not*)
        }

  - id: backdoor-shell
    description: References a backdoor shell
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      regex: "[bB]ackdoor.?[sS]hell"

  - id: backdoor-leet
    description: References backd00r (leet speak)
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      regex: "[bB][a4]ckd00r"

  - id: backdoor-hidden
    description: Suspicious backdoor reference
    criticality: suspicious
    confidence: 0.66
    condition:
      type: string
      regex: "(hidden|hide|icmp|pam|ssh|sshd)[_ ]backdoor|backdoor[_ ](task|process|shell|login|pass)"
