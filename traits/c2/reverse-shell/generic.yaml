# Reverse Shell Detection - Generic
# MBC: B0033 (Adversary-in-the-Middle)
# ATT&CK: T1059

traits:
  - id: reverse-shell
    desc: References a reverse shell
    crit: suspicious
    conf: 0.66
    attack: "T1059"
    if:
      type: yara
      source: |
        rule reverse_shell {
          strings:
            $reverse_shell = /(r[e3]v[e3]rs[e3]|w[3e]b)\s*sh[e3]ll/ nocase
            $revshell = "revshell"
            $not_elastic = "\"license\": \"Elastic License v2\""
          condition:
            any of ($reverse*, $revshell) and none of ($not*)
        }
