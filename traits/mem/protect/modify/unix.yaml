# Memory Protection - Unix
# ATT&CK: T1055 (Process Injection)

traits:
  - id: mprotect
    description: Change memory protection (mprotect)
    crit: inert
    confidence: 1.0
    attack: "T1055"
    platforms: [linux, macos, unix]
    file_types: [elf, macho, so, dylib, c]
    condition:
      type: symbol
      pattern: "^_?mprotect$"

  - id: mprotect-string
    description: mprotect reference in source/script
    crit: notable
    confidence: 0.7
    attack: "T1055"
    platforms: [linux, macos, unix]
    file_types: [python, shell, c]
    condition:
      type: string
      exact: "mprotect"

  - id: rwx-prot-bytes
    description: RWX protection bytes (PROT_READ|WRITE|EXEC = 0x07)
    crit: inert
    confidence: 0.6
    attack: "T1055"
    platforms: [linux, macos, unix]
    file_types: [elf, macho, so, dylib]
    condition:
      type: hex
      pattern: "07 00 00 00"
