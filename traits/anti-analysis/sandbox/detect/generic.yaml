# Sandbox Detection
# MBC: B0007 (Sandbox Detection)
# ATT&CK: T1497

traits:
  - id: anti-analysis/sandbox
    description: Sandbox detection techniques
    criticality: suspicious
    confidence: 0.66
    mbc: "B0007"
    attack: "T1497"
    condition:
      type: yara
      source: |
        rule sandbox_detect {
          strings:
            // Specific sandbox product names (not generic "sandbox" word)
            $cuckoo = "cuckoo" nocase fullword
            $joe = "joe sandbox" nocase
            $any_run = "any.run"
            $hybrid = "hybrid-analysis" nocase
            $virustotal = "virustotal" nocase
            // Analysis tools commonly checked for
            $wireshark = "wireshark" nocase fullword
            $fiddler = "fiddler" nocase fullword
            $procmon = "procmon" nocase fullword
            $processhacker = "process hacker" nocase
            $x64dbg = "x64dbg" nocase fullword
            $ollydbg = "ollydbg" nocase fullword
            // Sandbox detection file paths
            $sandbox_path = /C:\\(sandbox|analysis|malware)/i
          condition:
            any of them
        }
