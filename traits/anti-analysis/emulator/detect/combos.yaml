# Composite VM/Emulator Detection Capabilities

composite_rules:
  - id: detect-vendors
    description: VM detection via vendor/product strings
    criticality: suspicious
    mbc: "B0009"
    attack: "T1497.001"
    confidence: 0.9
    requires_count: 2
    conditions:
      - id: vmware-string
      - id: virtualbox-string
      - id: qemu-string
      - id: cpu-vendor

  - id: comprehensive
    description: Virtual machine environment detection
    criticality: suspicious
    mbc: "B0009"
    attack: "T1497.001"
    confidence: 0.9
    requires_count: 2
    conditions:
      - id: vmware-string
      - id: virtualbox-string
      - id: qemu-string
      - id: vm-hardware
      - id: macos-vm-sysctl
