# Composite Debugger Detection Capabilities

composite_rules:
  - id: win-basic
    description: Windows debugger detection (basic)
    criticality: suspicious
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.85
    platforms: [windows]
    file_types: [pe, dll]
    requires_any:
      - id: win-isdebuggerpresent
      - id: win-unhandledexception

  - id: win-comprehensive
    description: Windows debugger/VM detection (multiple signals)
    criticality: suspicious
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.9
    platforms: [windows]
    file_types: [pe, dll]
    requires_count: 2
    conditions:
      - id: win-isdebuggerpresent
      - id: win-unhandledexception
      - id: win-queryperformance

  - id: linux-comprehensive
    description: Linux debugger detection across multiple methods
    criticality: suspicious
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.95
    platforms: [linux]
    file_types: [elf]
    requires_count: 2
    conditions:
      - id: ld-debug
      - id: proc-status
      - id: ptrace

  - id: ptrace-self
    description: Anti-debugging via ptrace self-attachment
    criticality: suspicious
    mbc: "B0001.m01"
    attack: "T1622"
    confidence: 0.95
    platforms: [linux, unix]
    file_types: [elf]
    requires_all:
      - id: ptrace
      - id: getpid
      - id: ptrace-traceme-or-deny
