# Composite Debugger Detection Capabilities

composite_rules:
  - id: win-basic
    desc: Windows debugger detection (basic)
    crit: suspicious
    mbc: "B0001"
    attack: "T1622"
    conf: 0.85
    platforms: [windows]
    for: [pe, dll]
    any:
      - id: win-isdebuggerpresent
      - id: win-unhandledexception

  - id: win-comprehensive
    desc: Windows debugger/VM detection (multiple signals)
    crit: suspicious
    mbc: "B0001"
    attack: "T1622"
    conf: 0.9
    platforms: [windows]
    for: [pe, dll]
    count_min: 2
    any:
      - id: win-isdebuggerpresent
      - id: win-unhandledexception
      - id: win-queryperformance

  - id: linux-comprehensive
    desc: Linux debugger detection across multiple
    crit: suspicious
    mbc: "B0001"
    attack: "T1622"
    conf: 0.95
    platforms: [linux]
    for: [elf]
    count_min: 2
    any:
      - id: ld-debug
      - id: proc-status
      - id: ptrace

  - id: ptrace-self
    desc: Anti-debugging via ptrace self-attachment
    crit: suspicious
    mbc: "B0001.m01"
    attack: "T1622"
    conf: 0.95
    platforms: [linux, unix]
    for: [elf]
    all:
      - id: ptrace
      - id: getpid
      - id: ptrace-traceme-or-deny
