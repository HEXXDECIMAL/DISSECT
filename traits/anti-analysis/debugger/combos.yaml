# Composite Debugger Detection Capabilities

capabilities:
  - id: win-basic
    description: Windows debugger detection (basic)
    criticality: medium
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.85
    platforms: [windows]
    file_types: [pe, dll]
    requires_any:
      - type: trait
        id: win-isdebuggerpresent
      - type: trait
        id: win-unhandledexception

  - id: win-comprehensive
    description: Windows debugger/VM detection (multiple signals)
    criticality: high
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.9
    platforms: [windows]
    file_types: [pe, dll]
    requires_count: 2
    conditions:
      - type: trait
        id: win-isdebuggerpresent
      - type: trait
        id: win-unhandledexception
      - type: trait
        id: win-queryperformance

  - id: linux-comprehensive
    description: Linux debugger detection across multiple methods
    criticality: high
    mbc: "B0001"
    attack: "T1622"
    confidence: 0.95
    platforms: [linux]
    file_types: [elf]
    requires_count: 2
    conditions:
      - type: trait
        id: ld-debug
      - type: trait
        id: proc-status
      - type: trait
        id: ptrace

  - id: ptrace-self
    description: Anti-debugging via ptrace self-attachment
    criticality: high
    mbc: "B0001.m01"
    attack: "T1622"
    confidence: 0.95
    platforms: [linux, unix]
    file_types: [elf]
    requires_all:
      - type: trait
        id: ptrace
      - type: symbol
        pattern: getpid
      - type: string
        regex: "PTRACE_TRACEME|PT_DENY_ATTACH"
