# Raw Socket Operations
# MBC: C0001 (Socket Communication)
# ATT&CK: T1071

traits:
  - id: net/socket/raw
    description: Send raw and/or malformed IP packets
    criticality: suspicious
    confidence: 0.66
    mbc: "C0001"
    attack: "T1071"
    condition:
      type: yara
      source: |
        rule raw_sockets {
          strings:
            $ref = "raw socket" fullword
            $hdrincl = "HDRINCL" fullword
            $sock_raw = "SOCK_RAW" fullword
            $ipproto_raw = "IPPROTO_RAW" fullword
            $proc_net_raw = "/proc/net/raw"
            $make_ip = "makeIPPacket"
            $impacket = "impacket."
            $makePackets = "makePacket" fullword
            $scapy = /scapy.{0,32}Raw/
          condition:
            any of them
        }
