# Malware Family - Platypus Reverse Shell Backdoor
# Reference: https://github.com/WangYihang/Platypus
# ATT&CK: T1059 (Command and Scripting Interpreter)

traits:
  - id: malware/backdoor/platypus/remove-self
    description: Platypus self-removal function
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1070.004"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "RemoveSelfExecutable"

  - id: malware/backdoor/platypus/daemon-mode
    description: Platypus daemon mode startup
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1543"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "StartDaemonMode"

  - id: malware/backdoor/platypus/brand
    description: Platypus GitHub reference
    criticality: hostile
    confidence: 0.99
    family: true
    attack: "T1059"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "WangYihang/Platypus"

  - id: malware/backdoor/platypus/tunnel-connect
    description: Platypus tunnel connection
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1572"
    file_types: [elf, macho]
    condition:
      type: string
      exact: "BodyPullTunnelConnec"

composite_rules:
  - id: malware/backdoor/platypus/detected
    description: Platypus reverse shell backdoor
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://github.com/WangYihang/Platypus"
    attack: "T1059"
    mbc: "B0022"
    file_types: [elf, macho]
    requires_count: 3
    conditions:
      - type: trait
        id: malware/backdoor/platypus/remove-self
      - type: trait
        id: malware/backdoor/platypus/daemon-mode
      - type: trait
        id: malware/backdoor/platypus/brand
      - type: trait
        id: malware/backdoor/platypus/tunnel-connect
