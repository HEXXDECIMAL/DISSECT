# Malware Family - Havoc C2 Framework
# Reference: https://github.com/HavocFramework/Havoc
# ATT&CK: T1059 (Command and Scripting Interpreter)

traits:
  # === Atomic Traits ===

  - id: malware/c2-framework/havoc/amsi-dll-xor
    description: Havoc XOR'ed AMSI DLL reference
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1562.001"
    platforms: [windows]
    condition:
      type: yara
      source: |
        rule havoc_amsi_xor {
          strings:
            $ref = "amsi.dllATVSH" ascii xor
          condition:
            any of them
        }

composite_rules:
  - id: malware/c2-framework/havoc/detected
    description: Havoc C2 framework implant
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://github.com/HavocFramework/Havoc"
    attack: "T1059"
    mbc: "B0030"
    platforms: [windows]
    requires_any:
      - type: trait
        id: malware/c2-framework/havoc/amsi-dll-xor
