# Malware Family - Merlin C2 Agent
# Go-based post-exploitation C2 framework
# Reference: https://github.com/Ne0nd0g/merlin
# ATT&CK: T1071 (Application Layer Protocol)

traits:
  # === Atomic Traits ===

  - id: malware/c2-framework/merlin/main-ref
    description: Merlin Go main package reference
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1071"
    platforms: [all]
    condition:
      type: string
      exact: "main.Merlin"

composite_rules:
  - id: malware/c2-framework/merlin/detected
    description: Merlin C2 agent
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://github.com/Ne0nd0g/merlin"
    attack: "T1071"
    mbc: "B0030"
    platforms: [all]
    requires_any:
      - type: trait
        id: malware/c2-framework/merlin/main-ref
