# Bitcoin cryptocurrency detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  - id: malware/cryptominer/bitcoin/wallet-address
    description: "Bitcoin wallet address"
    criticality: suspicious
    confidence: 0.85
    mbc: "B0036"
    attack: "T1496"
    condition:
      type: string
      # Bitcoin address formats:
      # - P2PKH: starts with 1, 26-35 chars total
      # - P2SH: starts with 3, 26-35 chars total
      # - Bech32: starts with bc1, 42-62 chars total
      # Base58 excludes: 0, O, I, l (to avoid visual confusion)
      #
      # Key fix: Require uppercase letter within first 6 chars after prefix.
      # Real Base58Check addresses have mixed case from the encoding algorithm.
      # False positives like "1buildNameVersion..." are camelCase with lowercase first.
      # Using lookahead to require at least one uppercase in positions 2-7.
      regex: "\\b(?:bc1[ac-hj-np-z02-9]{38,58}|[13](?=[a-km-zA-HJ-NP-Z1-9]{0,5}[A-HJ-NP-Z])[a-km-zA-HJ-NP-Z1-9]{25,34})\\b"
