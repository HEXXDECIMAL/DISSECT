# Mining pool connection detection
# ATT&CK: T1496 (Resource Hijacking)

traits:
  - id: port-3333
    description: "Mining pool port 3333"
    criticality: suspicious
    confidence: 0.7
    attack: "T1496"
    condition:
      type: string
      regex: ":\\s*3333\\b"

  - id: port-14444
    description: "Mining pool port 14444 (XMR SSL)"
    criticality: suspicious
    confidence: 0.75
    attack: "T1496"
    condition:
      type: string
      regex: ":\\s*14444\\b"

  - id: domain
    description: "Mining pool domain pattern"
    criticality: suspicious
    confidence: 0.85
    attack: "T1496"
    condition:
      type: string
      regex: "(pool\\.|mining\\.|mine\\.|xmr\\.|monero).*:\\d+"

  - id: stratum
    description: "Stratum mining protocol"
    criticality: suspicious
    confidence: 0.85
    attack: "T1496"
    condition:
      type: string
      regex: "stratum\\+tcp://|stratum\\+ssl://"
