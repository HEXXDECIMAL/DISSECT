# Malware Family - Avasa-Zombie DDoS Agent
# Reference: Linux/Agent.FP variant
# ATT&CK: T1498 (Network Denial of Service)

traits:
  - id: malware/botnet/avasa-zombie/brand
    description: Avasa-Zombie botnet identifier
    criticality: hostile
    confidence: 0.99
    family: true
    attack: "T1498"
    file_types: [elf]
    condition:
      type: string
      exact: "avasa-zombie"

  - id: malware/botnet/avasa-zombie/motd-method
    description: Avasa-Zombie Minecraft MOTD method
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1498"
    file_types: [elf]
    condition:
      type: string
      exact: "MotdMethod"

  - id: malware/botnet/avasa-zombie/convert-attack
    description: Avasa-Zombie attack converter
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1498"
    file_types: [elf]
    condition:
      type: string
      exact: "ConvertAttack"

  - id: malware/botnet/avasa-zombie/local-attack
    description: Avasa-Zombie local attack storage
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1498"
    file_types: [elf]
    condition:
      type: string
      exact: "localAttackStorage"

composite_rules:
  - id: malware/botnet/avasa-zombie/detected
    description: Avasa-Zombie DDoS Agent
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1498"
    mbc: "B0008"
    file_types: [elf]
    requires_count: 3
    conditions:
      - type: trait
        id: malware/botnet/avasa-zombie/brand
      - type: trait
        id: malware/botnet/avasa-zombie/motd-method
      - type: trait
        id: malware/botnet/avasa-zombie/convert-attack
      - type: trait
        id: malware/botnet/avasa-zombie/local-attack
