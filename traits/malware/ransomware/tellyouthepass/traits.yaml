# TellYouThePass Ransomware Detection
# ATT&CK: T1486 (Data Encrypted for Impact)
# MBC: C0027 (Encrypt Files)

traits:
  # TellYouThePass ransomware indicators
  - id: malware/ransomware/tellyouthepass/generic
    description: TellYouThePass ransomware patterns
    criticality: hostile
    confidence: 0.9
    mbc: "C0027"
    attack: "T1486"
    file_types: [elf, macho, pe, so, dylib, dll]
    condition:
      type: yara
      source: |
        rule tellyouthepass {
          strings:
            $name1 = "tellyouthepass" ascii nocase
            $name2 = "TellYouThePass" ascii
            $name3 = "TYTP" ascii
            // Ransom extension
            $ext1 = ".locked" ascii
            $ext2 = ".crypted" ascii
            // Ransom note
            $note1 = "README_LOCKED" ascii
            $note2 = "HOW_TO_DECRYPT" ascii
            // Payment
            $btc1 = "bitcoin" ascii nocase
            $btc2 = "wallet" ascii
          condition:
            (any of ($name*) and (any of ($ext*) or any of ($note*))) or
            (any of ($ext*) and any of ($note*) and any of ($btc*))
        }

  # TellYouThePass Linux variant
  - id: malware/ransomware/tellyouthepass/linux
    description: TellYouThePass Linux targeting
    criticality: hostile
    confidence: 0.85
    mbc: "C0027"
    attack: "T1486"
    file_types: [elf, so]
    condition:
      type: yara
      source: |
        rule tellyouthepass_linux {
          strings:
            $name = "tellyouthepass" ascii nocase
            // Linux paths
            $path1 = "/home/" ascii
            $path2 = "/var/" ascii
            $path3 = "/opt/" ascii
            // Encryption
            $enc1 = "openssl" ascii
            $enc2 = "AES" ascii
            // File operations
            $file1 = "readdir" ascii
            $file2 = "rename" ascii
          condition:
            ($name and any of ($path*)) or
            (3 of ($path*) and any of ($enc*) and any of ($file*))
        }

composite_rules:
  - id: malware/ransomware/tellyouthepass/detected
    description: TellYouThePass ransomware detected
    criticality: hostile
    confidence: 0.95
    file_types: [elf, macho, pe, so, dylib, dll]
    requires_any:
      - type: trait
        id: malware/ransomware/tellyouthepass/generic
      - type: trait
        id: malware/ransomware/tellyouthepass/linux