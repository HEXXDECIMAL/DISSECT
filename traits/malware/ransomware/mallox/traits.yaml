# Malware Family - Mallox Ransomware
# Reference: https://www.uptycs.com/blog/mallox-ransomware-linux-variant-decryptor-discovered
# ATT&CK: T1486 (Data Encrypted for Impact)

traits:
  - id: malware/ransomware/mallox/ransom-note
    description: Mallox ransom note filename
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "READ_THIS_NOW.txt"

  - id: malware/ransomware/mallox/breach-notice
    description: Mallox breach notification
    criticality: hostile
    confidence: 0.85
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "has been breached"

  - id: malware/ransomware/mallox/encryption-notice
    description: Mallox encryption notice
    criticality: hostile
    confidence: 0.9
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "files have been stolen and encrypted"

  - id: malware/ransomware/mallox/tox-contact
    description: Mallox Tox chat contact
    criticality: hostile
    confidence: 0.85
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "Tox chat ID"

  - id: malware/ransomware/mallox/decryption-offer
    description: Mallox decryption tool offer
    criticality: hostile
    confidence: 0.8
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "provide you with a decryption tool"

  - id: malware/ransomware/mallox/publish-threat
    description: Mallox data publication threat
    criticality: hostile
    confidence: 0.85
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      exact: "publish all your private data"

  - id: malware/ransomware/mallox/brand-name
    description: Mallox brand string
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1486"
    file_types: [all]
    condition:
      type: string
      regex: "\\bmallox\\b"
      case_insensitive: true

composite_rules:
  - id: malware/ransomware/mallox/detected
    description: Mallox ransomware
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://www.uptycs.com/blog/mallox-ransomware-linux-variant-decryptor-discovered"
    attack: "T1486"
    mbc: "B0031"
    file_types: [all]
    requires_count: 3
    conditions:
      - type: trait
        id: malware/ransomware/mallox/ransom-note
      - type: trait
        id: malware/ransomware/mallox/breach-notice
      - type: trait
        id: malware/ransomware/mallox/encryption-notice
      - type: trait
        id: malware/ransomware/mallox/tox-contact
      - type: trait
        id: malware/ransomware/mallox/decryption-offer
      - type: trait
        id: malware/ransomware/mallox/publish-threat
      - type: trait
        id: malware/ransomware/mallox/brand-name
