# Malware Family - Beast Ransomware
# Reference: https://www.cybereason.com/blog/threat-analysis-beast-ransomware
# ATT&CK: T1486 (Data Encrypted for Impact)

traits:
  - id: malware/ransomware/beast/log-file
    description: Beast ransomware log file
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "beast.log"

  - id: malware/ransomware/beast/encrypter-daemon
    description: Beast encrypter daemon marker
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "ENCRYPTER: DAEMON"

  - id: malware/ransomware/beast/marker
    description: Beast ransomware marker string
    criticality: hostile
    confidence: 0.99
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "BEASTWASHERE"

  - id: malware/ransomware/beast/note-folder
    description: Beast ransom note placement
    criticality: hostile
    confidence: 0.9
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "Write note in each folder"

  - id: malware/ransomware/beast/note-external
    description: Beast external note file
    criticality: hostile
    confidence: 0.9
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "include note from eXternal file"

  - id: malware/ransomware/beast/default-key
    description: Beast default encryption key
    criticality: hostile
    confidence: 0.9
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "default.key"

  - id: malware/ransomware/beast/esxi-target
    description: Beast ESXi targeting
    criticality: hostile
    confidence: 0.8
    family: true
    attack: "T1486"
    file_types: [elf]
    condition:
      type: string
      exact: "vmsvc/getallvms"

composite_rules:
  - id: malware/ransomware/beast/detected
    description: Beast Ransomware
    criticality: hostile
    confidence: 0.95
    family: true
    reference: "https://www.cybereason.com/blog/threat-analysis-beast-ransomware"
    attack: "T1486"
    mbc: "B0031"
    file_types: [elf]
    condition:
      type: yara
      source: |
        rule beast_ransomware {
          strings:
            $beast = "beast.log" fullword
            $esxi = "esxi" fullword
            $chacha20 = "chacha20" fullword
            $encrypter = "ENCRYPTER: DAEMON"
            $note = "Write note in each folder"
            $note2 = "include note from eXternal file"
            $default_key = "default.key"
            $BEAST = "BEASTWASHERE"
            $vm = "vmsvc/getallvms"
          condition:
            uint32(0) == 0x464C457F and
            filesize < 1MB and 7 of them
        }
