# Malware Family - Python ScreenLocker
# ATT&CK: T1491 (Defacement)

traits:
  - id: malware/ransomware/lockscreen/locked-msg
    description: ScreenLocker locked message
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1491"
    file_types: [python]
    condition:
      type: string
      exact: "Your computer has been locked!"

  - id: malware/ransomware/lockscreen/class-name
    description: ScreenLocker class name
    criticality: hostile
    confidence: 0.9
    family: true
    attack: "T1491"
    file_types: [python]
    condition:
      type: string
      exact: "ScreenLocker"

  - id: malware/ransomware/lockscreen/no-escape
    description: ScreenLocker no escape message
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1491"
    file_types: [python]
    condition:
      type: string
      exact: "THERE'S NO ESCAPE"

  - id: malware/ransomware/lockscreen/wm-delete
    description: ScreenLocker window manager hook
    criticality: hostile
    confidence: 0.8
    family: true
    attack: "T1491"
    file_types: [python]
    condition:
      type: string
      exact: "WM_DELETE_WINDOW"

composite_rules:
  - id: malware/ransomware/lockscreen/detected
    description: Python ScreenLocker
    criticality: hostile
    confidence: 0.95
    family: true
    attack: "T1491"
    mbc: "B0031"
    file_types: [python]
    requires_count: 3
    conditions:
      - type: trait
        id: malware/ransomware/lockscreen/locked-msg
      - type: trait
        id: malware/ransomware/lockscreen/class-name
      - type: trait
        id: malware/ransomware/lockscreen/no-escape
      - type: trait
        id: malware/ransomware/lockscreen/wm-delete
