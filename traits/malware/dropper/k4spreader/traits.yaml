# K4Spreader Malware Detection
# Detects K4Spreader (Tsunami-derived) IoT malware
# ATT&CK: T1583.005 (Botnet)

defaults:
  file_types: [elf, macho, so, dylib]

traits:
  # K4Spreader identifiers
  - id: malware/dropper/k4spreader/generic
    description: K4Spreader malware detected
    criticality: hostile
    confidence: 0.9
    condition:
      type: yara
      source: |
        rule k4spreader_dropper {
          strings:
            $rel1 = "tsunami" ascii nocase fullword
            $rel2 = "kaiten" ascii nocase fullword
            $spread1 = "scanner" ascii fullword
            $spread2 = "exploit" ascii fullword
            $magic = "K4SPREADER" ascii
          condition:
            $magic or (any of ($rel*) and any of ($spread*))
        }