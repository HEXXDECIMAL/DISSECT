{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/macho/2026.homabrews_org/dump_all_xor_strings.py",
  "depth": 0,
  "file_type": "python",
  "sha256": "d0677af80eb5d1cf36de9d93e1dc85fec33bc133c5207ff19740cdf60c559e02",
  "size": 2458,
  "risk": "suspicious",
  "counts": {
    "suspicious": 3,
    "notable": 6
  },
  "findings": [
    {
      "id": "obj/lateral/supply-chain/pypi/install-patterns::py-basename",
      "kind": "capability",
      "desc": "Python file extension",
      "conf": 1.0,
      "crit": "notable",
      "attack": "T1195.002",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "dump_all_xor_strings.py"
        }
      ],
      "source_file": "obj/lateral/supply-chain/pypi/install-patterns/install-exfil.yaml"
    },
    {
      "id": "cap/comm/http/upload::form-data-append",
      "kind": "capability",
      "desc": "Appends data to FormData",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .append(",
          "location": "file"
        }
      ],
      "source_file": "cap/comm/http/upload/javascript.yaml"
    },
    {
      "id": "cap/data/control-flow/analysis::for-loop-ast",
      "kind": "capability",
      "desc": "for loop (AST)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "18:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "21:9"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "27:9"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "54:5"
        }
      ],
      "source_file": "cap/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "cap/io/console/logging::hacker-tool-log-marker",
      "kind": "capability",
      "desc": "Hacker tool logging marker ([*], [+], ...)",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x122"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x161"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x162"
        }
      ],
      "source_file": "cap/io/console/logging/traits.yaml"
    },
    {
      "id": "cap/data/text/keywords::offset",
      "kind": "capability",
      "desc": "offset keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "offset",
          "location": "0x5f3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "offset",
          "location": "0x5f4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "f\"{hex(entry['addr']):<12} {entry['offset']:<8} {display_str}",
          "location": "0x8c2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "offset",
          "location": "0x8e4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "offset",
          "location": "0x8e5"
        }
      ],
      "source_file": "cap/data/text/keywords/generic.yaml"
    },
    {
      "id": "cap/fs/file/operations::binary-file-ops",
      "kind": "capability",
      "desc": "Binary file operations",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "open",
          "location": "import"
        }
      ],
      "source_file": "cap/fs/file/operations/traits.yaml"
    },
    {
      "id": "cap/data/control-flow/analysis::for-loop-content",
      "kind": "capability",
      "desc": "for loop (content)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3  for offset in ",
          "location": "file"
        }
      ],
      "source_file": "cap/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "cap/data/obfuscation/code::python-printable-char-check",
      "kind": "capability",
      "desc": "Python logic checking for printable ASCII range",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "32",
          "location": "29:16"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "126",
          "location": "29:27"
        }
      ],
      "source_file": "cap/data/obfuscation/code/python_xor.yaml"
    },
    {
      "id": "cap/data/obfuscation/code::python-rolling-xor-loop",
      "kind": "capability",
      "desc": "Python XOR loop with rolling key index",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "data[i] ^ key[(i + offset) % key_len]",
          "location": "22:28"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "(i + offset) % key_len",
          "location": "22:42"
        }
      ],
      "source_file": "cap/data/obfuscation/code/python_xor.yaml"
    },
    {
      "id": "cap/data/obfuscation/code::python-sliding-key-loop",
      "kind": "capability",
      "desc": "Python loop iterating over key length",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "range",
          "location": "21:18"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "len",
          "location": "21:24"
        }
      ],
      "source_file": "cap/data/obfuscation/code/python_xor.yaml"
    },
    {
      "id": "cap/data/obfuscation/code::python-xor-byte-loop",
      "kind": "capability",
      "desc": "Python loop with XOR byte manipulation",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "data[i] ^ key[(i + offset) % key_len]",
          "location": "22:28"
        }
      ],
      "source_file": "cap/data/obfuscation/code/python_xor.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/pypi/install-patterns::setup-py-mkdir-staging",
      "kind": "capability",
      "desc": "Directory staging in setup.py",
      "conf": 0.85,
      "crit": "notable",
      "attack": "T1074.001",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of os.path.exists",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/supply-chain/pypi/install-patterns/install-dropper.yaml"
    },
    {
      "id": "cap/data/control-flow/analysis::iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "18:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "21:9"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "27:9"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "54:5"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3  for offset in ",
          "location": "file"
        }
      ],
      "source_file": "cap/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "obj/anti-analysis/obfuscation/decoders::python-xor-string-decoder",
      "kind": "capability",
      "desc": "Python script implementing XOR string decryption",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1027",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "data[i] ^ key[(i + offset) % key_len]",
          "location": "22:28"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "32",
          "location": "29:16"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "126",
          "location": "29:27"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "range",
          "location": "21:18"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "len",
          "location": "21:24"
        }
      ],
      "source_file": "obj/anti-analysis/obfuscation/decoders/python.yaml"
    },
    {
      "id": "obj/anti-analysis/obfuscation/decoders::python-bruteforce-string-dumper",
      "kind": "capability",
      "desc": "Python script that brute-forces XOR keys to dump strings",
      "conf": 1.0,
      "crit": "suspicious",
      "attack": "T1027",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "data[i] ^ key[(i + offset) % key_len]",
          "location": "22:28"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "(i + offset) % key_len",
          "location": "22:42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x122"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x161"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "[*] ",
          "location": "0x162"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "32",
          "location": "29:16"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "126",
          "location": "29:27"
        }
      ],
      "source_file": "obj/anti-analysis/obfuscation/decoders/python.yaml"
    },
    {
      "id": "meta/internal/imported::current_str/append",
      "kind": "structural",
      "desc": "calls current_str.append",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "current_str.append"
        }
      ]
    },
    {
      "id": "meta/internal/imported::current_str/decode-utf-8-strip",
      "kind": "structural",
      "desc": "calls current_str.decode('utf-8').strip",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "current_str.decode('utf-8').strip"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sorted",
      "kind": "structural",
      "desc": "calls sorted",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sorted"
        }
      ]
    },
    {
      "id": "meta/internal/imported::decrypt_all_strings",
      "kind": "structural",
      "desc": "calls decrypt_all_strings",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "decrypt_all_strings"
        }
      ]
    },
    {
      "id": "meta/internal/imported::all_found_strings/values",
      "kind": "structural",
      "desc": "calls all_found_strings.values",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "all_found_strings.values"
        }
      ]
    },
    {
      "id": "meta/internal/imported::key/decode",
      "kind": "structural",
      "desc": "calls key.decode",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "key.decode"
        }
      ]
    },
    {
      "id": "meta/internal/imported::current_str/decode",
      "kind": "structural",
      "desc": "calls current_str.decode",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "current_str.decode"
        }
      ]
    },
    {
      "id": "meta/internal/imported::hex",
      "kind": "structural",
      "desc": "calls hex",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "hex"
        }
      ]
    },
    {
      "id": "meta/internal/imported::range",
      "kind": "structural",
      "desc": "calls range",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "range"
        }
      ]
    },
    {
      "id": "meta/internal/imported::entry-str-replace-n-n-replace",
      "kind": "structural",
      "desc": "calls entry['str'].replace('\\n', '\\\\n').replace",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "entry['str'].replace('\\n', '\\\\n').replace"
        }
      ]
    },
    {
      "id": "meta/internal/imported::enumerate",
      "kind": "structural",
      "desc": "calls enumerate",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "enumerate"
        }
      ]
    },
    {
      "id": "meta/internal/imported::print",
      "kind": "structural",
      "desc": "calls print",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "print"
        }
      ]
    },
    {
      "id": "meta/internal/imported::open",
      "kind": "structural",
      "desc": "calls open",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "open"
        }
      ]
    },
    {
      "id": "meta/internal/imported::os/path/exists",
      "kind": "structural",
      "desc": "calls os.path.exists",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "os.path.exists"
        }
      ]
    },
    {
      "id": "meta/internal/imported::entry-str-replace",
      "kind": "structural",
      "desc": "calls entry['str'].replace",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "entry['str'].replace"
        }
      ]
    },
    {
      "id": "meta/internal/imported::f/read",
      "kind": "structural",
      "desc": "calls f.read",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "f.read"
        }
      ]
    },
    {
      "id": "meta/internal/imported::bytearray",
      "kind": "structural",
      "desc": "calls bytearray",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bytearray"
        }
      ]
    },
    {
      "id": "meta/internal/imported::len",
      "kind": "structural",
      "desc": "calls len",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "len"
        }
      ]
    },
    {
      "id": "meta/import/python::sys",
      "kind": "structural",
      "desc": "imports sys",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "import",
          "source": "import",
          "value": "sys"
        }
      ]
    },
    {
      "id": "meta/import/python::os",
      "kind": "structural",
      "desc": "imports os",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "import",
          "source": "import",
          "value": "os"
        }
      ]
    }
  ]
}