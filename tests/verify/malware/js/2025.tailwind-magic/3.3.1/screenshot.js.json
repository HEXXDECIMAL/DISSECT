{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/js/2025.tailwind-magic/3.3.1/screenshot.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "0c7547a023c0a1264332e04e2c47fd6c4eb6063512d3ab022e15e5204f6bb3a6",
  "size": 479,
  "risk": "suspicious",
  "counts": {
    "suspicious": 1,
    "notable": 7
  },
  "findings": [
    {
      "id": "cap/hw/display/screen::monitor-get-displays",
      "kind": "capability",
      "desc": "Enumerates display monitors (likely node-screenshots)",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "B0002",
      "attack": "T1113",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 Monitor.getAllDisplays",
          "location": "file"
        }
      ],
      "source_file": "cap/hw/display/screen/javascript.yaml"
    },
    {
      "id": "obj/impact/ransomware/behavior::writefile-sync",
      "kind": "capability",
      "desc": "writeFileSync function",
      "conf": 0.4,
      "crit": "notable",
      "attack": "T1486",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "fs.writeFileSync"
        }
      ],
      "source_file": "obj/impact/ransomware/behavior/patterns.yaml"
    },
    {
      "id": "obj/impact/ransomware/behavior::writefile-fn",
      "kind": "capability",
      "desc": "writeFile function",
      "conf": 0.4,
      "crit": "notable",
      "attack": "T1486",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "fs.writeFileSync"
        }
      ],
      "source_file": "obj/impact/ransomware/behavior/patterns.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/vscode::file-write-ops",
      "kind": "capability",
      "desc": "File write or copy operations",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "writeFile"
        }
      ],
      "source_file": "obj/lateral/supply-chain/vscode/malicious.yaml"
    },
    {
      "id": "cap/fs/write/file::write-file-sync",
      "kind": "capability",
      "desc": "Writes to file synchronously",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .writeFileSync(",
          "location": "file"
        }
      ],
      "source_file": "cap/fs/write/file/javascript.yaml"
    },
    {
      "id": "cap/hw/display/screen::screenshot-capture-fn",
      "kind": "capability",
      "desc": "Function explicitly named to capture screenshots",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "B0002",
      "attack": "T1113",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of captureScreenshots",
          "location": "file"
        }
      ],
      "source_file": "cap/hw/display/screen/javascript.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/npm/behavior::small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "screenshot.js"
        }
      ],
      "source_file": "obj/lateral/supply-chain/npm/behavior/traits.yaml"
    },
    {
      "id": "cap/exec/dropper/loader::file-write",
      "kind": "capability",
      "desc": "File write operation",
      "conf": 0.7,
      "crit": "inert",
      "mbc": "B0024",
      "attack": "T1059.007",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .writeFileSync(",
          "location": "file"
        }
      ],
      "source_file": "cap/exec/dropper/loader/node-fetch.yaml"
    },
    {
      "id": "cap/fs/write/file::js-file-write",
      "kind": "capability",
      "desc": "JavaScript file write operation",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .writeFileSync(",
          "location": "file"
        }
      ],
      "source_file": "cap/fs/write/file/javascript.yaml"
    },
    {
      "id": "obj/impact/ransomware/behavior::file-write-functions",
      "kind": "capability",
      "desc": "File write functions",
      "conf": 0.4,
      "crit": "notable",
      "attack": "T1486",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "fs.writeFileSync"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "fs.writeFileSync"
        }
      ],
      "source_file": "obj/impact/ransomware/behavior/patterns.yaml"
    },
    {
      "id": "obj/collect/monitor/watch::js-screenshot-file-write",
      "kind": "capability",
      "desc": "Screen capture saved to file (potential exfil staging)",
      "conf": 0.8,
      "crit": "suspicious",
      "mbc": "B0002",
      "attack": "T1113",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .writeFileSync(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 Monitor.getAllDisplays",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of captureScreenshots",
          "location": "file"
        }
      ],
      "source_file": "obj/collect/monitor/watch/javascript.yaml"
    },
    {
      "id": "meta/internal/imported::capturescreenshots",
      "kind": "structural",
      "desc": "calls captureScreenshots",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "captureScreenshots"
        }
      ]
    },
    {
      "id": "meta/internal/imported::screenshotpath",
      "kind": "structural",
      "desc": "calls screenshotPath",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "screenshotPath"
        }
      ]
    },
    {
      "id": "meta/internal/imported::path/join",
      "kind": "structural",
      "desc": "calls path.join",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "path.join"
        }
      ]
    },
    {
      "id": "meta/internal/imported::monitors",
      "kind": "structural",
      "desc": "calls monitors",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "monitors"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fs/writefilesync",
      "kind": "structural",
      "desc": "calls fs.writeFileSync",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fs.writeFileSync"
        }
      ]
    },
    {
      "id": "meta/internal/imported::uf",
      "kind": "structural",
      "desc": "calls uf",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "uf"
        }
      ]
    },
    {
      "id": "meta/internal/imported::monitor/getalldisplays",
      "kind": "structural",
      "desc": "calls Monitor.getAllDisplays",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Monitor.getAllDisplays"
        }
      ]
    }
  ]
}