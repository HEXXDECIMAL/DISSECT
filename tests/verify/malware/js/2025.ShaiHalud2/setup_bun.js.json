{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/js/2025.ShaiHalud2/setup_bun.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "a3894003ad1d293ba96d77881ccd2071446dc3f65f434669b49b3da92421901a",
  "size": 4960,
  "risk": "suspicious",
  "counts": {
    "suspicious": 6,
    "notable": 28
  },
  "findings": [
    {
      "id": "cap/comm/diagnostic/curl",
      "kind": "capability",
      "desc": "curl HTTP client",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/comm/download/curl/curl-cmd",
      "kind": "capability",
      "desc": "curl command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/comm/http/client/curl-cmd",
      "kind": "capability",
      "desc": "curl command",
      "conf": 0.3,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/data/config/parse/get-env-var",
      "kind": "capability",
      "desc": "GetEnvironmentVariable method",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/command",
      "kind": "capability",
      "desc": "command keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "command"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-bash",
      "kind": "capability",
      "desc": "curl piped to bash",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1059.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/os/console/pipe-bash",
      "kind": "capability",
      "desc": "Pipe to bash",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "meta/quality/dotenv-file",
      "kind": "capability",
      "desc": ".env file reference",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/c2/infrastructure/domain/http-url-with-domain-pattern",
      "kind": "capability",
      "desc": "Network URL with domain name",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "obj/creds/discord/token/appdata-ref",
      "kind": "capability",
      "desc": "Windows AppData directory reference",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1555.003",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/windows-dir-ref",
      "kind": "capability",
      "desc": "Windows directory reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "Windows",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/usr-dir-ref",
      "kind": "capability",
      "desc": "/usr directory reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xcc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xcc4"
        }
      ]
    },
    {
      "id": "obj/persist/cron/echo-command",
      "kind": "capability",
      "desc": "echo command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1053.003",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "echo",
          "location": "0x527"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "echo",
          "location": "0x546"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bash-profile",
      "kind": "capability",
      "desc": ".bash_profile shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bashrc",
      "kind": "capability",
      "desc": ".bashrc shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/profile",
      "kind": "capability",
      "desc": ".profile shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/zshrc",
      "kind": "capability",
      "desc": ".zshrc shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44d"
        }
      ]
    },
    {
      "id": "obj/persist/startup/exe-extension",
      "kind": "capability",
      "desc": ".exe file extension",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc20"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc21"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1115"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1116"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113f"
        }
      ]
    },
    {
      "id": "obj/persist/startup/ps1-extension",
      "kind": "capability",
      "desc": ".ps1 file extension",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "obj/persist/startup/powershell-word",
      "kind": "capability",
      "desc": "powershell keyword",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/executable/exe-ext",
      "kind": "capability",
      "desc": ".exe extension",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc20"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc21"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1115"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1116"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113f"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/arrow-function",
      "kind": "capability",
      "desc": "ES6 arrow function syntax",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "=> {",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/async-await",
      "kind": "capability",
      "desc": "ES2017 async/await syntax",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "async function",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/template-literal",
      "kind": "capability",
      "desc": "ES6 template literal syntax",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "`bash -c \"source ${",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/const-let",
      "kind": "capability",
      "desc": "ES6 const/let declarations",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "const p",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/destructuring",
      "kind": "capability",
      "desc": "ES6 destructuring assignment",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "const { spawn, execSync } =",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/eval/child-process-require",
      "kind": "capability",
      "desc": "Node.js child_process module import",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x38"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x39"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/eval/spawn-call",
      "kind": "capability",
      "desc": "spawn() function call",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "spawn(",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/vm/sandbox/base64-long-string",
      "kind": "capability",
      "desc": "Long base64-like string pattern",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/process/exit/exit-call",
      "kind": "capability",
      "desc": "Generic exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit",
          "location": "0xf19"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit",
          "location": "0xf1a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit"
        }
      ]
    },
    {
      "id": "cap/process/exit/process-exit",
      "kind": "capability",
      "desc": "Node.js process.exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.exit"
        }
      ]
    },
    {
      "id": "meta/quality/try-block-open",
      "kind": "capability",
      "desc": "try block opening",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "try {",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/quality/catch-keyword",
      "kind": "capability",
      "desc": "catch keyword",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        }
      ]
    },
    {
      "id": "obj/anti-static/obfuscation/strings/js-array-join-symbol",
      "kind": "capability",
      "desc": "Array join operation",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "path.join",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-ignore-array",
      "kind": "capability",
      "desc": "stdio array with ignore values",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "F0005",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 stdio: ['pipe', 'pipe', 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-ignore-string",
      "kind": "capability",
      "desc": "stdio set to ignore",
      "conf": 0.75,
      "crit": "notable",
      "mbc": "F0005",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 stdio: 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/path-join-dirname",
      "kind": "capability",
      "desc": "path.join with __dirname",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 path.join(__dirname",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/local-script-path",
      "kind": "capability",
      "desc": "Local script path reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 __dirname, 'bun_environment.js'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/reverse-shell/child-process-string",
      "kind": "capability",
      "desc": "child_process module reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x38"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x39"
        }
      ]
    },
    {
      "id": "obj/c2/reverse-shell/pipe-string",
      "kind": "capability",
      "desc": "pipe string reference",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x590"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x591"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x598"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x599"
        }
      ]
    },
    {
      "id": "obj/creds/environment/secret-access/dotenv-file",
      "kind": "capability",
      "desc": ".env file reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1552.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/creds/keylog/capture/exec-sync",
      "kind": "capability",
      "desc": "execSync function",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "B0015",
      "attack": "T1056.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "execSync",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/fingerprint/system/process-env-access",
      "kind": "capability",
      "desc": "process.env access",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "process.env",
          "location": "0x78e"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        }
      ]
    },
    {
      "id": "obj/discovery/system/os-homedir-call",
      "kind": "capability",
      "desc": "os.homedir() call",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1082",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "os.homedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-cwd-call",
      "kind": "capability",
      "desc": "process.cwd() call",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1082",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "process.cwd",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-platform-content",
      "kind": "capability",
      "desc": "process.platform in content",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1082",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of process.platform",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/system/node-dirname",
      "kind": "capability",
      "desc": "Collects script directory path",
      "conf": 0.75,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "__dirname",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/system/os-check-windows",
      "kind": "capability",
      "desc": "Windows OS detection string",
      "conf": 0.6,
      "crit": "inert",
      "mbc": "B0012",
      "attack": "T1082",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "Windows",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/system/os-check-linux",
      "kind": "capability",
      "desc": "Linux OS detection string",
      "conf": 0.6,
      "crit": "inert",
      "mbc": "B0012",
      "attack": "T1082",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "Linux",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/user/userprofile",
      "kind": "capability",
      "desc": "Windows USERPROFILE lookup",
      "conf": 0.75,
      "crit": "notable",
      "attack": "T1033",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "USERPROFILE",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/side-effect-only",
      "kind": "capability",
      "desc": "Module produces side effects without",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "http",
          "location": "offset:2292"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "spawn(",
          "location": "offset:3651"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/child-process-import",
      "kind": "capability",
      "desc": "Node child_process module usage",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x38"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x39"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/has-config-object",
      "kind": "capability",
      "desc": "Code uses configuration objects",
      "conf": 0.75,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "opts = {",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-os",
      "kind": "capability",
      "desc": "require('os') import",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-child-process",
      "kind": "capability",
      "desc": "require('child_process') import",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-fs",
      "kind": "capability",
      "desc": "require('fs') import",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "filesize",
          "source": "binary",
          "value": "4960 bytes"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/vscode/process-env",
      "kind": "capability",
      "desc": "process.env reference",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "process.env",
          "location": "0x78e"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/vscode/exec-pattern",
      "kind": "capability",
      "desc": "exec function pattern",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exec",
          "location": "0xa37"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exec",
          "location": "0xa38"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "execSync"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/vscode/env-file",
      "kind": "capability",
      "desc": ".env file reference",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/appdata-string",
      "kind": "capability",
      "desc": "AppData directory reference",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/localappdata-string",
      "kind": "capability",
      "desc": "Local AppData reference",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc10"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc11"
        }
      ]
    },
    {
      "id": "obj/persist/process-manager/spawn-call",
      "kind": "capability",
      "desc": "spawn() function call",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1543",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "spawn(",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/persist/shell/js-path-manipulation",
      "kind": "capability",
      "desc": "Manually manipulates PATH environment variable",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "process.env.PATH =",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/comm/diagnostic/performance",
      "kind": "capability",
      "desc": "Network performance testing",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/comm/download/curl/curl",
      "kind": "capability",
      "desc": "Download via curl",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/data/config/parse/environment-vars",
      "kind": "capability",
      "desc": "Environment variable access",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/modern-javascript",
      "kind": "capability",
      "desc": "Code uses modern JavaScript (ES6+)",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "=> {",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "async function",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "`bash -c \"source ${",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "const p",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "const { spawn, execSync } =",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-interpreters",
      "kind": "capability",
      "desc": "Curl piped to various interpreters",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-shell",
      "kind": "capability",
      "desc": "Curl output piped to shell",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1059.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/os/console/shell-pipes",
      "kind": "capability",
      "desc": "Pipe to shell interpreters",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "meta/quality/try-catch-handling",
      "kind": "capability",
      "desc": "Try/catch error handling patterns",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "try {",
          "location": "file"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        }
      ]
    },
    {
      "id": "meta/quality/config-management",
      "kind": "capability",
      "desc": "External configuration management",
      "conf": 0.85,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-suppressed",
      "kind": "capability",
      "desc": "Process stdio suppressed",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 stdio: ['pipe', 'pipe', 'ignore'",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 stdio: 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/creds/environment/secret-access/node-config",
      "kind": "capability",
      "desc": "Accessing sensitive configuration files",
      "conf": 0.7,
      "crit": "suspicious",
      "attack": "T1552.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-fingerprint-any",
      "kind": "capability",
      "desc": "Process object fingerprint property",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1082",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of process.platform",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/system-dir-reference",
      "kind": "capability",
      "desc": "Reference to critical system directories",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "Windows",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xcc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xcc4"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/dangerous-requires",
      "kind": "capability",
      "desc": "Dangerous Node.js API imports",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/vscode/credential-paths",
      "kind": "capability",
      "desc": "Sensitive credential file/directory paths",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env",
          "location": "0x78e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".env"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/windows-appdata-path",
      "kind": "capability",
      "desc": "Windows AppData path construction",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc10"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc11"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "os.homedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bash-files",
      "kind": "capability",
      "desc": "Bash shell configuration files",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        }
      ]
    },
    {
      "id": "obj/persist/startup/windows-executable-payload",
      "kind": "capability",
      "desc": "References executable file types or",
      "conf": 0.6,
      "crit": "notable",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc20"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc21"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1115"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1116"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x871"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/exec/shell/download-pipe-exec",
      "kind": "capability",
      "desc": "Download piped to interpreter (dropper",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1059",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "meta/quality/error-handling",
      "kind": "capability",
      "desc": "Proper error handling patterns",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "try {",
          "location": "file"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/single-file-dangerous",
      "kind": "capability",
      "desc": "Tiny npm package using dangerous",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "filesize",
          "source": "binary",
          "value": "4960 bytes"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/multi-file-access",
      "kind": "capability",
      "desc": "Multiple shell config files accessed",
      "conf": 0.9,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44d"
        },
        {
          "method": "exclusion",
          "source": "composite_rule",
          "value": "negative_conditions_not_found"
        }
      ]
    }
  ]
}