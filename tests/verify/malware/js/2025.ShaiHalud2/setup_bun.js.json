{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/js/2025.ShaiHalud2/setup_bun.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "a3894003ad1d293ba96d77881ccd2071446dc3f65f434669b49b3da92421901a",
  "size": 4960,
  "risk": "suspicious",
  "counts": {
    "suspicious": 5,
    "notable": 24
  },
  "findings": [
    {
      "id": "cap/comm/download/curl/curl-cmd",
      "kind": "capability",
      "desc": "curl command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/comm/http/client/curl-cmd",
      "kind": "capability",
      "desc": "curl command",
      "conf": 0.3,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/data/config/parse/get-env-var",
      "kind": "capability",
      "desc": "GetEnvironmentVariable method",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop-ast",
      "kind": "capability",
      "desc": "for loop (AST)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "40:7"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "124:3"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop-content",
      "kind": "capability",
      "desc": "for loop (content)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2  for (",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/command",
      "kind": "capability",
      "desc": "command keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "command"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-bash",
      "kind": "capability",
      "desc": "curl piped to bash",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1059.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/fs/path/binary/binary-usr-local",
      "kind": "capability",
      "desc": "Reference to /usr/local binaries",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/bin/bun",
          "location": "0xcc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/bin/bun",
          "location": "0xcc4"
        }
      ]
    },
    {
      "id": "cap/os/console/pipe-bash",
      "kind": "capability",
      "desc": "Pipe to bash",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "known/malware/rat/cobalt-strike/system-binary-exclusion",
      "kind": "capability",
      "desc": "Exclude Node.js and standard system binaries",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 usr/bin",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/lang/shebang/node",
      "kind": "capability",
      "desc": "Node.js shebang line",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #!/usr/bin/env node",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/lang/shebang/env-interpreter",
      "kind": "capability",
      "desc": "Generic env-based shebang line",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #!/usr/bin/env node",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/infrastructure/domain/short-domain-url-pattern",
      "kind": "capability",
      "desc": "Very short domain in URL",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "obj/creds/discord/token/appdata-ref",
      "kind": "capability",
      "desc": "Windows AppData directory reference",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1555.003",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        }
      ]
    },
    {
      "id": "obj/persist/cron/echo-command",
      "kind": "capability",
      "desc": "echo command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1053.003",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "echo",
          "location": "0x527"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "echo",
          "location": "0x546"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bash-profile",
      "kind": "capability",
      "desc": ".bash_profile shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bashrc",
      "kind": "capability",
      "desc": ".bashrc shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/profile",
      "kind": "capability",
      "desc": ".profile shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/zshrc",
      "kind": "capability",
      "desc": ".zshrc shell configuration file",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44d"
        }
      ]
    },
    {
      "id": "cap/exec/download/curl-pipe-bash-js",
      "kind": "capability",
      "desc": "curl piped to bash",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/exec/download/curl-pipe-sh-js",
      "kind": "capability",
      "desc": "curl piped to sh",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/exec/download/powershell-irm-iex",
      "kind": "capability",
      "desc": "PowerShell irm piped to iex",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell -c \"irm bun.sh/install.ps1|iex",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell -c \"irm bun.sh/install.ps1|iex",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/executable/exe-ext",
      "kind": "capability",
      "desc": ".exe extension",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xbdd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc20"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0xc21"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1115"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x1116"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".exe",
          "location": "0x113f"
        }
      ]
    },
    {
      "id": "cap/exec/javascript/eval/child-process-require",
      "kind": "capability",
      "desc": "Node.js child_process module import",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x38"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x39"
        }
      ]
    },
    {
      "id": "cap/exec/vm/sandbox/base64-long-string",
      "kind": "capability",
      "desc": "Long base64-like string pattern",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/exec/vm/sandbox/http-protocol-string",
      "kind": "capability",
      "desc": "HTTP or HTTPS protocol string",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/process/exit/exit-call",
      "kind": "capability",
      "desc": "Generic exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit",
          "location": "0xf19"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit",
          "location": "0xf1a"
        }
      ]
    },
    {
      "id": "cap/process/exit/process-exit",
      "kind": "capability",
      "desc": "Node.js process.exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.exit"
        }
      ]
    },
    {
      "id": "meta/quality/catch-keyword",
      "kind": "capability",
      "desc": "catch keyword",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-ignore-array",
      "kind": "capability",
      "desc": "stdio array with ignore values",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "F0005",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 stdio: ['pipe', 'pipe', 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-ignore-string",
      "kind": "capability",
      "desc": "stdio set to ignore",
      "conf": 0.75,
      "crit": "notable",
      "mbc": "F0005",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 stdio: 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/path-join-dirname",
      "kind": "capability",
      "desc": "path.join with __dirname",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 path.join(__dirname",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/local-script-path",
      "kind": "capability",
      "desc": "Local script path reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 __dirname, 'bun_environment.js'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/infrastructure/domain/http-url-script",
      "kind": "capability",
      "desc": "Network URL with domain name (script)",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://bun.sh/",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "obj/c2/reverse-shell/child-process-string",
      "kind": "capability",
      "desc": "child_process module reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x38"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "child_process",
          "location": "0x39"
        }
      ]
    },
    {
      "id": "obj/c2/reverse-shell/pipe-string",
      "kind": "capability",
      "desc": "pipe string reference",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x590"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x591"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x598"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "pipe",
          "location": "0x599"
        }
      ]
    },
    {
      "id": "obj/creds/keylog/capture/exec-sync",
      "kind": "capability",
      "desc": "execSync function",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "B0015",
      "attack": "T1056.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "execSync",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/fingerprint/system/process-env-access",
      "kind": "capability",
      "desc": "process.env access",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "process.env",
          "location": "0x78e"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "process.env"
        }
      ]
    },
    {
      "id": "obj/discovery/system/os-homedir-call",
      "kind": "capability",
      "desc": "os.homedir() call",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1082",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "os.homedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-cwd-call",
      "kind": "capability",
      "desc": "process.cwd() call",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1082",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "process.cwd",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-platform-content",
      "kind": "capability",
      "desc": "process.platform in content",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1082",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 process.platform",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/side-effect-only",
      "kind": "capability",
      "desc": "Module produces side effects without",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "require('fs')",
          "location": "offset:115"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "spawn(",
          "location": "offset:3651"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "child_process",
          "location": "offset:57"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-os",
      "kind": "capability",
      "desc": "require('os') import",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-child-process",
      "kind": "capability",
      "desc": "require('child_process') import",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/require-fs",
      "kind": "capability",
      "desc": "require('fs') import",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "filesize",
          "source": "binary",
          "value": "4960 bytes"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/vscode/exec-pattern",
      "kind": "capability",
      "desc": "exec function pattern",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exec",
          "location": "0xa37"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exec",
          "location": "0xa38"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "execSync"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/appdata-string",
      "kind": "capability",
      "desc": "AppData directory reference",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/localappdata-string",
      "kind": "capability",
      "desc": "Local AppData reference",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc10"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc11"
        }
      ]
    },
    {
      "id": "obj/persist/startup/powershell-word",
      "kind": "capability",
      "desc": "powershell keyword",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/comm/download/curl/curl",
      "kind": "capability",
      "desc": "Download via curl",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl ",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/data/config/parse/environment-vars",
      "kind": "capability",
      "desc": "Environment variable access",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GetEnvironmentVariable",
          "location": "0x27f"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "40:7"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "124:3"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2  for (",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/download/js-installer-sh",
      "kind": "capability",
      "desc": "Downloads and executes shell script",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/exec/download/js-installer-ps1",
      "kind": "capability",
      "desc": "Downloads and executes PowerShell script",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell -c \"irm bun.sh/install.ps1|iex",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell -c \"irm bun.sh/install.ps1|iex",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-interpreters",
      "kind": "capability",
      "desc": "Curl piped to various interpreters",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/exec/shell/curl-pipe-shell",
      "kind": "capability",
      "desc": "Curl output piped to shell",
      "conf": 0.95,
      "crit": "notable",
      "attack": "T1059.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "cap/os/console/shell-pipes",
      "kind": "capability",
      "desc": "Pipe to shell interpreters",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "| bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "obj/c2/dropper/node/stdio-suppressed",
      "kind": "capability",
      "desc": "Process stdio suppressed",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 stdio: ['pipe', 'pipe', 'ignore'",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 stdio: 'ignore'",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/system/process-fingerprint-any",
      "kind": "capability",
      "desc": "Process object fingerprint property",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1082",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 process.platform",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/dangerous-requires",
      "kind": "capability",
      "desc": "Dangerous Node.js API imports",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/persist/env-vars/windows-appdata-path",
      "kind": "capability",
      "desc": "Windows AppData path construction",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc05"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "AppData",
          "location": "0xc06"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc10"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Local",
          "location": "0xc11"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "os.homedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/bash-files",
      "kind": "capability",
      "desc": "Bash shell configuration files",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        }
      ]
    },
    {
      "id": "obj/persist/startup/windows-executable-payload",
      "kind": "capability",
      "desc": "References executable file types or",
      "conf": 0.6,
      "crit": "notable",
      "attack": "T1547.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x22f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x870"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "powershell",
          "location": "0x871"
        }
      ]
    },
    {
      "id": "cap/exec/shell/download-pipe-exec",
      "kind": "capability",
      "desc": "Download piped to interpreter (dropper",
      "conf": 0.9,
      "crit": "notable",
      "attack": "T1059",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "curl -fsSL https://bun.sh/install | bash",
          "location": "0x8e9"
        }
      ]
    },
    {
      "id": "obj/lateral/supply-chain/npm/single-file-dangerous",
      "kind": "capability",
      "desc": "Tiny npm package using dangerous",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "filesize",
          "source": "binary",
          "value": "4960 bytes"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "5:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'os'",
          "location": "5:20"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "2:29"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'child_process'",
          "location": "2:37"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "require",
          "location": "4:12"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'fs'",
          "location": "4:20"
        }
      ]
    },
    {
      "id": "obj/persist/shell/config/multi-file-access",
      "kind": "capability",
      "desc": "Multiple shell config files accessed",
      "conf": 0.9,
      "crit": "notable",
      "attack": "T1546.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bash_profile",
          "location": "0x3f8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x424"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".profile",
          "location": "0x425"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".bashrc",
          "location": "0x3d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".zshrc",
          "location": "0x44d"
        },
        {
          "method": "exclusion",
          "source": "composite_rule",
          "value": "negative_conditions_not_found"
        }
      ]
    }
  ]
}