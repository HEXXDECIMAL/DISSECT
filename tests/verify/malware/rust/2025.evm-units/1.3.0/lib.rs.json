{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/rust/2025.evm-units/1.3.0/lib.rs",
  "depth": 0,
  "file_type": "rust",
  "sha256": "cba65f613a5f8b481389dfed9bcc4205fc1a641779f35b2e564f4ac8e4c2f18b",
  "size": 5568,
  "risk": "suspicious",
  "counts": {
    "suspicious": 2,
    "notable": 11
  },
  "findings": [
    {
      "id": "micro-behaviors/comm/http/request::user-agent-header",
      "kind": "capability",
      "desc": "User-Agent header",
      "conf": 0.5,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf5f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf60"
        }
      ],
      "source_file": "micro-behaviors/comm/http/request/generic.yaml"
    },
    {
      "id": "micro-behaviors/data/control-flow/analysis::for-loop-content",
      "kind": "capability",
      "desc": "for loop (content)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1  for _ in ",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "micro-behaviors/execution/command/shell::bash-shell",
      "kind": "capability",
      "desc": "Bash shell reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2c"
        }
      ],
      "source_file": "micro-behaviors/execution/command/shell/traits.yaml"
    },
    {
      "id": "micro-behaviors/data/control-flow/analysis::for-loop-ast",
      "kind": "capability",
      "desc": "for loop (AST)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "70:5"
        }
      ],
      "source_file": "micro-behaviors/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "objectives/anti-analysis/kernel-hide/ebpf::bypass-string",
      "kind": "capability",
      "desc": "Bypass string reference",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Bypass",
          "location": "0x6a1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Bypass",
          "location": "0x6a4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bypass",
          "location": "0x846"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bypass",
          "location": "0x847"
        }
      ],
      "source_file": "objectives/anti-analysis/kernel-hide/ebpf/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/activex/com::activex-wshell",
      "kind": "capability",
      "desc": "WScript.Shell COM",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "E1243",
      "attack": "T1059.005",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "r#\"Set objShell = CreateObject(\"WScript.Shell\")\r\n    objShell.Run \"powershell.exe -NoProfile -ExecutionPolicy Bypass -File \"\"{}\"\"\", 0, False\"#",
          "location": "0x6a1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Set objShell = CreateObject(\"WScript.Shell\")\r\n    objShell.Run \"powershell.exe -NoProfile -ExecutionPolicy Bypass -File \"\"{}\"\"\", 0, False",
          "location": "0x6a4"
        }
      ],
      "source_file": "micro-behaviors/execution/activex/com/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/vbscript/interpreter::set-vbscript",
      "kind": "capability",
      "desc": "VBScript Set statement",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1059.005",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Set objShell =",
          "location": "0x6a4"
        }
      ],
      "source_file": "micro-behaviors/execution/vbscript/interpreter/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/command/script::powershell-script-execution",
      "kind": "capability",
      "desc": "Executes a PowerShell script file (.ps1)",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1059.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x246"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x247"
        }
      ],
      "source_file": "micro-behaviors/execution/command/script/execution.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscation/code-metrics/structure::very-low-comment-ratio",
      "kind": "capability",
      "desc": "Very low comment-to-code ratio (<1%)",
      "conf": 0.65,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "comments.to_code_ratio = 0.00"
        }
      ],
      "source_file": "objectives/anti-static/obfuscation/code-metrics/structure/traits.yaml"
    },
    {
      "id": "objectives/anti-analysis/masquerade/process::rust-360-check",
      "kind": "capability",
      "desc": "Checks for 360 Safe Tray",
      "conf": 1.0,
      "crit": "suspicious",
      "attack": "T1036",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "qhsafetray.exe",
          "location": "0x616"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "qhsafetray.exe",
          "location": "0x617"
        }
      ],
      "source_file": "objectives/anti-analysis/masquerade/process/rust.yaml"
    },
    {
      "id": "micro-behaviors/execution/dropper/loader::client-get",
      "kind": "capability",
      "desc": "HTTP client.get call",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "client.get.header"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "client.get.header.send"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "client.get"
        }
      ],
      "source_file": "micro-behaviors/execution/dropper/loader/rust.yaml"
    },
    {
      "id": "objectives/execution/condition/platform::executes-scripts",
      "kind": "capability",
      "desc": "Executes script files",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x246"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".ps1",
          "location": "0x247"
        }
      ],
      "source_file": "objectives/execution/condition/platform/os.yaml"
    },
    {
      "id": "objectives/execution/condition/platform::has-execution-capability",
      "kind": "capability",
      "desc": "Has code execution capability",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2c"
        }
      ],
      "source_file": "objectives/execution/condition/platform/os.yaml"
    },
    {
      "id": "micro-behaviors/comm/http/request::request",
      "kind": "capability",
      "desc": "Makes HTTP requests",
      "conf": 0.66,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf5f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf60"
        }
      ],
      "source_file": "micro-behaviors/comm/http/request/generic.yaml"
    },
    {
      "id": "objectives/command-and-control/ddos/attack::http-methods",
      "kind": "capability",
      "desc": "HTTP request methods detected",
      "conf": 1.0,
      "crit": "inert",
      "mbc": "B0009",
      "attack": "T1498",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xab3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf5f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "User-Agent",
          "location": "0xf60"
        }
      ],
      "source_file": "objectives/command-and-control/ddos/attack/generic.yaml"
    },
    {
      "id": "micro-behaviors/execution/command/shell::shell-symbols",
      "kind": "capability",
      "desc": "Shell execution symbols",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2c"
        }
      ],
      "source_file": "micro-behaviors/execution/command/shell/traits.yaml"
    },
    {
      "id": "micro-behaviors/data/control-flow/analysis::iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "70:5"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1  for _ in ",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/data/control-flow/analysis/generic.yaml"
    },
    {
      "id": "micro-behaviors/execution/command/shell::shell-execution-indicators",
      "kind": "capability",
      "desc": "Shell command execution indicators",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "bash",
          "location": "0xd2c"
        }
      ],
      "source_file": "micro-behaviors/execution/command/shell/traits.yaml"
    },
    {
      "id": "meta/internal/imported::encoded/as_bytes",
      "kind": "structural",
      "desc": "calls encoded.as_bytes",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "encoded.as_bytes"
        }
      ]
    },
    {
      "id": "meta/internal/imported::temp_dir",
      "kind": "structural",
      "desc": "calls temp_dir",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "temp_dir"
        }
      ]
    },
    {
      "id": "meta/internal/imported::check",
      "kind": "structural",
      "desc": "calls check",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "check"
        }
      ]
    },
    {
      "id": "meta/internal/imported::client/get/header",
      "kind": "structural",
      "desc": "calls client.get.header",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "client.get.header"
        }
      ]
    },
    {
      "id": "meta/internal/imported::assert_eq",
      "kind": "structural",
      "desc": "calls assert_eq",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "assert_eq"
        }
      ]
    },
    {
      "id": "meta/internal/imported::temp_dir/join",
      "kind": "structural",
      "desc": "calls temp_dir.join",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "temp_dir.join"
        }
      ]
    },
    {
      "id": "meta/internal/imported::response/bytes",
      "kind": "structural",
      "desc": "calls response.bytes",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "response.bytes"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sys/refresh_all",
      "kind": "structural",
      "desc": "calls sys.refresh_all",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sys.refresh_all"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cmd/args/stdout/stdin",
      "kind": "structural",
      "desc": "calls cmd.args.stdout.stdin",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cmd.args.stdout.stdin"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sys/processes_by_name",
      "kind": "structural",
      "desc": "calls sys.processes_by_name",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sys.processes_by_name"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cmd/args/stdout/stdin/stderr/spawn",
      "kind": "structural",
      "desc": "calls cmd.args.stdout.stdin.stderr.spawn",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cmd.args.stdout.stdin.stderr.spawn"
        }
      ]
    },
    {
      "id": "meta/internal/imported::scpath/to_str/unwrap",
      "kind": "structural",
      "desc": "calls scpath.to_str.unwrap",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "scpath.to_str.unwrap"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cmd/args/stdout/stdin/stderr",
      "kind": "structural",
      "desc": "calls cmd.args.stdout.stdin.stderr",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cmd.args.stdout.stdin.stderr"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cmd/args/stdout",
      "kind": "structural",
      "desc": "calls cmd.args.stdout",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cmd.args.stdout"
        }
      ]
    },
    {
      "id": "meta/internal/imported::rt/block_on",
      "kind": "structural",
      "desc": "calls rt.block_on",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "rt.block_on"
        }
      ]
    },
    {
      "id": "meta/internal/imported::scpath/with_extension",
      "kind": "structural",
      "desc": "calls scpath.with_extension",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "scpath.with_extension"
        }
      ]
    },
    {
      "id": "meta/internal/imported::format",
      "kind": "structural",
      "desc": "calls format",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "format"
        }
      ]
    },
    {
      "id": "meta/internal/imported::client/get/header/send",
      "kind": "structural",
      "desc": "calls client.get.header.send",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "client.get.header.send"
        }
      ]
    },
    {
      "id": "meta/internal/imported::client/get",
      "kind": "structural",
      "desc": "calls client.get",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "client.get"
        }
      ]
    },
    {
      "id": "meta/internal/imported::scpath/to_str",
      "kind": "structural",
      "desc": "calls scpath.to_str",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "scpath.to_str"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cmd/args",
      "kind": "structural",
      "desc": "calls cmd.args",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cmd.args"
        }
      ]
    },
    {
      "id": "meta/internal/imported::scpath/clone",
      "kind": "structural",
      "desc": "calls scpath.clone",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "scpath.clone"
        }
      ]
    },
    {
      "id": "meta/internal/imported::get_evm_version",
      "kind": "structural",
      "desc": "calls get_evm_version",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "get_evm_version"
        }
      ]
    },
    {
      "id": "meta/internal/imported::scfile/write",
      "kind": "structural",
      "desc": "calls scfile.write",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "scfile.write"
        }
      ]
    },
    {
      "id": "meta/encoded-payload/base64",
      "kind": "structural",
      "desc": "Encoded payload detected: base64",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "pattern",
          "source": "dissect",
          "value": "encoding=base64, type=Unknown, preview=https://download.videotalks.xyz/gui/6dad",
          "location": "offset:4840"
        }
      ]
    }
  ]
}
