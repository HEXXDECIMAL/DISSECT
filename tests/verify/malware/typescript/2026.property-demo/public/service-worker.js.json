{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/typescript/2026.property-demo/public/service-worker.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "b84dc1ff5ed815dd8c71dd5a60bc706a0418da5cf68d7d91d4cf52103fc633a2",
  "size": 4164,
  "risk": "suspicious",
  "counts": {
    "suspicious": 1,
    "notable": 11
  },
  "findings": [
    {
      "id": "obj/lateral/supply-chain/service-worker::cache-busting",
      "kind": "capability",
      "desc": "Service Worker implements aggressive cache busting",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of cache-bust=",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/supply-chain/service-worker/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/service-worker::protocol-downgrade",
      "kind": "capability",
      "desc": "Service Worker forces protocol synchronization (downgrade attack)",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .protocol = self.location.protocol",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/supply-chain/service-worker/traits.yaml"
    },
    {
      "id": "cap/comm/http/service-worker::event-activate",
      "kind": "capability",
      "desc": "Service Worker activate event listener",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 addEventListener('activate'",
          "location": "file"
        }
      ],
      "source_file": "cap/comm/http/service-worker/traits.yaml"
    },
    {
      "id": "cap/comm/http/service-worker::event-fetch",
      "kind": "capability",
      "desc": "Service Worker fetch event listener (network interception)",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 addEventListener('fetch'",
          "location": "file"
        }
      ],
      "source_file": "cap/comm/http/service-worker/traits.yaml"
    },
    {
      "id": "cap/comm/http/service-worker::api-respond-with",
      "kind": "capability",
      "desc": "Service Worker respondWith (modifies response)",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .respondWith(",
          "location": "file"
        }
      ],
      "source_file": "cap/comm/http/service-worker/traits.yaml"
    },
    {
      "id": "obj/c2/infrastructure/domain::hardcoded-domain-com",
      "kind": "capability",
      "desc": "Hardcoded .com/.org/.net domain (excluding known vendors)",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "gstatic.com",
          "location": "0x4f1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "gstatic.com",
          "location": "0x4f2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "googleapis.com",
          "location": "0x50e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "googleapis.com",
          "location": "0x50f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "jsdelivr.net",
          "location": "0x52e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "jsdelivr.net",
          "location": "0x52f"
        }
      ],
      "source_file": "obj/c2/infrastructure/domain/traits.yaml"
    },
    {
      "id": "cap/comm/http/service-worker::control-claim",
      "kind": "capability",
      "desc": "Service Worker claims clients immediately",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 clients.claim()",
          "location": "file"
        }
      ],
      "source_file": "cap/comm/http/service-worker/traits.yaml"
    },
    {
      "id": "cap/data/encoding/charset::proto-extension",
      "kind": "capability",
      "desc": ".proto file extension",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "url.protocol"
        }
      ],
      "source_file": "cap/data/encoding/charset/traits.yaml"
    },
    {
      "id": "meta/quality/error-handling::catch-keyword",
      "kind": "capability",
      "desc": "catch keyword",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "catch"
        }
      ],
      "source_file": "meta/quality/error-handling/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/vscode::activate-word",
      "kind": "capability",
      "desc": "activate keyword",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "activate",
          "location": "0x9c2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "activate",
          "location": "0x9c3"
        }
      ],
      "source_file": "obj/lateral/supply-chain/vscode/malicious.yaml"
    },
    {
      "id": "cap/exec/dropper/loader::fetch-call",
      "kind": "capability",
      "desc": "fetch() API call",
      "conf": 0.6,
      "crit": "inert",
      "mbc": "B0024",
      "attack": "T1059.007",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 fetch(",
          "location": "file"
        }
      ],
      "source_file": "cap/exec/dropper/loader/node-fetch.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/npm/behavior::small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "service-worker.js"
        }
      ],
      "source_file": "obj/lateral/supply-chain/npm/behavior/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/affiliate::new-url-constructor",
      "kind": "capability",
      "desc": "Creates URL object for manipulation",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "self.addEventListener('fetch', event => {\n    // Skip some of cross-origin requests, like those for ...",
          "location": "65:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "HOSTNAME_WHITELIST.indexOf(new URL(event.request.url).hostname)",
          "location": "67:9"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/affiliate/hijacking.yaml"
    },
    {
      "id": "obj/anti-static/obfuscation/code-metrics/functions::many-one-liner-functions",
      "kind": "capability",
      "desc": "Many one-liner functions (minified code",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "functions.one_liners = 6.00"
        }
      ],
      "source_file": "obj/anti-static/obfuscation/code-metrics/functions/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/service-worker::intercept-all",
      "kind": "capability",
      "desc": "Service Worker intercepts requests and claims clients immediately",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 addEventListener('fetch'",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 clients.claim()",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 .respondWith(",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/supply-chain/service-worker/traits.yaml"
    },
    {
      "id": "cap/data/encoding/charset::protobuf",
      "kind": "capability",
      "desc": "Google Protocol Buffers",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "url.protocol"
        }
      ],
      "source_file": "cap/data/encoding/charset/traits.yaml"
    },
    {
      "id": "meta/internal/imported::cached",
      "kind": "structural",
      "desc": "calls cached",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cached"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/race",
      "kind": "structural",
      "desc": "calls Promise.race",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.race"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cache/put",
      "kind": "structural",
      "desc": "calls cache.put",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cache.put"
        }
      ]
    },
    {
      "id": "meta/internal/imported::now",
      "kind": "structural",
      "desc": "calls now",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "now"
        }
      ]
    },
    {
      "id": "meta/internal/imported::caches/match",
      "kind": "structural",
      "desc": "calls caches.match",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "caches.match"
        }
      ]
    },
    {
      "id": "meta/internal/imported::url",
      "kind": "structural",
      "desc": "calls url",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "url"
        }
      ]
    },
    {
      "id": "meta/internal/imported::self/clients/claim",
      "kind": "structural",
      "desc": "calls self.clients.claim",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "self.clients.claim"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fetched/then",
      "kind": "structural",
      "desc": "calls fetched.then",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fetched.then"
        }
      ]
    },
    {
      "id": "meta/internal/imported::self/addeventlistener",
      "kind": "structural",
      "desc": "calls self.addEventListener",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "self.addEventListener"
        }
      ]
    },
    {
      "id": "meta/internal/imported::getfixedurl",
      "kind": "structural",
      "desc": "calls getFixedUrl",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "getFixedUrl"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fetched",
      "kind": "structural",
      "desc": "calls fetched",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fetched"
        }
      ]
    },
    {
      "id": "meta/internal/imported::date/now",
      "kind": "structural",
      "desc": "calls Date.now",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Date.now"
        }
      ]
    },
    {
      "id": "meta/internal/imported::hostname_whitelist/indexof",
      "kind": "structural",
      "desc": "calls HOSTNAME_WHITELIST.indexOf",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "HOSTNAME_WHITELIST.indexOf"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fetchedcopy",
      "kind": "structural",
      "desc": "calls fetchedCopy",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fetchedCopy"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/all/then/catch",
      "kind": "structural",
      "desc": "calls Promise.all.then.catch",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.all.then.catch"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/all",
      "kind": "structural",
      "desc": "calls Promise.all",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.all"
        }
      ]
    },
    {
      "id": "meta/internal/imported::event/respondwith",
      "kind": "structural",
      "desc": "calls event.respondWith",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "event.respondWith"
        }
      ]
    },
    {
      "id": "meta/internal/imported::url/protocol",
      "kind": "structural",
      "desc": "calls url.protocol",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "url.protocol"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/race/then/catch",
      "kind": "structural",
      "desc": "calls Promise.race.then.catch",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.race.then.catch"
        }
      ]
    },
    {
      "id": "meta/internal/imported::resp/clone",
      "kind": "structural",
      "desc": "calls resp.clone",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "resp.clone"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/race/then",
      "kind": "structural",
      "desc": "calls Promise.race.then",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.race.then"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fetched/catch",
      "kind": "structural",
      "desc": "calls fetched.catch",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fetched.catch"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fetch",
      "kind": "structural",
      "desc": "calls fetch",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fetch"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/all/then",
      "kind": "structural",
      "desc": "calls Promise.all.then",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.all.then"
        }
      ]
    },
    {
      "id": "meta/internal/imported::caches/open",
      "kind": "structural",
      "desc": "calls caches.open",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "caches.open"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fixedurl",
      "kind": "structural",
      "desc": "calls fixedUrl",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fixedUrl"
        }
      ]
    },
    {
      "id": "meta/internal/imported::event/waituntil",
      "kind": "structural",
      "desc": "calls event.waitUntil",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "event.waitUntil"
        }
      ]
    },
    {
      "id": "meta/internal/imported::hostname_whitelist",
      "kind": "structural",
      "desc": "calls HOSTNAME_WHITELIST",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "HOSTNAME_WHITELIST"
        }
      ]
    }
  ]
}