{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/typescript/2026.property-demo/server/controllers/orderController.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "2bf38e5d905cf5ad0c68c2063bbf088621f97b90230b2618236e7dd48d315962",
  "size": 3325,
  "risk": "notable",
  "counts": {
    "notable": 3
  },
  "findings": [
    {
      "id": "objectives/anti-static/obfuscation/code-metrics/functions::many-anonymous-functions",
      "kind": "capability",
      "desc": "Many anonymous functions",
      "conf": 0.75,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "functions.anonymous = 8.00"
        }
      ],
      "source_file": "objectives/anti-static/obfuscation/code-metrics/functions/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/vm/sandbox::base64-long-string",
      "kind": "capability",
      "desc": "Long base64-like string pattern",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/middlewares/helpers/asyncErrorHandler",
          "location": "0x22"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/middlewares/helpers/asyncErrorHandler",
          "location": "0x23"
        }
      ],
      "source_file": "micro-behaviors/execution/vm/sandbox/node.yaml"
    },
    {
      "id": "micro-behaviors/os/env/access::javascript",
      "kind": "capability",
      "desc": "Access environment variables",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "process",
          "location": "28:17"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "env",
          "location": "28:25"
        }
      ],
      "source_file": "micro-behaviors/os/env/access/javascript.yaml"
    },
    {
      "id": "objectives/lateral-movement/supply-chain/npm/behavior::small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "orderController.js"
        }
      ],
      "source_file": "objectives/lateral-movement/supply-chain/npm/behavior/traits.yaml"
    },
    {
      "id": "meta/internal/imported::order/create",
      "kind": "structural",
      "desc": "calls Order.create",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order.create"
        }
      ]
    },
    {
      "id": "meta/internal/imported::updatestock",
      "kind": "structural",
      "desc": "calls updateStock",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "updateStock"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/findbyid/populate",
      "kind": "structural",
      "desc": "calls Order.findById.populate",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order.findById.populate"
        }
      ]
    },
    {
      "id": "meta/internal/imported::orderexist",
      "kind": "structural",
      "desc": "calls orderExist",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orderExist"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getsingleorderdetails",
      "kind": "structural",
      "desc": "calls exports.getSingleOrderDetails",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getSingleOrderDetails"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/find",
      "kind": "structural",
      "desc": "calls Order.find",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order.find"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getallorders",
      "kind": "structural",
      "desc": "calls exports.getAllOrders",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getAllOrders"
        }
      ]
    },
    {
      "id": "meta/internal/imported::totalamount",
      "kind": "structural",
      "desc": "calls totalAmount",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "totalAmount"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/updateorder",
      "kind": "structural",
      "desc": "calls exports.updateOrder",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.updateOrder"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/myorders",
      "kind": "structural",
      "desc": "calls exports.myOrders",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.myOrders"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/shippedat",
      "kind": "structural",
      "desc": "calls order.shippedAt",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.shippedAt"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/neworder",
      "kind": "structural",
      "desc": "calls exports.newOrder",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.newOrder"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/save",
      "kind": "structural",
      "desc": "calls order.save",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.save"
        }
      ]
    },
    {
      "id": "meta/internal/imported::product/save",
      "kind": "structural",
      "desc": "calls product.save",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "product.save"
        }
      ]
    },
    {
      "id": "meta/internal/imported::next",
      "kind": "structural",
      "desc": "calls next",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "next"
        }
      ]
    },
    {
      "id": "meta/internal/imported::product",
      "kind": "structural",
      "desc": "calls product",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "product"
        }
      ]
    },
    {
      "id": "meta/internal/imported::product/findbyid",
      "kind": "structural",
      "desc": "calls Product.findById",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Product.findById"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/remove",
      "kind": "structural",
      "desc": "calls order.remove",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.remove"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/orderitems/foreach",
      "kind": "structural",
      "desc": "calls order.orderItems.forEach",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.orderItems.forEach"
        }
      ]
    },
    {
      "id": "meta/internal/imported::res/status",
      "kind": "structural",
      "desc": "calls res.status",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "res.status"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/orderstatus",
      "kind": "structural",
      "desc": "calls order.orderStatus",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.orderStatus"
        }
      ]
    },
    {
      "id": "meta/internal/imported::date/now",
      "kind": "structural",
      "desc": "calls Date.now",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Date.now"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/deleteorder",
      "kind": "structural",
      "desc": "calls exports.deleteOrder",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.deleteOrder"
        }
      ]
    },
    {
      "id": "meta/internal/imported::errorhandler",
      "kind": "structural",
      "desc": "calls ErrorHandler",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ErrorHandler"
        }
      ]
    },
    {
      "id": "meta/internal/imported::require",
      "kind": "structural",
      "desc": "calls require",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "require"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order",
      "kind": "structural",
      "desc": "calls Order",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order"
        }
      ]
    },
    {
      "id": "meta/internal/imported::orders/foreach",
      "kind": "structural",
      "desc": "calls orders.forEach",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orders.forEach"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sendemail",
      "kind": "structural",
      "desc": "calls sendEmail",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sendEmail"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/findbyid",
      "kind": "structural",
      "desc": "calls Order.findById",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order.findById"
        }
      ]
    },
    {
      "id": "meta/internal/imported::asyncerrorhandler",
      "kind": "structural",
      "desc": "calls asyncErrorHandler",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "asyncErrorHandler"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/deliveredat",
      "kind": "structural",
      "desc": "calls order.deliveredAt",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "order.deliveredAt"
        }
      ]
    },
    {
      "id": "meta/internal/imported::orders",
      "kind": "structural",
      "desc": "calls orders",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orders"
        }
      ]
    },
    {
      "id": "meta/internal/imported::order/findone",
      "kind": "structural",
      "desc": "calls Order.findOne",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Order.findOne"
        }
      ]
    },
    {
      "id": "meta/internal/imported::res/status/json",
      "kind": "structural",
      "desc": "calls res.status.json",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "res.status.json"
        }
      ]
    }
  ]
}