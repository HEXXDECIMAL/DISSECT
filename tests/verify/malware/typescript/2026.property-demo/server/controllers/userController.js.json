{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/typescript/2026.property-demo/server/controllers/userController.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "f1e2b0b5f4d91100a846d0847eabb3768daba8325dcc5df834ec7935d6ddb1b0",
  "size": 6707,
  "risk": "hostile",
  "counts": {
    "hostile": 1,
    "suspicious": 5,
    "notable": 15
  },
  "findings": [
    {
      "id": "known/malware/supply-chain::property-demo-env-key",
      "kind": "capability",
      "desc": "Reference to Property-demo specific DEV_API_KEY",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of atob(process.env.DEV_API_KEY",
          "location": "file"
        }
      ],
      "source_file": "known/malware/supply-chain/property-demo-loader.yaml"
    },
    {
      "id": "micro-behaviors/execution/load/obfuscated::function-constructor-require",
      "kind": "capability",
      "desc": "Function constructor with require access",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of new (Function.constructor)('require'",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/execution/load/obfuscated/node.yaml"
    },
    {
      "id": "known/malware/trojan::ts-ui-reiboot-classes",
      "kind": "capability",
      "desc": "Tenorshare ReiBoot UI classes",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "ResetPasswordToken"
        }
      ],
      "source_file": "known/malware/trojan/tenorshare-suspicious.yaml"
    },
    {
      "id": "micro-behaviors/data/text/keywords::token",
      "kind": "capability",
      "desc": "token keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Token",
          "location": "0x96"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Token",
          "location": "0x97"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "token",
          "location": "0x68a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "token",
          "location": "0x68b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Token",
          "location": "0x9cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "token",
          "location": "0xde5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "token",
          "location": "0xde6"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "Token"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "Token"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "Token"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "Token"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "Token"
        }
      ],
      "source_file": "micro-behaviors/data/text/keywords/generic.yaml"
    },
    {
      "id": "micro-behaviors/data/text/keywords::password",
      "kind": "capability",
      "desc": "password keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Please Enter Email And Password",
          "location": "0x495"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Please Enter Email And Password",
          "location": "0x496"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "+password",
          "location": "0x4f8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "+password",
          "location": "0x4f9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid Email or Password",
          "location": "0x537"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid Email or Password",
          "location": "0x538"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid Email or Password",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid Email or Password",
          "location": "0x5e1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "https://${req.get(\n    \"host\"\n  )}/password/reset/${resetToken}",
          "location": "0x9cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/password/reset/",
          "location": "0x9ee"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid reset password token",
          "location": "0xde5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Invalid reset password token",
          "location": "0xde6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "+password",
          "location": "0xf4e"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "+password",
          "location": "0xf4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Old Password is Invalid",
          "location": "0xfe9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Old Password is Invalid",
          "location": "0xfea"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "user.resetPasswordExpire"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "user.resetPasswordToken"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "exports.resetPassword"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "user.password"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "isPasswordMatched"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "user.getResetPasswordToken"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "exports.updatePassword"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "exports.forgotPassword"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "user.comparePassword"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "resetPasswordUrl"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "resetPasswordToken"
        }
      ],
      "source_file": "micro-behaviors/data/text/keywords/generic.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscate/dynamic::env-atob-decode",
      "kind": "capability",
      "desc": "Usage of atob to decode environment variables",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 occurrences of atob(process.env.",
          "location": "file"
        }
      ],
      "source_file": "objectives/anti-static/obfuscate/dynamic/loader.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscate/dynamic::axios-get",
      "kind": "capability",
      "desc": "Axios GET request",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of axios.get",
          "location": "file"
        }
      ],
      "source_file": "objectives/anti-static/obfuscate/dynamic/loader.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscate/dynamic::export-iife-injection",
      "kind": "capability",
      "desc": "Immediately Invoked Function Expression on Export",
      "conf": 0.8,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 exports.registerUser = asyncErrorHandler(async (req, res, next) => {\n  const myCloud = await cloudinary.v2.uploader.upload(req.body.avatar, {\n    folder: \"avatars\",\n    width: 150,\n    crop: \"scale\",\n  });\n\n  const { name, email, gender, password } = req.body;\n\n  const user = await User.create({\n    name,\n    email,\n    gender,\n    password,\n    avatar: {\n      public_id: myCloud.public_id,\n      url: myCloud.secure_url,\n    },\n  });\n\n  sendToken(user, 201, res);\n});\n\n// Login User\nexports.loginUser = asyncErrorHandler(async (req, res, next) => {\n  const { email, password } = req.body;\n\n  if (!email || !password) {\n    return next(new ErrorHandler(\"Please Enter Email And Password\", 400));\n  }\n\n  const user = await User.findOne({ email }).select(\"+password\");\n\n  if (!user) {\n    return next(new ErrorHandler(\"Invalid Email or Password\", 401));\n  }\n\n  const isPasswordMatched = await user.comparePassword(password);\n\n  if (!isPasswordMatched) {\n    return next(new ErrorHandler(\"Invalid Email or Password\", 401));\n  }\n\n  sendToken(user, 201, res);\n});\n\n// Logout User\nexports.logoutUser = asyncErrorHandler(async (req, res, next) => {\n  res.cookie(\"token\", null, {\n    expires: new Date(Date.now()),\n    httpOnly: true,\n  });\n\n  res.status(200).json({\n    success: true,\n    message: \"Logged Out\",\n  });\n});\n\n// Get User Details\nexports.getUserDetails = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findById(req.user.id);\n\n  res.status(200).json({\n    success: true,\n    user,\n  });\n});\n\n// Forgot Password\nexports.forgotPassword = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findOne({ email: req.body.email });\n\n  if (!user) {\n    return next(new ErrorHandler(\"User Not Found\", 404));\n  }\n\n  const resetToken = await user.getResetPasswordToken();\n\n  await user.save({ validateBeforeSave: false });\n\n  // const resetPasswordUrl = `${req.protocol}://${req.get(\"host\")}/password/reset/${resetToken}`;\n  const resetPasswordUrl = `https://${req.get(\n    \"host\"\n  )}/password/reset/${resetToken}`;\n\n  // const message = `Your password reset token is : \\n\\n ${resetPasswordUrl}`;\n\n  try {\n    await sendEmail({\n      email: user.email,\n      templateId: process.env.SENDGRID_RESET_TEMPLATEID,\n      data: {\n        reset_url: resetPasswordUrl,\n      },\n    });\n\n    res.status(200).json({\n      success: true,\n      message: `Email sent to ${user.email} successfully`,\n    });\n  } catch (error) {\n    user.resetPasswordToken = undefined;\n    user.resetPasswordExpire = undefined;\n\n    await user.save({ validateBeforeSave: false });\n    return next(new ErrorHandler(error.message, 500));\n  }\n});\n\n// Reset Password\nexports.resetPassword = asyncErrorHandler(async (req, res, next) => {\n  // create hash token\n  const resetPasswordToken = crypto\n    .createHash(\"sha256\")\n    .update(req.params.token)\n    .digest(\"hex\");\n\n  const user = await User.findOne({\n    resetPasswordToken,\n    resetPasswordExpire: { $gt: Date.now() },\n  });\n\n  if (!user) {\n    return next(new ErrorHandler(\"Invalid reset password token\", 404));\n  }\n\n  user.password = req.body.password;\n  user.resetPasswordToken = undefined;\n  user.resetPasswordExpire = undefined;\n\n  await user.save();\n  sendToken(user, 200, res);\n});\n\n// Update Password\nexports.updatePassword = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findById(req.user.id).select(\"+password\");\n\n  const isPasswordMatched = await user.comparePassword(req.body.oldPassword);\n\n  if (!isPasswordMatched) {\n    return next(new ErrorHandler(\"Old Password is Invalid\", 400));\n  }\n\n  user.password = req.body.newPassword;\n  await user.save();\n  sendToken(user, 201, res);\n});\n\n// Update User Profile\nexports.updateProfile = asyncErrorHandler(async (req, res, next) => {\n  const newUserData = {\n    name: req.body.name,\n    email: req.body.email,\n  };\n\n  if (req.body.avatar !== \"\") {\n    const user = await User.findById(req.user.id);\n\n    const imageId = user.avatar.public_id;\n\n    await cloudinary.v2.uploader.destroy(imageId);\n\n    const myCloud = await cloud...[truncated]",
          "location": "file"
        }
      ],
      "source_file": "objectives/anti-static/obfuscate/dynamic/loader.yaml"
    },
    {
      "id": "objectives/credential-access/phishing/lure::enter-password-prompt",
      "kind": "capability",
      "desc": "Prompts user to enter password",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1056.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Enter Email And Password",
          "location": "0x495"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Enter Email And Password",
          "location": "0x496"
        }
      ],
      "source_file": "objectives/credential-access/phishing/lure/applescript.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscation/code-metrics/identifiers::low-identifier-reuse",
      "kind": "capability",
      "desc": "Low identifier reuse (each variable",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "identifiers.reuse_ratio = 0.14"
        }
      ],
      "source_file": "objectives/anti-static/obfuscation/code-metrics/identifiers/traits.yaml"
    },
    {
      "id": "objectives/command-and-control/network/http-listener::express-get-endpoint",
      "kind": "capability",
      "desc": "Express GET endpoint",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".get(",
          "location": "0x9cb"
        }
      ],
      "source_file": "objectives/command-and-control/network/http-listener/javascript.yaml"
    },
    {
      "id": "objectives/discovery/host/fingerprint::createhash-call",
      "kind": "capability",
      "desc": "crypto.createHash call",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash.update"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash.update.digest"
        }
      ],
      "source_file": "objectives/discovery/host/fingerprint/node.yaml"
    },
    {
      "id": "objectives/anti-static/obfuscation/code-metrics/functions::many-anonymous-functions",
      "kind": "capability",
      "desc": "Many anonymous functions",
      "conf": 0.75,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "functions.anonymous = 13.00"
        }
      ],
      "source_file": "objectives/anti-static/obfuscation/code-metrics/functions/traits.yaml"
    },
    {
      "id": "objectives/impact/ransomware/behavior::crypto-module",
      "kind": "capability",
      "desc": "crypto module",
      "conf": 0.3,
      "crit": "notable",
      "attack": "T1486",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "crypto",
          "location": "0x12c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "crypto",
          "location": "0x12d"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash.update"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto.createHash.update.digest"
        }
      ],
      "source_file": "objectives/impact/ransomware/behavior/patterns.yaml"
    },
    {
      "id": "micro-behaviors/comm/http/request::axios",
      "kind": "capability",
      "desc": "axios library reference",
      "conf": 0.6,
      "crit": "inert",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x177"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x178"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ],
      "source_file": "micro-behaviors/comm/http/request/javascript.yaml"
    },
    {
      "id": "objectives/command-and-control/rat/script::require-resolve-check",
      "kind": "capability",
      "desc": "Module installation check",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "resolve",
          "location": "10:38"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "'../config/.config.env'",
          "location": "10:57"
        }
      ],
      "source_file": "objectives/command-and-control/rat/script/javascript.yaml"
    },
    {
      "id": "objectives/discovery/host/fingerprint::sha256-keyword",
      "kind": "capability",
      "desc": "sha256 hash algorithm",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "sha256",
          "location": "0xd07"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "sha256",
          "location": "0xd08"
        }
      ],
      "source_file": "objectives/discovery/host/fingerprint/node.yaml"
    },
    {
      "id": "meta/quality/config::dotenv-module",
      "kind": "capability",
      "desc": "dotenv module reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "dotenv",
          "location": "0x1a7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "dotenv",
          "location": "0x1a8"
        }
      ],
      "source_file": "meta/quality/config/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/vm/sandbox::base64-long-string",
      "kind": "capability",
      "desc": "Long base64-like string pattern",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/middlewares/helpers/asyncErrorHandler",
          "location": "0x4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/middlewares/helpers/asyncErrorHandler",
          "location": "0x50"
        }
      ],
      "source_file": "micro-behaviors/execution/vm/sandbox/node.yaml"
    },
    {
      "id": "micro-behaviors/os/env/access::javascript",
      "kind": "capability",
      "desc": "Access environment variables",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "process",
          "location": "104:19"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "env",
          "location": "104:27"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "process",
          "location": "267:23"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "env",
          "location": "267:31"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "process",
          "location": "268:18"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "env",
          "location": "268:26"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "process",
          "location": "269:18"
        },
        {
          "method": "ast_query",
          "source": "tree-sitter",
          "value": "env",
          "location": "269:26"
        }
      ],
      "source_file": "micro-behaviors/os/env/access/javascript.yaml"
    },
    {
      "id": "micro-behaviors/data/exploitation/memory::js-proto-pollution-guard",
      "kind": "capability",
      "desc": "Prototype pollution guard check present",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 constructor",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/data/exploitation/memory/generic.yaml"
    },
    {
      "id": "objectives/credential-access/wallet/mnemonic::crypto-word",
      "kind": "capability",
      "desc": "crypto term",
      "conf": 0.5,
      "crit": "notable",
      "mbc": "B0028",
      "attack": "T1555",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "crypto",
          "location": "0x12c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "crypto",
          "location": "0x12d"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "crypto"
        }
      ],
      "source_file": "objectives/credential-access/wallet/mnemonic/traits.yaml"
    },
    {
      "id": "meta/quality::config-management",
      "kind": "capability",
      "desc": "External configuration management",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "dotenv",
          "location": "0x1a7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "dotenv",
          "location": "0x1a8"
        }
      ],
      "source_file": "meta/quality/traits.yaml"
    },
    {
      "id": "objectives/lateral-movement/supply-chain/vscode::send-methods",
      "kind": "capability",
      "desc": "HTTP send methods",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x177"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x178"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ],
      "source_file": "objectives/lateral-movement/supply-chain/vscode/malicious.yaml"
    },
    {
      "id": "known/malware/supply-chain::property-demo-infection",
      "kind": "capability",
      "desc": "Property-demo infection markers",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 exports.registerUser = asyncErrorHandler(async (req, res, next) => {\n  const myCloud = await cloudinary.v2.uploader.upload(req.body.avatar, {\n    folder: \"avatars\",\n    width: 150,\n    crop: \"scale\",\n  });\n\n  const { name, email, gender, password } = req.body;\n\n  const user = await User.create({\n    name,\n    email,\n    gender,\n    password,\n    avatar: {\n      public_id: myCloud.public_id,\n      url: myCloud.secure_url,\n    },\n  });\n\n  sendToken(user, 201, res);\n});\n\n// Login User\nexports.loginUser = asyncErrorHandler(async (req, res, next) => {\n  const { email, password } = req.body;\n\n  if (!email || !password) {\n    return next(new ErrorHandler(\"Please Enter Email And Password\", 400));\n  }\n\n  const user = await User.findOne({ email }).select(\"+password\");\n\n  if (!user) {\n    return next(new ErrorHandler(\"Invalid Email or Password\", 401));\n  }\n\n  const isPasswordMatched = await user.comparePassword(password);\n\n  if (!isPasswordMatched) {\n    return next(new ErrorHandler(\"Invalid Email or Password\", 401));\n  }\n\n  sendToken(user, 201, res);\n});\n\n// Logout User\nexports.logoutUser = asyncErrorHandler(async (req, res, next) => {\n  res.cookie(\"token\", null, {\n    expires: new Date(Date.now()),\n    httpOnly: true,\n  });\n\n  res.status(200).json({\n    success: true,\n    message: \"Logged Out\",\n  });\n});\n\n// Get User Details\nexports.getUserDetails = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findById(req.user.id);\n\n  res.status(200).json({\n    success: true,\n    user,\n  });\n});\n\n// Forgot Password\nexports.forgotPassword = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findOne({ email: req.body.email });\n\n  if (!user) {\n    return next(new ErrorHandler(\"User Not Found\", 404));\n  }\n\n  const resetToken = await user.getResetPasswordToken();\n\n  await user.save({ validateBeforeSave: false });\n\n  // const resetPasswordUrl = `${req.protocol}://${req.get(\"host\")}/password/reset/${resetToken}`;\n  const resetPasswordUrl = `https://${req.get(\n    \"host\"\n  )}/password/reset/${resetToken}`;\n\n  // const message = `Your password reset token is : \\n\\n ${resetPasswordUrl}`;\n\n  try {\n    await sendEmail({\n      email: user.email,\n      templateId: process.env.SENDGRID_RESET_TEMPLATEID,\n      data: {\n        reset_url: resetPasswordUrl,\n      },\n    });\n\n    res.status(200).json({\n      success: true,\n      message: `Email sent to ${user.email} successfully`,\n    });\n  } catch (error) {\n    user.resetPasswordToken = undefined;\n    user.resetPasswordExpire = undefined;\n\n    await user.save({ validateBeforeSave: false });\n    return next(new ErrorHandler(error.message, 500));\n  }\n});\n\n// Reset Password\nexports.resetPassword = asyncErrorHandler(async (req, res, next) => {\n  // create hash token\n  const resetPasswordToken = crypto\n    .createHash(\"sha256\")\n    .update(req.params.token)\n    .digest(\"hex\");\n\n  const user = await User.findOne({\n    resetPasswordToken,\n    resetPasswordExpire: { $gt: Date.now() },\n  });\n\n  if (!user) {\n    return next(new ErrorHandler(\"Invalid reset password token\", 404));\n  }\n\n  user.password = req.body.password;\n  user.resetPasswordToken = undefined;\n  user.resetPasswordExpire = undefined;\n\n  await user.save();\n  sendToken(user, 200, res);\n});\n\n// Update Password\nexports.updatePassword = asyncErrorHandler(async (req, res, next) => {\n  const user = await User.findById(req.user.id).select(\"+password\");\n\n  const isPasswordMatched = await user.comparePassword(req.body.oldPassword);\n\n  if (!isPasswordMatched) {\n    return next(new ErrorHandler(\"Old Password is Invalid\", 400));\n  }\n\n  user.password = req.body.newPassword;\n  await user.save();\n  sendToken(user, 201, res);\n});\n\n// Update User Profile\nexports.updateProfile = asyncErrorHandler(async (req, res, next) => {\n  const newUserData = {\n    name: req.body.name,\n    email: req.body.email,\n  };\n\n  if (req.body.avatar !== \"\") {\n    const user = await User.findById(req.user.id);\n\n    const imageId = user.avatar.public_id;\n\n    await cloudinary.v2.uploader.destroy(imageId);\n\n    const myCloud = await cloud...[truncated]",
          "location": "file"
        }
      ],
      "source_file": "known/malware/supply-chain/property-demo-loader.yaml"
    },
    {
      "id": "micro-behaviors/execution/vm/sandbox::http-clients",
      "kind": "capability",
      "desc": "HTTP client library usage",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x177"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x178"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ],
      "source_file": "micro-behaviors/execution/vm/sandbox/node.yaml"
    },
    {
      "id": "objectives/credential-access/phishing/lure::password-prompt-pattern",
      "kind": "capability",
      "desc": "Password dialog prompt",
      "conf": 0.8,
      "crit": "suspicious",
      "attack": "T1056.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Enter Email And Password",
          "location": "0x495"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Enter Email And Password",
          "location": "0x496"
        }
      ],
      "source_file": "objectives/credential-access/phishing/lure/applescript.yaml"
    },
    {
      "id": "known/malware/supply-chain::property-demo-loader-pattern",
      "kind": "capability",
      "desc": "Property-demo specific loader pattern",
      "conf": 1.0,
      "crit": "hostile",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of atob(process.env.DEV_API_KEY",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of new (Function.constructor)('require'",
          "location": "file"
        }
      ],
      "source_file": "known/malware/supply-chain/property-demo-loader.yaml"
    },
    {
      "id": "micro-behaviors/execution/vm/sandbox::http-fetch-methods",
      "kind": "capability",
      "desc": "HTTP fetch methods",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x177"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x178"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ],
      "source_file": "micro-behaviors/execution/vm/sandbox/node.yaml"
    },
    {
      "id": "objectives/discovery/host/fingerprint::hash-algorithms",
      "kind": "capability",
      "desc": "Hash algorithm keywords",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "sha256",
          "location": "0xd07"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "sha256",
          "location": "0xd08"
        }
      ],
      "source_file": "objectives/discovery/host/fingerprint/node.yaml"
    },
    {
      "id": "objectives/command-and-control/ddos/attack::http-methods",
      "kind": "capability",
      "desc": "HTTP request methods detected",
      "conf": 1.0,
      "crit": "inert",
      "mbc": "B0009",
      "attack": "T1498",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x177"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "axios",
          "location": "0x178"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ],
      "source_file": "objectives/command-and-control/ddos/attack/generic.yaml"
    },
    {
      "id": "meta/internal/imported::user/resetpasswordexpire",
      "kind": "structural",
      "desc": "calls user.resetPasswordExpire",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.resetPasswordExpire"
        }
      ]
    },
    {
      "id": "meta/internal/imported::atob",
      "kind": "structural",
      "desc": "calls atob",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "atob"
        }
      ]
    },
    {
      "id": "meta/internal/imported::imageid",
      "kind": "structural",
      "desc": "calls imageId",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "imageId"
        }
      ]
    },
    {
      "id": "meta/internal/imported::users",
      "kind": "structural",
      "desc": "calls users",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "users"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/save",
      "kind": "structural",
      "desc": "calls user.save",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.save"
        }
      ]
    },
    {
      "id": "meta/internal/imported::crypto/createhash/update",
      "kind": "structural",
      "desc": "calls crypto.createHash.update",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "crypto.createHash.update"
        }
      ]
    },
    {
      "id": "meta/internal/imported::require",
      "kind": "structural",
      "desc": "calls require",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "require"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getcookie",
      "kind": "structural",
      "desc": "calls exports.getCookie",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getCookie"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getuserdetails",
      "kind": "structural",
      "desc": "calls exports.getUserDetails",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getUserDetails"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getsingleuser",
      "kind": "structural",
      "desc": "calls exports.getSingleUser",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getSingleUser"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cloudinary/v2/uploader/upload",
      "kind": "structural",
      "desc": "calls cloudinary.v2.uploader.upload",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cloudinary.v2.uploader.upload"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/remove",
      "kind": "structural",
      "desc": "calls user.remove",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.remove"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/logoutuser",
      "kind": "structural",
      "desc": "calls exports.logoutUser",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.logoutUser"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/findbyid",
      "kind": "structural",
      "desc": "calls User.findById",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.findById"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/create",
      "kind": "structural",
      "desc": "calls User.create",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.create"
        }
      ]
    },
    {
      "id": "meta/internal/imported::res/status/json",
      "kind": "structural",
      "desc": "calls res.status.json",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "res.status.json"
        }
      ]
    },
    {
      "id": "meta/internal/imported::resettoken",
      "kind": "structural",
      "desc": "calls resetToken",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "resetToken"
        }
      ]
    },
    {
      "id": "meta/internal/imported::newuserdata/avatar",
      "kind": "structural",
      "desc": "calls newUserData.avatar",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "newUserData.avatar"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/updateuserrole",
      "kind": "structural",
      "desc": "calls exports.updateUserRole",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.updateUserRole"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user",
      "kind": "structural",
      "desc": "calls User",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sendtoken",
      "kind": "structural",
      "desc": "calls sendToken",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sendToken"
        }
      ]
    },
    {
      "id": "meta/internal/imported::newuserdata",
      "kind": "structural",
      "desc": "calls newUserData",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "newUserData"
        }
      ]
    },
    {
      "id": "meta/internal/imported::path/resolve",
      "kind": "structural",
      "desc": "calls path.resolve",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "path.resolve"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/getallusers",
      "kind": "structural",
      "desc": "calls exports.getAllUsers",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.getAllUsers"
        }
      ]
    },
    {
      "id": "meta/internal/imported::axios",
      "kind": "structural",
      "desc": "calls axios",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "axios"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/registeruser",
      "kind": "structural",
      "desc": "calls exports.registerUser",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.registerUser"
        }
      ]
    },
    {
      "id": "meta/internal/imported::require/config",
      "kind": "structural",
      "desc": "calls require.config",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "require.config"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cloudinary/v2/uploader/destroy",
      "kind": "structural",
      "desc": "calls cloudinary.v2.uploader.destroy",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cloudinary.v2.uploader.destroy"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/resetpasswordtoken",
      "kind": "structural",
      "desc": "calls user.resetPasswordToken",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.resetPasswordToken"
        }
      ]
    },
    {
      "id": "meta/internal/imported::date/now",
      "kind": "structural",
      "desc": "calls Date.now",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Date.now"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/updateprofile",
      "kind": "structural",
      "desc": "calls exports.updateProfile",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.updateProfile"
        }
      ]
    },
    {
      "id": "meta/internal/imported::res/cookie",
      "kind": "structural",
      "desc": "calls res.cookie",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "res.cookie"
        }
      ]
    },
    {
      "id": "meta/internal/imported::next",
      "kind": "structural",
      "desc": "calls next",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "next"
        }
      ]
    },
    {
      "id": "meta/internal/imported::crypto",
      "kind": "structural",
      "desc": "calls crypto",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "crypto"
        }
      ]
    },
    {
      "id": "meta/internal/imported::errorhandler",
      "kind": "structural",
      "desc": "calls ErrorHandler",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ErrorHandler"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/resetpassword",
      "kind": "structural",
      "desc": "calls exports.resetPassword",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.resetPassword"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cookie",
      "kind": "structural",
      "desc": "calls cookie",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cookie"
        }
      ]
    },
    {
      "id": "meta/internal/imported::path",
      "kind": "structural",
      "desc": "calls path",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "path"
        }
      ]
    },
    {
      "id": "meta/internal/imported::crypto/createhash",
      "kind": "structural",
      "desc": "calls crypto.createHash",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "crypto.createHash"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/loginuser",
      "kind": "structural",
      "desc": "calls exports.loginUser",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.loginUser"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/findone/select",
      "kind": "structural",
      "desc": "calls User.findOne.select",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.findOne.select"
        }
      ]
    },
    {
      "id": "meta/internal/imported::mycloud",
      "kind": "structural",
      "desc": "calls myCloud",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "myCloud"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/password",
      "kind": "structural",
      "desc": "calls user.password",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.password"
        }
      ]
    },
    {
      "id": "meta/internal/imported::sendemail",
      "kind": "structural",
      "desc": "calls sendEmail",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sendEmail"
        }
      ]
    },
    {
      "id": "meta/internal/imported::ispasswordmatched",
      "kind": "structural",
      "desc": "calls isPasswordMatched",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "isPasswordMatched"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/findbyid/select",
      "kind": "structural",
      "desc": "calls User.findById.select",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.findById.select"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/getresetpasswordtoken",
      "kind": "structural",
      "desc": "calls user.getResetPasswordToken",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.getResetPasswordToken"
        }
      ]
    },
    {
      "id": "meta/internal/imported::handler",
      "kind": "structural",
      "desc": "calls handler",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "handler"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/updatepassword",
      "kind": "structural",
      "desc": "calls exports.updatePassword",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.updatePassword"
        }
      ]
    },
    {
      "id": "meta/internal/imported::crypto/createhash/update/digest",
      "kind": "structural",
      "desc": "calls crypto.createHash.update.digest",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "crypto.createHash.update.digest"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/deleteuser",
      "kind": "structural",
      "desc": "calls exports.deleteUser",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.deleteUser"
        }
      ]
    },
    {
      "id": "meta/internal/imported::cloudinary",
      "kind": "structural",
      "desc": "calls cloudinary",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "cloudinary"
        }
      ]
    },
    {
      "id": "meta/internal/imported::exports/forgotpassword",
      "kind": "structural",
      "desc": "calls exports.forgotPassword",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exports.forgotPassword"
        }
      ]
    },
    {
      "id": "meta/internal/imported::req/get",
      "kind": "structural",
      "desc": "calls req.get",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "req.get"
        }
      ]
    },
    {
      "id": "meta/internal/imported::res/status",
      "kind": "structural",
      "desc": "calls res.status",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "res.status"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/comparepassword",
      "kind": "structural",
      "desc": "calls user.comparePassword",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "user.comparePassword"
        }
      ]
    },
    {
      "id": "meta/internal/imported::axios/get",
      "kind": "structural",
      "desc": "calls axios.get",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "axios.get"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/findone",
      "kind": "structural",
      "desc": "calls User.findOne",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.findOne"
        }
      ]
    },
    {
      "id": "meta/internal/imported::resetpasswordurl",
      "kind": "structural",
      "desc": "calls resetPasswordUrl",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "resetPasswordUrl"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/find",
      "kind": "structural",
      "desc": "calls User.find",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.find"
        }
      ]
    },
    {
      "id": "meta/internal/imported::resetpasswordtoken",
      "kind": "structural",
      "desc": "calls resetPasswordToken",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "resetPasswordToken"
        }
      ]
    },
    {
      "id": "meta/internal/imported::user/findbyidandupdate",
      "kind": "structural",
      "desc": "calls User.findByIdAndUpdate",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "User.findByIdAndUpdate"
        }
      ]
    },
    {
      "id": "meta/internal/imported::asyncerrorhandler",
      "kind": "structural",
      "desc": "calls asyncErrorHandler",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "asyncErrorHandler"
        }
      ]
    }
  ]
}