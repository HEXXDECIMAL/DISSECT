{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/typescript/2026.property-demo/server/middlewares/helpers/waterMarker.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "0726b8905896eea54f6899631f3d55e8b3ba3a0522530692d97fb118783452dd",
  "size": 1346,
  "risk": "notable",
  "counts": {
    "notable": 1
  },
  "findings": [
    {
      "id": "objectives/lateral-movement/supply-chain/npm/behavior::small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "waterMarker.js"
        }
      ],
      "source_file": "objectives/lateral-movement/supply-chain/npm/behavior/traits.yaml"
    },
    {
      "id": "meta/internal/imported::options",
      "kind": "structural",
      "desc": "calls options",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "options"
        }
      ]
    },
    {
      "id": "meta/internal/imported::results",
      "kind": "structural",
      "desc": "calls results",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "results"
        }
      ]
    },
    {
      "id": "meta/internal/imported::getdimensions",
      "kind": "structural",
      "desc": "calls getDimensions",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "getDimensions"
        }
      ]
    },
    {
      "id": "meta/internal/imported::jimp/read",
      "kind": "structural",
      "desc": "calls Jimp.read",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Jimp.read"
        }
      ]
    },
    {
      "id": "meta/internal/imported::hh",
      "kind": "structural",
      "desc": "calls hh",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "hh"
        }
      ]
    },
    {
      "id": "meta/internal/imported::imagepath",
      "kind": "structural",
      "desc": "calls imagePath",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "imagePath"
        }
      ]
    },
    {
      "id": "meta/internal/imported::watermark",
      "kind": "structural",
      "desc": "calls watermark",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "watermark"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main/getheight",
      "kind": "structural",
      "desc": "calls main.getHeight",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main.getHeight"
        }
      ]
    },
    {
      "id": "meta/internal/imported::watermark/resize",
      "kind": "structural",
      "desc": "calls watermark.resize",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "watermark.resize"
        }
      ]
    },
    {
      "id": "meta/internal/imported::watermark/opacity",
      "kind": "structural",
      "desc": "calls watermark.opacity",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "watermark.opacity"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main/quality",
      "kind": "structural",
      "desc": "calls main.quality",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main.quality"
        }
      ]
    },
    {
      "id": "meta/internal/imported::req/files/map",
      "kind": "structural",
      "desc": "calls req.files.map",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "req.files.map"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main/quality/write",
      "kind": "structural",
      "desc": "calls main.quality.write",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main.quality.write"
        }
      ]
    },
    {
      "id": "meta/internal/imported::positionx",
      "kind": "structural",
      "desc": "calls positionX",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "positionX"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main",
      "kind": "structural",
      "desc": "calls main",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main/getwidth",
      "kind": "structural",
      "desc": "calls main.getWidth",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main.getWidth"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/all",
      "kind": "structural",
      "desc": "calls Promise.all",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.all"
        }
      ]
    },
    {
      "id": "meta/internal/imported::positiony",
      "kind": "structural",
      "desc": "calls positionY",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "positionY"
        }
      ]
    },
    {
      "id": "meta/internal/imported::jimp",
      "kind": "structural",
      "desc": "calls Jimp",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Jimp"
        }
      ]
    },
    {
      "id": "meta/internal/imported::watermark/getheight",
      "kind": "structural",
      "desc": "calls watermark.getHeight",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "watermark.getHeight"
        }
      ]
    },
    {
      "id": "meta/internal/imported::next",
      "kind": "structural",
      "desc": "calls next",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "next"
        }
      ]
    },
    {
      "id": "meta/internal/imported::ww",
      "kind": "structural",
      "desc": "calls ww",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ww"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module/exports",
      "kind": "structural",
      "desc": "calls module.exports",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "module.exports"
        }
      ]
    },
    {
      "id": "meta/internal/imported::watermark/getwidth",
      "kind": "structural",
      "desc": "calls watermark.getWidth",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "watermark.getWidth"
        }
      ]
    },
    {
      "id": "meta/internal/imported::main/composite",
      "kind": "structural",
      "desc": "calls main.composite",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "main.composite"
        }
      ]
    },
    {
      "id": "meta/internal/imported::require",
      "kind": "structural",
      "desc": "calls require",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "require"
        }
      ]
    }
  ]
}