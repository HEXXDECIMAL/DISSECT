{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/sh/2022.sandstorm/AwfulShred.sh",
  "depth": 0,
  "file_type": "shell",
  "sha256": "bcdf0bd8142a4828c61e775686c9892d89893ed0f5093bdc70bde3e48d04ab99",
  "size": 10046,
  "risk": "suspicious",
  "counts": {
    "suspicious": 19,
    "notable": 14
  },
  "findings": [
    {
      "id": "cap/comm/ssh/connect/ssh-string",
      "kind": "capability",
      "desc": "ssh string",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0x199"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0x19a"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/while-loop",
      "kind": "capability",
      "desc": "while loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/command",
      "kind": "capability",
      "desc": "command keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "command"
        }
      ]
    },
    {
      "id": "cap/data/text/output",
      "kind": "capability",
      "desc": "output keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "output",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/systemd-ref",
      "kind": "capability",
      "desc": "systemd reference",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "cap/fs/file/read-symbols",
      "kind": "capability",
      "desc": "File read symbols",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file-ops/binary-file-ops",
      "kind": "capability",
      "desc": "Binary file operations",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/path/config/config-etc",
      "kind": "capability",
      "desc": "Reference to /etc configuration files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd/system",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd/system",
          "location": "0x372"
        }
      ]
    },
    {
      "id": "cap/fs/path/device/dev-path-pattern",
      "kind": "capability",
      "desc": "/dev/ device path pattern",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "E1083",
      "attack": "T1083",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/null",
          "location": "0xc7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/null",
          "location": "0xc8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/urandom",
          "location": "0x315"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/urandom",
          "location": "0x316"
        }
      ]
    },
    {
      "id": "cap/fs/path/device/dev-null",
      "kind": "capability",
      "desc": "/dev/null (legitimate discard device)",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/null",
          "location": "0xc7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/null",
          "location": "0xc8"
        }
      ]
    },
    {
      "id": "cap/fs/path/system/system-var",
      "kind": "capability",
      "desc": "Reference to /var",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/var/log",
          "location": "0x11f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/var/log",
          "location": "0x120"
        }
      ]
    },
    {
      "id": "cap/hw/random/device/urandom",
      "kind": "capability",
      "desc": "Access /dev/urandom",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/urandom",
          "location": "0x315"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/dev/urandom",
          "location": "0x316"
        }
      ]
    },
    {
      "id": "cap/os/admin/sysadmin/monitoring",
      "kind": "capability",
      "desc": "System monitoring utilities",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "lsblk -",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/sysadmin/config",
      "kind": "capability",
      "desc": "System configuration utilities",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:2207"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:2284"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:2397"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:2737"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:2793"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:3088"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "systemctl",
          "location": "offset:3409"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "service ",
          "location": "offset:3342"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "chkconfig",
          "location": "offset:2341"
        }
      ]
    },
    {
      "id": "cap/os/console/stderr-redirect",
      "kind": "capability",
      "desc": "Stderr redirect 2>&1",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x676"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x697"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/history/histsize-zero",
      "kind": "capability",
      "desc": "HISTSIZE=0 disables history",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0005",
      "attack": "T1070.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTSIZE=0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/history/histfilesize-zero",
      "kind": "capability",
      "desc": "HISTFILESIZE=0 disables history file",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0005",
      "attack": "T1070.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTFILESIZE=0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/log-clear/system/history-c",
      "kind": "capability",
      "desc": "history -c clear history command",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "F0005",
      "attack": "T1070.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "history -c",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/self-delete/file/rm-dollar-zero",
      "kind": "capability",
      "desc": "rm $0 self-deletion",
      "conf": 0.8,
      "crit": "suspicious",
      "mbc": "F0007",
      "attack": "T1070.004",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm $0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/creds/shell/history/bash-history",
      "kind": "capability",
      "desc": "Bash shell history file access",
      "conf": 0.8,
      "crit": "suspicious",
      "attack": "T1552.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": ".bash_history",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/fingerprint/lsblk-cmd",
      "kind": "capability",
      "desc": "lsblk command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1082",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "lsblk"
        }
      ]
    },
    {
      "id": "obj/discovery/fingerprint/id-u-cmd",
      "kind": "capability",
      "desc": "id -u command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1033",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "id -u",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/services/stop/systemctl-stop",
      "kind": "capability",
      "desc": "Systemd service stop",
      "conf": 0.8,
      "crit": "suspicious",
      "attack": "T1489",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl stop",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/root-wipe",
      "kind": "capability",
      "desc": "Root filesystem wipe attempt",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1561",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm -rf / ",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/rm-rf-cmd",
      "kind": "capability",
      "desc": "rm -rf command",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm -rf",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/etc-dir-ref",
      "kind": "capability",
      "desc": "/etc directory reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x372"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/boot-dir-ref",
      "kind": "capability",
      "desc": "/boot directory reference",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe8"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/usr-dir-ref",
      "kind": "capability",
      "desc": "/usr directory reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "obj/persist/cron/echo-command",
      "kind": "capability",
      "desc": "echo command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1053.003",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "echo"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/systemd-keyword",
      "kind": "capability",
      "desc": "systemd init system keyword",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/systemctl-command",
      "kind": "capability",
      "desc": "systemctl command (control systemd services)",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "systemctl"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/etc-systemd-path",
      "kind": "capability",
      "desc": "/etc/systemd directory path (system services)",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "B0028",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd",
          "location": "0x372"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/lib-systemd-path",
      "kind": "capability",
      "desc": "/lib/systemd directory path (default services)",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "B0028",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/service-extension",
      "kind": "capability",
      "desc": ".service file extension (systemd unit",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".service",
          "location": "0x855"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".service",
          "location": "0x85a"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/script/curl-output-dash-o",
      "kind": "capability",
      "desc": "Curl with -o flag",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": " -o ",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/script/curl-output-flag",
      "kind": "capability",
      "desc": "Curl with --output",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "--output",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/windows/redirect-null",
      "kind": "capability",
      "desc": "Redirect output to null (hide",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "F0005",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x676"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x697"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "2>&1"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/windows/output-flag",
      "kind": "capability",
      "desc": "Output flag -o",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "-o",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/systemctl-list",
      "kind": "capability",
      "desc": "systemctl list command",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl list",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/systemctl-is-active",
      "kind": "capability",
      "desc": "systemctl is-active command",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl is-active",
          "location": "file"
        }
      ]
    },
    {
      "id": "known/malware/backdoor/upstyle/systemctl-cmd",
      "kind": "capability",
      "desc": "systemctl command",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "systemctl"
        }
      ]
    },
    {
      "id": "known/malware/miner/kinsing-enhanced/systemctl-grep-malware",
      "kind": "capability",
      "desc": "Systemd service targeting",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1531",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl list-units",
          "location": "file"
        }
      ]
    },
    {
      "id": "known/malware/miner/kinsing-enhanced/systemd-stop-xmrig",
      "kind": "capability",
      "desc": "Systemd stop XMRig service",
      "conf": 0.8,
      "crit": "suspicious",
      "attack": "T1531",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl stop",
          "location": "file"
        }
      ]
    },
    {
      "id": "known/malware/miner/kinsing-enhanced/systemd-disable-malware",
      "kind": "capability",
      "desc": "Systemd disable malware services",
      "conf": 0.8,
      "crit": "suspicious",
      "attack": "T1531",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl disable",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/log-clear/history-clear",
      "kind": "capability",
      "desc": "Clears shell history",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "F0006",
      "attack": "T1070.003",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 history -c",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/self-delete/rm-self-dollar-zero",
      "kind": "capability",
      "desc": "Self-deletes using rm $0",
      "conf": 0.95,
      "crit": "suspicious",
      "mbc": "F0007",
      "attack": "T1070.004",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 rm $0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-static/obfuscation/code-metrics/low-identifier-reuse",
      "kind": "capability",
      "desc": "Low identifier reuse (each variable",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "identifiers.reuse_ratio = 0.00"
        }
      ]
    },
    {
      "id": "obj/anti-static/obfuscation/code-metrics/very-low-comment-ratio",
      "kind": "capability",
      "desc": "Very low comment-to-code ratio (<1%)",
      "conf": 0.65,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "comments.to_code_ratio = 0.00"
        }
      ]
    },
    {
      "id": "obj/discovery/system/os-check-linux",
      "kind": "capability",
      "desc": "Linux OS detection string",
      "conf": 0.6,
      "crit": "inert",
      "mbc": "B0012",
      "attack": "T1082",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Linux",
          "location": "0x75"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Linux",
          "location": "0x76"
        }
      ]
    },
    {
      "id": "obj/persist/autostart/chkconfig-cmd",
      "kind": "capability",
      "desc": "chkconfig command",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1037.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chkconfig"
        }
      ]
    },
    {
      "id": "obj/persist/implant/backdoor/bash-shell",
      "kind": "capability",
      "desc": "Bash shell",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "bash",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/persist/implant/backdoor/system-call",
      "kind": "capability",
      "desc": "System call",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "system",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "cap/comm/ssh/connect/connect",
      "kind": "capability",
      "desc": "SSH connection",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0x199"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0x19a"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/script/curl-output-file",
      "kind": "capability",
      "desc": "Curl downloading to file",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": " -o ",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "--output",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/system-lib-marker",
      "kind": "capability",
      "desc": "Known system library markers",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "cap/fs/file/read",
      "kind": "capability",
      "desc": "File read operations",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/systemctl-commands",
      "kind": "capability",
      "desc": "systemctl commands",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl list",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl is-active",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/console/output-suppression",
      "kind": "capability",
      "desc": "Output/error suppression",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x676"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1",
          "location": "0x697"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "2>&1"
        }
      ]
    },
    {
      "id": "known/malware/backdoor/upstyle/service-persistence",
      "kind": "capability",
      "desc": "Service-based persistence",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "systemctl"
        }
      ]
    },
    {
      "id": "known/malware/miner/kinsing-enhanced/systemd-service-targeting",
      "kind": "capability",
      "desc": "Systemd service stop/disable patterns",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl stop",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl disable",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/history/histfile-null",
      "kind": "capability",
      "desc": "Redirects shell history to /dev/null",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0005",
      "attack": "T1070.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTSIZE=0",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTFILESIZE=0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/log-clear/system/log-clear",
      "kind": "capability",
      "desc": "Clear system logs or history",
      "conf": 0.8,
      "crit": "suspicious",
      "mbc": "F0005",
      "attack": "T1070.001",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "history -c",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/self-delete/file/self-delete-shell",
      "kind": "capability",
      "desc": "Self-deleting shell script",
      "conf": 0.66,
      "crit": "suspicious",
      "mbc": "F0007",
      "attack": "T1070.004",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm $0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/creds/shell/history/history-theft",
      "kind": "capability",
      "desc": "Shell history file theft",
      "conf": 0.8,
      "crit": "suspicious",
      "mbc": "E1552",
      "attack": "T1552.003",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": ".bash_history",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/recursive-delete-cmd",
      "kind": "capability",
      "desc": "Recursive deletion command pattern",
      "conf": 0.8,
      "crit": "notable",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm -rf",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/system-dir-reference",
      "kind": "capability",
      "desc": "Reference to critical system directories",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c6"
        }
      ]
    },
    {
      "id": "obj/persist/autostart/linux-init-script",
      "kind": "capability",
      "desc": "init.d script persistence",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1037.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chkconfig"
        }
      ]
    },
    {
      "id": "obj/persist/systemd/service/systemd",
      "kind": "capability",
      "desc": "Linux systemd persistence (2+ indicators)",
      "conf": 0.66,
      "crit": "notable",
      "mbc": "B0028",
      "attack": "T1543.002",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "systemd",
          "location": "0x3c6"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "systemctl"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/systemd",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x39b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x39c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/systemd",
          "location": "0x3c6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".service",
          "location": "0x855"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": ".service",
          "location": "0x85a"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/systemd-management",
      "kind": "capability",
      "desc": "Legitimate systemd service management",
      "conf": 0.75,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl list",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "systemctl is-active",
          "location": "file"
        }
      ]
    },
    {
      "id": "known/malware/backdoor/upstyle/cron-or-service",
      "kind": "capability",
      "desc": "Cron or service persistence",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "systemctl"
        }
      ]
    },
    {
      "id": "obj/anti-forensics/history/history-clearing",
      "kind": "capability",
      "desc": "Shell history clearing techniques",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTSIZE=0",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "HISTFILESIZE=0",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/mass-deletion",
      "kind": "capability",
      "desc": "Mass system file deletion",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "rm -rf",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x371"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc",
          "location": "0x372"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/boot",
          "location": "0xe8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x3c6"
        }
      ]
    }
  ]
}