{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/hidden_ssh/client/run.sh",
  "depth": 0,
  "file_type": "shell",
  "sha256": "3859f3528cec93c72e6deb079a6fccc3d66ef0939c89c3eaaf111f415c41d133",
  "size": 906,
  "risk": "suspicious",
  "counts": {
    "suspicious": 2,
    "notable": 6
  },
  "findings": [
    {
      "id": "cap/comm/diagnostic/nc",
      "kind": "capability",
      "desc": "nc/netcat command",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x1d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x2d8"
        }
      ]
    },
    {
      "id": "cap/comm/socket/listen/listen-netcat",
      "kind": "capability",
      "desc": "Listen with netcat",
      "conf": 0.66,
      "crit": "suspicious",
      "mbc": "C0001",
      "attack": "T1071",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc -p",
          "location": "0x1d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc -p",
          "location": "0x2d8"
        }
      ]
    },
    {
      "id": "cap/comm/ssh/client/publickey-auth",
      "kind": "capability",
      "desc": "SSH publickey auth method",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "publickey",
          "location": "0x227"
        }
      ]
    },
    {
      "id": "cap/comm/ssh/connect/ssh-string",
      "kind": "capability",
      "desc": "ssh string",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "ssh"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "for",
          "location": "0x297"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "for",
          "location": "0x298"
        }
      ]
    },
    {
      "id": "cap/data/text/password",
      "kind": "capability",
      "desc": "password keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "password",
          "location": "0x24f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "password",
          "location": "0x297"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "password",
          "location": "0x298"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "password",
          "location": "0x31c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "password",
          "location": "0x343"
        }
      ]
    },
    {
      "id": "cap/data/text/connect",
      "kind": "capability",
      "desc": "connect keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "connect",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/interface/usage/usage-help",
      "kind": "capability",
      "desc": "Usage or help text in binary",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12c"
        }
      ]
    },
    {
      "id": "cap/os/admin/sysadmin/config",
      "kind": "capability",
      "desc": "System configuration utilities",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:348"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:638"
        }
      ]
    },
    {
      "id": "meta/quality/usage-title",
      "kind": "capability",
      "desc": "Usage: label (title case)",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12c"
        }
      ]
    },
    {
      "id": "obj/persist/cron/echo-command",
      "kind": "capability",
      "desc": "echo command",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1053.003",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "echo"
        }
      ]
    },
    {
      "id": "obj/persist/launchd/agent/shell-program",
      "kind": "capability",
      "desc": "Shell as launchd Program (/bin/sh)",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1059.004",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 /bin/bash",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/script/curl-output-dash-o",
      "kind": "capability",
      "desc": "Curl with -o flag",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": " -o ",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/windows/output-flag",
      "kind": "capability",
      "desc": "Output flag -o",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "-o",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/passwd-command",
      "kind": "capability",
      "desc": "passwd command",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x135"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27d"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27e"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/ssh-command",
      "kind": "capability",
      "desc": "ssh - command",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "ssh -",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/process/exit/exit-call",
      "kind": "capability",
      "desc": "Generic exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit"
        }
      ]
    },
    {
      "id": "meta/intent/backdoor",
      "kind": "capability",
      "desc": "Backdoor naming pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor_key",
          "location": "0xc0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor_key",
          "location": "0xc1"
        }
      ]
    },
    {
      "id": "obj/discovery/user/env-user",
      "kind": "capability",
      "desc": "USER environment variable",
      "conf": 0.5,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "USER",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/exploit/vulnerability/path-env-var",
      "kind": "capability",
      "desc": "PATH environment variable manipulation",
      "conf": 0.5,
      "crit": "notable",
      "attack": "T1068",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "PATH=",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/lateral/ssh/ssh-remote-execute",
      "kind": "capability",
      "desc": "SSH remote command execution",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "B0040",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 ssh -o 'ProxyCommand nc -p '$KEY_PORT' %h %p' -i $PRIVATE_KEY_PATH -p $PORT $USER@$SERVER -o '",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/persist/implant/backdoor/bash-shell",
      "kind": "capability",
      "desc": "Bash shell",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "bash",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/comm/diagnostic/troubleshoot",
      "kind": "capability",
      "desc": "Network troubleshooting utilities",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x1d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x2d8"
        }
      ]
    },
    {
      "id": "cap/comm/ssh/connect/connect",
      "kind": "capability",
      "desc": "SSH connection",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "ssh"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "for",
          "location": "0x297"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "for",
          "location": "0x298"
        }
      ]
    },
    {
      "id": "cap/exec/dropper/script/curl-output-file",
      "kind": "capability",
      "desc": "Curl downloading to file",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1105",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": " -o ",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/password-commands",
      "kind": "capability",
      "desc": "Password management commands",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x135"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27d"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27e"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/ssh-admin",
      "kind": "capability",
      "desc": "Legitimate SSH server administration",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "ssh -",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/admin/legitimate/user-management",
      "kind": "capability",
      "desc": "Legitimate user account management",
      "conf": 0.75,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x135"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27d"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27e"
        }
      ]
    }
  ]
}