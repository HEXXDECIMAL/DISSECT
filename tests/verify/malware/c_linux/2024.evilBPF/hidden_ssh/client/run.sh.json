{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/hidden_ssh/client/run.sh",
  "depth": 0,
  "file_type": "shell",
  "sha256": "3859f3528cec93c72e6deb079a6fccc3d66ef0939c89c3eaaf111f415c41d133",
  "size": 906,
  "risk": "suspicious",
  "counts": {
    "suspicious": 2,
    "notable": 5
  },
  "findings": [
    {
      "id": "obj/persist/cron/schedule::echo-command",
      "kind": "capability",
      "desc": "echo command",
      "conf": 0.5,
      "crit": "notable",
      "attack": "T1053.003",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "echo"
        }
      ],
      "source_file": "obj/persist/cron/schedule/manipulation.yaml"
    },
    {
      "id": "meta/quality/help::usage-title",
      "kind": "capability",
      "desc": "Usage: label (title case)",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage: $0 <user> <server_ip> <server_port> <key|passwd>",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage: ",
          "location": "0x12c"
        }
      ],
      "source_file": "meta/quality/help/traits.yaml"
    },
    {
      "id": "cap/os/admin/sysadmin::config",
      "kind": "capability",
      "desc": "System configuration utilities",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:348"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:638"
        }
      ],
      "source_file": "cap/os/admin/sysadmin/traits.yaml"
    },
    {
      "id": "cap/comm/ssh/connect::ssh-string",
      "kind": "capability",
      "desc": "ssh string",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "ssh"
        }
      ],
      "source_file": "cap/comm/ssh/connect/generic.yaml"
    },
    {
      "id": "cap/comm/socket/netcat::nc",
      "kind": "capability",
      "desc": "nc command invocation",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x1d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc ",
          "location": "0x2d8"
        }
      ],
      "source_file": "cap/comm/socket/netcat/traits.yaml"
    },
    {
      "id": "meta/lang/shebang::bash",
      "kind": "capability",
      "desc": "Bash shell shebang line",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #!/bin/bash",
          "location": "file"
        }
      ],
      "source_file": "meta/lang/shebang/traits.yaml"
    },
    {
      "id": "cap/interface/usage/api::usage-help",
      "kind": "capability",
      "desc": "Usage or help text in binary",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x12c"
        }
      ],
      "source_file": "cap/interface/usage/api/strings.yaml"
    },
    {
      "id": "cap/data/text/keywords::password",
      "kind": "capability",
      "desc": "password keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "PasswordAuthentication=no",
          "location": "0x24f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "You'll be asked for the password, which is: $PASSWD",
          "location": "0x297"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "You'll be asked for the password, which is: ",
          "location": "0x298"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "PreferredAuthentications=password",
          "location": "0x31c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "PasswordAuthentication=yes",
          "location": "0x343"
        }
      ],
      "source_file": "cap/data/text/keywords/generic.yaml"
    },
    {
      "id": "cap/comm/socket/listen::listen-netcat",
      "kind": "capability",
      "desc": "Listen with netcat",
      "conf": 0.66,
      "crit": "suspicious",
      "mbc": "C0001",
      "attack": "T1071",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc -p",
          "location": "0x1d1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "nc -p",
          "location": "0x2d8"
        }
      ],
      "source_file": "cap/comm/socket/listen/shell.yaml"
    },
    {
      "id": "cap/comm/ssh/client::publickey-auth",
      "kind": "capability",
      "desc": "SSH publickey auth method",
      "conf": 0.6,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "PreferredAuthentications=publickey",
          "location": "0x227"
        }
      ],
      "source_file": "cap/comm/ssh/client/traits.yaml"
    },
    {
      "id": "meta/intent::backdoor",
      "kind": "capability",
      "desc": "Backdoor naming pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor_key",
          "location": "0xc0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor_key",
          "location": "0xc1"
        }
      ],
      "source_file": "meta/intent/traits.yaml"
    },
    {
      "id": "obj/lateral/ssh/backdoor::ssh-remote-execute",
      "kind": "capability",
      "desc": "SSH remote command execution",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "B0040",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 ssh -o 'ProxyCommand nc -p '$KEY_PORT' %h %p' -i $PRIVATE_KEY_PATH -p $PORT $USER@$SERVER -o '",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/ssh/backdoor/shell.yaml"
    },
    {
      "id": "obj/persist/account/create::passwd-command",
      "kind": "capability",
      "desc": "passwd password change command",
      "conf": 0.5,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x12b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x135"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27d"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "passwd",
          "location": "0x27e"
        }
      ],
      "source_file": "obj/persist/account/create/traits.yaml"
    },
    {
      "id": "cap/process/exit/terminate::exit-call",
      "kind": "capability",
      "desc": "Generic exit call",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "exit"
        }
      ],
      "source_file": "cap/process/exit/terminate/traits.yaml"
    },
    {
      "id": "cap/exec/dropper/script::output-flag",
      "kind": "capability",
      "desc": "Output flag -o",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 6 -o",
          "location": "file"
        }
      ],
      "source_file": "cap/exec/dropper/script/batch.yaml"
    },
    {
      "id": "obj/lateral/brute-force/ssh::ssh-protocol",
      "kind": "capability",
      "desc": "SSH protocol indicators",
      "conf": 1.0,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "PreferredAuthentications=publickey",
          "location": "0x227"
        }
      ],
      "source_file": "obj/lateral/brute-force/ssh/traits.yaml"
    },
    {
      "id": "cap/comm/ssh/connect::connect",
      "kind": "capability",
      "desc": "SSH connection",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "ssh"
        }
      ],
      "source_file": "cap/comm/ssh/connect/generic.yaml"
    },
    {
      "id": "meta/internal/imported::exit",
      "kind": "structural",
      "desc": "calls exit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit"
        }
      ]
    },
    {
      "id": "meta/internal/imported::echo",
      "kind": "structural",
      "desc": "calls echo",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "echo"
        }
      ]
    },
    {
      "id": "meta/internal/imported::ssh",
      "kind": "structural",
      "desc": "calls ssh",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssh"
        }
      ]
    }
  ]
}