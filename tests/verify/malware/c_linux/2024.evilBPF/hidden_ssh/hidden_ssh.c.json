{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/hidden_ssh/hidden_ssh.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "ea4ccf74ada4a15f12229eac9c1035fd2a456e60a3c9fe30480d01a965e0953d",
  "size": 5099,
  "risk": "suspicious",
  "counts": {
    "suspicious": 4,
    "notable": 8
  },
  "findings": [
    {
      "id": "cap/comm/ssh/connect/ssh-string",
      "kind": "capability",
      "desc": "ssh string",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0xcd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0xce"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop-ast",
      "kind": "capability",
      "desc": "for loop (AST)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "52:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "70:5"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop-content",
      "kind": "capability",
      "desc": "for loop (content)",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2  for (",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/buffer",
      "kind": "capability",
      "desc": "buffer keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "buffer",
          "location": "0x3c1"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "buffer",
          "location": "0x3c2"
        }
      ]
    },
    {
      "id": "cap/fs/file/read-symbols",
      "kind": "capability",
      "desc": "File read symbols",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file-ops/binary-file-ops",
      "kind": "capability",
      "desc": "Binary file operations",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "open",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/path/config/config-etc",
      "kind": "capability",
      "desc": "Reference to /etc configuration files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x489"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x48a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "cap/os/admin/sysadmin/config",
      "kind": "capability",
      "desc": "System configuration utilities",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:310"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:1093"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:1167"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:1676"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:1941"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:1999"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2055"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2086"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2196"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2232"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2361"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2836"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2911"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:2993"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:3081"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4345"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4372"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4438"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4454"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4474"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4595"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4615"
        },
        {
          "method": "yara",
          "source": "yara-x",
          "value": "passwd",
          "location": "offset:4918"
        }
      ]
    },
    {
      "id": "obj/c2/backdoor/backdoor-ref",
      "kind": "capability",
      "desc": "Backdoor keyword reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1543",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x82"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x83"
        }
      ]
    },
    {
      "id": "obj/c2/backdoor/traits-backdoor-ref",
      "kind": "capability",
      "desc": "Backdoor terminology reference",
      "conf": 0.75,
      "crit": "suspicious",
      "attack": "T1059",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x82"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x83"
        }
      ]
    },
    {
      "id": "obj/creds/macos/validation/etc-shadow",
      "kind": "capability",
      "desc": "/etc/shadow file",
      "conf": 0.7,
      "crit": "inert",
      "attack": "T1003.008",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "obj/discovery/permissions/etc-shadow-core",
      "kind": "capability",
      "desc": "Shadow file access string",
      "conf": 0.85,
      "crit": "inert",
      "attack": "T1003.008",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "obj/discovery/user/etc-passwd",
      "kind": "capability",
      "desc": "Password file access",
      "conf": 0.8,
      "crit": "notable",
      "attack": "T1087.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x489"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x48a"
        }
      ]
    },
    {
      "id": "cap/fs/file/open/open",
      "kind": "capability",
      "desc": "Open files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "open",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "hidden_ssh_bpf__open",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/read/read",
      "kind": "capability",
      "desc": "Read files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read_file",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "read_file(char *path, char *buff, int buff_len)",
          "location": "0x219"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-skeleton-include",
      "kind": "capability",
      "desc": "BPF skeleton header include",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #include \"hidden_ssh.skel.h\"",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-update",
      "kind": "capability",
      "desc": "BPF map update helper",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 bpf_map_update_elem",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-delete",
      "kind": "capability",
      "desc": "BPF map delete helper",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 bpf_map_delete_elem",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-skeleton",
      "kind": "capability",
      "desc": "BPF skeleton pattern",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "hidden_ssh_bpf__open"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "hidden_ssh_bpf__destroy"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "hidden_ssh_bpf__load"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "hidden_ssh_bpf__attach"
        }
      ]
    },
    {
      "id": "cap/os/time/query/sleep",
      "kind": "capability",
      "desc": "Suspend execution for interval",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sleep",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/signal",
      "kind": "capability",
      "desc": "Install signal handler",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "F0004",
      "attack": "T1562.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "signal",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/exit",
      "kind": "capability",
      "desc": "Terminate process with status code",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "E1562",
      "attack": "T1562",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit",
          "location": "import"
        }
      ]
    },
    {
      "id": "meta/intent/backdoor",
      "kind": "capability",
      "desc": "Backdoor naming pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x82"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x83"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/malware-mention-comment",
      "kind": "capability",
      "desc": "Code explicitly mentions malware/backdoor",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "// apply the backdoor passwd",
          "location": "84:17"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "// Set backdoor settings",
          "location": "186:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "// backdoor auth",
          "location": "188:38"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "// backdoor passwd",
          "location": "189:38"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/sandbox/detect/sleep-accel",
      "kind": "capability",
      "desc": "Sleep acceleration detection (sandbox evasion)",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "B0007",
      "attack": "T1497.003",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sleep",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/comm/ssh/connect/connect",
      "kind": "capability",
      "desc": "SSH connection",
      "conf": 0.66,
      "crit": "notable",
      "attack": "T1021.004",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0xcd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssh",
          "location": "0xce"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "52:5"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "for",
          "location": "70:5"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2  for (",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/fs/file/read",
      "kind": "capability",
      "desc": "File read operations",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/permissions/etc-shadow",
      "kind": "capability",
      "desc": "Shadow file access",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1003.008",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x489"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x48a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf/sensitive-file-ref",
      "kind": "capability",
      "desc": "Sensitive system file references",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x489"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x48a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "obj/creds/dump/system/shadow-file",
      "kind": "capability",
      "desc": "Access to system shadow password",
      "conf": 0.9,
      "crit": "notable",
      "attack": "T1003.008",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x489"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/passwd",
          "location": "0x48a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cb"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/etc/shadow",
          "location": "0x5cc"
        }
      ]
    },
    {
      "id": "obj/c2/backdoor/backdoor",
      "kind": "capability",
      "desc": "References a backdoor",
      "conf": 0.66,
      "crit": "suspicious",
      "attack": "T1543",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x82"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "backdoor",
          "location": "0x83"
        },
        {
          "method": "exclusion",
          "source": "composite_rule",
          "value": "negative_conditions_not_found"
        }
      ]
    }
  ]
}