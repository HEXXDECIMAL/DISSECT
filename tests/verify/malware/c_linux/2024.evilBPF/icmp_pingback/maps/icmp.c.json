{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/icmp_pingback/maps/icmp.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "b0ece36bebc4aaf2efd39b4e498eb01f6dfba38bdf0e37db81a1cbb66dcd25f9",
  "size": 2442,
  "risk": "suspicious",
  "counts": {
    "suspicious": 1,
    "notable": 10
  },
  "findings": [
    {
      "id": "cap/comm/ip/services/icmp-upper",
      "kind": "capability",
      "desc": "ICMP uppercase",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d6"
        }
      ]
    },
    {
      "id": "cap/comm/ip/services/icmp-lower",
      "kind": "capability",
      "desc": "icmp lowercase",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        }
      ]
    },
    {
      "id": "cap/interface/usage/usage-help",
      "kind": "capability",
      "desc": "Usage or help text in binary",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x35a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x35b"
        }
      ]
    },
    {
      "id": "cap/os/bpf/libbpf",
      "kind": "capability",
      "desc": "libbpf library",
      "conf": 0.85,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libbpf",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf"
        }
      ]
    },
    {
      "id": "meta/quality/usage-title",
      "kind": "capability",
      "desc": "Usage: label (title case)",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x35a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x35b"
        }
      ]
    },
    {
      "id": "cap/comm/interface/enum/name-lookup",
      "kind": "capability",
      "desc": "Network interface name lookup",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "if_nametoindex",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/open/open",
      "kind": "capability",
      "desc": "Open files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "icmp_bpf__open_and_load",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-program",
      "kind": "capability",
      "desc": "bpf_program struct",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "bpf_program"
        }
      ]
    },
    {
      "id": "cap/os/bpf/xdp-attach",
      "kind": "capability",
      "desc": "XDP program attachment to interface",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/xdp-flags",
      "kind": "capability",
      "desc": "XDP attachment flags",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 XDP_FLAGS_UPDATE_IF_NOEXIST",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-skeleton-include",
      "kind": "capability",
      "desc": "BPF skeleton header include",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #include \"icmp.skel.h\"",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/icmp-prog-reply",
      "kind": "capability",
      "desc": "ICMP reply program reference",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 icmp_prog_reply",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-update",
      "kind": "capability",
      "desc": "BPF map update helper",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf_map_update_elem",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-kernel-types",
      "kind": "capability",
      "desc": "eBPF kernel type aliases",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 __u32",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-skeleton",
      "kind": "capability",
      "desc": "BPF skeleton pattern",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "icmp_bpf__destroy"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "icmp_bpf__open"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/signal",
      "kind": "capability",
      "desc": "Install signal handler",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "F0004",
      "attack": "T1562.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "signal",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/exit",
      "kind": "capability",
      "desc": "Terminate process with status code",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "E1562",
      "attack": "T1562",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/system/limits/setrlimit",
      "kind": "capability",
      "desc": "Set resource limits for process",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "F0004",
      "attack": "T1562.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "setrlimit",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/comm/ip/services/services-icmp",
      "kind": "capability",
      "desc": "ICMP communication",
      "conf": 0.66,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        }
      ]
    },
    {
      "id": "cap/os/bpf/tracing-frameworks",
      "kind": "capability",
      "desc": "eBPF tracing frameworks",
      "conf": 0.85,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libbpf",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf"
        }
      ]
    },
    {
      "id": "cap/os/bpf/icmp-indicators",
      "kind": "capability",
      "desc": "ICMP covert channel indicators",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 icmp_prog_reply",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/tracing",
      "kind": "capability",
      "desc": "Legitimate eBPF tracing/observability",
      "conf": 0.85,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libbpf",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf"
        }
      ]
    },
    {
      "id": "cap/os/bpf/xdp-icmp-loader",
      "kind": "capability",
      "desc": "XDP ICMP covert channel loader",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1095",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 icmp_prog_reply",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 #include \"icmp.skel.h\"",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ICMP",
          "location": "0x8d6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp",
          "location": "0xe5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp"
        }
      ]
    }
  ]
}