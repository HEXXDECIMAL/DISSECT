{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/icmp_pingback/minimum/icmp.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "59b65b7cb08253e42250153aa7be5679833ad5504a0da5b17096b4a8ddb0512b",
  "size": 2234,
  "risk": "hostile",
  "counts": {
    "hostile": 1,
    "suspicious": 3,
    "notable": 16
  },
  "findings": [
    {
      "id": "metadata/quality/help::usage-title",
      "kind": "capability",
      "desc": "Usage: label (title case)",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage: %s IFNAME\\n",
          "location": "0x2a0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage: %s IFNAME",
          "location": "0x2a1"
        }
      ],
      "source_file": "metadata/quality/help/traits.yaml"
    },
    {
      "id": "micro-behaviors/comm/ip/services::icmp-lower",
      "kind": "capability",
      "desc": "icmp lowercase",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x455"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x456"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        }
      ],
      "source_file": "micro-behaviors/comm/ip/services/generic.yaml"
    },
    {
      "id": "micro-behaviors/interface/usage/api::usage-help",
      "kind": "capability",
      "desc": "Usage or help text in binary",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x2a0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Usage:",
          "location": "0x2a1"
        }
      ],
      "source_file": "micro-behaviors/interface/usage/api/strings.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/trace-frameworks::libbpf",
      "kind": "capability",
      "desc": "libbpf library",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "<bpf/libbpf.h>",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf_get_error"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/trace-frameworks/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/network-infra::bpf-program",
      "kind": "capability",
      "desc": "bpf_program struct",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "bpf_program__set_type"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "bpf_program__fd"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/network-infra/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/network::xdp-flags",
      "kind": "capability",
      "desc": "XDP attachment flags",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 XDP_FLAGS_UPDATE_IF_NOEXIST",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/network/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/loader::bpf-program-find",
      "kind": "capability",
      "desc": "Find BPF program in object by name",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__find_program_by_name",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/loader/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/network::xdp-attach",
      "kind": "capability",
      "desc": "XDP program attachment to interface",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/network/traits.yaml"
    },
    {
      "id": "objectives/anti-analysis/sandbox/detect::sleep-accel",
      "kind": "capability",
      "desc": "Sleep acceleration detection (sandbox evasion)",
      "conf": 0.5,
      "crit": "notable",
      "mbc": "B0007",
      "attack": "T1497.003",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sleep",
          "location": "import"
        }
      ],
      "source_file": "objectives/anti-analysis/sandbox/detect/traits.yaml"
    },
    {
      "id": "micro-behaviors/comm/interface/enum::name-lookup",
      "kind": "capability",
      "desc": "Network interface name lookup",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "if_nametoindex",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/comm/interface/enum/unix.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/loader::ebpf-kernel-types",
      "kind": "capability",
      "desc": "eBPF kernel type aliases",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 __u32",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/loader/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/loader::bpf-object-load",
      "kind": "capability",
      "desc": "Load BPF object into kernel",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__load",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/loader/traits.yaml"
    },
    {
      "id": "objectives/discovery/system/limits::setrlimit",
      "kind": "capability",
      "desc": "Set resource limits for process",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "F0004",
      "attack": "T1562.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "setrlimit",
          "location": "import"
        }
      ],
      "source_file": "objectives/discovery/system/limits/traits.yaml"
    },
    {
      "id": "micro-behaviors/fs/file/open::open",
      "kind": "capability",
      "desc": "Open files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__open_file",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/fs/file/open/unix.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/loader::bpf-object-open",
      "kind": "capability",
      "desc": "Load BPF object from file",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__open_file",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/loader/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/time/query::sleep",
      "kind": "capability",
      "desc": "Suspend execution for interval",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sleep",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/os/time/query/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/loader::bpf-rlimit-memlock",
      "kind": "capability",
      "desc": "High RLIMIT_MEMLOCK for BPF",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 512UL << 20,\n\t\t.rlim_max = 512UL << 20,\n\t};\n\n\terr = setrlimit(RLIMIT_MEMLOCK",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/loader/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/icmp::icmp-prog-reply",
      "kind": "capability",
      "desc": "ICMP reply program reference",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 icmp_prog_reply",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/icmp/traits.yaml"
    },
    {
      "id": "micro-behaviors/process/terminate/signal::exit",
      "kind": "capability",
      "desc": "Terminate process with status code",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "E1562",
      "attack": "T1562",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/process/terminate/signal/traits.yaml"
    },
    {
      "id": "known/malware/rootkit::icmp-prog-reply",
      "kind": "capability",
      "desc": "evilBPF ICMP reply program name",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::tracing-frameworks",
      "kind": "capability",
      "desc": "eBPF tracing frameworks",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "<bpf/libbpf.h>",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf_get_error"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "micro-behaviors/comm/ip/services::services-icmp",
      "kind": "capability",
      "desc": "ICMP communication",
      "conf": 0.66,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x455"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x456"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        }
      ],
      "source_file": "micro-behaviors/comm/ip/services/generic.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/icmp::icmp-indicators",
      "kind": "capability",
      "desc": "ICMP covert channel indicators",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 icmp_prog_reply",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/icmp/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::bpf-packet-inspection",
      "kind": "capability",
      "desc": "BPF packet inspection components",
      "conf": 0.6,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "bpf_program__set_type"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "bpf_program__fd"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 XDP_FLAGS_UPDATE_IF_NOEXIST",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__find_program_by_name",
          "location": "import"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 __u32",
          "location": "file"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__load",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__open_file",
          "location": "import"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 512UL << 20,\n\t\t.rlim_max = 512UL << 20,\n\t};\n\n\terr = setrlimit(RLIMIT_MEMLOCK",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "known/malware/rootkit::icmp-loader",
      "kind": "capability",
      "desc": "evilBPF ICMP loader",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::tracing",
      "kind": "capability",
      "desc": "Legitimate eBPF tracing/observability",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "<bpf/libbpf.h>",
          "location": "0xb2"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "libbpf_get_error"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "known/malware/rootkit::evilbpf",
      "kind": "capability",
      "desc": "evilBPF eBPF rootkit framework",
      "conf": 1.0,
      "crit": "hostile",
      "mbc": "B0006",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "objectives/command-and-control/channels/covert::xdp-icmp-loader",
      "kind": "capability",
      "desc": "XDP ICMP covert channel loader",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1095",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of bpf_xdp_attach",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 icmp_prog_reply",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x455"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp.bpf.o",
          "location": "0x456"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x52f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "icmp_prog_reply",
          "location": "0x530"
        }
      ],
      "source_file": "objectives/command-and-control/channels/covert/xdp-icmp.yaml"
    },
    {
      "id": "metadata/internal/imported::bpf_xdp_attach",
      "kind": "structural",
      "desc": "calls bpf_xdp_attach",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_xdp_attach"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::signal",
      "kind": "structural",
      "desc": "calls signal",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "signal"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::exit",
      "kind": "structural",
      "desc": "calls exit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::if_nametoindex",
      "kind": "structural",
      "desc": "calls if_nametoindex",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "if_nametoindex"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_object__find_program_by_name",
      "kind": "structural",
      "desc": "calls bpf_object__find_program_by_name",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__find_program_by_name"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::setrlimit",
      "kind": "structural",
      "desc": "calls setrlimit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "setrlimit"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::libbpf_get_error",
      "kind": "structural",
      "desc": "calls libbpf_get_error",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "libbpf_get_error"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_object__open_file",
      "kind": "structural",
      "desc": "calls bpf_object__open_file",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__open_file"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_object__load",
      "kind": "structural",
      "desc": "calls bpf_object__load",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__load"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_object__close",
      "kind": "structural",
      "desc": "calls bpf_object__close",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_object__close"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_program__set_type",
      "kind": "structural",
      "desc": "calls bpf_program__set_type",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_program__set_type"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::sleep",
      "kind": "structural",
      "desc": "calls sleep",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "sleep"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::printf",
      "kind": "structural",
      "desc": "calls printf",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "printf"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_program__fd",
      "kind": "structural",
      "desc": "calls bpf_program__fd",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_program__fd"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::bpf_obj_get_info_by_fd",
      "kind": "structural",
      "desc": "calls bpf_obj_get_info_by_fd",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_obj_get_info_by_fd"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::fprintf",
      "kind": "structural",
      "desc": "calls fprintf",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fprintf"
        }
      ]
    }
  ]
}
