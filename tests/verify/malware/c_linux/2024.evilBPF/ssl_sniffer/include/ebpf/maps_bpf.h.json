{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/include/ebpf/maps_bpf.h",
  "depth": 0,
  "file_type": "c",
  "sha256": "38f9abace2516e5f538e855d995f9a9c0eb29000acfb4a582f185542633ade2d",
  "size": 964,
  "risk": "suspicious",
  "counts": {
    "suspicious": 3,
    "notable": 7
  },
  "findings": [
    {
      "id": "cap/os/bpf/vmlinux-h",
      "kind": "capability",
      "desc": "vmlinux.h CO-RE eBPF header",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-helpers-h",
      "kind": "capability",
      "desc": "bpf/bpf_helpers.h include",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-ringbuf",
      "kind": "capability",
      "desc": "BPF ring buffer map",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of BPF_MAP_TYPE_RINGBUF",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-hash",
      "kind": "capability",
      "desc": "BPF hash map",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of BPF_MAP_TYPE_HASH",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-ctx-map",
      "kind": "capability",
      "desc": "SSL context tracking map",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 fd_to_ssl",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-ctx-ref",
      "kind": "capability",
      "desc": "SSL context reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 SSL CTX",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-ctx-tracking",
      "kind": "capability",
      "desc": "SSL context tracking maps",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 fd_to_ssl",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 SSL CTX",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-data-buffer",
      "kind": "capability",
      "desc": "eBPF data buffer maps",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of BPF_MAP_TYPE_RINGBUF",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-core-header",
      "kind": "capability",
      "desc": "eBPF CO-RE development header",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-program-header",
      "kind": "capability",
      "desc": "eBPF program with license section",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-intercept-infra",
      "kind": "capability",
      "desc": "eBPF SSL interception infrastructure",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 occurrences of BPF_MAP_TYPE_RINGBUF",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 fd_to_ssl",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 SSL CTX",
          "location": "file"
        }
      ]
    }
  ]
}