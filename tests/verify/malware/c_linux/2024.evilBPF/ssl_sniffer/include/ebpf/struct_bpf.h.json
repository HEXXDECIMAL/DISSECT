{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/include/ebpf/struct_bpf.h",
  "depth": 0,
  "file_type": "c",
  "sha256": "3e35f02d20a8b6dfe36b623c4d754d59e37a0a6543779460421bf0e2bc72e982",
  "size": 582,
  "risk": "suspicious",
  "counts": {
    "suspicious": 2,
    "notable": 4
  },
  "findings": [
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-op-string",
      "kind": "capability",
      "desc": "SSL operation indicator",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-op-type",
      "kind": "capability",
      "desc": "SSL operation type definition",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 ssl_op_t",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-kernel-types",
      "kind": "capability",
      "desc": "eBPF kernel type aliases",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 __u32",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/data-event-struct",
      "kind": "capability",
      "desc": "eBPF data event structure",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 data_event",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/kernel-userspace-transfer",
      "kind": "capability",
      "desc": "Kernel to userspace data transfer",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 kernel to user space",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-sniffer-header",
      "kind": "capability",
      "desc": "eBPF SSL sniffer header pattern",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 data_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 ssl_op_t",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 kernel to user space",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-exfil-struct",
      "kind": "capability",
      "desc": "eBPF data exfiltration structures",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 __u32",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 data_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 kernel to user space",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 ssl_op_t",
          "location": "file"
        }
      ]
    }
  ]
}