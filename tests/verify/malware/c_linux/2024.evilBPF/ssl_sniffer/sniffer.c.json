{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/sniffer.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "985ec23dd058b3458877254d68cacc124a22503a6cb47fcd2da4bb6819d95454",
  "size": 1873,
  "risk": "suspicious",
  "counts": {
    "suspicious": 4,
    "notable": 12
  },
  "findings": [
    {
      "id": "micro-behaviors/execution/load/library::libssl-ref",
      "kind": "capability",
      "desc": "libssl library reference",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        }
      ],
      "source_file": "micro-behaviors/execution/load/library/traits.yaml"
    },
    {
      "id": "known/malware/rootkit::attach-macro",
      "kind": "capability",
      "desc": "evilBPF library attachment macro pattern",
      "conf": 1.0,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::ssl-listen-event",
      "kind": "capability",
      "desc": "SSL event listener",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_listen_event",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "objectives/discovery/host/software::global-search-library-fn",
      "kind": "capability",
      "desc": "Global library search function",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        }
      ],
      "source_file": "objectives/discovery/host/software/library-search.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::ssl-attach-macro",
      "kind": "capability",
      "desc": "SSL attach macro pattern",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "known/malware/rootkit::ssl-load",
      "kind": "capability",
      "desc": "evilBPF ssl_load function",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_load",
          "location": "import"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "known/malware/rootkit::ssl-listen-event",
      "kind": "capability",
      "desc": "evilBPF ssl_listen_event function",
      "conf": 1.0,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_listen_event",
          "location": "import"
        }
      ],
      "source_file": "known/malware/rootkit/evilbpf.yaml"
    },
    {
      "id": "micro-behaviors/execution/load/library::libssl-so",
      "kind": "capability",
      "desc": "libssl shared library reference",
      "conf": 0.7,
      "crit": "inert",
      "mbc": "E1083",
      "attack": "T1083",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        }
      ],
      "source_file": "micro-behaviors/execution/load/library/names.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::ssl-load-fn",
      "kind": "capability",
      "desc": "SSL loader function",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "micro-behaviors/execution/load/library::libgnutls-so",
      "kind": "capability",
      "desc": "libgnutls shared library reference",
      "conf": 0.7,
      "crit": "inert",
      "mbc": "E1083",
      "attack": "T1083",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ],
      "source_file": "micro-behaviors/execution/load/library/names.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::libnspr4-target",
      "kind": "capability",
      "desc": "NSS/NSPR library target",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libnspr4.so",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::ebpf-loader-include",
      "kind": "capability",
      "desc": "eBPF loader header include",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ebpf/loader",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "micro-behaviors/communications/socket/listen::listen-sym",
      "kind": "capability",
      "desc": "listen function symbol",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "C0001",
      "attack": "T1071",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_listen_event",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/communications/socket/listen/unix.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::lib-resolver-include",
      "kind": "capability",
      "desc": "Library resolver header include",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libresolver",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "micro-behaviors/process/terminate/signal::exit",
      "kind": "capability",
      "desc": "Terminate process with status code",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "E1562",
      "attack": "T1562",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit",
          "location": "import"
        }
      ],
      "source_file": "micro-behaviors/process/terminate/signal/traits.yaml"
    },
    {
      "id": "micro-behaviors/communications/http/server::listen-keyword",
      "kind": "capability",
      "desc": "listen() socket call",
      "conf": 0.5,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "listen",
          "location": "0x70c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "listen",
          "location": "0x70d"
        }
      ],
      "source_file": "micro-behaviors/communications/http/server/generic.yaml"
    },
    {
      "id": "objectives/discovery/host/software::ssl-lib-targets",
      "kind": "capability",
      "desc": "SSL/TLS library search targets",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ],
      "source_file": "objectives/discovery/host/software/library-search.yaml"
    },
    {
      "id": "micro-behaviors/execution/load/library::network-lib-marker",
      "kind": "capability",
      "desc": "Known network library markers",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        }
      ],
      "source_file": "micro-behaviors/execution/load/library/traits.yaml"
    },
    {
      "id": "objectives/discovery/host/software::lib-resolver-fn",
      "kind": "capability",
      "desc": "Library resolver function patterns",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        }
      ],
      "source_file": "objectives/discovery/host/software/library-search.yaml"
    },
    {
      "id": "micro-behaviors/os/bpf/program/ssl::ssl-sniffer-loader",
      "kind": "capability",
      "desc": "SSL sniffer loader API",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_listen_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        }
      ],
      "source_file": "micro-behaviors/os/bpf/program/ssl/traits.yaml"
    },
    {
      "id": "objectives/collection/network/ssl-intercept::ssl-sniffer-loader",
      "kind": "capability",
      "desc": "SSL sniffer loader program",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_listen_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ebpf/loader",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ],
      "source_file": "objectives/collection/network/ssl-intercept/traits.yaml"
    },
    {
      "id": "metadata/internal/imported::attach_sys_library",
      "kind": "structural",
      "desc": "calls ATTACH_SYS_LIBRARY",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ATTACH_SYS_LIBRARY"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::exit",
      "kind": "structural",
      "desc": "calls exit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::ssl_load",
      "kind": "structural",
      "desc": "calls ssl_load",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_load"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::ssl_listen_event",
      "kind": "structural",
      "desc": "calls ssl_listen_event",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_listen_event"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::fprintf",
      "kind": "structural",
      "desc": "calls fprintf",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fprintf"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::signal",
      "kind": "structural",
      "desc": "calls signal",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "signal"
        }
      ]
    },
    {
      "id": "metadata/internal/imported::ssl_exit",
      "kind": "structural",
      "desc": "calls ssl_exit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_exit"
        }
      ]
    }
  ]
}