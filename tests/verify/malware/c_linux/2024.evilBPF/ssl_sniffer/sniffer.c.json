{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/sniffer.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "985ec23dd058b3458877254d68cacc124a22503a6cb47fcd2da4bb6819d95454",
  "size": 1873,
  "risk": "hostile",
  "counts": {
    "hostile": 1,
    "suspicious": 3,
    "notable": 9
  },
  "findings": [
    {
      "id": "cap/data/control-flow/while-loop",
      "kind": "capability",
      "desc": "while loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/database/es-search-endpoint",
      "kind": "capability",
      "desc": "_search ES endpoint",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "_search",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/libssl-ref",
      "kind": "capability",
      "desc": "libssl library reference",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl",
          "location": "0x5e0"
        }
      ]
    },
    {
      "id": "cap/comm/http/server/listen-keyword",
      "kind": "capability",
      "desc": "listen() socket call",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "listen",
          "location": "0x70c"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "listen",
          "location": "0x70d"
        }
      ]
    },
    {
      "id": "cap/comm/socket/listen/listen-sym",
      "kind": "capability",
      "desc": "listen function symbol",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "C0001",
      "attack": "T1071",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ssl_listen_event",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-attach-macro",
      "kind": "capability",
      "desc": "SSL attach macro pattern",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/libnspr4-target",
      "kind": "capability",
      "desc": "NSS/NSPR library target",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libnspr4.so",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-loader-include",
      "kind": "capability",
      "desc": "eBPF loader header include",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ebpf/loader",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/lib-resolver-include",
      "kind": "capability",
      "desc": "Library resolver header include",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libresolver",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-listen-event",
      "kind": "capability",
      "desc": "SSL event listener",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_listen_event",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-load-fn",
      "kind": "capability",
      "desc": "SSL loader function",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/signal",
      "kind": "capability",
      "desc": "Install signal handler",
      "conf": 0.6,
      "crit": "notable",
      "mbc": "F0004",
      "attack": "T1562.001",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "signal",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/process/terminate/signal/exit",
      "kind": "capability",
      "desc": "Terminate process with status code",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "E1562",
      "attack": "T1562",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "exit",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/software/libssl-so",
      "kind": "capability",
      "desc": "libssl shared library reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        }
      ]
    },
    {
      "id": "obj/discovery/software/libgnutls-so",
      "kind": "capability",
      "desc": "libgnutls shared library reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ]
    },
    {
      "id": "obj/discovery/software/global-search-library-fn",
      "kind": "capability",
      "desc": "Global library search function",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/database/elasticsearch",
      "kind": "capability",
      "desc": "Elasticsearch connectivity",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "_search",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/network-lib-marker",
      "kind": "capability",
      "desc": "Known network library markers",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl",
          "location": "0x5e0"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-sniffer-loader",
      "kind": "capability",
      "desc": "SSL sniffer loader API",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_listen_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/ssl-lib-targets",
      "kind": "capability",
      "desc": "SSL/TLS library search targets",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lib-resolver-fn",
      "kind": "capability",
      "desc": "Library resolver function patterns",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ssl-sniffer-loader",
      "kind": "capability",
      "desc": "SSL sniffer loader program",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_listen_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ebpf/loader",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/multi-tls-intercept",
      "kind": "capability",
      "desc": "Multi-library TLS interception",
      "conf": 0.95,
      "crit": "hostile",
      "mbc": "C0001",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_listen_event",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 ssl_load(",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5df"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libssl.so",
          "location": "0x5e0"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x60f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "libgnutls.so",
          "location": "0x610"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ebpf/loader",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of ssl_attach_##",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libresolver",
          "location": "file"
        }
      ]
    }
  ]
}