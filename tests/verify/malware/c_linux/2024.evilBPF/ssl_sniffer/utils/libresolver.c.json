{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/utils/libresolver.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "ceaba5cf5817aab76b3c6e5b853836bea85650127aaeadf62c5cc91f1c3377bd",
  "size": 4818,
  "risk": "suspicious",
  "counts": {
    "suspicious": 1,
    "notable": 7
  },
  "findings": [
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/while-loop",
      "kind": "capability",
      "desc": "while loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/database/es-search-endpoint",
      "kind": "capability",
      "desc": "_search ES endpoint",
      "conf": 0.8,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "_search",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/libssl-ref",
      "kind": "capability",
      "desc": "libssl library reference",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "libssl",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/usr-dir-ref",
      "kind": "capability",
      "desc": "/usr directory reference",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xf7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x10a"
        }
      ]
    },
    {
      "id": "cap/fs/directory/readdir/readdir",
      "kind": "capability",
      "desc": "List directory contents",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "readdir",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "opendir",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "closedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/open/open",
      "kind": "capability",
      "desc": "Open files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "opendir",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/read/read",
      "kind": "capability",
      "desc": "Read files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "readdir",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/stat/stat-exists",
      "kind": "capability",
      "desc": "Check if file exists",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "access",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/read-write/operation/access",
      "kind": "capability",
      "desc": "Check file accessibility and permissions",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "E1083",
      "attack": "T1083",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "access",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/lib-resolver-include",
      "kind": "capability",
      "desc": "Library resolver header include",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of libresolver",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/syscall/d-name-field",
      "kind": "capability",
      "desc": "d_name field access",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 13 occurrences of d_name",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lib-path",
      "kind": "capability",
      "desc": "Reference to /lib/ directory",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc4"
        }
      ]
    },
    {
      "id": "obj/discovery/software/usr-lib-path",
      "kind": "capability",
      "desc": "Reference to /usr/lib directory",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf7"
        }
      ]
    },
    {
      "id": "obj/discovery/software/usr-local-lib-path",
      "kind": "capability",
      "desc": "Reference to /usr/local/lib",
      "conf": 0.4,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x10a"
        }
      ]
    },
    {
      "id": "obj/discovery/software/libssl-so",
      "kind": "capability",
      "desc": "libssl shared library reference",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "libssl.so",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/arch-x86-64",
      "kind": "capability",
      "desc": "x86_64 architecture string",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc2f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc30"
        }
      ]
    },
    {
      "id": "obj/discovery/software/arch-aarch64",
      "kind": "capability",
      "desc": "aarch64 architecture string",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd5"
        }
      ]
    },
    {
      "id": "obj/discovery/software/arch-i386",
      "kind": "capability",
      "desc": "i386 architecture string",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd48"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd49"
        }
      ]
    },
    {
      "id": "obj/discovery/software/arch-arm",
      "kind": "capability",
      "desc": "arm architecture string",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbe"
        }
      ]
    },
    {
      "id": "obj/discovery/software/global-search-library-fn",
      "kind": "capability",
      "desc": "Global library search function",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lookup-path-fn",
      "kind": "capability",
      "desc": "Path lookup function",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 lookup_path",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/database/elasticsearch",
      "kind": "capability",
      "desc": "Elasticsearch connectivity",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "_search",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/exec/load/network-lib-marker",
      "kind": "capability",
      "desc": "Known network library markers",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "libssl",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lib-path-enum",
      "kind": "capability",
      "desc": "Library path enumeration",
      "conf": 0.7,
      "crit": "notable",
      "mbc": "E1083",
      "attack": "T1518",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x10a"
        }
      ]
    },
    {
      "id": "obj/discovery/software/arch-detection",
      "kind": "capability",
      "desc": "Architecture detection strings",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc2f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc30"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd48"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd49"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbe"
        }
      ]
    },
    {
      "id": "obj/discovery/software/ssl-lib-targets",
      "kind": "capability",
      "desc": "SSL/TLS library search targets",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "libssl.so",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lib-resolver-fn",
      "kind": "capability",
      "desc": "Library resolver function patterns",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 lookup_path",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/impact/system/directory/system-dir-reference",
      "kind": "capability",
      "desc": "Reference to critical system directories",
      "conf": 0.4,
      "crit": "inert",
      "attack": "T1485",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0xf7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr",
          "location": "0x10a"
        }
      ]
    },
    {
      "id": "obj/discovery/software/lib-search-infra",
      "kind": "capability",
      "desc": "Library search infrastructure",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "E1083",
      "attack": "T1518",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x10a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc2f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "x86_64",
          "location": "0xc30"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "aarch64",
          "location": "0xdd5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd48"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "i386",
          "location": "0xd49"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbd"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "arm",
          "location": "0xcbe"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 global_search_library",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 lookup_path",
          "location": "file"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "readdir",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "opendir",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "closedir",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/discovery/software/ssl-lib-discovery",
      "kind": "capability",
      "desc": "SSL library discovery",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "E1083",
      "attack": "T1557",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib/",
          "location": "0xa8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib64/",
          "location": "0xb5"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/lib32/",
          "location": "0xc4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd2"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib/",
          "location": "0xd3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe3"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib64/",
          "location": "0xe4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf6"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/lib32/",
          "location": "0xf7"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x109"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "/usr/local/lib/",
          "location": "0x10a"
        },
        {
          "method": "string",
          "source": "raw_content",
          "value": "libssl.so",
          "location": "file"
        }
      ]
    }
  ]
}