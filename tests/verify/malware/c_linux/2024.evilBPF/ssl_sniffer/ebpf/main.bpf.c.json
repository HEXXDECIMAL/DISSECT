{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.evilBPF/ssl_sniffer/ebpf/main.bpf.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "998ce5e55ce7c64482d6abefe879c8056eb5f159f48f7525406e644db3811cb3",
  "size": 3157,
  "risk": "suspicious",
  "counts": {
    "suspicious": 3,
    "notable": 20
  },
  "findings": [
    {
      "id": "cap/comm/http/request/http-version",
      "kind": "capability",
      "desc": "HTTP/1.x version string",
      "conf": 0.5,
      "crit": "inert",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HTTP/1.",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/for-loop",
      "kind": "capability",
      "desc": "for loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/address",
      "kind": "capability",
      "desc": "address keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "address",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/buffer",
      "kind": "capability",
      "desc": "buffer keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "buffer",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/quality/gpl-word",
      "kind": "capability",
      "desc": "GPL license reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0xc4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0xc50"
        }
      ]
    },
    {
      "id": "cap/fs/file/read/read",
      "kind": "capability",
      "desc": "Read files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_core_read",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_core_read_user",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "probe_ssl_read_return(struct pt_regs *ctx)",
          "location": "0xb5c"
        }
      ]
    },
    {
      "id": "cap/fs/file/write/write",
      "kind": "capability",
      "desc": "Write files",
      "conf": 0.66,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "handle_rw_exit(struct pt_regs *ctx, int is_write)",
          "location": "0x45b"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "probe_ssl_write_return(struct pt_regs *ctx)",
          "location": "0xbd4"
        }
      ]
    },
    {
      "id": "cap/os/bpf/vmlinux-h",
      "kind": "capability",
      "desc": "vmlinux.h CO-RE eBPF header",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-helpers-h",
      "kind": "capability",
      "desc": "bpf/bpf_helpers.h include",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/sec-license",
      "kind": "capability",
      "desc": "eBPF license section declaration",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 SEC(\"license",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-lookup",
      "kind": "capability",
      "desc": "BPF map lookup helper",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf_map_lookup_elem",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-update",
      "kind": "capability",
      "desc": "BPF map update helper",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf_map_update_elem",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-core-read-user",
      "kind": "capability",
      "desc": "eBPF read from user memory",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_core_read_user",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/uprobe-sec",
      "kind": "capability",
      "desc": "eBPF uprobe SEC declaration",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa19"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa1a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbba"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-hook-target",
      "kind": "capability",
      "desc": "SSL function as hook target",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbba"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-op-string",
      "kind": "capability",
      "desc": "SSL operation indicator",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/data-event-struct",
      "kind": "capability",
      "desc": "eBPF data event structure",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 data_event",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-ringbuf",
      "kind": "capability",
      "desc": "eBPF ringbuf helpers",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_submit",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_reserve",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/bpf-map-hash",
      "kind": "capability",
      "desc": "BPF hash map",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of BPF_MAP_TYPE_HASH",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/time/clock/get",
      "kind": "capability",
      "desc": "Get system time",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ktime_get_ns",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/time/query/time",
      "kind": "capability",
      "desc": "Get current calendar time (seconds",
      "conf": 0.3,
      "crit": "inert",
      "mbc": "T1124",
      "attack": "T1124",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ktime_get_ns",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf/sec-uprobe",
      "kind": "capability",
      "desc": "SEC(\"uprobe/\") section marker",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "SEC(\"uprobe/",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/comm/http/request/request",
      "kind": "capability",
      "desc": "Makes HTTP requests",
      "conf": 0.66,
      "crit": "notable",
      "mbc": "C0002",
      "attack": "T1071.001",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HTTP/1.",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "for",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-data-buffer",
      "kind": "capability",
      "desc": "eBPF data buffer maps",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_submit",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_reserve",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ssl-sniffer-header",
      "kind": "capability",
      "desc": "eBPF SSL sniffer header pattern",
      "conf": 0.85,
      "crit": "suspicious",
      "attack": "T1557",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 data_event",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-core-header",
      "kind": "capability",
      "desc": "eBPF CO-RE development header",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/bpf/ebpf-program-header",
      "kind": "capability",
      "desc": "eBPF program with license section",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "vmlinux.h",
          "location": "0x31"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of bpf/bpf_helpers.h",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 SEC(\"license",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/quality/licensed",
      "kind": "capability",
      "desc": "Contains license information",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0xc4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0xc50"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf/ebpf-indicator",
      "kind": "capability",
      "desc": "eBPF-related markers",
      "conf": 0.6,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "SEC(\"uprobe/",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/c2/ddos/http-methods",
      "kind": "capability",
      "desc": "HTTP request methods detected",
      "conf": 1.0,
      "crit": "inert",
      "mbc": "B0009",
      "attack": "T1498",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "HTTP/1.",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ssl-fn-targets",
      "kind": "capability",
      "desc": "SSL/TLS functions as targets",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbba"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ebpf-uprobe-hook",
      "kind": "capability",
      "desc": "eBPF uprobe hooking",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa19"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa1a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbba"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ebpf-data-exfil",
      "kind": "capability",
      "desc": "eBPF data exfiltration",
      "conf": 0.75,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_submit",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_reserve",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_core_read_user",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ebpf-ssl-intercept",
      "kind": "capability",
      "desc": "eBPF-based SSL/TLS interception",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "C0001",
      "attack": "T1557",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0x99b"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa19"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xa1a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "uprobe/",
          "location": "0xbba"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbba"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_submit",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_ringbuf_reserve",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "ast",
          "value": "bpf_core_read_user",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/collect/network/ssl-intercept/ssl-hook-pattern",
      "kind": "capability",
      "desc": "SSL/TLS function hook pattern",
      "conf": 0.85,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb42"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_read",
          "location": "0xb43"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbb9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "ssl_write",
          "location": "0xbba"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 2 SSL_OP_WRITE",
          "location": "file"
        }
      ]
    }
  ]
}