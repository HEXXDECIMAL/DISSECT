{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.HiddenGhost/main.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "fad6740bae51b44c1419864273858c80d330d53dc055671e364b87e21eecc985",
  "size": 2733,
  "risk": "suspicious",
  "counts": {
    "suspicious": 13,
    "notable": 6
  },
  "findings": [
    {
      "id": "cap/data/control-flow/while-loop",
      "kind": "capability",
      "desc": "while loop pattern",
      "conf": 0.3,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/data/text/offset",
      "kind": "capability",
      "desc": "offset keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "offset",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/quality/semver-pattern",
      "kind": "capability",
      "desc": "Semantic version pattern",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0",
          "location": "0x15f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0",
          "location": "0x160"
        }
      ]
    },
    {
      "id": "meta/quality/gpl-word",
      "kind": "capability",
      "desc": "GPL license reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x148"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x149"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf/rootkit-string",
      "kind": "capability",
      "desc": "Rootkit string reference",
      "conf": 0.8,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x95f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x969"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x96a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa45"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa50"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/kallsyms-lookup-fn",
      "kind": "capability",
      "desc": "kallsyms_lookup kernel function",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "F0015",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/userspace/rootkit-string",
      "kind": "capability",
      "desc": "Rootkit string reference",
      "conf": 0.7,
      "crit": "suspicious",
      "mbc": "B0003",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x95f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x969"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x96a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa45"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa50"
        }
      ]
    },
    {
      "id": "cap/comm/ip/parse/parse-string",
      "kind": "capability",
      "desc": "IP address string patterns",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0.3",
          "location": "0x15f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0.3",
          "location": "0x160"
        }
      ]
    },
    {
      "id": "cap/fs/directory/readdir/readdir",
      "kind": "capability",
      "desc": "List directory contents",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orig_getdents64",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "hook_getdents64(unsigned int fd, struct linux_dirent64 *dirp, unsigned int count)",
          "location": "0x472"
        }
      ]
    },
    {
      "id": "cap/fs/file/read/read",
      "kind": "capability",
      "desc": "Read files",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read_cr0",
          "location": "import"
        }
      ]
    },
    {
      "id": "cap/fs/file/write/write",
      "kind": "capability",
      "desc": "Write files",
      "conf": 0.66,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ]
    },
    {
      "id": "cap/os/syscall/dirent64-struct",
      "kind": "capability",
      "desc": "struct dirent64 usage",
      "conf": 0.8,
      "crit": "notable",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of dirent64",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/syscall/d-reclen-field",
      "kind": "capability",
      "desc": "d_reclen field access",
      "conf": 0.85,
      "crit": "notable",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of d_reclen",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/syscall/d-name-field",
      "kind": "capability",
      "desc": "d_name field access",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of d_name",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf/d-reclen",
      "kind": "capability",
      "desc": "d_reclen dirent field",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "d_reclen",
          "location": "file"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/write-cr0",
      "kind": "capability",
      "desc": "write_cr0 function",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0015",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/orig-getdents",
      "kind": "capability",
      "desc": "orig_getdents function",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "orig_getdents"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/kprobes-include-str",
      "kind": "capability",
      "desc": "linux/kprobes.h include (kernel hooking)",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/kprobes.h",
          "location": "0xbc"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/dirent-include-str",
      "kind": "capability",
      "desc": "linux/dirent.h include (file hiding)",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/dirent.h",
          "location": "0x86"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/kallsyms-lookup-name-str",
      "kind": "capability",
      "desc": "kallsyms_lookup_name string (symbol resolution)",
      "conf": 0.98,
      "crit": "suspicious",
      "mbc": "F0004",
      "attack": "T1014",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/cr0-variable-str",
      "kind": "capability",
      "desc": "cr0 register variable",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b9"
        }
      ]
    },
    {
      "id": "cap/data/control-flow/iteration-loop-pattern",
      "kind": "capability",
      "desc": "Iteration or loop pattern",
      "conf": 0.5,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "raw_content",
          "value": "while",
          "location": "file"
        }
      ]
    },
    {
      "id": "cap/os/syscall/dirent-manipulation",
      "kind": "capability",
      "desc": "Dirent structure manipulation",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of dirent64",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of d_reclen",
          "location": "file"
        }
      ]
    },
    {
      "id": "meta/quality/versioned",
      "kind": "capability",
      "desc": "Contains version information",
      "conf": 0.85,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0",
          "location": "0x15f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0",
          "location": "0x160"
        }
      ]
    },
    {
      "id": "meta/quality/licensed",
      "kind": "capability",
      "desc": "Contains license information",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x148"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x149"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/kallsyms-lookup",
      "kind": "capability",
      "desc": "Accesses /proc/kallsyms for kernel symbol",
      "conf": 0.85,
      "crit": "suspicious",
      "mbc": "F0015",
      "attack": "T1014",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name",
          "location": "import"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/cr0-manipulation",
      "kind": "capability",
      "desc": "CR0 write protection bypass",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/kprobes-kallsyms",
      "kind": "capability",
      "desc": "Kprobes with kallsyms (kernel 5.7+ symbol bypass)",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/kprobes.h",
          "location": "0xbc"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/cr0-bypass",
      "kind": "capability",
      "desc": "CR0 write protection bypass",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b9"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/syscall-hook",
      "kind": "capability",
      "desc": "Syscall table manipulation patterns",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0015",
      "attack": "T1014",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ]
    },
    {
      "id": "obj/anti-analysis/kernel-hide/kernel/lkm-rootkit-behavior",
      "kind": "capability",
      "desc": "LKM rootkit behavior indicators",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ]
    }
  ]
}