{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/malware/c_linux/2024.HiddenGhost/main.c",
  "depth": 0,
  "file_type": "c",
  "sha256": "fad6740bae51b44c1419864273858c80d330d53dc055671e364b87e21eecc985",
  "size": 2733,
  "risk": "suspicious",
  "counts": {
    "suspicious": 12,
    "notable": 9
  },
  "findings": [
    {
      "id": "obj/anti-analysis/kernel-hide/module::kallsyms-lookup-fn",
      "kind": "capability",
      "desc": "kallsyms_lookup kernel function",
      "conf": 0.8,
      "crit": "notable",
      "mbc": "F0015",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name",
          "location": "import"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/userspace::rootkit-string",
      "kind": "capability",
      "desc": "Rootkit string reference",
      "conf": 0.7,
      "crit": "suspicious",
      "mbc": "B0003",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x95f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x969"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x96a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa45"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa50"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/userspace/linux.yaml"
    },
    {
      "id": "meta/quality/license::gpl-word",
      "kind": "capability",
      "desc": "GPL license reference",
      "conf": 0.7,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x148"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x149"
        }
      ],
      "source_file": "meta/quality/license/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/ebpf::rootkit-string",
      "kind": "capability",
      "desc": "Rootkit string reference",
      "conf": 0.8,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x95f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x969"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0x96a"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa45"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa4f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "Rootkit",
          "location": "0xa50"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/ebpf/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/headers::kprobes-include-str",
      "kind": "capability",
      "desc": "linux/kprobes.h include (kernel hooking)",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/kprobes.h",
          "location": "0xbc"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/headers/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::write-cr0",
      "kind": "capability",
      "desc": "write_cr0 function",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0015",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "cap/comm/ip/parse::parse-string",
      "kind": "capability",
      "desc": "IP address string patterns",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0.3",
          "location": "0x15f"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "0.0.0.3",
          "location": "0x160"
        }
      ],
      "source_file": "cap/comm/ip/parse/unix.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/headers::cr0-variable-str",
      "kind": "capability",
      "desc": "cr0 register variable",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b9"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/headers/traits.yaml"
    },
    {
      "id": "cap/fs/directory/readdir::readdir",
      "kind": "capability",
      "desc": "List directory contents",
      "conf": 0.66,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orig_getdents64",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "hook_getdents64(unsigned int fd, struct linux_dirent64 *dirp, unsigned int count)",
          "location": "0x472"
        }
      ],
      "source_file": "cap/fs/directory/readdir/unix.yaml"
    },
    {
      "id": "cap/os/syscall/invoke::dirent64-struct",
      "kind": "capability",
      "desc": "struct dirent64 usage",
      "conf": 0.8,
      "crit": "notable",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of dirent64",
          "location": "file"
        }
      ],
      "source_file": "cap/os/syscall/invoke/direct.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/headers::dirent-include-str",
      "kind": "capability",
      "desc": "linux/dirent.h include (file hiding)",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/dirent.h",
          "location": "0x86"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/headers/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm/headers::kallsyms-lookup-name-str",
      "kind": "capability",
      "desc": "kallsyms_lookup_name string (symbol resolution)",
      "conf": 0.98,
      "crit": "suspicious",
      "mbc": "F0004",
      "attack": "T1014",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/headers/traits.yaml"
    },
    {
      "id": "cap/os/syscall/invoke::d-reclen-field",
      "kind": "capability",
      "desc": "d_reclen field access",
      "conf": 0.85,
      "crit": "notable",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of d_reclen",
          "location": "file"
        }
      ],
      "source_file": "cap/os/syscall/invoke/direct.yaml"
    },
    {
      "id": "cap/fs/file/write::write",
      "kind": "capability",
      "desc": "Write files",
      "conf": 0.66,
      "crit": "notable",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ],
      "source_file": "cap/fs/file/write/unix.yaml"
    },
    {
      "id": "cap/os/syscall/invoke::d-name-field",
      "kind": "capability",
      "desc": "d_name field access",
      "conf": 0.5,
      "crit": "inert",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 occurrences of d_name",
          "location": "file"
        }
      ],
      "source_file": "cap/os/syscall/invoke/direct.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::orig-getdents",
      "kind": "capability",
      "desc": "orig_getdents function",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "orig_getdents64"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm::syscall-hook-setup",
      "kind": "capability",
      "desc": "Syscall hooking setup (table+dirent)",
      "conf": 0.7,
      "crit": "notable",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/kprobes.h",
          "location": "0xbc"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b9"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/dirent.h",
          "location": "0x86"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm::kprobes-kallsyms",
      "kind": "capability",
      "desc": "Kprobes with kallsyms (kernel 5.7+ symbol bypass)",
      "conf": 0.95,
      "crit": "suspicious",
      "attack": "T1014",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "linux/kprobes.h",
          "location": "0xbc"
        },
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/lkm::cr0-bypass",
      "kind": "capability",
      "desc": "CR0 write protection bypass",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b8"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "cr0",
          "location": "0x1b9"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/lkm/traits.yaml"
    },
    {
      "id": "meta/quality::licensed",
      "kind": "capability",
      "desc": "Contains license information",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x148"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "GPL",
          "location": "0x149"
        }
      ],
      "source_file": "meta/quality/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::kallsyms-lookup-method",
      "kind": "capability",
      "desc": "Accesses /proc/kallsyms for kernel symbol",
      "conf": 0.85,
      "crit": "notable",
      "mbc": "F0015",
      "attack": "T1014",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name",
          "location": "import"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::cr0-manipulation",
      "kind": "capability",
      "desc": "CR0 write protection bypass",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "cap/os/syscall/invoke::dirent-manipulation",
      "kind": "capability",
      "desc": "Dirent structure manipulation",
      "conf": 0.9,
      "crit": "suspicious",
      "attack": "T1106",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of dirent64",
          "location": "file"
        },
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 4 occurrences of d_reclen",
          "location": "file"
        }
      ],
      "source_file": "cap/os/syscall/invoke/direct.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::syscall-hook",
      "kind": "capability",
      "desc": "Syscall table manipulation patterns",
      "conf": 0.9,
      "crit": "suspicious",
      "mbc": "F0015",
      "attack": "T1014",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "obj/anti-analysis/kernel-hide/module::lkm-rootkit-behavior",
      "kind": "capability",
      "desc": "LKM rootkit behavior indicators",
      "conf": 0.9,
      "crit": "suspicious",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced",
          "location": "import"
        },
        {
          "method": "symbol",
          "source": "tree-sitter-c",
          "value": "write_cr0_forced(unsigned long value)",
          "location": "0x16c"
        }
      ],
      "source_file": "obj/anti-analysis/kernel-hide/module/traits.yaml"
    },
    {
      "id": "meta/internal/imported::kzalloc",
      "kind": "structural",
      "desc": "calls kzalloc",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kzalloc"
        }
      ]
    },
    {
      "id": "meta/internal/imported::find_syscall_table",
      "kind": "structural",
      "desc": "calls find_syscall_table",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "find_syscall_table"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module_license",
      "kind": "structural",
      "desc": "calls MODULE_LICENSE",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "MODULE_LICENSE"
        }
      ]
    },
    {
      "id": "meta/internal/imported::unregister_kprobe",
      "kind": "structural",
      "desc": "calls unregister_kprobe",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "unregister_kprobe"
        }
      ]
    },
    {
      "id": "meta/internal/imported::copy_to_user",
      "kind": "structural",
      "desc": "calls copy_to_user",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "copy_to_user"
        }
      ]
    },
    {
      "id": "meta/internal/imported::copy_from_user",
      "kind": "structural",
      "desc": "calls copy_from_user",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "copy_from_user"
        }
      ]
    },
    {
      "id": "meta/internal/imported::write_cr0_forced",
      "kind": "structural",
      "desc": "calls write_cr0_forced",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "write_cr0_forced"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module_init",
      "kind": "structural",
      "desc": "calls module_init",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "module_init"
        }
      ]
    },
    {
      "id": "meta/internal/imported::orig_getdents64",
      "kind": "structural",
      "desc": "calls orig_getdents64",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "orig_getdents64"
        }
      ]
    },
    {
      "id": "meta/internal/imported::read_cr0",
      "kind": "structural",
      "desc": "calls read_cr0",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "read_cr0"
        }
      ]
    },
    {
      "id": "meta/internal/imported::unprotect_memory",
      "kind": "structural",
      "desc": "calls unprotect_memory",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "unprotect_memory"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module_version",
      "kind": "structural",
      "desc": "calls MODULE_VERSION",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "MODULE_VERSION"
        }
      ]
    },
    {
      "id": "meta/internal/imported::register_kprobe",
      "kind": "structural",
      "desc": "calls register_kprobe",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "register_kprobe"
        }
      ]
    },
    {
      "id": "meta/internal/imported::kfree",
      "kind": "structural",
      "desc": "calls kfree",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kfree"
        }
      ]
    },
    {
      "id": "meta/internal/imported::memmove",
      "kind": "structural",
      "desc": "calls memmove",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "memmove"
        }
      ]
    },
    {
      "id": "meta/internal/imported::strcmp",
      "kind": "structural",
      "desc": "calls strcmp",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "strcmp"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module_exit",
      "kind": "structural",
      "desc": "calls module_exit",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "module_exit"
        }
      ]
    },
    {
      "id": "meta/internal/imported::protect_memory",
      "kind": "structural",
      "desc": "calls protect_memory",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "protect_memory"
        }
      ]
    },
    {
      "id": "meta/internal/imported::printk",
      "kind": "structural",
      "desc": "calls printk",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "printk"
        }
      ]
    },
    {
      "id": "meta/internal/imported::module_author",
      "kind": "structural",
      "desc": "calls MODULE_AUTHOR",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "MODULE_AUTHOR"
        }
      ]
    },
    {
      "id": "meta/internal/imported::kallsyms_lookup_name",
      "kind": "structural",
      "desc": "calls kallsyms_lookup_name",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "kallsyms_lookup_name"
        }
      ]
    }
  ]
}