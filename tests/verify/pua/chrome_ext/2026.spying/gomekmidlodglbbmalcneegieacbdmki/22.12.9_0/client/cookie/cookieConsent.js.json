{
  "type": "file",
  "id": 0,
  "path": "/Users/t/data/dissect/pua/chrome_ext/2026.spying/gomekmidlodglbbmalcneegieacbdmki/22.12.9_0/client/cookie/cookieConsent.js",
  "depth": 0,
  "file_type": "javascript",
  "sha256": "09518e02d7b5400bc801c76001f9da1014ace555607c00b6be78eec9b30ec0e4",
  "size": 2075,
  "risk": "notable",
  "counts": {
    "notable": 10
  },
  "findings": [
    {
      "id": "cap/data/text/keywords::runtime",
      "kind": "capability",
      "desc": "runtime keyword",
      "conf": 0.2,
      "crit": "inert",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chrome.runtime.sendMessage"
        }
      ],
      "source_file": "cap/data/text/keywords/generic.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/npm/malicious-patterns::auto-execute",
      "kind": "capability",
      "desc": "Code auto-executes on require/import",
      "conf": 0.8,
      "crit": "notable",
      "evidence": [
        {
          "method": "yara",
          "source": "yara-x",
          "value": "(()",
          "location": "offset:0"
        }
      ],
      "source_file": "obj/lateral/supply-chain/npm/malicious-patterns/behavioral.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::chrome-namespace",
      "kind": "capability",
      "desc": "Uses chrome.* namespace",
      "conf": 0.95,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chrome.runtime"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/api.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::chrome-runtime",
      "kind": "capability",
      "desc": "chrome.runtime API usage",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chrome.runtime.sendMessage"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/npm/web-frameworks::has-di-pattern",
      "kind": "capability",
      "desc": "Code uses dependency injection",
      "conf": 0.85,
      "crit": "notable",
      "evidence": [
        {
          "method": "string",
          "source": "string_extractor",
          "value": "inject",
          "location": "0x7c4"
        },
        {
          "method": "string",
          "source": "string_extractor",
          "value": "inject",
          "location": "0x7c5"
        }
      ],
      "source_file": "obj/lateral/supply-chain/npm/web-frameworks/traits.yaml"
    },
    {
      "id": "cap/data/exploitation/memory::js-proto-pollution-guard",
      "kind": "capability",
      "desc": "Prototype pollution guard check present",
      "conf": 0.9,
      "crit": "inert",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 3 constructor",
          "location": "file"
        }
      ],
      "source_file": "cap/data/exploitation/memory/generic.yaml"
    },
    {
      "id": "obj/anti-static/obfuscation/code-metrics/functions::many-anonymous-functions",
      "kind": "capability",
      "desc": "Many anonymous functions",
      "conf": 0.75,
      "crit": "notable",
      "mbc": "B0032",
      "attack": "T1027",
      "evidence": [
        {
          "method": "metrics",
          "source": "analyzer",
          "value": "functions.anonymous = 6.00"
        }
      ],
      "source_file": "obj/anti-static/obfuscation/code-metrics/functions/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/npm/behavior::small-file-5k",
      "kind": "capability",
      "desc": "Small file under 5KB",
      "conf": 0.7,
      "crit": "notable",
      "evidence": [
        {
          "method": "basename",
          "source": "target",
          "value": "cookieConsent.js"
        }
      ],
      "source_file": "obj/lateral/supply-chain/npm/behavior/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::runtime-send-message",
      "kind": "capability",
      "desc": "Sends message between extension contexts",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "(() => {\n  var __async = (__this, __arguments, generator) => {\n    return new Promise((resolve, reje...",
          "location": "1:1"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "__async(this, null, function* () {\n        return chrome.runtime.sendMessage(this.message, this.call...",
          "location": "61:14"
        },
        {
          "method": "ast",
          "source": "tree-sitter",
          "value": "chrome.runtime.sendMessage(this.message, this.callback)",
          "location": "62:16"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/api.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::sendMessage",
      "kind": "capability",
      "desc": "chrome.runtime.sendMessage",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "raw",
          "source": "raw_content",
          "value": "Found 1 chrome.runtime.sendMessage",
          "location": "file"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/traits.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::is-extension",
      "kind": "capability",
      "desc": "File is part of a browser extension",
      "conf": 0.9,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chrome.runtime"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/api.yaml"
    },
    {
      "id": "obj/lateral/supply-chain/chrome-ext/api::chrome-extension-context",
      "kind": "capability",
      "desc": "Chrome extension API context",
      "conf": 0.95,
      "crit": "notable",
      "evidence": [
        {
          "method": "import_symbol",
          "source": "ast",
          "value": "chrome.runtime.sendMessage"
        }
      ],
      "source_file": "obj/lateral/supply-chain/chrome-ext/api/traits.yaml"
    },
    {
      "id": "meta/internal/imported::reject",
      "kind": "structural",
      "desc": "calls reject",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "reject"
        }
      ]
    },
    {
      "id": "meta/internal/imported::resolve",
      "kind": "structural",
      "desc": "calls resolve",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "resolve"
        }
      ]
    },
    {
      "id": "meta/internal/imported::clientmessagequery",
      "kind": "structural",
      "desc": "calls ClientMessageQuery",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "ClientMessageQuery"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/reject",
      "kind": "structural",
      "desc": "calls Promise.reject",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.reject"
        }
      ]
    },
    {
      "id": "meta/internal/imported::generator/apply",
      "kind": "structural",
      "desc": "calls generator.apply",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "generator.apply"
        }
      ]
    },
    {
      "id": "meta/internal/imported::step",
      "kind": "structural",
      "desc": "calls step",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "step"
        }
      ]
    },
    {
      "id": "meta/internal/imported::isiframe",
      "kind": "structural",
      "desc": "calls isIFrame",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "isIFrame"
        }
      ]
    },
    {
      "id": "meta/internal/imported::chrome/runtime/sendmessage",
      "kind": "structural",
      "desc": "calls chrome.runtime.sendMessage",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "chrome.runtime.sendMessage"
        }
      ]
    },
    {
      "id": "meta/internal/imported::messagenotsenterror",
      "kind": "structural",
      "desc": "calls MessageNotSentError",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "MessageNotSentError"
        }
      ]
    },
    {
      "id": "meta/internal/imported::fulfilled",
      "kind": "structural",
      "desc": "calls fulfilled",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "fulfilled"
        }
      ]
    },
    {
      "id": "meta/internal/imported::command",
      "kind": "structural",
      "desc": "calls Command",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Command"
        }
      ]
    },
    {
      "id": "meta/internal/imported::async",
      "kind": "structural",
      "desc": "calls async",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "async"
        }
      ]
    },
    {
      "id": "meta/internal/imported::rejected",
      "kind": "structural",
      "desc": "calls rejected",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "rejected"
        }
      ]
    },
    {
      "id": "meta/internal/imported::messagequerybase",
      "kind": "structural",
      "desc": "calls MessageQueryBase",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "MessageQueryBase"
        }
      ]
    },
    {
      "id": "meta/internal/imported::generator/throw",
      "kind": "structural",
      "desc": "calls generator.throw",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "generator.throw"
        }
      ]
    },
    {
      "id": "meta/internal/imported::generator/next",
      "kind": "structural",
      "desc": "calls generator.next",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "generator.next"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/resolve",
      "kind": "structural",
      "desc": "calls Promise.resolve",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.resolve"
        }
      ]
    },
    {
      "id": "meta/internal/imported::generator",
      "kind": "structural",
      "desc": "calls generator",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "generator"
        }
      ]
    },
    {
      "id": "meta/internal/imported::promise/resolve/then",
      "kind": "structural",
      "desc": "calls Promise.resolve.then",
      "conf": 0.95,
      "crit": "inert",
      "evidence": [
        {
          "method": "symbol",
          "source": "ast",
          "value": "Promise.resolve.then"
        }
      ]
    }
  ]
}